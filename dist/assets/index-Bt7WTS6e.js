function hg(e,t){for(var n=0;n<t.length;n++){const i=t[n];if(typeof i!="string"&&!Array.isArray(i)){for(const l in i)if(l!=="default"&&!(l in e)){const c=Object.getOwnPropertyDescriptor(i,l);c&&Object.defineProperty(e,l,c.get?c:{enumerable:!0,get:()=>i[l]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const m of c.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&i(m)}).observe(document,{childList:!0,subtree:!0});function n(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(l){if(l.ep)return;l.ep=!0;const c=n(l);fetch(l.href,c)}})();var Sn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Dh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function ny(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(i){var l=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(n,i,l.get?l:{enumerable:!0,get:function(){return e[i]}})}),n}var fg={exports:{}},ru={},gg={exports:{}},ct={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _l=Symbol.for("react.element"),ry=Symbol.for("react.portal"),iy=Symbol.for("react.fragment"),sy=Symbol.for("react.strict_mode"),oy=Symbol.for("react.profiler"),ay=Symbol.for("react.provider"),ly=Symbol.for("react.context"),cy=Symbol.for("react.forward_ref"),uy=Symbol.for("react.suspense"),dy=Symbol.for("react.memo"),hy=Symbol.for("react.lazy"),u0=Symbol.iterator;function fy(e){return e===null||typeof e!="object"?null:(e=u0&&e[u0]||e["@@iterator"],typeof e=="function"?e:null)}var mg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},pg=Object.assign,xg={};function ra(e,t,n){this.props=e,this.context=t,this.refs=xg,this.updater=n||mg}ra.prototype.isReactComponent={};ra.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ra.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function yg(){}yg.prototype=ra.prototype;function Bh(e,t,n){this.props=e,this.context=t,this.refs=xg,this.updater=n||mg}var Fh=Bh.prototype=new yg;Fh.constructor=Bh;pg(Fh,ra.prototype);Fh.isPureReactComponent=!0;var d0=Array.isArray,vg=Object.prototype.hasOwnProperty,Uh={current:null},wg={key:!0,ref:!0,__self:!0,__source:!0};function _g(e,t,n){var i,l={},c=null,m=null;if(t!=null)for(i in t.ref!==void 0&&(m=t.ref),t.key!==void 0&&(c=""+t.key),t)vg.call(t,i)&&!wg.hasOwnProperty(i)&&(l[i]=t[i]);var _=arguments.length-2;if(_===1)l.children=n;else if(1<_){for(var v=Array(_),y=0;y<_;y++)v[y]=arguments[y+2];l.children=v}if(e&&e.defaultProps)for(i in _=e.defaultProps,_)l[i]===void 0&&(l[i]=_[i]);return{$$typeof:_l,type:e,key:c,ref:m,props:l,_owner:Uh.current}}function gy(e,t){return{$$typeof:_l,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function zh(e){return typeof e=="object"&&e!==null&&e.$$typeof===_l}function my(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var h0=/\/+/g;function Uu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?my(""+e.key):t.toString(36)}function hc(e,t,n,i,l){var c=typeof e;(c==="undefined"||c==="boolean")&&(e=null);var m=!1;if(e===null)m=!0;else switch(c){case"string":case"number":m=!0;break;case"object":switch(e.$$typeof){case _l:case ry:m=!0}}if(m)return m=e,l=l(m),e=i===""?"."+Uu(m,0):i,d0(l)?(n="",e!=null&&(n=e.replace(h0,"$&/")+"/"),hc(l,t,n,"",function(y){return y})):l!=null&&(zh(l)&&(l=gy(l,n+(!l.key||m&&m.key===l.key?"":(""+l.key).replace(h0,"$&/")+"/")+e)),t.push(l)),1;if(m=0,i=i===""?".":i+":",d0(e))for(var _=0;_<e.length;_++){c=e[_];var v=i+Uu(c,_);m+=hc(c,t,n,v,l)}else if(v=fy(e),typeof v=="function")for(e=v.call(e),_=0;!(c=e.next()).done;)c=c.value,v=i+Uu(c,_++),m+=hc(c,t,n,v,l);else if(c==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return m}function Wl(e,t,n){if(e==null)return e;var i=[],l=0;return hc(e,i,"","",function(c){return t.call(n,c,l++)}),i}function py(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Jn={current:null},fc={transition:null},xy={ReactCurrentDispatcher:Jn,ReactCurrentBatchConfig:fc,ReactCurrentOwner:Uh};function bg(){throw Error("act(...) is not supported in production builds of React.")}ct.Children={map:Wl,forEach:function(e,t,n){Wl(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Wl(e,function(){t++}),t},toArray:function(e){return Wl(e,function(t){return t})||[]},only:function(e){if(!zh(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ct.Component=ra;ct.Fragment=iy;ct.Profiler=oy;ct.PureComponent=Bh;ct.StrictMode=sy;ct.Suspense=uy;ct.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xy;ct.act=bg;ct.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=pg({},e.props),l=e.key,c=e.ref,m=e._owner;if(t!=null){if(t.ref!==void 0&&(c=t.ref,m=Uh.current),t.key!==void 0&&(l=""+t.key),e.type&&e.type.defaultProps)var _=e.type.defaultProps;for(v in t)vg.call(t,v)&&!wg.hasOwnProperty(v)&&(i[v]=t[v]===void 0&&_!==void 0?_[v]:t[v])}var v=arguments.length-2;if(v===1)i.children=n;else if(1<v){_=Array(v);for(var y=0;y<v;y++)_[y]=arguments[y+2];i.children=_}return{$$typeof:_l,type:e.type,key:l,ref:c,props:i,_owner:m}};ct.createContext=function(e){return e={$$typeof:ly,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:ay,_context:e},e.Consumer=e};ct.createElement=_g;ct.createFactory=function(e){var t=_g.bind(null,e);return t.type=e,t};ct.createRef=function(){return{current:null}};ct.forwardRef=function(e){return{$$typeof:cy,render:e}};ct.isValidElement=zh;ct.lazy=function(e){return{$$typeof:hy,_payload:{_status:-1,_result:e},_init:py}};ct.memo=function(e,t){return{$$typeof:dy,type:e,compare:t===void 0?null:t}};ct.startTransition=function(e){var t=fc.transition;fc.transition={};try{e()}finally{fc.transition=t}};ct.unstable_act=bg;ct.useCallback=function(e,t){return Jn.current.useCallback(e,t)};ct.useContext=function(e){return Jn.current.useContext(e)};ct.useDebugValue=function(){};ct.useDeferredValue=function(e){return Jn.current.useDeferredValue(e)};ct.useEffect=function(e,t){return Jn.current.useEffect(e,t)};ct.useId=function(){return Jn.current.useId()};ct.useImperativeHandle=function(e,t,n){return Jn.current.useImperativeHandle(e,t,n)};ct.useInsertionEffect=function(e,t){return Jn.current.useInsertionEffect(e,t)};ct.useLayoutEffect=function(e,t){return Jn.current.useLayoutEffect(e,t)};ct.useMemo=function(e,t){return Jn.current.useMemo(e,t)};ct.useReducer=function(e,t,n){return Jn.current.useReducer(e,t,n)};ct.useRef=function(e){return Jn.current.useRef(e)};ct.useState=function(e){return Jn.current.useState(e)};ct.useSyncExternalStore=function(e,t,n){return Jn.current.useSyncExternalStore(e,t,n)};ct.useTransition=function(){return Jn.current.useTransition()};ct.version="18.3.1";gg.exports=ct;var H=gg.exports;const qn=Dh(H),yy=hg({__proto__:null,default:qn},[H]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vy=H,wy=Symbol.for("react.element"),_y=Symbol.for("react.fragment"),by=Object.prototype.hasOwnProperty,Cy=vy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ey={key:!0,ref:!0,__self:!0,__source:!0};function Cg(e,t,n){var i,l={},c=null,m=null;n!==void 0&&(c=""+n),t.key!==void 0&&(c=""+t.key),t.ref!==void 0&&(m=t.ref);for(i in t)by.call(t,i)&&!Ey.hasOwnProperty(i)&&(l[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)l[i]===void 0&&(l[i]=t[i]);return{$$typeof:wy,type:e,key:c,ref:m,props:l,_owner:Cy.current}}ru.Fragment=_y;ru.jsx=Cg;ru.jsxs=Cg;fg.exports=ru;var g=fg.exports,bd={},Eg={exports:{}},Cr={},Sg={exports:{}},Ag={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(K,me){var le=K.length;K.push(me);e:for(;0<le;){var be=le-1>>>1,we=K[be];if(0<l(we,me))K[be]=me,K[le]=we,le=be;else break e}}function n(K){return K.length===0?null:K[0]}function i(K){if(K.length===0)return null;var me=K[0],le=K.pop();if(le!==me){K[0]=le;e:for(var be=0,we=K.length,Qe=we>>>1;be<Qe;){var Fe=2*(be+1)-1,Ve=K[Fe],fe=Fe+1,je=K[fe];if(0>l(Ve,le))fe<we&&0>l(je,Ve)?(K[be]=je,K[fe]=le,be=fe):(K[be]=Ve,K[Fe]=le,be=Fe);else if(fe<we&&0>l(je,le))K[be]=je,K[fe]=le,be=fe;else break e}}return me}function l(K,me){var le=K.sortIndex-me.sortIndex;return le!==0?le:K.id-me.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;e.unstable_now=function(){return c.now()}}else{var m=Date,_=m.now();e.unstable_now=function(){return m.now()-_}}var v=[],y=[],S=1,E=null,T=3,U=!1,j=!1,P=!1,D=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(K){for(var me=n(y);me!==null;){if(me.callback===null)i(y);else if(me.startTime<=K)i(y),me.sortIndex=me.expirationTime,t(v,me);else break;me=n(y)}}function z(K){if(P=!1,k(K),!j)if(n(v)!==null)j=!0,pe(G);else{var me=n(y);me!==null&&ne(z,me.startTime-K)}}function G(K,me){j=!1,P&&(P=!1,R(J),J=-1),U=!0;var le=T;try{for(k(me),E=n(v);E!==null&&(!(E.expirationTime>me)||K&&!ce());){var be=E.callback;if(typeof be=="function"){E.callback=null,T=E.priorityLevel;var we=be(E.expirationTime<=me);me=e.unstable_now(),typeof we=="function"?E.callback=we:E===n(v)&&i(v),k(me)}else i(v);E=n(v)}if(E!==null)var Qe=!0;else{var Fe=n(y);Fe!==null&&ne(z,Fe.startTime-me),Qe=!1}return Qe}finally{E=null,T=le,U=!1}}var Y=!1,Z=null,J=-1,ie=5,Ee=-1;function ce(){return!(e.unstable_now()-Ee<ie)}function ue(){if(Z!==null){var K=e.unstable_now();Ee=K;var me=!0;try{me=Z(!0,K)}finally{me?Ie():(Y=!1,Z=null)}}else Y=!1}var Ie;if(typeof I=="function")Ie=function(){I(ue)};else if(typeof MessageChannel<"u"){var Te=new MessageChannel,Q=Te.port2;Te.port1.onmessage=ue,Ie=function(){Q.postMessage(null)}}else Ie=function(){D(ue,0)};function pe(K){Z=K,Y||(Y=!0,Ie())}function ne(K,me){J=D(function(){K(e.unstable_now())},me)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(K){K.callback=null},e.unstable_continueExecution=function(){j||U||(j=!0,pe(G))},e.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ie=0<K?Math.floor(1e3/K):5},e.unstable_getCurrentPriorityLevel=function(){return T},e.unstable_getFirstCallbackNode=function(){return n(v)},e.unstable_next=function(K){switch(T){case 1:case 2:case 3:var me=3;break;default:me=T}var le=T;T=me;try{return K()}finally{T=le}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(K,me){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var le=T;T=K;try{return me()}finally{T=le}},e.unstable_scheduleCallback=function(K,me,le){var be=e.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?be+le:be):le=be,K){case 1:var we=-1;break;case 2:we=250;break;case 5:we=1073741823;break;case 4:we=1e4;break;default:we=5e3}return we=le+we,K={id:S++,callback:me,priorityLevel:K,startTime:le,expirationTime:we,sortIndex:-1},le>be?(K.sortIndex=le,t(y,K),n(v)===null&&K===n(y)&&(P?(R(J),J=-1):P=!0,ne(z,le-be))):(K.sortIndex=we,t(v,K),j||U||(j=!0,pe(G))),K},e.unstable_shouldYield=ce,e.unstable_wrapCallback=function(K){var me=T;return function(){var le=T;T=me;try{return K.apply(this,arguments)}finally{T=le}}}})(Ag);Sg.exports=Ag;var Sy=Sg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ay=H,br=Sy;function ve(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ng=new Set,tl={};function lo(e,t){Yo(e,t),Yo(e+"Capture",t)}function Yo(e,t){for(tl[e]=t,e=0;e<t.length;e++)Ng.add(t[e])}var ji=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Cd=Object.prototype.hasOwnProperty,Ny=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f0={},g0={};function Ty(e){return Cd.call(g0,e)?!0:Cd.call(f0,e)?!1:Ny.test(e)?g0[e]=!0:(f0[e]=!0,!1)}function Iy(e,t,n,i){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function ky(e,t,n,i){if(t===null||typeof t>"u"||Iy(e,t,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function er(e,t,n,i,l,c,m){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=l,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=c,this.removeEmptyString=m}var On={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){On[e]=new er(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];On[t]=new er(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){On[e]=new er(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){On[e]=new er(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){On[e]=new er(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){On[e]=new er(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){On[e]=new er(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){On[e]=new er(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){On[e]=new er(e,5,!1,e.toLowerCase(),null,!1,!1)});var Hh=/[\-:]([a-z])/g;function Wh(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Hh,Wh);On[t]=new er(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Hh,Wh);On[t]=new er(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Hh,Wh);On[t]=new er(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){On[e]=new er(e,1,!1,e.toLowerCase(),null,!1,!1)});On.xlinkHref=new er("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){On[e]=new er(e,1,!1,e.toLowerCase(),null,!0,!0)});function Vh(e,t,n,i){var l=On.hasOwnProperty(t)?On[t]:null;(l!==null?l.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(ky(t,n,l,i)&&(n=null),i||l===null?Ty(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):l.mustUseProperty?e[l.propertyName]=n===null?l.type===3?!1:"":n:(t=l.attributeName,i=l.attributeNamespace,n===null?e.removeAttribute(t):(l=l.type,n=l===3||l===4&&n===!0?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}var Ui=Ay.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Vl=Symbol.for("react.element"),To=Symbol.for("react.portal"),Io=Symbol.for("react.fragment"),Gh=Symbol.for("react.strict_mode"),Ed=Symbol.for("react.profiler"),Tg=Symbol.for("react.provider"),Ig=Symbol.for("react.context"),Zh=Symbol.for("react.forward_ref"),Sd=Symbol.for("react.suspense"),Ad=Symbol.for("react.suspense_list"),Yh=Symbol.for("react.memo"),ss=Symbol.for("react.lazy"),kg=Symbol.for("react.offscreen"),m0=Symbol.iterator;function Ta(e){return e===null||typeof e!="object"?null:(e=m0&&e[m0]||e["@@iterator"],typeof e=="function"?e:null)}var Xt=Object.assign,zu;function Da(e){if(zu===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);zu=t&&t[1]||""}return`
`+zu+e}var Hu=!1;function Wu(e,t){if(!e||Hu)return"";Hu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(y){var i=y}Reflect.construct(e,[],t)}else{try{t.call()}catch(y){i=y}e.call(t.prototype)}else{try{throw Error()}catch(y){i=y}e()}}catch(y){if(y&&i&&typeof y.stack=="string"){for(var l=y.stack.split(`
`),c=i.stack.split(`
`),m=l.length-1,_=c.length-1;1<=m&&0<=_&&l[m]!==c[_];)_--;for(;1<=m&&0<=_;m--,_--)if(l[m]!==c[_]){if(m!==1||_!==1)do if(m--,_--,0>_||l[m]!==c[_]){var v=`
`+l[m].replace(" at new "," at ");return e.displayName&&v.includes("<anonymous>")&&(v=v.replace("<anonymous>",e.displayName)),v}while(1<=m&&0<=_);break}}}finally{Hu=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Da(e):""}function My(e){switch(e.tag){case 5:return Da(e.type);case 16:return Da("Lazy");case 13:return Da("Suspense");case 19:return Da("SuspenseList");case 0:case 2:case 15:return e=Wu(e.type,!1),e;case 11:return e=Wu(e.type.render,!1),e;case 1:return e=Wu(e.type,!0),e;default:return""}}function Nd(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Io:return"Fragment";case To:return"Portal";case Ed:return"Profiler";case Gh:return"StrictMode";case Sd:return"Suspense";case Ad:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ig:return(e.displayName||"Context")+".Consumer";case Tg:return(e._context.displayName||"Context")+".Provider";case Zh:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Yh:return t=e.displayName||null,t!==null?t:Nd(e.type)||"Memo";case ss:t=e._payload,e=e._init;try{return Nd(e(t))}catch{}}return null}function Oy(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Nd(t);case 8:return t===Gh?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Cs(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Mg(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Ly(e){var t=Mg(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var l=n.get,c=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return l.call(this)},set:function(m){i=""+m,c.call(this,m)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(m){i=""+m},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Gl(e){e._valueTracker||(e._valueTracker=Ly(e))}function Og(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=Mg(e)?e.checked?"true":"false":e.value),e=i,e!==n?(t.setValue(e),!0):!1}function Ec(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Td(e,t){var n=t.checked;return Xt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function p0(e,t){var n=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;n=Cs(t.value!=null?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Lg(e,t){t=t.checked,t!=null&&Vh(e,"checked",t,!1)}function Id(e,t){Lg(e,t);var n=Cs(t.value),i=t.type;if(n!=null)i==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?kd(e,t.type,n):t.hasOwnProperty("defaultValue")&&kd(e,t.type,Cs(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function x0(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function kd(e,t,n){(t!=="number"||Ec(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Ba=Array.isArray;function zo(e,t,n,i){if(e=e.options,t){t={};for(var l=0;l<n.length;l++)t["$"+n[l]]=!0;for(n=0;n<e.length;n++)l=t.hasOwnProperty("$"+e[n].value),e[n].selected!==l&&(e[n].selected=l),l&&i&&(e[n].defaultSelected=!0)}else{for(n=""+Cs(n),t=null,l=0;l<e.length;l++){if(e[l].value===n){e[l].selected=!0,i&&(e[l].defaultSelected=!0);return}t!==null||e[l].disabled||(t=e[l])}t!==null&&(t.selected=!0)}}function Md(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ve(91));return Xt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function y0(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ve(92));if(Ba(n)){if(1<n.length)throw Error(ve(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Cs(n)}}function Pg(e,t){var n=Cs(t.value),i=Cs(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),i!=null&&(e.defaultValue=""+i)}function v0(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Rg(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Od(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Rg(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Zl,jg=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,i,l){MSApp.execUnsafeLocalFunction(function(){return e(t,n,i,l)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Zl=Zl||document.createElement("div"),Zl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Zl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function nl(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Wa={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Py=["Webkit","ms","Moz","O"];Object.keys(Wa).forEach(function(e){Py.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Wa[t]=Wa[e]})});function Dg(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Wa.hasOwnProperty(e)&&Wa[e]?(""+t).trim():t+"px"}function Bg(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var i=n.indexOf("--")===0,l=Dg(n,t[n],i);n==="float"&&(n="cssFloat"),i?e.setProperty(n,l):e[n]=l}}var Ry=Xt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ld(e,t){if(t){if(Ry[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ve(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ve(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ve(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ve(62))}}function Pd(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rd=null;function $h(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var jd=null,Ho=null,Wo=null;function w0(e){if(e=El(e)){if(typeof jd!="function")throw Error(ve(280));var t=e.stateNode;t&&(t=lu(t),jd(e.stateNode,e.type,t))}}function Fg(e){Ho?Wo?Wo.push(e):Wo=[e]:Ho=e}function Ug(){if(Ho){var e=Ho,t=Wo;if(Wo=Ho=null,w0(e),t)for(e=0;e<t.length;e++)w0(t[e])}}function zg(e,t){return e(t)}function Hg(){}var Vu=!1;function Wg(e,t,n){if(Vu)return e(t,n);Vu=!0;try{return zg(e,t,n)}finally{Vu=!1,(Ho!==null||Wo!==null)&&(Hg(),Ug())}}function rl(e,t){var n=e.stateNode;if(n===null)return null;var i=lu(n);if(i===null)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ve(231,t,typeof n));return n}var Dd=!1;if(ji)try{var Ia={};Object.defineProperty(Ia,"passive",{get:function(){Dd=!0}}),window.addEventListener("test",Ia,Ia),window.removeEventListener("test",Ia,Ia)}catch{Dd=!1}function jy(e,t,n,i,l,c,m,_,v){var y=Array.prototype.slice.call(arguments,3);try{t.apply(n,y)}catch(S){this.onError(S)}}var Va=!1,Sc=null,Ac=!1,Bd=null,Dy={onError:function(e){Va=!0,Sc=e}};function By(e,t,n,i,l,c,m,_,v){Va=!1,Sc=null,jy.apply(Dy,arguments)}function Fy(e,t,n,i,l,c,m,_,v){if(By.apply(this,arguments),Va){if(Va){var y=Sc;Va=!1,Sc=null}else throw Error(ve(198));Ac||(Ac=!0,Bd=y)}}function co(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Vg(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function _0(e){if(co(e)!==e)throw Error(ve(188))}function Uy(e){var t=e.alternate;if(!t){if(t=co(e),t===null)throw Error(ve(188));return t!==e?null:e}for(var n=e,i=t;;){var l=n.return;if(l===null)break;var c=l.alternate;if(c===null){if(i=l.return,i!==null){n=i;continue}break}if(l.child===c.child){for(c=l.child;c;){if(c===n)return _0(l),e;if(c===i)return _0(l),t;c=c.sibling}throw Error(ve(188))}if(n.return!==i.return)n=l,i=c;else{for(var m=!1,_=l.child;_;){if(_===n){m=!0,n=l,i=c;break}if(_===i){m=!0,i=l,n=c;break}_=_.sibling}if(!m){for(_=c.child;_;){if(_===n){m=!0,n=c,i=l;break}if(_===i){m=!0,i=c,n=l;break}_=_.sibling}if(!m)throw Error(ve(189))}}if(n.alternate!==i)throw Error(ve(190))}if(n.tag!==3)throw Error(ve(188));return n.stateNode.current===n?e:t}function Gg(e){return e=Uy(e),e!==null?Zg(e):null}function Zg(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Zg(e);if(t!==null)return t;e=e.sibling}return null}var Yg=br.unstable_scheduleCallback,b0=br.unstable_cancelCallback,zy=br.unstable_shouldYield,Hy=br.unstable_requestPaint,nn=br.unstable_now,Wy=br.unstable_getCurrentPriorityLevel,Xh=br.unstable_ImmediatePriority,$g=br.unstable_UserBlockingPriority,Nc=br.unstable_NormalPriority,Vy=br.unstable_LowPriority,Xg=br.unstable_IdlePriority,iu=null,mi=null;function Gy(e){if(mi&&typeof mi.onCommitFiberRoot=="function")try{mi.onCommitFiberRoot(iu,e,void 0,(e.current.flags&128)===128)}catch{}}var ei=Math.clz32?Math.clz32:$y,Zy=Math.log,Yy=Math.LN2;function $y(e){return e>>>=0,e===0?32:31-(Zy(e)/Yy|0)|0}var Yl=64,$l=4194304;function Fa(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Tc(e,t){var n=e.pendingLanes;if(n===0)return 0;var i=0,l=e.suspendedLanes,c=e.pingedLanes,m=n&268435455;if(m!==0){var _=m&~l;_!==0?i=Fa(_):(c&=m,c!==0&&(i=Fa(c)))}else m=n&~l,m!==0?i=Fa(m):c!==0&&(i=Fa(c));if(i===0)return 0;if(t!==0&&t!==i&&!(t&l)&&(l=i&-i,c=t&-t,l>=c||l===16&&(c&4194240)!==0))return t;if(i&4&&(i|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=i;0<t;)n=31-ei(t),l=1<<n,i|=e[n],t&=~l;return i}function Xy(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qy(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,l=e.expirationTimes,c=e.pendingLanes;0<c;){var m=31-ei(c),_=1<<m,v=l[m];v===-1?(!(_&n)||_&i)&&(l[m]=Xy(_,t)):v<=t&&(e.expiredLanes|=_),c&=~_}}function Fd(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function qg(){var e=Yl;return Yl<<=1,!(Yl&4194240)&&(Yl=64),e}function Gu(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function bl(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ei(t),e[t]=n}function Ky(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var l=31-ei(n),c=1<<l;t[l]=0,i[l]=-1,e[l]=-1,n&=~c}}function qh(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-ei(n),l=1<<i;l&t|e[i]&t&&(e[i]|=t),n&=~l}}var St=0;function Kg(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Qg,Kh,Jg,em,tm,Ud=!1,Xl=[],fs=null,gs=null,ms=null,il=new Map,sl=new Map,as=[],Qy="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function C0(e,t){switch(e){case"focusin":case"focusout":fs=null;break;case"dragenter":case"dragleave":gs=null;break;case"mouseover":case"mouseout":ms=null;break;case"pointerover":case"pointerout":il.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":sl.delete(t.pointerId)}}function ka(e,t,n,i,l,c){return e===null||e.nativeEvent!==c?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:c,targetContainers:[l]},t!==null&&(t=El(t),t!==null&&Kh(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,l!==null&&t.indexOf(l)===-1&&t.push(l),e)}function Jy(e,t,n,i,l){switch(t){case"focusin":return fs=ka(fs,e,t,n,i,l),!0;case"dragenter":return gs=ka(gs,e,t,n,i,l),!0;case"mouseover":return ms=ka(ms,e,t,n,i,l),!0;case"pointerover":var c=l.pointerId;return il.set(c,ka(il.get(c)||null,e,t,n,i,l)),!0;case"gotpointercapture":return c=l.pointerId,sl.set(c,ka(sl.get(c)||null,e,t,n,i,l)),!0}return!1}function nm(e){var t=Ks(e.target);if(t!==null){var n=co(t);if(n!==null){if(t=n.tag,t===13){if(t=Vg(n),t!==null){e.blockedOn=t,tm(e.priority,function(){Jg(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function gc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=zd(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var i=new n.constructor(n.type,n);Rd=i,n.target.dispatchEvent(i),Rd=null}else return t=El(n),t!==null&&Kh(t),e.blockedOn=n,!1;t.shift()}return!0}function E0(e,t,n){gc(e)&&n.delete(t)}function e2(){Ud=!1,fs!==null&&gc(fs)&&(fs=null),gs!==null&&gc(gs)&&(gs=null),ms!==null&&gc(ms)&&(ms=null),il.forEach(E0),sl.forEach(E0)}function Ma(e,t){e.blockedOn===t&&(e.blockedOn=null,Ud||(Ud=!0,br.unstable_scheduleCallback(br.unstable_NormalPriority,e2)))}function ol(e){function t(l){return Ma(l,e)}if(0<Xl.length){Ma(Xl[0],e);for(var n=1;n<Xl.length;n++){var i=Xl[n];i.blockedOn===e&&(i.blockedOn=null)}}for(fs!==null&&Ma(fs,e),gs!==null&&Ma(gs,e),ms!==null&&Ma(ms,e),il.forEach(t),sl.forEach(t),n=0;n<as.length;n++)i=as[n],i.blockedOn===e&&(i.blockedOn=null);for(;0<as.length&&(n=as[0],n.blockedOn===null);)nm(n),n.blockedOn===null&&as.shift()}var Vo=Ui.ReactCurrentBatchConfig,Ic=!0;function t2(e,t,n,i){var l=St,c=Vo.transition;Vo.transition=null;try{St=1,Qh(e,t,n,i)}finally{St=l,Vo.transition=c}}function n2(e,t,n,i){var l=St,c=Vo.transition;Vo.transition=null;try{St=4,Qh(e,t,n,i)}finally{St=l,Vo.transition=c}}function Qh(e,t,n,i){if(Ic){var l=zd(e,t,n,i);if(l===null)td(e,t,i,kc,n),C0(e,i);else if(Jy(l,e,t,n,i))i.stopPropagation();else if(C0(e,i),t&4&&-1<Qy.indexOf(e)){for(;l!==null;){var c=El(l);if(c!==null&&Qg(c),c=zd(e,t,n,i),c===null&&td(e,t,i,kc,n),c===l)break;l=c}l!==null&&i.stopPropagation()}else td(e,t,i,null,n)}}var kc=null;function zd(e,t,n,i){if(kc=null,e=$h(i),e=Ks(e),e!==null)if(t=co(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Vg(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return kc=e,null}function rm(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Wy()){case Xh:return 1;case $g:return 4;case Nc:case Vy:return 16;case Xg:return 536870912;default:return 16}default:return 16}}var us=null,Jh=null,mc=null;function im(){if(mc)return mc;var e,t=Jh,n=t.length,i,l="value"in us?us.value:us.textContent,c=l.length;for(e=0;e<n&&t[e]===l[e];e++);var m=n-e;for(i=1;i<=m&&t[n-i]===l[c-i];i++);return mc=l.slice(e,1<i?1-i:void 0)}function pc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ql(){return!0}function S0(){return!1}function Er(e){function t(n,i,l,c,m){this._reactName=n,this._targetInst=l,this.type=i,this.nativeEvent=c,this.target=m,this.currentTarget=null;for(var _ in e)e.hasOwnProperty(_)&&(n=e[_],this[_]=n?n(c):c[_]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?ql:S0,this.isPropagationStopped=S0,this}return Xt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ql)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ql)},persist:function(){},isPersistent:ql}),t}var ia={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ef=Er(ia),Cl=Xt({},ia,{view:0,detail:0}),r2=Er(Cl),Zu,Yu,Oa,su=Xt({},Cl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:tf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Oa&&(Oa&&e.type==="mousemove"?(Zu=e.screenX-Oa.screenX,Yu=e.screenY-Oa.screenY):Yu=Zu=0,Oa=e),Zu)},movementY:function(e){return"movementY"in e?e.movementY:Yu}}),A0=Er(su),i2=Xt({},su,{dataTransfer:0}),s2=Er(i2),o2=Xt({},Cl,{relatedTarget:0}),$u=Er(o2),a2=Xt({},ia,{animationName:0,elapsedTime:0,pseudoElement:0}),l2=Er(a2),c2=Xt({},ia,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),u2=Er(c2),d2=Xt({},ia,{data:0}),N0=Er(d2),h2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},f2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},g2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function m2(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=g2[e])?!!t[e]:!1}function tf(){return m2}var p2=Xt({},Cl,{key:function(e){if(e.key){var t=h2[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=pc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?f2[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:tf,charCode:function(e){return e.type==="keypress"?pc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?pc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),x2=Er(p2),y2=Xt({},su,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),T0=Er(y2),v2=Xt({},Cl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:tf}),w2=Er(v2),_2=Xt({},ia,{propertyName:0,elapsedTime:0,pseudoElement:0}),b2=Er(_2),C2=Xt({},su,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),E2=Er(C2),S2=[9,13,27,32],nf=ji&&"CompositionEvent"in window,Ga=null;ji&&"documentMode"in document&&(Ga=document.documentMode);var A2=ji&&"TextEvent"in window&&!Ga,sm=ji&&(!nf||Ga&&8<Ga&&11>=Ga),I0=" ",k0=!1;function om(e,t){switch(e){case"keyup":return S2.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function am(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ko=!1;function N2(e,t){switch(e){case"compositionend":return am(t);case"keypress":return t.which!==32?null:(k0=!0,I0);case"textInput":return e=t.data,e===I0&&k0?null:e;default:return null}}function T2(e,t){if(ko)return e==="compositionend"||!nf&&om(e,t)?(e=im(),mc=Jh=us=null,ko=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return sm&&t.locale!=="ko"?null:t.data;default:return null}}var I2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function M0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!I2[e.type]:t==="textarea"}function lm(e,t,n,i){Fg(i),t=Mc(t,"onChange"),0<t.length&&(n=new ef("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Za=null,al=null;function k2(e){vm(e,0)}function ou(e){var t=Lo(e);if(Og(t))return e}function M2(e,t){if(e==="change")return t}var cm=!1;if(ji){var Xu;if(ji){var qu="oninput"in document;if(!qu){var O0=document.createElement("div");O0.setAttribute("oninput","return;"),qu=typeof O0.oninput=="function"}Xu=qu}else Xu=!1;cm=Xu&&(!document.documentMode||9<document.documentMode)}function L0(){Za&&(Za.detachEvent("onpropertychange",um),al=Za=null)}function um(e){if(e.propertyName==="value"&&ou(al)){var t=[];lm(t,al,e,$h(e)),Wg(k2,t)}}function O2(e,t,n){e==="focusin"?(L0(),Za=t,al=n,Za.attachEvent("onpropertychange",um)):e==="focusout"&&L0()}function L2(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ou(al)}function P2(e,t){if(e==="click")return ou(t)}function R2(e,t){if(e==="input"||e==="change")return ou(t)}function j2(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ni=typeof Object.is=="function"?Object.is:j2;function ll(e,t){if(ni(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var l=n[i];if(!Cd.call(t,l)||!ni(e[l],t[l]))return!1}return!0}function P0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function R0(e,t){var n=P0(e);e=0;for(var i;n;){if(n.nodeType===3){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=P0(n)}}function dm(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?dm(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function hm(){for(var e=window,t=Ec();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Ec(e.document)}return t}function rf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function D2(e){var t=hm(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dm(n.ownerDocument.documentElement,n)){if(i!==null&&rf(n)){if(t=i.start,e=i.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var l=n.textContent.length,c=Math.min(i.start,l);i=i.end===void 0?c:Math.min(i.end,l),!e.extend&&c>i&&(l=i,i=c,c=l),l=R0(n,c);var m=R0(n,i);l&&m&&(e.rangeCount!==1||e.anchorNode!==l.node||e.anchorOffset!==l.offset||e.focusNode!==m.node||e.focusOffset!==m.offset)&&(t=t.createRange(),t.setStart(l.node,l.offset),e.removeAllRanges(),c>i?(e.addRange(t),e.extend(m.node,m.offset)):(t.setEnd(m.node,m.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var B2=ji&&"documentMode"in document&&11>=document.documentMode,Mo=null,Hd=null,Ya=null,Wd=!1;function j0(e,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Wd||Mo==null||Mo!==Ec(i)||(i=Mo,"selectionStart"in i&&rf(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Ya&&ll(Ya,i)||(Ya=i,i=Mc(Hd,"onSelect"),0<i.length&&(t=new ef("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=Mo)))}function Kl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Oo={animationend:Kl("Animation","AnimationEnd"),animationiteration:Kl("Animation","AnimationIteration"),animationstart:Kl("Animation","AnimationStart"),transitionend:Kl("Transition","TransitionEnd")},Ku={},fm={};ji&&(fm=document.createElement("div").style,"AnimationEvent"in window||(delete Oo.animationend.animation,delete Oo.animationiteration.animation,delete Oo.animationstart.animation),"TransitionEvent"in window||delete Oo.transitionend.transition);function au(e){if(Ku[e])return Ku[e];if(!Oo[e])return e;var t=Oo[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in fm)return Ku[e]=t[n];return e}var gm=au("animationend"),mm=au("animationiteration"),pm=au("animationstart"),xm=au("transitionend"),ym=new Map,D0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function As(e,t){ym.set(e,t),lo(t,[e])}for(var Qu=0;Qu<D0.length;Qu++){var Ju=D0[Qu],F2=Ju.toLowerCase(),U2=Ju[0].toUpperCase()+Ju.slice(1);As(F2,"on"+U2)}As(gm,"onAnimationEnd");As(mm,"onAnimationIteration");As(pm,"onAnimationStart");As("dblclick","onDoubleClick");As("focusin","onFocus");As("focusout","onBlur");As(xm,"onTransitionEnd");Yo("onMouseEnter",["mouseout","mouseover"]);Yo("onMouseLeave",["mouseout","mouseover"]);Yo("onPointerEnter",["pointerout","pointerover"]);Yo("onPointerLeave",["pointerout","pointerover"]);lo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));lo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));lo("onBeforeInput",["compositionend","keypress","textInput","paste"]);lo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));lo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));lo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ua="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),z2=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ua));function B0(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,Fy(i,t,void 0,e),e.currentTarget=null}function vm(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var i=e[n],l=i.event;i=i.listeners;e:{var c=void 0;if(t)for(var m=i.length-1;0<=m;m--){var _=i[m],v=_.instance,y=_.currentTarget;if(_=_.listener,v!==c&&l.isPropagationStopped())break e;B0(l,_,y),c=v}else for(m=0;m<i.length;m++){if(_=i[m],v=_.instance,y=_.currentTarget,_=_.listener,v!==c&&l.isPropagationStopped())break e;B0(l,_,y),c=v}}}if(Ac)throw e=Bd,Ac=!1,Bd=null,e}function zt(e,t){var n=t[$d];n===void 0&&(n=t[$d]=new Set);var i=e+"__bubble";n.has(i)||(wm(t,e,2,!1),n.add(i))}function ed(e,t,n){var i=0;t&&(i|=4),wm(n,e,i,t)}var Ql="_reactListening"+Math.random().toString(36).slice(2);function cl(e){if(!e[Ql]){e[Ql]=!0,Ng.forEach(function(n){n!=="selectionchange"&&(z2.has(n)||ed(n,!1,e),ed(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ql]||(t[Ql]=!0,ed("selectionchange",!1,t))}}function wm(e,t,n,i){switch(rm(t)){case 1:var l=t2;break;case 4:l=n2;break;default:l=Qh}n=l.bind(null,t,n,e),l=void 0,!Dd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(l=!0),i?l!==void 0?e.addEventListener(t,n,{capture:!0,passive:l}):e.addEventListener(t,n,!0):l!==void 0?e.addEventListener(t,n,{passive:l}):e.addEventListener(t,n,!1)}function td(e,t,n,i,l){var c=i;if(!(t&1)&&!(t&2)&&i!==null)e:for(;;){if(i===null)return;var m=i.tag;if(m===3||m===4){var _=i.stateNode.containerInfo;if(_===l||_.nodeType===8&&_.parentNode===l)break;if(m===4)for(m=i.return;m!==null;){var v=m.tag;if((v===3||v===4)&&(v=m.stateNode.containerInfo,v===l||v.nodeType===8&&v.parentNode===l))return;m=m.return}for(;_!==null;){if(m=Ks(_),m===null)return;if(v=m.tag,v===5||v===6){i=c=m;continue e}_=_.parentNode}}i=i.return}Wg(function(){var y=c,S=$h(n),E=[];e:{var T=ym.get(e);if(T!==void 0){var U=ef,j=e;switch(e){case"keypress":if(pc(n)===0)break e;case"keydown":case"keyup":U=x2;break;case"focusin":j="focus",U=$u;break;case"focusout":j="blur",U=$u;break;case"beforeblur":case"afterblur":U=$u;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":U=A0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":U=s2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":U=w2;break;case gm:case mm:case pm:U=l2;break;case xm:U=b2;break;case"scroll":U=r2;break;case"wheel":U=E2;break;case"copy":case"cut":case"paste":U=u2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":U=T0}var P=(t&4)!==0,D=!P&&e==="scroll",R=P?T!==null?T+"Capture":null:T;P=[];for(var I=y,k;I!==null;){k=I;var z=k.stateNode;if(k.tag===5&&z!==null&&(k=z,R!==null&&(z=rl(I,R),z!=null&&P.push(ul(I,z,k)))),D)break;I=I.return}0<P.length&&(T=new U(T,j,null,n,S),E.push({event:T,listeners:P}))}}if(!(t&7)){e:{if(T=e==="mouseover"||e==="pointerover",U=e==="mouseout"||e==="pointerout",T&&n!==Rd&&(j=n.relatedTarget||n.fromElement)&&(Ks(j)||j[Di]))break e;if((U||T)&&(T=S.window===S?S:(T=S.ownerDocument)?T.defaultView||T.parentWindow:window,U?(j=n.relatedTarget||n.toElement,U=y,j=j?Ks(j):null,j!==null&&(D=co(j),j!==D||j.tag!==5&&j.tag!==6)&&(j=null)):(U=null,j=y),U!==j)){if(P=A0,z="onMouseLeave",R="onMouseEnter",I="mouse",(e==="pointerout"||e==="pointerover")&&(P=T0,z="onPointerLeave",R="onPointerEnter",I="pointer"),D=U==null?T:Lo(U),k=j==null?T:Lo(j),T=new P(z,I+"leave",U,n,S),T.target=D,T.relatedTarget=k,z=null,Ks(S)===y&&(P=new P(R,I+"enter",j,n,S),P.target=k,P.relatedTarget=D,z=P),D=z,U&&j)t:{for(P=U,R=j,I=0,k=P;k;k=wo(k))I++;for(k=0,z=R;z;z=wo(z))k++;for(;0<I-k;)P=wo(P),I--;for(;0<k-I;)R=wo(R),k--;for(;I--;){if(P===R||R!==null&&P===R.alternate)break t;P=wo(P),R=wo(R)}P=null}else P=null;U!==null&&F0(E,T,U,P,!1),j!==null&&D!==null&&F0(E,D,j,P,!0)}}e:{if(T=y?Lo(y):window,U=T.nodeName&&T.nodeName.toLowerCase(),U==="select"||U==="input"&&T.type==="file")var G=M2;else if(M0(T))if(cm)G=R2;else{G=L2;var Y=O2}else(U=T.nodeName)&&U.toLowerCase()==="input"&&(T.type==="checkbox"||T.type==="radio")&&(G=P2);if(G&&(G=G(e,y))){lm(E,G,n,S);break e}Y&&Y(e,T,y),e==="focusout"&&(Y=T._wrapperState)&&Y.controlled&&T.type==="number"&&kd(T,"number",T.value)}switch(Y=y?Lo(y):window,e){case"focusin":(M0(Y)||Y.contentEditable==="true")&&(Mo=Y,Hd=y,Ya=null);break;case"focusout":Ya=Hd=Mo=null;break;case"mousedown":Wd=!0;break;case"contextmenu":case"mouseup":case"dragend":Wd=!1,j0(E,n,S);break;case"selectionchange":if(B2)break;case"keydown":case"keyup":j0(E,n,S)}var Z;if(nf)e:{switch(e){case"compositionstart":var J="onCompositionStart";break e;case"compositionend":J="onCompositionEnd";break e;case"compositionupdate":J="onCompositionUpdate";break e}J=void 0}else ko?om(e,n)&&(J="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(J="onCompositionStart");J&&(sm&&n.locale!=="ko"&&(ko||J!=="onCompositionStart"?J==="onCompositionEnd"&&ko&&(Z=im()):(us=S,Jh="value"in us?us.value:us.textContent,ko=!0)),Y=Mc(y,J),0<Y.length&&(J=new N0(J,e,null,n,S),E.push({event:J,listeners:Y}),Z?J.data=Z:(Z=am(n),Z!==null&&(J.data=Z)))),(Z=A2?N2(e,n):T2(e,n))&&(y=Mc(y,"onBeforeInput"),0<y.length&&(S=new N0("onBeforeInput","beforeinput",null,n,S),E.push({event:S,listeners:y}),S.data=Z))}vm(E,t)})}function ul(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Mc(e,t){for(var n=t+"Capture",i=[];e!==null;){var l=e,c=l.stateNode;l.tag===5&&c!==null&&(l=c,c=rl(e,n),c!=null&&i.unshift(ul(e,c,l)),c=rl(e,t),c!=null&&i.push(ul(e,c,l))),e=e.return}return i}function wo(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function F0(e,t,n,i,l){for(var c=t._reactName,m=[];n!==null&&n!==i;){var _=n,v=_.alternate,y=_.stateNode;if(v!==null&&v===i)break;_.tag===5&&y!==null&&(_=y,l?(v=rl(n,c),v!=null&&m.unshift(ul(n,v,_))):l||(v=rl(n,c),v!=null&&m.push(ul(n,v,_)))),n=n.return}m.length!==0&&e.push({event:t,listeners:m})}var H2=/\r\n?/g,W2=/\u0000|\uFFFD/g;function U0(e){return(typeof e=="string"?e:""+e).replace(H2,`
`).replace(W2,"")}function Jl(e,t,n){if(t=U0(t),U0(e)!==t&&n)throw Error(ve(425))}function Oc(){}var Vd=null,Gd=null;function Zd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Yd=typeof setTimeout=="function"?setTimeout:void 0,V2=typeof clearTimeout=="function"?clearTimeout:void 0,z0=typeof Promise=="function"?Promise:void 0,G2=typeof queueMicrotask=="function"?queueMicrotask:typeof z0<"u"?function(e){return z0.resolve(null).then(e).catch(Z2)}:Yd;function Z2(e){setTimeout(function(){throw e})}function nd(e,t){var n=t,i=0;do{var l=n.nextSibling;if(e.removeChild(n),l&&l.nodeType===8)if(n=l.data,n==="/$"){if(i===0){e.removeChild(l),ol(t);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=l}while(n);ol(t)}function ps(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function H0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var sa=Math.random().toString(36).slice(2),gi="__reactFiber$"+sa,dl="__reactProps$"+sa,Di="__reactContainer$"+sa,$d="__reactEvents$"+sa,Y2="__reactListeners$"+sa,$2="__reactHandles$"+sa;function Ks(e){var t=e[gi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Di]||n[gi]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=H0(e);e!==null;){if(n=e[gi])return n;e=H0(e)}return t}e=n,n=e.parentNode}return null}function El(e){return e=e[gi]||e[Di],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Lo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ve(33))}function lu(e){return e[dl]||null}var Xd=[],Po=-1;function Ns(e){return{current:e}}function Wt(e){0>Po||(e.current=Xd[Po],Xd[Po]=null,Po--)}function Dt(e,t){Po++,Xd[Po]=e.current,e.current=t}var Es={},Un=Ns(Es),ar=Ns(!1),no=Es;function $o(e,t){var n=e.type.contextTypes;if(!n)return Es;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var l={},c;for(c in n)l[c]=t[c];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=l),l}function lr(e){return e=e.childContextTypes,e!=null}function Lc(){Wt(ar),Wt(Un)}function W0(e,t,n){if(Un.current!==Es)throw Error(ve(168));Dt(Un,t),Dt(ar,n)}function _m(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var l in i)if(!(l in t))throw Error(ve(108,Oy(e)||"Unknown",l));return Xt({},n,i)}function Pc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Es,no=Un.current,Dt(Un,e),Dt(ar,ar.current),!0}function V0(e,t,n){var i=e.stateNode;if(!i)throw Error(ve(169));n?(e=_m(e,t,no),i.__reactInternalMemoizedMergedChildContext=e,Wt(ar),Wt(Un),Dt(Un,e)):Wt(ar),Dt(ar,n)}var Mi=null,cu=!1,rd=!1;function bm(e){Mi===null?Mi=[e]:Mi.push(e)}function X2(e){cu=!0,bm(e)}function Ts(){if(!rd&&Mi!==null){rd=!0;var e=0,t=St;try{var n=Mi;for(St=1;e<n.length;e++){var i=n[e];do i=i(!0);while(i!==null)}Mi=null,cu=!1}catch(l){throw Mi!==null&&(Mi=Mi.slice(e+1)),Yg(Xh,Ts),l}finally{St=t,rd=!1}}return null}var Ro=[],jo=0,Rc=null,jc=0,Rr=[],jr=0,ro=null,Oi=1,Li="";function Ys(e,t){Ro[jo++]=jc,Ro[jo++]=Rc,Rc=e,jc=t}function Cm(e,t,n){Rr[jr++]=Oi,Rr[jr++]=Li,Rr[jr++]=ro,ro=e;var i=Oi;e=Li;var l=32-ei(i)-1;i&=~(1<<l),n+=1;var c=32-ei(t)+l;if(30<c){var m=l-l%5;c=(i&(1<<m)-1).toString(32),i>>=m,l-=m,Oi=1<<32-ei(t)+l|n<<l|i,Li=c+e}else Oi=1<<c|n<<l|i,Li=e}function sf(e){e.return!==null&&(Ys(e,1),Cm(e,1,0))}function of(e){for(;e===Rc;)Rc=Ro[--jo],Ro[jo]=null,jc=Ro[--jo],Ro[jo]=null;for(;e===ro;)ro=Rr[--jr],Rr[jr]=null,Li=Rr[--jr],Rr[jr]=null,Oi=Rr[--jr],Rr[jr]=null}var _r=null,wr=null,Gt=!1,Jr=null;function Em(e,t){var n=Dr(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function G0(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,_r=e,wr=ps(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,_r=e,wr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=ro!==null?{id:Oi,overflow:Li}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Dr(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,_r=e,wr=null,!0):!1;default:return!1}}function qd(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Kd(e){if(Gt){var t=wr;if(t){var n=t;if(!G0(e,t)){if(qd(e))throw Error(ve(418));t=ps(n.nextSibling);var i=_r;t&&G0(e,t)?Em(i,n):(e.flags=e.flags&-4097|2,Gt=!1,_r=e)}}else{if(qd(e))throw Error(ve(418));e.flags=e.flags&-4097|2,Gt=!1,_r=e}}}function Z0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;_r=e}function ec(e){if(e!==_r)return!1;if(!Gt)return Z0(e),Gt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Zd(e.type,e.memoizedProps)),t&&(t=wr)){if(qd(e))throw Sm(),Error(ve(418));for(;t;)Em(e,t),t=ps(t.nextSibling)}if(Z0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ve(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){wr=ps(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}wr=null}}else wr=_r?ps(e.stateNode.nextSibling):null;return!0}function Sm(){for(var e=wr;e;)e=ps(e.nextSibling)}function Xo(){wr=_r=null,Gt=!1}function af(e){Jr===null?Jr=[e]:Jr.push(e)}var q2=Ui.ReactCurrentBatchConfig;function La(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ve(309));var i=n.stateNode}if(!i)throw Error(ve(147,e));var l=i,c=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===c?t.ref:(t=function(m){var _=l.refs;m===null?delete _[c]:_[c]=m},t._stringRef=c,t)}if(typeof e!="string")throw Error(ve(284));if(!n._owner)throw Error(ve(290,e))}return e}function tc(e,t){throw e=Object.prototype.toString.call(t),Error(ve(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Y0(e){var t=e._init;return t(e._payload)}function Am(e){function t(R,I){if(e){var k=R.deletions;k===null?(R.deletions=[I],R.flags|=16):k.push(I)}}function n(R,I){if(!e)return null;for(;I!==null;)t(R,I),I=I.sibling;return null}function i(R,I){for(R=new Map;I!==null;)I.key!==null?R.set(I.key,I):R.set(I.index,I),I=I.sibling;return R}function l(R,I){return R=ws(R,I),R.index=0,R.sibling=null,R}function c(R,I,k){return R.index=k,e?(k=R.alternate,k!==null?(k=k.index,k<I?(R.flags|=2,I):k):(R.flags|=2,I)):(R.flags|=1048576,I)}function m(R){return e&&R.alternate===null&&(R.flags|=2),R}function _(R,I,k,z){return I===null||I.tag!==6?(I=ud(k,R.mode,z),I.return=R,I):(I=l(I,k),I.return=R,I)}function v(R,I,k,z){var G=k.type;return G===Io?S(R,I,k.props.children,z,k.key):I!==null&&(I.elementType===G||typeof G=="object"&&G!==null&&G.$$typeof===ss&&Y0(G)===I.type)?(z=l(I,k.props),z.ref=La(R,I,k),z.return=R,z):(z=Cc(k.type,k.key,k.props,null,R.mode,z),z.ref=La(R,I,k),z.return=R,z)}function y(R,I,k,z){return I===null||I.tag!==4||I.stateNode.containerInfo!==k.containerInfo||I.stateNode.implementation!==k.implementation?(I=dd(k,R.mode,z),I.return=R,I):(I=l(I,k.children||[]),I.return=R,I)}function S(R,I,k,z,G){return I===null||I.tag!==7?(I=to(k,R.mode,z,G),I.return=R,I):(I=l(I,k),I.return=R,I)}function E(R,I,k){if(typeof I=="string"&&I!==""||typeof I=="number")return I=ud(""+I,R.mode,k),I.return=R,I;if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Vl:return k=Cc(I.type,I.key,I.props,null,R.mode,k),k.ref=La(R,null,I),k.return=R,k;case To:return I=dd(I,R.mode,k),I.return=R,I;case ss:var z=I._init;return E(R,z(I._payload),k)}if(Ba(I)||Ta(I))return I=to(I,R.mode,k,null),I.return=R,I;tc(R,I)}return null}function T(R,I,k,z){var G=I!==null?I.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return G!==null?null:_(R,I,""+k,z);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Vl:return k.key===G?v(R,I,k,z):null;case To:return k.key===G?y(R,I,k,z):null;case ss:return G=k._init,T(R,I,G(k._payload),z)}if(Ba(k)||Ta(k))return G!==null?null:S(R,I,k,z,null);tc(R,k)}return null}function U(R,I,k,z,G){if(typeof z=="string"&&z!==""||typeof z=="number")return R=R.get(k)||null,_(I,R,""+z,G);if(typeof z=="object"&&z!==null){switch(z.$$typeof){case Vl:return R=R.get(z.key===null?k:z.key)||null,v(I,R,z,G);case To:return R=R.get(z.key===null?k:z.key)||null,y(I,R,z,G);case ss:var Y=z._init;return U(R,I,k,Y(z._payload),G)}if(Ba(z)||Ta(z))return R=R.get(k)||null,S(I,R,z,G,null);tc(I,z)}return null}function j(R,I,k,z){for(var G=null,Y=null,Z=I,J=I=0,ie=null;Z!==null&&J<k.length;J++){Z.index>J?(ie=Z,Z=null):ie=Z.sibling;var Ee=T(R,Z,k[J],z);if(Ee===null){Z===null&&(Z=ie);break}e&&Z&&Ee.alternate===null&&t(R,Z),I=c(Ee,I,J),Y===null?G=Ee:Y.sibling=Ee,Y=Ee,Z=ie}if(J===k.length)return n(R,Z),Gt&&Ys(R,J),G;if(Z===null){for(;J<k.length;J++)Z=E(R,k[J],z),Z!==null&&(I=c(Z,I,J),Y===null?G=Z:Y.sibling=Z,Y=Z);return Gt&&Ys(R,J),G}for(Z=i(R,Z);J<k.length;J++)ie=U(Z,R,J,k[J],z),ie!==null&&(e&&ie.alternate!==null&&Z.delete(ie.key===null?J:ie.key),I=c(ie,I,J),Y===null?G=ie:Y.sibling=ie,Y=ie);return e&&Z.forEach(function(ce){return t(R,ce)}),Gt&&Ys(R,J),G}function P(R,I,k,z){var G=Ta(k);if(typeof G!="function")throw Error(ve(150));if(k=G.call(k),k==null)throw Error(ve(151));for(var Y=G=null,Z=I,J=I=0,ie=null,Ee=k.next();Z!==null&&!Ee.done;J++,Ee=k.next()){Z.index>J?(ie=Z,Z=null):ie=Z.sibling;var ce=T(R,Z,Ee.value,z);if(ce===null){Z===null&&(Z=ie);break}e&&Z&&ce.alternate===null&&t(R,Z),I=c(ce,I,J),Y===null?G=ce:Y.sibling=ce,Y=ce,Z=ie}if(Ee.done)return n(R,Z),Gt&&Ys(R,J),G;if(Z===null){for(;!Ee.done;J++,Ee=k.next())Ee=E(R,Ee.value,z),Ee!==null&&(I=c(Ee,I,J),Y===null?G=Ee:Y.sibling=Ee,Y=Ee);return Gt&&Ys(R,J),G}for(Z=i(R,Z);!Ee.done;J++,Ee=k.next())Ee=U(Z,R,J,Ee.value,z),Ee!==null&&(e&&Ee.alternate!==null&&Z.delete(Ee.key===null?J:Ee.key),I=c(Ee,I,J),Y===null?G=Ee:Y.sibling=Ee,Y=Ee);return e&&Z.forEach(function(ue){return t(R,ue)}),Gt&&Ys(R,J),G}function D(R,I,k,z){if(typeof k=="object"&&k!==null&&k.type===Io&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case Vl:e:{for(var G=k.key,Y=I;Y!==null;){if(Y.key===G){if(G=k.type,G===Io){if(Y.tag===7){n(R,Y.sibling),I=l(Y,k.props.children),I.return=R,R=I;break e}}else if(Y.elementType===G||typeof G=="object"&&G!==null&&G.$$typeof===ss&&Y0(G)===Y.type){n(R,Y.sibling),I=l(Y,k.props),I.ref=La(R,Y,k),I.return=R,R=I;break e}n(R,Y);break}else t(R,Y);Y=Y.sibling}k.type===Io?(I=to(k.props.children,R.mode,z,k.key),I.return=R,R=I):(z=Cc(k.type,k.key,k.props,null,R.mode,z),z.ref=La(R,I,k),z.return=R,R=z)}return m(R);case To:e:{for(Y=k.key;I!==null;){if(I.key===Y)if(I.tag===4&&I.stateNode.containerInfo===k.containerInfo&&I.stateNode.implementation===k.implementation){n(R,I.sibling),I=l(I,k.children||[]),I.return=R,R=I;break e}else{n(R,I);break}else t(R,I);I=I.sibling}I=dd(k,R.mode,z),I.return=R,R=I}return m(R);case ss:return Y=k._init,D(R,I,Y(k._payload),z)}if(Ba(k))return j(R,I,k,z);if(Ta(k))return P(R,I,k,z);tc(R,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,I!==null&&I.tag===6?(n(R,I.sibling),I=l(I,k),I.return=R,R=I):(n(R,I),I=ud(k,R.mode,z),I.return=R,R=I),m(R)):n(R,I)}return D}var qo=Am(!0),Nm=Am(!1),Dc=Ns(null),Bc=null,Do=null,lf=null;function cf(){lf=Do=Bc=null}function uf(e){var t=Dc.current;Wt(Dc),e._currentValue=t}function Qd(e,t,n){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Go(e,t){Bc=e,lf=Do=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(or=!0),e.firstContext=null)}function Fr(e){var t=e._currentValue;if(lf!==e)if(e={context:e,memoizedValue:t,next:null},Do===null){if(Bc===null)throw Error(ve(308));Do=e,Bc.dependencies={lanes:0,firstContext:e}}else Do=Do.next=e;return t}var Qs=null;function df(e){Qs===null?Qs=[e]:Qs.push(e)}function Tm(e,t,n,i){var l=t.interleaved;return l===null?(n.next=n,df(t)):(n.next=l.next,l.next=n),t.interleaved=n,Bi(e,i)}function Bi(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var os=!1;function hf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Im(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ri(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function xs(e,t,n){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,pt&2){var l=i.pending;return l===null?t.next=t:(t.next=l.next,l.next=t),i.pending=t,Bi(e,n)}return l=i.interleaved,l===null?(t.next=t,df(i)):(t.next=l.next,l.next=t),i.interleaved=t,Bi(e,n)}function xc(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,qh(e,n)}}function $0(e,t){var n=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var l=null,c=null;if(n=n.firstBaseUpdate,n!==null){do{var m={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};c===null?l=c=m:c=c.next=m,n=n.next}while(n!==null);c===null?l=c=t:c=c.next=t}else l=c=t;n={baseState:i.baseState,firstBaseUpdate:l,lastBaseUpdate:c,shared:i.shared,effects:i.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Fc(e,t,n,i){var l=e.updateQueue;os=!1;var c=l.firstBaseUpdate,m=l.lastBaseUpdate,_=l.shared.pending;if(_!==null){l.shared.pending=null;var v=_,y=v.next;v.next=null,m===null?c=y:m.next=y,m=v;var S=e.alternate;S!==null&&(S=S.updateQueue,_=S.lastBaseUpdate,_!==m&&(_===null?S.firstBaseUpdate=y:_.next=y,S.lastBaseUpdate=v))}if(c!==null){var E=l.baseState;m=0,S=y=v=null,_=c;do{var T=_.lane,U=_.eventTime;if((i&T)===T){S!==null&&(S=S.next={eventTime:U,lane:0,tag:_.tag,payload:_.payload,callback:_.callback,next:null});e:{var j=e,P=_;switch(T=t,U=n,P.tag){case 1:if(j=P.payload,typeof j=="function"){E=j.call(U,E,T);break e}E=j;break e;case 3:j.flags=j.flags&-65537|128;case 0:if(j=P.payload,T=typeof j=="function"?j.call(U,E,T):j,T==null)break e;E=Xt({},E,T);break e;case 2:os=!0}}_.callback!==null&&_.lane!==0&&(e.flags|=64,T=l.effects,T===null?l.effects=[_]:T.push(_))}else U={eventTime:U,lane:T,tag:_.tag,payload:_.payload,callback:_.callback,next:null},S===null?(y=S=U,v=E):S=S.next=U,m|=T;if(_=_.next,_===null){if(_=l.shared.pending,_===null)break;T=_,_=T.next,T.next=null,l.lastBaseUpdate=T,l.shared.pending=null}}while(!0);if(S===null&&(v=E),l.baseState=v,l.firstBaseUpdate=y,l.lastBaseUpdate=S,t=l.shared.interleaved,t!==null){l=t;do m|=l.lane,l=l.next;while(l!==t)}else c===null&&(l.shared.lanes=0);so|=m,e.lanes=m,e.memoizedState=E}}function X0(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var i=e[t],l=i.callback;if(l!==null){if(i.callback=null,i=n,typeof l!="function")throw Error(ve(191,l));l.call(i)}}}var Sl={},pi=Ns(Sl),hl=Ns(Sl),fl=Ns(Sl);function Js(e){if(e===Sl)throw Error(ve(174));return e}function ff(e,t){switch(Dt(fl,t),Dt(hl,e),Dt(pi,Sl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Od(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Od(t,e)}Wt(pi),Dt(pi,t)}function Ko(){Wt(pi),Wt(hl),Wt(fl)}function km(e){Js(fl.current);var t=Js(pi.current),n=Od(t,e.type);t!==n&&(Dt(hl,e),Dt(pi,n))}function gf(e){hl.current===e&&(Wt(pi),Wt(hl))}var Yt=Ns(0);function Uc(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var id=[];function mf(){for(var e=0;e<id.length;e++)id[e]._workInProgressVersionPrimary=null;id.length=0}var yc=Ui.ReactCurrentDispatcher,sd=Ui.ReactCurrentBatchConfig,io=0,$t=null,mn=null,En=null,zc=!1,$a=!1,gl=0,K2=0;function Dn(){throw Error(ve(321))}function pf(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ni(e[n],t[n]))return!1;return!0}function xf(e,t,n,i,l,c){if(io=c,$t=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,yc.current=e===null||e.memoizedState===null?tv:nv,e=n(i,l),$a){c=0;do{if($a=!1,gl=0,25<=c)throw Error(ve(301));c+=1,En=mn=null,t.updateQueue=null,yc.current=rv,e=n(i,l)}while($a)}if(yc.current=Hc,t=mn!==null&&mn.next!==null,io=0,En=mn=$t=null,zc=!1,t)throw Error(ve(300));return e}function yf(){var e=gl!==0;return gl=0,e}function di(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return En===null?$t.memoizedState=En=e:En=En.next=e,En}function Ur(){if(mn===null){var e=$t.alternate;e=e!==null?e.memoizedState:null}else e=mn.next;var t=En===null?$t.memoizedState:En.next;if(t!==null)En=t,mn=e;else{if(e===null)throw Error(ve(310));mn=e,e={memoizedState:mn.memoizedState,baseState:mn.baseState,baseQueue:mn.baseQueue,queue:mn.queue,next:null},En===null?$t.memoizedState=En=e:En=En.next=e}return En}function ml(e,t){return typeof t=="function"?t(e):t}function od(e){var t=Ur(),n=t.queue;if(n===null)throw Error(ve(311));n.lastRenderedReducer=e;var i=mn,l=i.baseQueue,c=n.pending;if(c!==null){if(l!==null){var m=l.next;l.next=c.next,c.next=m}i.baseQueue=l=c,n.pending=null}if(l!==null){c=l.next,i=i.baseState;var _=m=null,v=null,y=c;do{var S=y.lane;if((io&S)===S)v!==null&&(v=v.next={lane:0,action:y.action,hasEagerState:y.hasEagerState,eagerState:y.eagerState,next:null}),i=y.hasEagerState?y.eagerState:e(i,y.action);else{var E={lane:S,action:y.action,hasEagerState:y.hasEagerState,eagerState:y.eagerState,next:null};v===null?(_=v=E,m=i):v=v.next=E,$t.lanes|=S,so|=S}y=y.next}while(y!==null&&y!==c);v===null?m=i:v.next=_,ni(i,t.memoizedState)||(or=!0),t.memoizedState=i,t.baseState=m,t.baseQueue=v,n.lastRenderedState=i}if(e=n.interleaved,e!==null){l=e;do c=l.lane,$t.lanes|=c,so|=c,l=l.next;while(l!==e)}else l===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ad(e){var t=Ur(),n=t.queue;if(n===null)throw Error(ve(311));n.lastRenderedReducer=e;var i=n.dispatch,l=n.pending,c=t.memoizedState;if(l!==null){n.pending=null;var m=l=l.next;do c=e(c,m.action),m=m.next;while(m!==l);ni(c,t.memoizedState)||(or=!0),t.memoizedState=c,t.baseQueue===null&&(t.baseState=c),n.lastRenderedState=c}return[c,i]}function Mm(){}function Om(e,t){var n=$t,i=Ur(),l=t(),c=!ni(i.memoizedState,l);if(c&&(i.memoizedState=l,or=!0),i=i.queue,vf(Rm.bind(null,n,i,e),[e]),i.getSnapshot!==t||c||En!==null&&En.memoizedState.tag&1){if(n.flags|=2048,pl(9,Pm.bind(null,n,i,l,t),void 0,null),An===null)throw Error(ve(349));io&30||Lm(n,t,l)}return l}function Lm(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=$t.updateQueue,t===null?(t={lastEffect:null,stores:null},$t.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Pm(e,t,n,i){t.value=n,t.getSnapshot=i,jm(t)&&Dm(e)}function Rm(e,t,n){return n(function(){jm(t)&&Dm(e)})}function jm(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ni(e,n)}catch{return!0}}function Dm(e){var t=Bi(e,1);t!==null&&ti(t,e,1,-1)}function q0(e){var t=di();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ml,lastRenderedState:e},t.queue=e,e=e.dispatch=ev.bind(null,$t,e),[t.memoizedState,e]}function pl(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},t=$t.updateQueue,t===null?(t={lastEffect:null,stores:null},$t.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e)),e}function Bm(){return Ur().memoizedState}function vc(e,t,n,i){var l=di();$t.flags|=e,l.memoizedState=pl(1|t,n,void 0,i===void 0?null:i)}function uu(e,t,n,i){var l=Ur();i=i===void 0?null:i;var c=void 0;if(mn!==null){var m=mn.memoizedState;if(c=m.destroy,i!==null&&pf(i,m.deps)){l.memoizedState=pl(t,n,c,i);return}}$t.flags|=e,l.memoizedState=pl(1|t,n,c,i)}function K0(e,t){return vc(8390656,8,e,t)}function vf(e,t){return uu(2048,8,e,t)}function Fm(e,t){return uu(4,2,e,t)}function Um(e,t){return uu(4,4,e,t)}function zm(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Hm(e,t,n){return n=n!=null?n.concat([e]):null,uu(4,4,zm.bind(null,t,e),n)}function wf(){}function Wm(e,t){var n=Ur();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&pf(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Vm(e,t){var n=Ur();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&pf(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Gm(e,t,n){return io&21?(ni(n,t)||(n=qg(),$t.lanes|=n,so|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,or=!0),e.memoizedState=n)}function Q2(e,t){var n=St;St=n!==0&&4>n?n:4,e(!0);var i=sd.transition;sd.transition={};try{e(!1),t()}finally{St=n,sd.transition=i}}function Zm(){return Ur().memoizedState}function J2(e,t,n){var i=vs(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Ym(e))$m(t,n);else if(n=Tm(e,t,n,i),n!==null){var l=Qn();ti(n,e,i,l),Xm(n,t,i)}}function ev(e,t,n){var i=vs(e),l={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ym(e))$m(t,l);else{var c=e.alternate;if(e.lanes===0&&(c===null||c.lanes===0)&&(c=t.lastRenderedReducer,c!==null))try{var m=t.lastRenderedState,_=c(m,n);if(l.hasEagerState=!0,l.eagerState=_,ni(_,m)){var v=t.interleaved;v===null?(l.next=l,df(t)):(l.next=v.next,v.next=l),t.interleaved=l;return}}catch{}finally{}n=Tm(e,t,l,i),n!==null&&(l=Qn(),ti(n,e,i,l),Xm(n,t,i))}}function Ym(e){var t=e.alternate;return e===$t||t!==null&&t===$t}function $m(e,t){$a=zc=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Xm(e,t,n){if(n&4194240){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,qh(e,n)}}var Hc={readContext:Fr,useCallback:Dn,useContext:Dn,useEffect:Dn,useImperativeHandle:Dn,useInsertionEffect:Dn,useLayoutEffect:Dn,useMemo:Dn,useReducer:Dn,useRef:Dn,useState:Dn,useDebugValue:Dn,useDeferredValue:Dn,useTransition:Dn,useMutableSource:Dn,useSyncExternalStore:Dn,useId:Dn,unstable_isNewReconciler:!1},tv={readContext:Fr,useCallback:function(e,t){return di().memoizedState=[e,t===void 0?null:t],e},useContext:Fr,useEffect:K0,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,vc(4194308,4,zm.bind(null,t,e),n)},useLayoutEffect:function(e,t){return vc(4194308,4,e,t)},useInsertionEffect:function(e,t){return vc(4,2,e,t)},useMemo:function(e,t){var n=di();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=di();return t=n!==void 0?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=J2.bind(null,$t,e),[i.memoizedState,e]},useRef:function(e){var t=di();return e={current:e},t.memoizedState=e},useState:q0,useDebugValue:wf,useDeferredValue:function(e){return di().memoizedState=e},useTransition:function(){var e=q0(!1),t=e[0];return e=Q2.bind(null,e[1]),di().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=$t,l=di();if(Gt){if(n===void 0)throw Error(ve(407));n=n()}else{if(n=t(),An===null)throw Error(ve(349));io&30||Lm(i,t,n)}l.memoizedState=n;var c={value:n,getSnapshot:t};return l.queue=c,K0(Rm.bind(null,i,c,e),[e]),i.flags|=2048,pl(9,Pm.bind(null,i,c,n,t),void 0,null),n},useId:function(){var e=di(),t=An.identifierPrefix;if(Gt){var n=Li,i=Oi;n=(i&~(1<<32-ei(i)-1)).toString(32)+n,t=":"+t+"R"+n,n=gl++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=K2++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},nv={readContext:Fr,useCallback:Wm,useContext:Fr,useEffect:vf,useImperativeHandle:Hm,useInsertionEffect:Fm,useLayoutEffect:Um,useMemo:Vm,useReducer:od,useRef:Bm,useState:function(){return od(ml)},useDebugValue:wf,useDeferredValue:function(e){var t=Ur();return Gm(t,mn.memoizedState,e)},useTransition:function(){var e=od(ml)[0],t=Ur().memoizedState;return[e,t]},useMutableSource:Mm,useSyncExternalStore:Om,useId:Zm,unstable_isNewReconciler:!1},rv={readContext:Fr,useCallback:Wm,useContext:Fr,useEffect:vf,useImperativeHandle:Hm,useInsertionEffect:Fm,useLayoutEffect:Um,useMemo:Vm,useReducer:ad,useRef:Bm,useState:function(){return ad(ml)},useDebugValue:wf,useDeferredValue:function(e){var t=Ur();return mn===null?t.memoizedState=e:Gm(t,mn.memoizedState,e)},useTransition:function(){var e=ad(ml)[0],t=Ur().memoizedState;return[e,t]},useMutableSource:Mm,useSyncExternalStore:Om,useId:Zm,unstable_isNewReconciler:!1};function Xr(e,t){if(e&&e.defaultProps){t=Xt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Jd(e,t,n,i){t=e.memoizedState,n=n(i,t),n=n==null?t:Xt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var du={isMounted:function(e){return(e=e._reactInternals)?co(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=Qn(),l=vs(e),c=Ri(i,l);c.payload=t,n!=null&&(c.callback=n),t=xs(e,c,l),t!==null&&(ti(t,e,l,i),xc(t,e,l))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=Qn(),l=vs(e),c=Ri(i,l);c.tag=1,c.payload=t,n!=null&&(c.callback=n),t=xs(e,c,l),t!==null&&(ti(t,e,l,i),xc(t,e,l))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Qn(),i=vs(e),l=Ri(n,i);l.tag=2,t!=null&&(l.callback=t),t=xs(e,l,i),t!==null&&(ti(t,e,i,n),xc(t,e,i))}};function Q0(e,t,n,i,l,c,m){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,c,m):t.prototype&&t.prototype.isPureReactComponent?!ll(n,i)||!ll(l,c):!0}function qm(e,t,n){var i=!1,l=Es,c=t.contextType;return typeof c=="object"&&c!==null?c=Fr(c):(l=lr(t)?no:Un.current,i=t.contextTypes,c=(i=i!=null)?$o(e,l):Es),t=new t(n,c),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=du,e.stateNode=t,t._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=l,e.__reactInternalMemoizedMaskedChildContext=c),t}function J0(e,t,n,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&du.enqueueReplaceState(t,t.state,null)}function eh(e,t,n,i){var l=e.stateNode;l.props=n,l.state=e.memoizedState,l.refs={},hf(e);var c=t.contextType;typeof c=="object"&&c!==null?l.context=Fr(c):(c=lr(t)?no:Un.current,l.context=$o(e,c)),l.state=e.memoizedState,c=t.getDerivedStateFromProps,typeof c=="function"&&(Jd(e,t,c,n),l.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof l.getSnapshotBeforeUpdate=="function"||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(t=l.state,typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount(),t!==l.state&&du.enqueueReplaceState(l,l.state,null),Fc(e,n,l,i),l.state=e.memoizedState),typeof l.componentDidMount=="function"&&(e.flags|=4194308)}function Qo(e,t){try{var n="",i=t;do n+=My(i),i=i.return;while(i);var l=n}catch(c){l=`
Error generating stack: `+c.message+`
`+c.stack}return{value:e,source:t,stack:l,digest:null}}function ld(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function th(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var iv=typeof WeakMap=="function"?WeakMap:Map;function Km(e,t,n){n=Ri(-1,n),n.tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){Vc||(Vc=!0,dh=i),th(e,t)},n}function Qm(e,t,n){n=Ri(-1,n),n.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var l=t.value;n.payload=function(){return i(l)},n.callback=function(){th(e,t)}}var c=e.stateNode;return c!==null&&typeof c.componentDidCatch=="function"&&(n.callback=function(){th(e,t),typeof i!="function"&&(ys===null?ys=new Set([this]):ys.add(this));var m=t.stack;this.componentDidCatch(t.value,{componentStack:m!==null?m:""})}),n}function e1(e,t,n){var i=e.pingCache;if(i===null){i=e.pingCache=new iv;var l=new Set;i.set(t,l)}else l=i.get(t),l===void 0&&(l=new Set,i.set(t,l));l.has(n)||(l.add(n),e=yv.bind(null,e,t,n),t.then(e,e))}function t1(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function n1(e,t,n,i,l){return e.mode&1?(e.flags|=65536,e.lanes=l,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Ri(-1,1),t.tag=2,xs(n,t,1))),n.lanes|=1),e)}var sv=Ui.ReactCurrentOwner,or=!1;function Kn(e,t,n,i){t.child=e===null?Nm(t,null,n,i):qo(t,e.child,n,i)}function r1(e,t,n,i,l){n=n.render;var c=t.ref;return Go(t,l),i=xf(e,t,n,i,c,l),n=yf(),e!==null&&!or?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,Fi(e,t,l)):(Gt&&n&&sf(t),t.flags|=1,Kn(e,t,i,l),t.child)}function i1(e,t,n,i,l){if(e===null){var c=n.type;return typeof c=="function"&&!Tf(c)&&c.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=c,Jm(e,t,c,i,l)):(e=Cc(n.type,null,i,t,t.mode,l),e.ref=t.ref,e.return=t,t.child=e)}if(c=e.child,!(e.lanes&l)){var m=c.memoizedProps;if(n=n.compare,n=n!==null?n:ll,n(m,i)&&e.ref===t.ref)return Fi(e,t,l)}return t.flags|=1,e=ws(c,i),e.ref=t.ref,e.return=t,t.child=e}function Jm(e,t,n,i,l){if(e!==null){var c=e.memoizedProps;if(ll(c,i)&&e.ref===t.ref)if(or=!1,t.pendingProps=i=c,(e.lanes&l)!==0)e.flags&131072&&(or=!0);else return t.lanes=e.lanes,Fi(e,t,l)}return nh(e,t,n,i,l)}function ep(e,t,n){var i=t.pendingProps,l=i.children,c=e!==null?e.memoizedState:null;if(i.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Dt(Fo,yr),yr|=n;else{if(!(n&1073741824))return e=c!==null?c.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Dt(Fo,yr),yr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=c!==null?c.baseLanes:n,Dt(Fo,yr),yr|=i}else c!==null?(i=c.baseLanes|n,t.memoizedState=null):i=n,Dt(Fo,yr),yr|=i;return Kn(e,t,l,n),t.child}function tp(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function nh(e,t,n,i,l){var c=lr(n)?no:Un.current;return c=$o(t,c),Go(t,l),n=xf(e,t,n,i,c,l),i=yf(),e!==null&&!or?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,Fi(e,t,l)):(Gt&&i&&sf(t),t.flags|=1,Kn(e,t,n,l),t.child)}function s1(e,t,n,i,l){if(lr(n)){var c=!0;Pc(t)}else c=!1;if(Go(t,l),t.stateNode===null)wc(e,t),qm(t,n,i),eh(t,n,i,l),i=!0;else if(e===null){var m=t.stateNode,_=t.memoizedProps;m.props=_;var v=m.context,y=n.contextType;typeof y=="object"&&y!==null?y=Fr(y):(y=lr(n)?no:Un.current,y=$o(t,y));var S=n.getDerivedStateFromProps,E=typeof S=="function"||typeof m.getSnapshotBeforeUpdate=="function";E||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(_!==i||v!==y)&&J0(t,m,i,y),os=!1;var T=t.memoizedState;m.state=T,Fc(t,i,m,l),v=t.memoizedState,_!==i||T!==v||ar.current||os?(typeof S=="function"&&(Jd(t,n,S,i),v=t.memoizedState),(_=os||Q0(t,n,_,i,T,v,y))?(E||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(t.flags|=4194308)):(typeof m.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=v),m.props=i,m.state=v,m.context=y,i=_):(typeof m.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{m=t.stateNode,Im(e,t),_=t.memoizedProps,y=t.type===t.elementType?_:Xr(t.type,_),m.props=y,E=t.pendingProps,T=m.context,v=n.contextType,typeof v=="object"&&v!==null?v=Fr(v):(v=lr(n)?no:Un.current,v=$o(t,v));var U=n.getDerivedStateFromProps;(S=typeof U=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(_!==E||T!==v)&&J0(t,m,i,v),os=!1,T=t.memoizedState,m.state=T,Fc(t,i,m,l);var j=t.memoizedState;_!==E||T!==j||ar.current||os?(typeof U=="function"&&(Jd(t,n,U,i),j=t.memoizedState),(y=os||Q0(t,n,y,i,T,j,v)||!1)?(S||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(i,j,v),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(i,j,v)),typeof m.componentDidUpdate=="function"&&(t.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof m.componentDidUpdate!="function"||_===e.memoizedProps&&T===e.memoizedState||(t.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||_===e.memoizedProps&&T===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=j),m.props=i,m.state=j,m.context=v,i=y):(typeof m.componentDidUpdate!="function"||_===e.memoizedProps&&T===e.memoizedState||(t.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||_===e.memoizedProps&&T===e.memoizedState||(t.flags|=1024),i=!1)}return rh(e,t,n,i,c,l)}function rh(e,t,n,i,l,c){tp(e,t);var m=(t.flags&128)!==0;if(!i&&!m)return l&&V0(t,n,!1),Fi(e,t,c);i=t.stateNode,sv.current=t;var _=m&&typeof n.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,e!==null&&m?(t.child=qo(t,e.child,null,c),t.child=qo(t,null,_,c)):Kn(e,t,_,c),t.memoizedState=i.state,l&&V0(t,n,!0),t.child}function np(e){var t=e.stateNode;t.pendingContext?W0(e,t.pendingContext,t.pendingContext!==t.context):t.context&&W0(e,t.context,!1),ff(e,t.containerInfo)}function o1(e,t,n,i,l){return Xo(),af(l),t.flags|=256,Kn(e,t,n,i),t.child}var ih={dehydrated:null,treeContext:null,retryLane:0};function sh(e){return{baseLanes:e,cachePool:null,transitions:null}}function rp(e,t,n){var i=t.pendingProps,l=Yt.current,c=!1,m=(t.flags&128)!==0,_;if((_=m)||(_=e!==null&&e.memoizedState===null?!1:(l&2)!==0),_?(c=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(l|=1),Dt(Yt,l&1),e===null)return Kd(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(m=i.children,e=i.fallback,c?(i=t.mode,c=t.child,m={mode:"hidden",children:m},!(i&1)&&c!==null?(c.childLanes=0,c.pendingProps=m):c=gu(m,i,0,null),e=to(e,i,n,null),c.return=t,e.return=t,c.sibling=e,t.child=c,t.child.memoizedState=sh(n),t.memoizedState=ih,e):_f(t,m));if(l=e.memoizedState,l!==null&&(_=l.dehydrated,_!==null))return ov(e,t,m,i,_,l,n);if(c){c=i.fallback,m=t.mode,l=e.child,_=l.sibling;var v={mode:"hidden",children:i.children};return!(m&1)&&t.child!==l?(i=t.child,i.childLanes=0,i.pendingProps=v,t.deletions=null):(i=ws(l,v),i.subtreeFlags=l.subtreeFlags&14680064),_!==null?c=ws(_,c):(c=to(c,m,n,null),c.flags|=2),c.return=t,i.return=t,i.sibling=c,t.child=i,i=c,c=t.child,m=e.child.memoizedState,m=m===null?sh(n):{baseLanes:m.baseLanes|n,cachePool:null,transitions:m.transitions},c.memoizedState=m,c.childLanes=e.childLanes&~n,t.memoizedState=ih,i}return c=e.child,e=c.sibling,i=ws(c,{mode:"visible",children:i.children}),!(t.mode&1)&&(i.lanes=n),i.return=t,i.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function _f(e,t){return t=gu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function nc(e,t,n,i){return i!==null&&af(i),qo(t,e.child,null,n),e=_f(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function ov(e,t,n,i,l,c,m){if(n)return t.flags&256?(t.flags&=-257,i=ld(Error(ve(422))),nc(e,t,m,i)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(c=i.fallback,l=t.mode,i=gu({mode:"visible",children:i.children},l,0,null),c=to(c,l,m,null),c.flags|=2,i.return=t,c.return=t,i.sibling=c,t.child=i,t.mode&1&&qo(t,e.child,null,m),t.child.memoizedState=sh(m),t.memoizedState=ih,c);if(!(t.mode&1))return nc(e,t,m,null);if(l.data==="$!"){if(i=l.nextSibling&&l.nextSibling.dataset,i)var _=i.dgst;return i=_,c=Error(ve(419)),i=ld(c,i,void 0),nc(e,t,m,i)}if(_=(m&e.childLanes)!==0,or||_){if(i=An,i!==null){switch(m&-m){case 4:l=2;break;case 16:l=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:l=32;break;case 536870912:l=268435456;break;default:l=0}l=l&(i.suspendedLanes|m)?0:l,l!==0&&l!==c.retryLane&&(c.retryLane=l,Bi(e,l),ti(i,e,l,-1))}return Nf(),i=ld(Error(ve(421))),nc(e,t,m,i)}return l.data==="$?"?(t.flags|=128,t.child=e.child,t=vv.bind(null,e),l._reactRetry=t,null):(e=c.treeContext,wr=ps(l.nextSibling),_r=t,Gt=!0,Jr=null,e!==null&&(Rr[jr++]=Oi,Rr[jr++]=Li,Rr[jr++]=ro,Oi=e.id,Li=e.overflow,ro=t),t=_f(t,i.children),t.flags|=4096,t)}function a1(e,t,n){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),Qd(e.return,t,n)}function cd(e,t,n,i,l){var c=e.memoizedState;c===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:l}:(c.isBackwards=t,c.rendering=null,c.renderingStartTime=0,c.last=i,c.tail=n,c.tailMode=l)}function ip(e,t,n){var i=t.pendingProps,l=i.revealOrder,c=i.tail;if(Kn(e,t,i.children,n),i=Yt.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&a1(e,n,t);else if(e.tag===19)a1(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Dt(Yt,i),!(t.mode&1))t.memoizedState=null;else switch(l){case"forwards":for(n=t.child,l=null;n!==null;)e=n.alternate,e!==null&&Uc(e)===null&&(l=n),n=n.sibling;n=l,n===null?(l=t.child,t.child=null):(l=n.sibling,n.sibling=null),cd(t,!1,l,n,c);break;case"backwards":for(n=null,l=t.child,t.child=null;l!==null;){if(e=l.alternate,e!==null&&Uc(e)===null){t.child=l;break}e=l.sibling,l.sibling=n,n=l,l=e}cd(t,!0,n,null,c);break;case"together":cd(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function wc(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Fi(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),so|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ve(153));if(t.child!==null){for(e=t.child,n=ws(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=ws(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function av(e,t,n){switch(t.tag){case 3:np(t),Xo();break;case 5:km(t);break;case 1:lr(t.type)&&Pc(t);break;case 4:ff(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,l=t.memoizedProps.value;Dt(Dc,i._currentValue),i._currentValue=l;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?(Dt(Yt,Yt.current&1),t.flags|=128,null):n&t.child.childLanes?rp(e,t,n):(Dt(Yt,Yt.current&1),e=Fi(e,t,n),e!==null?e.sibling:null);Dt(Yt,Yt.current&1);break;case 19:if(i=(n&t.childLanes)!==0,e.flags&128){if(i)return ip(e,t,n);t.flags|=128}if(l=t.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),Dt(Yt,Yt.current),i)break;return null;case 22:case 23:return t.lanes=0,ep(e,t,n)}return Fi(e,t,n)}var sp,oh,op,ap;sp=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};oh=function(){};op=function(e,t,n,i){var l=e.memoizedProps;if(l!==i){e=t.stateNode,Js(pi.current);var c=null;switch(n){case"input":l=Td(e,l),i=Td(e,i),c=[];break;case"select":l=Xt({},l,{value:void 0}),i=Xt({},i,{value:void 0}),c=[];break;case"textarea":l=Md(e,l),i=Md(e,i),c=[];break;default:typeof l.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=Oc)}Ld(n,i);var m;n=null;for(y in l)if(!i.hasOwnProperty(y)&&l.hasOwnProperty(y)&&l[y]!=null)if(y==="style"){var _=l[y];for(m in _)_.hasOwnProperty(m)&&(n||(n={}),n[m]="")}else y!=="dangerouslySetInnerHTML"&&y!=="children"&&y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(tl.hasOwnProperty(y)?c||(c=[]):(c=c||[]).push(y,null));for(y in i){var v=i[y];if(_=l!=null?l[y]:void 0,i.hasOwnProperty(y)&&v!==_&&(v!=null||_!=null))if(y==="style")if(_){for(m in _)!_.hasOwnProperty(m)||v&&v.hasOwnProperty(m)||(n||(n={}),n[m]="");for(m in v)v.hasOwnProperty(m)&&_[m]!==v[m]&&(n||(n={}),n[m]=v[m])}else n||(c||(c=[]),c.push(y,n)),n=v;else y==="dangerouslySetInnerHTML"?(v=v?v.__html:void 0,_=_?_.__html:void 0,v!=null&&_!==v&&(c=c||[]).push(y,v)):y==="children"?typeof v!="string"&&typeof v!="number"||(c=c||[]).push(y,""+v):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&(tl.hasOwnProperty(y)?(v!=null&&y==="onScroll"&&zt("scroll",e),c||_===v||(c=[])):(c=c||[]).push(y,v))}n&&(c=c||[]).push("style",n);var y=c;(t.updateQueue=y)&&(t.flags|=4)}};ap=function(e,t,n,i){n!==i&&(t.flags|=4)};function Pa(e,t){if(!Gt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Bn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,i=0;if(t)for(var l=e.child;l!==null;)n|=l.lanes|l.childLanes,i|=l.subtreeFlags&14680064,i|=l.flags&14680064,l.return=e,l=l.sibling;else for(l=e.child;l!==null;)n|=l.lanes|l.childLanes,i|=l.subtreeFlags,i|=l.flags,l.return=e,l=l.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function lv(e,t,n){var i=t.pendingProps;switch(of(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bn(t),null;case 1:return lr(t.type)&&Lc(),Bn(t),null;case 3:return i=t.stateNode,Ko(),Wt(ar),Wt(Un),mf(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(ec(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Jr!==null&&(gh(Jr),Jr=null))),oh(e,t),Bn(t),null;case 5:gf(t);var l=Js(fl.current);if(n=t.type,e!==null&&t.stateNode!=null)op(e,t,n,i,l),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(ve(166));return Bn(t),null}if(e=Js(pi.current),ec(t)){i=t.stateNode,n=t.type;var c=t.memoizedProps;switch(i[gi]=t,i[dl]=c,e=(t.mode&1)!==0,n){case"dialog":zt("cancel",i),zt("close",i);break;case"iframe":case"object":case"embed":zt("load",i);break;case"video":case"audio":for(l=0;l<Ua.length;l++)zt(Ua[l],i);break;case"source":zt("error",i);break;case"img":case"image":case"link":zt("error",i),zt("load",i);break;case"details":zt("toggle",i);break;case"input":p0(i,c),zt("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!c.multiple},zt("invalid",i);break;case"textarea":y0(i,c),zt("invalid",i)}Ld(n,c),l=null;for(var m in c)if(c.hasOwnProperty(m)){var _=c[m];m==="children"?typeof _=="string"?i.textContent!==_&&(c.suppressHydrationWarning!==!0&&Jl(i.textContent,_,e),l=["children",_]):typeof _=="number"&&i.textContent!==""+_&&(c.suppressHydrationWarning!==!0&&Jl(i.textContent,_,e),l=["children",""+_]):tl.hasOwnProperty(m)&&_!=null&&m==="onScroll"&&zt("scroll",i)}switch(n){case"input":Gl(i),x0(i,c,!0);break;case"textarea":Gl(i),v0(i);break;case"select":case"option":break;default:typeof c.onClick=="function"&&(i.onclick=Oc)}i=l,t.updateQueue=i,i!==null&&(t.flags|=4)}else{m=l.nodeType===9?l:l.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Rg(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=m.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=m.createElement(n,{is:i.is}):(e=m.createElement(n),n==="select"&&(m=e,i.multiple?m.multiple=!0:i.size&&(m.size=i.size))):e=m.createElementNS(e,n),e[gi]=t,e[dl]=i,sp(e,t,!1,!1),t.stateNode=e;e:{switch(m=Pd(n,i),n){case"dialog":zt("cancel",e),zt("close",e),l=i;break;case"iframe":case"object":case"embed":zt("load",e),l=i;break;case"video":case"audio":for(l=0;l<Ua.length;l++)zt(Ua[l],e);l=i;break;case"source":zt("error",e),l=i;break;case"img":case"image":case"link":zt("error",e),zt("load",e),l=i;break;case"details":zt("toggle",e),l=i;break;case"input":p0(e,i),l=Td(e,i),zt("invalid",e);break;case"option":l=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},l=Xt({},i,{value:void 0}),zt("invalid",e);break;case"textarea":y0(e,i),l=Md(e,i),zt("invalid",e);break;default:l=i}Ld(n,l),_=l;for(c in _)if(_.hasOwnProperty(c)){var v=_[c];c==="style"?Bg(e,v):c==="dangerouslySetInnerHTML"?(v=v?v.__html:void 0,v!=null&&jg(e,v)):c==="children"?typeof v=="string"?(n!=="textarea"||v!=="")&&nl(e,v):typeof v=="number"&&nl(e,""+v):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(tl.hasOwnProperty(c)?v!=null&&c==="onScroll"&&zt("scroll",e):v!=null&&Vh(e,c,v,m))}switch(n){case"input":Gl(e),x0(e,i,!1);break;case"textarea":Gl(e),v0(e);break;case"option":i.value!=null&&e.setAttribute("value",""+Cs(i.value));break;case"select":e.multiple=!!i.multiple,c=i.value,c!=null?zo(e,!!i.multiple,c,!1):i.defaultValue!=null&&zo(e,!!i.multiple,i.defaultValue,!0);break;default:typeof l.onClick=="function"&&(e.onclick=Oc)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Bn(t),null;case 6:if(e&&t.stateNode!=null)ap(e,t,e.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(ve(166));if(n=Js(fl.current),Js(pi.current),ec(t)){if(i=t.stateNode,n=t.memoizedProps,i[gi]=t,(c=i.nodeValue!==n)&&(e=_r,e!==null))switch(e.tag){case 3:Jl(i.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Jl(i.nodeValue,n,(e.mode&1)!==0)}c&&(t.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[gi]=t,t.stateNode=i}return Bn(t),null;case 13:if(Wt(Yt),i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Gt&&wr!==null&&t.mode&1&&!(t.flags&128))Sm(),Xo(),t.flags|=98560,c=!1;else if(c=ec(t),i!==null&&i.dehydrated!==null){if(e===null){if(!c)throw Error(ve(318));if(c=t.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(ve(317));c[gi]=t}else Xo(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Bn(t),c=!1}else Jr!==null&&(gh(Jr),Jr=null),c=!0;if(!c)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(i=i!==null,i!==(e!==null&&e.memoizedState!==null)&&i&&(t.child.flags|=8192,t.mode&1&&(e===null||Yt.current&1?pn===0&&(pn=3):Nf())),t.updateQueue!==null&&(t.flags|=4),Bn(t),null);case 4:return Ko(),oh(e,t),e===null&&cl(t.stateNode.containerInfo),Bn(t),null;case 10:return uf(t.type._context),Bn(t),null;case 17:return lr(t.type)&&Lc(),Bn(t),null;case 19:if(Wt(Yt),c=t.memoizedState,c===null)return Bn(t),null;if(i=(t.flags&128)!==0,m=c.rendering,m===null)if(i)Pa(c,!1);else{if(pn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(m=Uc(e),m!==null){for(t.flags|=128,Pa(c,!1),i=m.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;n!==null;)c=n,e=i,c.flags&=14680066,m=c.alternate,m===null?(c.childLanes=0,c.lanes=e,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=m.childLanes,c.lanes=m.lanes,c.child=m.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=m.memoizedProps,c.memoizedState=m.memoizedState,c.updateQueue=m.updateQueue,c.type=m.type,e=m.dependencies,c.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Dt(Yt,Yt.current&1|2),t.child}e=e.sibling}c.tail!==null&&nn()>Jo&&(t.flags|=128,i=!0,Pa(c,!1),t.lanes=4194304)}else{if(!i)if(e=Uc(m),e!==null){if(t.flags|=128,i=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Pa(c,!0),c.tail===null&&c.tailMode==="hidden"&&!m.alternate&&!Gt)return Bn(t),null}else 2*nn()-c.renderingStartTime>Jo&&n!==1073741824&&(t.flags|=128,i=!0,Pa(c,!1),t.lanes=4194304);c.isBackwards?(m.sibling=t.child,t.child=m):(n=c.last,n!==null?n.sibling=m:t.child=m,c.last=m)}return c.tail!==null?(t=c.tail,c.rendering=t,c.tail=t.sibling,c.renderingStartTime=nn(),t.sibling=null,n=Yt.current,Dt(Yt,i?n&1|2:n&1),t):(Bn(t),null);case 22:case 23:return Af(),i=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(t.flags|=8192),i&&t.mode&1?yr&1073741824&&(Bn(t),t.subtreeFlags&6&&(t.flags|=8192)):Bn(t),null;case 24:return null;case 25:return null}throw Error(ve(156,t.tag))}function cv(e,t){switch(of(t),t.tag){case 1:return lr(t.type)&&Lc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ko(),Wt(ar),Wt(Un),mf(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return gf(t),null;case 13:if(Wt(Yt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ve(340));Xo()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Wt(Yt),null;case 4:return Ko(),null;case 10:return uf(t.type._context),null;case 22:case 23:return Af(),null;case 24:return null;default:return null}}var rc=!1,Fn=!1,uv=typeof WeakSet=="function"?WeakSet:Set,Oe=null;function Bo(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){Qt(e,t,i)}else n.current=null}function ah(e,t,n){try{n()}catch(i){Qt(e,t,i)}}var l1=!1;function dv(e,t){if(Vd=Ic,e=hm(),rf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var l=i.anchorOffset,c=i.focusNode;i=i.focusOffset;try{n.nodeType,c.nodeType}catch{n=null;break e}var m=0,_=-1,v=-1,y=0,S=0,E=e,T=null;t:for(;;){for(var U;E!==n||l!==0&&E.nodeType!==3||(_=m+l),E!==c||i!==0&&E.nodeType!==3||(v=m+i),E.nodeType===3&&(m+=E.nodeValue.length),(U=E.firstChild)!==null;)T=E,E=U;for(;;){if(E===e)break t;if(T===n&&++y===l&&(_=m),T===c&&++S===i&&(v=m),(U=E.nextSibling)!==null)break;E=T,T=E.parentNode}E=U}n=_===-1||v===-1?null:{start:_,end:v}}else n=null}n=n||{start:0,end:0}}else n=null;for(Gd={focusedElem:e,selectionRange:n},Ic=!1,Oe=t;Oe!==null;)if(t=Oe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Oe=e;else for(;Oe!==null;){t=Oe;try{var j=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(j!==null){var P=j.memoizedProps,D=j.memoizedState,R=t.stateNode,I=R.getSnapshotBeforeUpdate(t.elementType===t.type?P:Xr(t.type,P),D);R.__reactInternalSnapshotBeforeUpdate=I}break;case 3:var k=t.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ve(163))}}catch(z){Qt(t,t.return,z)}if(e=t.sibling,e!==null){e.return=t.return,Oe=e;break}Oe=t.return}return j=l1,l1=!1,j}function Xa(e,t,n){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var l=i=i.next;do{if((l.tag&e)===e){var c=l.destroy;l.destroy=void 0,c!==void 0&&ah(t,n,c)}l=l.next}while(l!==i)}}function hu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function lh(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function lp(e){var t=e.alternate;t!==null&&(e.alternate=null,lp(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[gi],delete t[dl],delete t[$d],delete t[Y2],delete t[$2])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function cp(e){return e.tag===5||e.tag===3||e.tag===4}function c1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||cp(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ch(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Oc));else if(i!==4&&(e=e.child,e!==null))for(ch(e,t,n),e=e.sibling;e!==null;)ch(e,t,n),e=e.sibling}function uh(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for(uh(e,t,n),e=e.sibling;e!==null;)uh(e,t,n),e=e.sibling}var kn=null,qr=!1;function es(e,t,n){for(n=n.child;n!==null;)up(e,t,n),n=n.sibling}function up(e,t,n){if(mi&&typeof mi.onCommitFiberUnmount=="function")try{mi.onCommitFiberUnmount(iu,n)}catch{}switch(n.tag){case 5:Fn||Bo(n,t);case 6:var i=kn,l=qr;kn=null,es(e,t,n),kn=i,qr=l,kn!==null&&(qr?(e=kn,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):kn.removeChild(n.stateNode));break;case 18:kn!==null&&(qr?(e=kn,n=n.stateNode,e.nodeType===8?nd(e.parentNode,n):e.nodeType===1&&nd(e,n),ol(e)):nd(kn,n.stateNode));break;case 4:i=kn,l=qr,kn=n.stateNode.containerInfo,qr=!0,es(e,t,n),kn=i,qr=l;break;case 0:case 11:case 14:case 15:if(!Fn&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){l=i=i.next;do{var c=l,m=c.destroy;c=c.tag,m!==void 0&&(c&2||c&4)&&ah(n,t,m),l=l.next}while(l!==i)}es(e,t,n);break;case 1:if(!Fn&&(Bo(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(_){Qt(n,t,_)}es(e,t,n);break;case 21:es(e,t,n);break;case 22:n.mode&1?(Fn=(i=Fn)||n.memoizedState!==null,es(e,t,n),Fn=i):es(e,t,n);break;default:es(e,t,n)}}function u1(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new uv),t.forEach(function(i){var l=wv.bind(null,e,i);n.has(i)||(n.add(i),i.then(l,l))})}}function Yr(e,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var l=n[i];try{var c=e,m=t,_=m;e:for(;_!==null;){switch(_.tag){case 5:kn=_.stateNode,qr=!1;break e;case 3:kn=_.stateNode.containerInfo,qr=!0;break e;case 4:kn=_.stateNode.containerInfo,qr=!0;break e}_=_.return}if(kn===null)throw Error(ve(160));up(c,m,l),kn=null,qr=!1;var v=l.alternate;v!==null&&(v.return=null),l.return=null}catch(y){Qt(l,t,y)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)dp(t,e),t=t.sibling}function dp(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Yr(t,e),ui(e),i&4){try{Xa(3,e,e.return),hu(3,e)}catch(P){Qt(e,e.return,P)}try{Xa(5,e,e.return)}catch(P){Qt(e,e.return,P)}}break;case 1:Yr(t,e),ui(e),i&512&&n!==null&&Bo(n,n.return);break;case 5:if(Yr(t,e),ui(e),i&512&&n!==null&&Bo(n,n.return),e.flags&32){var l=e.stateNode;try{nl(l,"")}catch(P){Qt(e,e.return,P)}}if(i&4&&(l=e.stateNode,l!=null)){var c=e.memoizedProps,m=n!==null?n.memoizedProps:c,_=e.type,v=e.updateQueue;if(e.updateQueue=null,v!==null)try{_==="input"&&c.type==="radio"&&c.name!=null&&Lg(l,c),Pd(_,m);var y=Pd(_,c);for(m=0;m<v.length;m+=2){var S=v[m],E=v[m+1];S==="style"?Bg(l,E):S==="dangerouslySetInnerHTML"?jg(l,E):S==="children"?nl(l,E):Vh(l,S,E,y)}switch(_){case"input":Id(l,c);break;case"textarea":Pg(l,c);break;case"select":var T=l._wrapperState.wasMultiple;l._wrapperState.wasMultiple=!!c.multiple;var U=c.value;U!=null?zo(l,!!c.multiple,U,!1):T!==!!c.multiple&&(c.defaultValue!=null?zo(l,!!c.multiple,c.defaultValue,!0):zo(l,!!c.multiple,c.multiple?[]:"",!1))}l[dl]=c}catch(P){Qt(e,e.return,P)}}break;case 6:if(Yr(t,e),ui(e),i&4){if(e.stateNode===null)throw Error(ve(162));l=e.stateNode,c=e.memoizedProps;try{l.nodeValue=c}catch(P){Qt(e,e.return,P)}}break;case 3:if(Yr(t,e),ui(e),i&4&&n!==null&&n.memoizedState.isDehydrated)try{ol(t.containerInfo)}catch(P){Qt(e,e.return,P)}break;case 4:Yr(t,e),ui(e);break;case 13:Yr(t,e),ui(e),l=e.child,l.flags&8192&&(c=l.memoizedState!==null,l.stateNode.isHidden=c,!c||l.alternate!==null&&l.alternate.memoizedState!==null||(Ef=nn())),i&4&&u1(e);break;case 22:if(S=n!==null&&n.memoizedState!==null,e.mode&1?(Fn=(y=Fn)||S,Yr(t,e),Fn=y):Yr(t,e),ui(e),i&8192){if(y=e.memoizedState!==null,(e.stateNode.isHidden=y)&&!S&&e.mode&1)for(Oe=e,S=e.child;S!==null;){for(E=Oe=S;Oe!==null;){switch(T=Oe,U=T.child,T.tag){case 0:case 11:case 14:case 15:Xa(4,T,T.return);break;case 1:Bo(T,T.return);var j=T.stateNode;if(typeof j.componentWillUnmount=="function"){i=T,n=T.return;try{t=i,j.props=t.memoizedProps,j.state=t.memoizedState,j.componentWillUnmount()}catch(P){Qt(i,n,P)}}break;case 5:Bo(T,T.return);break;case 22:if(T.memoizedState!==null){h1(E);continue}}U!==null?(U.return=T,Oe=U):h1(E)}S=S.sibling}e:for(S=null,E=e;;){if(E.tag===5){if(S===null){S=E;try{l=E.stateNode,y?(c=l.style,typeof c.setProperty=="function"?c.setProperty("display","none","important"):c.display="none"):(_=E.stateNode,v=E.memoizedProps.style,m=v!=null&&v.hasOwnProperty("display")?v.display:null,_.style.display=Dg("display",m))}catch(P){Qt(e,e.return,P)}}}else if(E.tag===6){if(S===null)try{E.stateNode.nodeValue=y?"":E.memoizedProps}catch(P){Qt(e,e.return,P)}}else if((E.tag!==22&&E.tag!==23||E.memoizedState===null||E===e)&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===e)break e;for(;E.sibling===null;){if(E.return===null||E.return===e)break e;S===E&&(S=null),E=E.return}S===E&&(S=null),E.sibling.return=E.return,E=E.sibling}}break;case 19:Yr(t,e),ui(e),i&4&&u1(e);break;case 21:break;default:Yr(t,e),ui(e)}}function ui(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(cp(n)){var i=n;break e}n=n.return}throw Error(ve(160))}switch(i.tag){case 5:var l=i.stateNode;i.flags&32&&(nl(l,""),i.flags&=-33);var c=c1(e);uh(e,c,l);break;case 3:case 4:var m=i.stateNode.containerInfo,_=c1(e);ch(e,_,m);break;default:throw Error(ve(161))}}catch(v){Qt(e,e.return,v)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function hv(e,t,n){Oe=e,hp(e)}function hp(e,t,n){for(var i=(e.mode&1)!==0;Oe!==null;){var l=Oe,c=l.child;if(l.tag===22&&i){var m=l.memoizedState!==null||rc;if(!m){var _=l.alternate,v=_!==null&&_.memoizedState!==null||Fn;_=rc;var y=Fn;if(rc=m,(Fn=v)&&!y)for(Oe=l;Oe!==null;)m=Oe,v=m.child,m.tag===22&&m.memoizedState!==null?f1(l):v!==null?(v.return=m,Oe=v):f1(l);for(;c!==null;)Oe=c,hp(c),c=c.sibling;Oe=l,rc=_,Fn=y}d1(e)}else l.subtreeFlags&8772&&c!==null?(c.return=l,Oe=c):d1(e)}}function d1(e){for(;Oe!==null;){var t=Oe;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Fn||hu(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!Fn)if(n===null)i.componentDidMount();else{var l=t.elementType===t.type?n.memoizedProps:Xr(t.type,n.memoizedProps);i.componentDidUpdate(l,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var c=t.updateQueue;c!==null&&X0(t,c,i);break;case 3:var m=t.updateQueue;if(m!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}X0(t,m,n)}break;case 5:var _=t.stateNode;if(n===null&&t.flags&4){n=_;var v=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":v.autoFocus&&n.focus();break;case"img":v.src&&(n.src=v.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var y=t.alternate;if(y!==null){var S=y.memoizedState;if(S!==null){var E=S.dehydrated;E!==null&&ol(E)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ve(163))}Fn||t.flags&512&&lh(t)}catch(T){Qt(t,t.return,T)}}if(t===e){Oe=null;break}if(n=t.sibling,n!==null){n.return=t.return,Oe=n;break}Oe=t.return}}function h1(e){for(;Oe!==null;){var t=Oe;if(t===e){Oe=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Oe=n;break}Oe=t.return}}function f1(e){for(;Oe!==null;){var t=Oe;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{hu(4,t)}catch(v){Qt(t,n,v)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var l=t.return;try{i.componentDidMount()}catch(v){Qt(t,l,v)}}var c=t.return;try{lh(t)}catch(v){Qt(t,c,v)}break;case 5:var m=t.return;try{lh(t)}catch(v){Qt(t,m,v)}}}catch(v){Qt(t,t.return,v)}if(t===e){Oe=null;break}var _=t.sibling;if(_!==null){_.return=t.return,Oe=_;break}Oe=t.return}}var fv=Math.ceil,Wc=Ui.ReactCurrentDispatcher,bf=Ui.ReactCurrentOwner,Br=Ui.ReactCurrentBatchConfig,pt=0,An=null,ln=null,Mn=0,yr=0,Fo=Ns(0),pn=0,xl=null,so=0,fu=0,Cf=0,qa=null,ir=null,Ef=0,Jo=1/0,Ii=null,Vc=!1,dh=null,ys=null,ic=!1,ds=null,Gc=0,Ka=0,hh=null,_c=-1,bc=0;function Qn(){return pt&6?nn():_c!==-1?_c:_c=nn()}function vs(e){return e.mode&1?pt&2&&Mn!==0?Mn&-Mn:q2.transition!==null?(bc===0&&(bc=qg()),bc):(e=St,e!==0||(e=window.event,e=e===void 0?16:rm(e.type)),e):1}function ti(e,t,n,i){if(50<Ka)throw Ka=0,hh=null,Error(ve(185));bl(e,n,i),(!(pt&2)||e!==An)&&(e===An&&(!(pt&2)&&(fu|=n),pn===4&&ls(e,Mn)),cr(e,i),n===1&&pt===0&&!(t.mode&1)&&(Jo=nn()+500,cu&&Ts()))}function cr(e,t){var n=e.callbackNode;qy(e,t);var i=Tc(e,e===An?Mn:0);if(i===0)n!==null&&b0(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(n!=null&&b0(n),t===1)e.tag===0?X2(g1.bind(null,e)):bm(g1.bind(null,e)),G2(function(){!(pt&6)&&Ts()}),n=null;else{switch(Kg(i)){case 1:n=Xh;break;case 4:n=$g;break;case 16:n=Nc;break;case 536870912:n=Xg;break;default:n=Nc}n=wp(n,fp.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function fp(e,t){if(_c=-1,bc=0,pt&6)throw Error(ve(327));var n=e.callbackNode;if(Zo()&&e.callbackNode!==n)return null;var i=Tc(e,e===An?Mn:0);if(i===0)return null;if(i&30||i&e.expiredLanes||t)t=Zc(e,i);else{t=i;var l=pt;pt|=2;var c=mp();(An!==e||Mn!==t)&&(Ii=null,Jo=nn()+500,eo(e,t));do try{pv();break}catch(_){gp(e,_)}while(!0);cf(),Wc.current=c,pt=l,ln!==null?t=0:(An=null,Mn=0,t=pn)}if(t!==0){if(t===2&&(l=Fd(e),l!==0&&(i=l,t=fh(e,l))),t===1)throw n=xl,eo(e,0),ls(e,i),cr(e,nn()),n;if(t===6)ls(e,i);else{if(l=e.current.alternate,!(i&30)&&!gv(l)&&(t=Zc(e,i),t===2&&(c=Fd(e),c!==0&&(i=c,t=fh(e,c))),t===1))throw n=xl,eo(e,0),ls(e,i),cr(e,nn()),n;switch(e.finishedWork=l,e.finishedLanes=i,t){case 0:case 1:throw Error(ve(345));case 2:$s(e,ir,Ii);break;case 3:if(ls(e,i),(i&130023424)===i&&(t=Ef+500-nn(),10<t)){if(Tc(e,0)!==0)break;if(l=e.suspendedLanes,(l&i)!==i){Qn(),e.pingedLanes|=e.suspendedLanes&l;break}e.timeoutHandle=Yd($s.bind(null,e,ir,Ii),t);break}$s(e,ir,Ii);break;case 4:if(ls(e,i),(i&4194240)===i)break;for(t=e.eventTimes,l=-1;0<i;){var m=31-ei(i);c=1<<m,m=t[m],m>l&&(l=m),i&=~c}if(i=l,i=nn()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*fv(i/1960))-i,10<i){e.timeoutHandle=Yd($s.bind(null,e,ir,Ii),i);break}$s(e,ir,Ii);break;case 5:$s(e,ir,Ii);break;default:throw Error(ve(329))}}}return cr(e,nn()),e.callbackNode===n?fp.bind(null,e):null}function fh(e,t){var n=qa;return e.current.memoizedState.isDehydrated&&(eo(e,t).flags|=256),e=Zc(e,t),e!==2&&(t=ir,ir=n,t!==null&&gh(t)),e}function gh(e){ir===null?ir=e:ir.push.apply(ir,e)}function gv(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var l=n[i],c=l.getSnapshot;l=l.value;try{if(!ni(c(),l))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ls(e,t){for(t&=~Cf,t&=~fu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ei(t),i=1<<n;e[n]=-1,t&=~i}}function g1(e){if(pt&6)throw Error(ve(327));Zo();var t=Tc(e,0);if(!(t&1))return cr(e,nn()),null;var n=Zc(e,t);if(e.tag!==0&&n===2){var i=Fd(e);i!==0&&(t=i,n=fh(e,i))}if(n===1)throw n=xl,eo(e,0),ls(e,t),cr(e,nn()),n;if(n===6)throw Error(ve(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,$s(e,ir,Ii),cr(e,nn()),null}function Sf(e,t){var n=pt;pt|=1;try{return e(t)}finally{pt=n,pt===0&&(Jo=nn()+500,cu&&Ts())}}function oo(e){ds!==null&&ds.tag===0&&!(pt&6)&&Zo();var t=pt;pt|=1;var n=Br.transition,i=St;try{if(Br.transition=null,St=1,e)return e()}finally{St=i,Br.transition=n,pt=t,!(pt&6)&&Ts()}}function Af(){yr=Fo.current,Wt(Fo)}function eo(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,V2(n)),ln!==null)for(n=ln.return;n!==null;){var i=n;switch(of(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Lc();break;case 3:Ko(),Wt(ar),Wt(Un),mf();break;case 5:gf(i);break;case 4:Ko();break;case 13:Wt(Yt);break;case 19:Wt(Yt);break;case 10:uf(i.type._context);break;case 22:case 23:Af()}n=n.return}if(An=e,ln=e=ws(e.current,null),Mn=yr=t,pn=0,xl=null,Cf=fu=so=0,ir=qa=null,Qs!==null){for(t=0;t<Qs.length;t++)if(n=Qs[t],i=n.interleaved,i!==null){n.interleaved=null;var l=i.next,c=n.pending;if(c!==null){var m=c.next;c.next=l,i.next=m}n.pending=i}Qs=null}return e}function gp(e,t){do{var n=ln;try{if(cf(),yc.current=Hc,zc){for(var i=$t.memoizedState;i!==null;){var l=i.queue;l!==null&&(l.pending=null),i=i.next}zc=!1}if(io=0,En=mn=$t=null,$a=!1,gl=0,bf.current=null,n===null||n.return===null){pn=1,xl=t,ln=null;break}e:{var c=e,m=n.return,_=n,v=t;if(t=Mn,_.flags|=32768,v!==null&&typeof v=="object"&&typeof v.then=="function"){var y=v,S=_,E=S.tag;if(!(S.mode&1)&&(E===0||E===11||E===15)){var T=S.alternate;T?(S.updateQueue=T.updateQueue,S.memoizedState=T.memoizedState,S.lanes=T.lanes):(S.updateQueue=null,S.memoizedState=null)}var U=t1(m);if(U!==null){U.flags&=-257,n1(U,m,_,c,t),U.mode&1&&e1(c,y,t),t=U,v=y;var j=t.updateQueue;if(j===null){var P=new Set;P.add(v),t.updateQueue=P}else j.add(v);break e}else{if(!(t&1)){e1(c,y,t),Nf();break e}v=Error(ve(426))}}else if(Gt&&_.mode&1){var D=t1(m);if(D!==null){!(D.flags&65536)&&(D.flags|=256),n1(D,m,_,c,t),af(Qo(v,_));break e}}c=v=Qo(v,_),pn!==4&&(pn=2),qa===null?qa=[c]:qa.push(c),c=m;do{switch(c.tag){case 3:c.flags|=65536,t&=-t,c.lanes|=t;var R=Km(c,v,t);$0(c,R);break e;case 1:_=v;var I=c.type,k=c.stateNode;if(!(c.flags&128)&&(typeof I.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(ys===null||!ys.has(k)))){c.flags|=65536,t&=-t,c.lanes|=t;var z=Qm(c,_,t);$0(c,z);break e}}c=c.return}while(c!==null)}xp(n)}catch(G){t=G,ln===n&&n!==null&&(ln=n=n.return);continue}break}while(!0)}function mp(){var e=Wc.current;return Wc.current=Hc,e===null?Hc:e}function Nf(){(pn===0||pn===3||pn===2)&&(pn=4),An===null||!(so&268435455)&&!(fu&268435455)||ls(An,Mn)}function Zc(e,t){var n=pt;pt|=2;var i=mp();(An!==e||Mn!==t)&&(Ii=null,eo(e,t));do try{mv();break}catch(l){gp(e,l)}while(!0);if(cf(),pt=n,Wc.current=i,ln!==null)throw Error(ve(261));return An=null,Mn=0,pn}function mv(){for(;ln!==null;)pp(ln)}function pv(){for(;ln!==null&&!zy();)pp(ln)}function pp(e){var t=vp(e.alternate,e,yr);e.memoizedProps=e.pendingProps,t===null?xp(e):ln=t,bf.current=null}function xp(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=cv(n,t),n!==null){n.flags&=32767,ln=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{pn=6,ln=null;return}}else if(n=lv(n,t,yr),n!==null){ln=n;return}if(t=t.sibling,t!==null){ln=t;return}ln=t=e}while(t!==null);pn===0&&(pn=5)}function $s(e,t,n){var i=St,l=Br.transition;try{Br.transition=null,St=1,xv(e,t,n,i)}finally{Br.transition=l,St=i}return null}function xv(e,t,n,i){do Zo();while(ds!==null);if(pt&6)throw Error(ve(327));n=e.finishedWork;var l=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ve(177));e.callbackNode=null,e.callbackPriority=0;var c=n.lanes|n.childLanes;if(Ky(e,c),e===An&&(ln=An=null,Mn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ic||(ic=!0,wp(Nc,function(){return Zo(),null})),c=(n.flags&15990)!==0,n.subtreeFlags&15990||c){c=Br.transition,Br.transition=null;var m=St;St=1;var _=pt;pt|=4,bf.current=null,dv(e,n),dp(n,e),D2(Gd),Ic=!!Vd,Gd=Vd=null,e.current=n,hv(n),Hy(),pt=_,St=m,Br.transition=c}else e.current=n;if(ic&&(ic=!1,ds=e,Gc=l),c=e.pendingLanes,c===0&&(ys=null),Gy(n.stateNode),cr(e,nn()),t!==null)for(i=e.onRecoverableError,n=0;n<t.length;n++)l=t[n],i(l.value,{componentStack:l.stack,digest:l.digest});if(Vc)throw Vc=!1,e=dh,dh=null,e;return Gc&1&&e.tag!==0&&Zo(),c=e.pendingLanes,c&1?e===hh?Ka++:(Ka=0,hh=e):Ka=0,Ts(),null}function Zo(){if(ds!==null){var e=Kg(Gc),t=Br.transition,n=St;try{if(Br.transition=null,St=16>e?16:e,ds===null)var i=!1;else{if(e=ds,ds=null,Gc=0,pt&6)throw Error(ve(331));var l=pt;for(pt|=4,Oe=e.current;Oe!==null;){var c=Oe,m=c.child;if(Oe.flags&16){var _=c.deletions;if(_!==null){for(var v=0;v<_.length;v++){var y=_[v];for(Oe=y;Oe!==null;){var S=Oe;switch(S.tag){case 0:case 11:case 15:Xa(8,S,c)}var E=S.child;if(E!==null)E.return=S,Oe=E;else for(;Oe!==null;){S=Oe;var T=S.sibling,U=S.return;if(lp(S),S===y){Oe=null;break}if(T!==null){T.return=U,Oe=T;break}Oe=U}}}var j=c.alternate;if(j!==null){var P=j.child;if(P!==null){j.child=null;do{var D=P.sibling;P.sibling=null,P=D}while(P!==null)}}Oe=c}}if(c.subtreeFlags&2064&&m!==null)m.return=c,Oe=m;else e:for(;Oe!==null;){if(c=Oe,c.flags&2048)switch(c.tag){case 0:case 11:case 15:Xa(9,c,c.return)}var R=c.sibling;if(R!==null){R.return=c.return,Oe=R;break e}Oe=c.return}}var I=e.current;for(Oe=I;Oe!==null;){m=Oe;var k=m.child;if(m.subtreeFlags&2064&&k!==null)k.return=m,Oe=k;else e:for(m=I;Oe!==null;){if(_=Oe,_.flags&2048)try{switch(_.tag){case 0:case 11:case 15:hu(9,_)}}catch(G){Qt(_,_.return,G)}if(_===m){Oe=null;break e}var z=_.sibling;if(z!==null){z.return=_.return,Oe=z;break e}Oe=_.return}}if(pt=l,Ts(),mi&&typeof mi.onPostCommitFiberRoot=="function")try{mi.onPostCommitFiberRoot(iu,e)}catch{}i=!0}return i}finally{St=n,Br.transition=t}}return!1}function m1(e,t,n){t=Qo(n,t),t=Km(e,t,1),e=xs(e,t,1),t=Qn(),e!==null&&(bl(e,1,t),cr(e,t))}function Qt(e,t,n){if(e.tag===3)m1(e,e,n);else for(;t!==null;){if(t.tag===3){m1(t,e,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(ys===null||!ys.has(i))){e=Qo(n,e),e=Qm(t,e,1),t=xs(t,e,1),e=Qn(),t!==null&&(bl(t,1,e),cr(t,e));break}}t=t.return}}function yv(e,t,n){var i=e.pingCache;i!==null&&i.delete(t),t=Qn(),e.pingedLanes|=e.suspendedLanes&n,An===e&&(Mn&n)===n&&(pn===4||pn===3&&(Mn&130023424)===Mn&&500>nn()-Ef?eo(e,0):Cf|=n),cr(e,t)}function yp(e,t){t===0&&(e.mode&1?(t=$l,$l<<=1,!($l&130023424)&&($l=4194304)):t=1);var n=Qn();e=Bi(e,t),e!==null&&(bl(e,t,n),cr(e,n))}function vv(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),yp(e,n)}function wv(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,l=e.memoizedState;l!==null&&(n=l.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(ve(314))}i!==null&&i.delete(t),yp(e,n)}var vp;vp=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||ar.current)or=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return or=!1,av(e,t,n);or=!!(e.flags&131072)}else or=!1,Gt&&t.flags&1048576&&Cm(t,jc,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;wc(e,t),e=t.pendingProps;var l=$o(t,Un.current);Go(t,n),l=xf(null,t,i,e,l,n);var c=yf();return t.flags|=1,typeof l=="object"&&l!==null&&typeof l.render=="function"&&l.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,lr(i)?(c=!0,Pc(t)):c=!1,t.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,hf(t),l.updater=du,t.stateNode=l,l._reactInternals=t,eh(t,i,e,n),t=rh(null,t,i,!0,c,n)):(t.tag=0,Gt&&c&&sf(t),Kn(null,t,l,n),t=t.child),t;case 16:i=t.elementType;e:{switch(wc(e,t),e=t.pendingProps,l=i._init,i=l(i._payload),t.type=i,l=t.tag=bv(i),e=Xr(i,e),l){case 0:t=nh(null,t,i,e,n);break e;case 1:t=s1(null,t,i,e,n);break e;case 11:t=r1(null,t,i,e,n);break e;case 14:t=i1(null,t,i,Xr(i.type,e),n);break e}throw Error(ve(306,i,""))}return t;case 0:return i=t.type,l=t.pendingProps,l=t.elementType===i?l:Xr(i,l),nh(e,t,i,l,n);case 1:return i=t.type,l=t.pendingProps,l=t.elementType===i?l:Xr(i,l),s1(e,t,i,l,n);case 3:e:{if(np(t),e===null)throw Error(ve(387));i=t.pendingProps,c=t.memoizedState,l=c.element,Im(e,t),Fc(t,i,null,n);var m=t.memoizedState;if(i=m.element,c.isDehydrated)if(c={element:i,isDehydrated:!1,cache:m.cache,pendingSuspenseBoundaries:m.pendingSuspenseBoundaries,transitions:m.transitions},t.updateQueue.baseState=c,t.memoizedState=c,t.flags&256){l=Qo(Error(ve(423)),t),t=o1(e,t,i,n,l);break e}else if(i!==l){l=Qo(Error(ve(424)),t),t=o1(e,t,i,n,l);break e}else for(wr=ps(t.stateNode.containerInfo.firstChild),_r=t,Gt=!0,Jr=null,n=Nm(t,null,i,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Xo(),i===l){t=Fi(e,t,n);break e}Kn(e,t,i,n)}t=t.child}return t;case 5:return km(t),e===null&&Kd(t),i=t.type,l=t.pendingProps,c=e!==null?e.memoizedProps:null,m=l.children,Zd(i,l)?m=null:c!==null&&Zd(i,c)&&(t.flags|=32),tp(e,t),Kn(e,t,m,n),t.child;case 6:return e===null&&Kd(t),null;case 13:return rp(e,t,n);case 4:return ff(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=qo(t,null,i,n):Kn(e,t,i,n),t.child;case 11:return i=t.type,l=t.pendingProps,l=t.elementType===i?l:Xr(i,l),r1(e,t,i,l,n);case 7:return Kn(e,t,t.pendingProps,n),t.child;case 8:return Kn(e,t,t.pendingProps.children,n),t.child;case 12:return Kn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,l=t.pendingProps,c=t.memoizedProps,m=l.value,Dt(Dc,i._currentValue),i._currentValue=m,c!==null)if(ni(c.value,m)){if(c.children===l.children&&!ar.current){t=Fi(e,t,n);break e}}else for(c=t.child,c!==null&&(c.return=t);c!==null;){var _=c.dependencies;if(_!==null){m=c.child;for(var v=_.firstContext;v!==null;){if(v.context===i){if(c.tag===1){v=Ri(-1,n&-n),v.tag=2;var y=c.updateQueue;if(y!==null){y=y.shared;var S=y.pending;S===null?v.next=v:(v.next=S.next,S.next=v),y.pending=v}}c.lanes|=n,v=c.alternate,v!==null&&(v.lanes|=n),Qd(c.return,n,t),_.lanes|=n;break}v=v.next}}else if(c.tag===10)m=c.type===t.type?null:c.child;else if(c.tag===18){if(m=c.return,m===null)throw Error(ve(341));m.lanes|=n,_=m.alternate,_!==null&&(_.lanes|=n),Qd(m,n,t),m=c.sibling}else m=c.child;if(m!==null)m.return=c;else for(m=c;m!==null;){if(m===t){m=null;break}if(c=m.sibling,c!==null){c.return=m.return,m=c;break}m=m.return}c=m}Kn(e,t,l.children,n),t=t.child}return t;case 9:return l=t.type,i=t.pendingProps.children,Go(t,n),l=Fr(l),i=i(l),t.flags|=1,Kn(e,t,i,n),t.child;case 14:return i=t.type,l=Xr(i,t.pendingProps),l=Xr(i.type,l),i1(e,t,i,l,n);case 15:return Jm(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,l=t.pendingProps,l=t.elementType===i?l:Xr(i,l),wc(e,t),t.tag=1,lr(i)?(e=!0,Pc(t)):e=!1,Go(t,n),qm(t,i,l),eh(t,i,l,n),rh(null,t,i,!0,e,n);case 19:return ip(e,t,n);case 22:return ep(e,t,n)}throw Error(ve(156,t.tag))};function wp(e,t){return Yg(e,t)}function _v(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dr(e,t,n,i){return new _v(e,t,n,i)}function Tf(e){return e=e.prototype,!(!e||!e.isReactComponent)}function bv(e){if(typeof e=="function")return Tf(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Zh)return 11;if(e===Yh)return 14}return 2}function ws(e,t){var n=e.alternate;return n===null?(n=Dr(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Cc(e,t,n,i,l,c){var m=2;if(i=e,typeof e=="function")Tf(e)&&(m=1);else if(typeof e=="string")m=5;else e:switch(e){case Io:return to(n.children,l,c,t);case Gh:m=8,l|=8;break;case Ed:return e=Dr(12,n,t,l|2),e.elementType=Ed,e.lanes=c,e;case Sd:return e=Dr(13,n,t,l),e.elementType=Sd,e.lanes=c,e;case Ad:return e=Dr(19,n,t,l),e.elementType=Ad,e.lanes=c,e;case kg:return gu(n,l,c,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Tg:m=10;break e;case Ig:m=9;break e;case Zh:m=11;break e;case Yh:m=14;break e;case ss:m=16,i=null;break e}throw Error(ve(130,e==null?e:typeof e,""))}return t=Dr(m,n,t,l),t.elementType=e,t.type=i,t.lanes=c,t}function to(e,t,n,i){return e=Dr(7,e,i,t),e.lanes=n,e}function gu(e,t,n,i){return e=Dr(22,e,i,t),e.elementType=kg,e.lanes=n,e.stateNode={isHidden:!1},e}function ud(e,t,n){return e=Dr(6,e,null,t),e.lanes=n,e}function dd(e,t,n){return t=Dr(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Cv(e,t,n,i,l){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gu(0),this.expirationTimes=Gu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gu(0),this.identifierPrefix=i,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function If(e,t,n,i,l,c,m,_,v){return e=new Cv(e,t,n,_,v),t===1?(t=1,c===!0&&(t|=8)):t=0,c=Dr(3,null,null,t),e.current=c,c.stateNode=e,c.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},hf(c),e}function Ev(e,t,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:To,key:i==null?null:""+i,children:e,containerInfo:t,implementation:n}}function _p(e){if(!e)return Es;e=e._reactInternals;e:{if(co(e)!==e||e.tag!==1)throw Error(ve(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(lr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ve(171))}if(e.tag===1){var n=e.type;if(lr(n))return _m(e,n,t)}return t}function bp(e,t,n,i,l,c,m,_,v){return e=If(n,i,!0,e,l,c,m,_,v),e.context=_p(null),n=e.current,i=Qn(),l=vs(n),c=Ri(i,l),c.callback=t??null,xs(n,c,l),e.current.lanes=l,bl(e,l,i),cr(e,i),e}function mu(e,t,n,i){var l=t.current,c=Qn(),m=vs(l);return n=_p(n),t.context===null?t.context=n:t.pendingContext=n,t=Ri(c,m),t.payload={element:e},i=i===void 0?null:i,i!==null&&(t.callback=i),e=xs(l,t,m),e!==null&&(ti(e,l,m,c),xc(e,l,m)),m}function Yc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function p1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function kf(e,t){p1(e,t),(e=e.alternate)&&p1(e,t)}function Sv(){return null}var Cp=typeof reportError=="function"?reportError:function(e){console.error(e)};function Mf(e){this._internalRoot=e}pu.prototype.render=Mf.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ve(409));mu(e,t,null,null)};pu.prototype.unmount=Mf.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;oo(function(){mu(null,e,null,null)}),t[Di]=null}};function pu(e){this._internalRoot=e}pu.prototype.unstable_scheduleHydration=function(e){if(e){var t=em();e={blockedOn:null,target:e,priority:t};for(var n=0;n<as.length&&t!==0&&t<as[n].priority;n++);as.splice(n,0,e),n===0&&nm(e)}};function Of(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function xu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function x1(){}function Av(e,t,n,i,l){if(l){if(typeof i=="function"){var c=i;i=function(){var y=Yc(m);c.call(y)}}var m=bp(t,i,e,0,null,!1,!1,"",x1);return e._reactRootContainer=m,e[Di]=m.current,cl(e.nodeType===8?e.parentNode:e),oo(),m}for(;l=e.lastChild;)e.removeChild(l);if(typeof i=="function"){var _=i;i=function(){var y=Yc(v);_.call(y)}}var v=If(e,0,!1,null,null,!1,!1,"",x1);return e._reactRootContainer=v,e[Di]=v.current,cl(e.nodeType===8?e.parentNode:e),oo(function(){mu(t,v,n,i)}),v}function yu(e,t,n,i,l){var c=n._reactRootContainer;if(c){var m=c;if(typeof l=="function"){var _=l;l=function(){var v=Yc(m);_.call(v)}}mu(t,m,e,l)}else m=Av(n,t,e,l,i);return Yc(m)}Qg=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Fa(t.pendingLanes);n!==0&&(qh(t,n|1),cr(t,nn()),!(pt&6)&&(Jo=nn()+500,Ts()))}break;case 13:oo(function(){var i=Bi(e,1);if(i!==null){var l=Qn();ti(i,e,1,l)}}),kf(e,1)}};Kh=function(e){if(e.tag===13){var t=Bi(e,134217728);if(t!==null){var n=Qn();ti(t,e,134217728,n)}kf(e,134217728)}};Jg=function(e){if(e.tag===13){var t=vs(e),n=Bi(e,t);if(n!==null){var i=Qn();ti(n,e,t,i)}kf(e,t)}};em=function(){return St};tm=function(e,t){var n=St;try{return St=e,t()}finally{St=n}};jd=function(e,t,n){switch(t){case"input":if(Id(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var l=lu(i);if(!l)throw Error(ve(90));Og(i),Id(i,l)}}}break;case"textarea":Pg(e,n);break;case"select":t=n.value,t!=null&&zo(e,!!n.multiple,t,!1)}};zg=Sf;Hg=oo;var Nv={usingClientEntryPoint:!1,Events:[El,Lo,lu,Fg,Ug,Sf]},Ra={findFiberByHostInstance:Ks,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Tv={bundleType:Ra.bundleType,version:Ra.version,rendererPackageName:Ra.rendererPackageName,rendererConfig:Ra.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ui.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Gg(e),e===null?null:e.stateNode},findFiberByHostInstance:Ra.findFiberByHostInstance||Sv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sc.isDisabled&&sc.supportsFiber)try{iu=sc.inject(Tv),mi=sc}catch{}}Cr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Nv;Cr.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Of(t))throw Error(ve(200));return Ev(e,t,null,n)};Cr.createRoot=function(e,t){if(!Of(e))throw Error(ve(299));var n=!1,i="",l=Cp;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(l=t.onRecoverableError)),t=If(e,1,!1,null,null,n,!1,i,l),e[Di]=t.current,cl(e.nodeType===8?e.parentNode:e),new Mf(t)};Cr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ve(188)):(e=Object.keys(e).join(","),Error(ve(268,e)));return e=Gg(t),e=e===null?null:e.stateNode,e};Cr.flushSync=function(e){return oo(e)};Cr.hydrate=function(e,t,n){if(!xu(t))throw Error(ve(200));return yu(null,e,t,!0,n)};Cr.hydrateRoot=function(e,t,n){if(!Of(e))throw Error(ve(405));var i=n!=null&&n.hydratedSources||null,l=!1,c="",m=Cp;if(n!=null&&(n.unstable_strictMode===!0&&(l=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onRecoverableError!==void 0&&(m=n.onRecoverableError)),t=bp(t,null,e,1,n??null,l,!1,c,m),e[Di]=t.current,cl(e),i)for(e=0;e<i.length;e++)n=i[e],l=n._getVersion,l=l(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,l]:t.mutableSourceEagerHydrationData.push(n,l);return new pu(t)};Cr.render=function(e,t,n){if(!xu(t))throw Error(ve(200));return yu(null,e,t,!1,n)};Cr.unmountComponentAtNode=function(e){if(!xu(e))throw Error(ve(40));return e._reactRootContainer?(oo(function(){yu(null,null,e,!1,function(){e._reactRootContainer=null,e[Di]=null})}),!0):!1};Cr.unstable_batchedUpdates=Sf;Cr.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!xu(n))throw Error(ve(200));if(e==null||e._reactInternals===void 0)throw Error(ve(38));return yu(e,t,n,!1,i)};Cr.version="18.3.1-next-f1338f8080-20240426";function Ep(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ep)}catch(e){console.error(e)}}Ep(),Eg.exports=Cr;var Sp=Eg.exports,y1=Sp;bd.createRoot=y1.createRoot,bd.hydrateRoot=y1.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yl(){return yl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},yl.apply(this,arguments)}var hs;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(hs||(hs={}));const v1="popstate";function Iv(e){e===void 0&&(e={});function t(i,l){let{pathname:c,search:m,hash:_}=i.location;return mh("",{pathname:c,search:m,hash:_},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function n(i,l){return typeof l=="string"?l:$c(l)}return Mv(t,n,null,e)}function Jt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Ap(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function kv(){return Math.random().toString(36).substr(2,8)}function w1(e,t){return{usr:e.state,key:e.key,idx:t}}function mh(e,t,n,i){return n===void 0&&(n=null),yl({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?oa(t):t,{state:n,key:t&&t.key||i||kv()})}function $c(e){let{pathname:t="/",search:n="",hash:i=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),i&&i!=="#"&&(t+=i.charAt(0)==="#"?i:"#"+i),t}function oa(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let i=e.indexOf("?");i>=0&&(t.search=e.substr(i),e=e.substr(0,i)),e&&(t.pathname=e)}return t}function Mv(e,t,n,i){i===void 0&&(i={});let{window:l=document.defaultView,v5Compat:c=!1}=i,m=l.history,_=hs.Pop,v=null,y=S();y==null&&(y=0,m.replaceState(yl({},m.state,{idx:y}),""));function S(){return(m.state||{idx:null}).idx}function E(){_=hs.Pop;let D=S(),R=D==null?null:D-y;y=D,v&&v({action:_,location:P.location,delta:R})}function T(D,R){_=hs.Push;let I=mh(P.location,D,R);y=S()+1;let k=w1(I,y),z=P.createHref(I);try{m.pushState(k,"",z)}catch(G){if(G instanceof DOMException&&G.name==="DataCloneError")throw G;l.location.assign(z)}c&&v&&v({action:_,location:P.location,delta:1})}function U(D,R){_=hs.Replace;let I=mh(P.location,D,R);y=S();let k=w1(I,y),z=P.createHref(I);m.replaceState(k,"",z),c&&v&&v({action:_,location:P.location,delta:0})}function j(D){let R=l.location.origin!=="null"?l.location.origin:l.location.href,I=typeof D=="string"?D:$c(D);return I=I.replace(/ $/,"%20"),Jt(R,"No window.location.(origin|href) available to create URL for href: "+I),new URL(I,R)}let P={get action(){return _},get location(){return e(l,m)},listen(D){if(v)throw new Error("A history only accepts one active listener");return l.addEventListener(v1,E),v=D,()=>{l.removeEventListener(v1,E),v=null}},createHref(D){return t(l,D)},createURL:j,encodeLocation(D){let R=j(D);return{pathname:R.pathname,search:R.search,hash:R.hash}},push:T,replace:U,go(D){return m.go(D)}};return P}var _1;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(_1||(_1={}));function Ov(e,t,n){return n===void 0&&(n="/"),Lv(e,t,n)}function Lv(e,t,n,i){let l=typeof t=="string"?oa(t):t,c=ea(l.pathname||"/",n);if(c==null)return null;let m=Np(e);Pv(m);let _=null;for(let v=0;_==null&&v<m.length;++v){let y=Gv(c);_=Wv(m[v],y)}return _}function Np(e,t,n,i){t===void 0&&(t=[]),n===void 0&&(n=[]),i===void 0&&(i="");let l=(c,m,_)=>{let v={relativePath:_===void 0?c.path||"":_,caseSensitive:c.caseSensitive===!0,childrenIndex:m,route:c};v.relativePath.startsWith("/")&&(Jt(v.relativePath.startsWith(i),'Absolute route path "'+v.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),v.relativePath=v.relativePath.slice(i.length));let y=_s([i,v.relativePath]),S=n.concat(v);c.children&&c.children.length>0&&(Jt(c.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+y+'".')),Np(c.children,t,S,y)),!(c.path==null&&!c.index)&&t.push({path:y,score:zv(y,c.index),routesMeta:S})};return e.forEach((c,m)=>{var _;if(c.path===""||!((_=c.path)!=null&&_.includes("?")))l(c,m);else for(let v of Tp(c.path))l(c,m,v)}),t}function Tp(e){let t=e.split("/");if(t.length===0)return[];let[n,...i]=t,l=n.endsWith("?"),c=n.replace(/\?$/,"");if(i.length===0)return l?[c,""]:[c];let m=Tp(i.join("/")),_=[];return _.push(...m.map(v=>v===""?c:[c,v].join("/"))),l&&_.push(...m),_.map(v=>e.startsWith("/")&&v===""?"/":v)}function Pv(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:Hv(t.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}const Rv=/^:[\w-]+$/,jv=3,Dv=2,Bv=1,Fv=10,Uv=-2,b1=e=>e==="*";function zv(e,t){let n=e.split("/"),i=n.length;return n.some(b1)&&(i+=Uv),t&&(i+=Dv),n.filter(l=>!b1(l)).reduce((l,c)=>l+(Rv.test(c)?jv:c===""?Bv:Fv),i)}function Hv(e,t){return e.length===t.length&&e.slice(0,-1).every((i,l)=>i===t[l])?e[e.length-1]-t[t.length-1]:0}function Wv(e,t,n){let{routesMeta:i}=e,l={},c="/",m=[];for(let _=0;_<i.length;++_){let v=i[_],y=_===i.length-1,S=c==="/"?t:t.slice(c.length)||"/",E=ph({path:v.relativePath,caseSensitive:v.caseSensitive,end:y},S),T=v.route;if(!E)return null;Object.assign(l,E.params),m.push({params:l,pathname:_s([c,E.pathname]),pathnameBase:Xv(_s([c,E.pathnameBase])),route:T}),E.pathnameBase!=="/"&&(c=_s([c,E.pathnameBase]))}return m}function ph(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,i]=Vv(e.path,e.caseSensitive,e.end),l=t.match(n);if(!l)return null;let c=l[0],m=c.replace(/(.)\/+$/,"$1"),_=l.slice(1);return{params:i.reduce((y,S,E)=>{let{paramName:T,isOptional:U}=S;if(T==="*"){let P=_[E]||"";m=c.slice(0,c.length-P.length).replace(/(.)\/+$/,"$1")}const j=_[E];return U&&!j?y[T]=void 0:y[T]=(j||"").replace(/%2F/g,"/"),y},{}),pathname:c,pathnameBase:m,pattern:e}}function Vv(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),Ap(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let i=[],l="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(m,_,v)=>(i.push({paramName:_,isOptional:v!=null}),v?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(i.push({paramName:"*"}),l+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?l+="\\/*$":e!==""&&e!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,t?void 0:"i"),i]}function Gv(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Ap(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function ea(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=e.charAt(n);return i&&i!=="/"?null:e.slice(n)||"/"}function Zv(e,t){t===void 0&&(t="/");let{pathname:n,search:i="",hash:l=""}=typeof e=="string"?oa(e):e;return{pathname:n?n.startsWith("/")?n:Yv(n,t):t,search:qv(i),hash:Kv(l)}}function Yv(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(l=>{l===".."?n.length>1&&n.pop():l!=="."&&n.push(l)}),n.length>1?n.join("/"):"/"}function hd(e,t,n,i){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function $v(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function Ip(e,t){let n=$v(e);return t?n.map((i,l)=>l===n.length-1?i.pathname:i.pathnameBase):n.map(i=>i.pathnameBase)}function kp(e,t,n,i){i===void 0&&(i=!1);let l;typeof e=="string"?l=oa(e):(l=yl({},e),Jt(!l.pathname||!l.pathname.includes("?"),hd("?","pathname","search",l)),Jt(!l.pathname||!l.pathname.includes("#"),hd("#","pathname","hash",l)),Jt(!l.search||!l.search.includes("#"),hd("#","search","hash",l)));let c=e===""||l.pathname==="",m=c?"/":l.pathname,_;if(m==null)_=n;else{let E=t.length-1;if(!i&&m.startsWith("..")){let T=m.split("/");for(;T[0]==="..";)T.shift(),E-=1;l.pathname=T.join("/")}_=E>=0?t[E]:"/"}let v=Zv(l,_),y=m&&m!=="/"&&m.endsWith("/"),S=(c||m===".")&&n.endsWith("/");return!v.pathname.endsWith("/")&&(y||S)&&(v.pathname+="/"),v}const _s=e=>e.join("/").replace(/\/\/+/g,"/"),Xv=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),qv=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Kv=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Qv(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Mp=["post","put","patch","delete"];new Set(Mp);const Jv=["get",...Mp];new Set(Jv);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vl(){return vl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},vl.apply(this,arguments)}const vu=H.createContext(null),Op=H.createContext(null),Is=H.createContext(null),wu=H.createContext(null),ks=H.createContext({outlet:null,matches:[],isDataRoute:!1}),Lp=H.createContext(null);function ew(e,t){let{relative:n}=t===void 0?{}:t;Al()||Jt(!1);let{basename:i,navigator:l}=H.useContext(Is),{hash:c,pathname:m,search:_}=_u(e,{relative:n}),v=m;return i!=="/"&&(v=m==="/"?i:_s([i,m])),l.createHref({pathname:v,search:_,hash:c})}function Al(){return H.useContext(wu)!=null}function Ms(){return Al()||Jt(!1),H.useContext(wu).location}function Pp(e){H.useContext(Is).static||H.useLayoutEffect(e)}function zi(){let{isDataRoute:e}=H.useContext(ks);return e?gw():tw()}function tw(){Al()||Jt(!1);let e=H.useContext(vu),{basename:t,future:n,navigator:i}=H.useContext(Is),{matches:l}=H.useContext(ks),{pathname:c}=Ms(),m=JSON.stringify(Ip(l,n.v7_relativeSplatPath)),_=H.useRef(!1);return Pp(()=>{_.current=!0}),H.useCallback(function(y,S){if(S===void 0&&(S={}),!_.current)return;if(typeof y=="number"){i.go(y);return}let E=kp(y,JSON.parse(m),c,S.relative==="path");e==null&&t!=="/"&&(E.pathname=E.pathname==="/"?t:_s([t,E.pathname])),(S.replace?i.replace:i.push)(E,S.state,S)},[t,i,m,c,e])}function nw(){let{matches:e}=H.useContext(ks),t=e[e.length-1];return t?t.params:{}}function _u(e,t){let{relative:n}=t===void 0?{}:t,{future:i}=H.useContext(Is),{matches:l}=H.useContext(ks),{pathname:c}=Ms(),m=JSON.stringify(Ip(l,i.v7_relativeSplatPath));return H.useMemo(()=>kp(e,JSON.parse(m),c,n==="path"),[e,m,c,n])}function rw(e,t){return iw(e,t)}function iw(e,t,n,i){Al()||Jt(!1);let{navigator:l}=H.useContext(Is),{matches:c}=H.useContext(ks),m=c[c.length-1],_=m?m.params:{};m&&m.pathname;let v=m?m.pathnameBase:"/";m&&m.route;let y=Ms(),S;if(t){var E;let D=typeof t=="string"?oa(t):t;v==="/"||(E=D.pathname)!=null&&E.startsWith(v)||Jt(!1),S=D}else S=y;let T=S.pathname||"/",U=T;if(v!=="/"){let D=v.replace(/^\//,"").split("/");U="/"+T.replace(/^\//,"").split("/").slice(D.length).join("/")}let j=Ov(e,{pathname:U}),P=cw(j&&j.map(D=>Object.assign({},D,{params:Object.assign({},_,D.params),pathname:_s([v,l.encodeLocation?l.encodeLocation(D.pathname).pathname:D.pathname]),pathnameBase:D.pathnameBase==="/"?v:_s([v,l.encodeLocation?l.encodeLocation(D.pathnameBase).pathname:D.pathnameBase])})),c,n,i);return t&&P?H.createElement(wu.Provider,{value:{location:vl({pathname:"/",search:"",hash:"",state:null,key:"default"},S),navigationType:hs.Pop}},P):P}function sw(){let e=fw(),t=Qv(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,l={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return H.createElement(H.Fragment,null,H.createElement("h2",null,"Unexpected Application Error!"),H.createElement("h3",{style:{fontStyle:"italic"}},t),n?H.createElement("pre",{style:l},n):null,null)}const ow=H.createElement(sw,null);class aw extends H.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?H.createElement(ks.Provider,{value:this.props.routeContext},H.createElement(Lp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function lw(e){let{routeContext:t,match:n,children:i}=e,l=H.useContext(vu);return l&&l.static&&l.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(l.staticContext._deepestRenderedBoundaryId=n.route.id),H.createElement(ks.Provider,{value:t},i)}function cw(e,t,n,i){var l;if(t===void 0&&(t=[]),n===void 0&&(n=null),i===void 0&&(i=null),e==null){var c;if(!n)return null;if(n.errors)e=n.matches;else if((c=i)!=null&&c.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let m=e,_=(l=n)==null?void 0:l.errors;if(_!=null){let S=m.findIndex(E=>E.route.id&&(_==null?void 0:_[E.route.id])!==void 0);S>=0||Jt(!1),m=m.slice(0,Math.min(m.length,S+1))}let v=!1,y=-1;if(n&&i&&i.v7_partialHydration)for(let S=0;S<m.length;S++){let E=m[S];if((E.route.HydrateFallback||E.route.hydrateFallbackElement)&&(y=S),E.route.id){let{loaderData:T,errors:U}=n,j=E.route.loader&&T[E.route.id]===void 0&&(!U||U[E.route.id]===void 0);if(E.route.lazy||j){v=!0,y>=0?m=m.slice(0,y+1):m=[m[0]];break}}}return m.reduceRight((S,E,T)=>{let U,j=!1,P=null,D=null;n&&(U=_&&E.route.id?_[E.route.id]:void 0,P=E.route.errorElement||ow,v&&(y<0&&T===0?(mw("route-fallback"),j=!0,D=null):y===T&&(j=!0,D=E.route.hydrateFallbackElement||null)));let R=t.concat(m.slice(0,T+1)),I=()=>{let k;return U?k=P:j?k=D:E.route.Component?k=H.createElement(E.route.Component,null):E.route.element?k=E.route.element:k=S,H.createElement(lw,{match:E,routeContext:{outlet:S,matches:R,isDataRoute:n!=null},children:k})};return n&&(E.route.ErrorBoundary||E.route.errorElement||T===0)?H.createElement(aw,{location:n.location,revalidation:n.revalidation,component:P,error:U,children:I(),routeContext:{outlet:null,matches:R,isDataRoute:!0}}):I()},null)}var Rp=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Rp||{}),jp=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(jp||{});function uw(e){let t=H.useContext(vu);return t||Jt(!1),t}function dw(e){let t=H.useContext(Op);return t||Jt(!1),t}function hw(e){let t=H.useContext(ks);return t||Jt(!1),t}function Dp(e){let t=hw(),n=t.matches[t.matches.length-1];return n.route.id||Jt(!1),n.route.id}function fw(){var e;let t=H.useContext(Lp),n=dw(),i=Dp();return t!==void 0?t:(e=n.errors)==null?void 0:e[i]}function gw(){let{router:e}=uw(Rp.UseNavigateStable),t=Dp(jp.UseNavigateStable),n=H.useRef(!1);return Pp(()=>{n.current=!0}),H.useCallback(function(l,c){c===void 0&&(c={}),n.current&&(typeof l=="number"?e.navigate(l):e.navigate(l,vl({fromRouteId:t},c)))},[e,t])}const C1={};function mw(e,t,n){C1[e]||(C1[e]=!0)}function pw(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Xn(e){Jt(!1)}function xw(e){let{basename:t="/",children:n=null,location:i,navigationType:l=hs.Pop,navigator:c,static:m=!1,future:_}=e;Al()&&Jt(!1);let v=t.replace(/^\/*/,"/"),y=H.useMemo(()=>({basename:v,navigator:c,static:m,future:vl({v7_relativeSplatPath:!1},_)}),[v,_,c,m]);typeof i=="string"&&(i=oa(i));let{pathname:S="/",search:E="",hash:T="",state:U=null,key:j="default"}=i,P=H.useMemo(()=>{let D=ea(S,v);return D==null?null:{location:{pathname:D,search:E,hash:T,state:U,key:j},navigationType:l}},[v,S,E,T,U,j,l]);return P==null?null:H.createElement(Is.Provider,{value:y},H.createElement(wu.Provider,{children:n,value:P}))}function yw(e){let{children:t,location:n}=e;return rw(xh(t),n)}new Promise(()=>{});function xh(e,t){t===void 0&&(t=[]);let n=[];return H.Children.forEach(e,(i,l)=>{if(!H.isValidElement(i))return;let c=[...t,l];if(i.type===H.Fragment){n.push.apply(n,xh(i.props.children,c));return}i.type!==Xn&&Jt(!1),!i.props.index||!i.props.children||Jt(!1);let m={id:i.props.id||c.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(m.children=xh(i.props.children,c)),n.push(m)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Xc(){return Xc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Xc.apply(this,arguments)}function Bp(e,t){if(e==null)return{};var n={},i=Object.keys(e),l,c;for(c=0;c<i.length;c++)l=i[c],!(t.indexOf(l)>=0)&&(n[l]=e[l]);return n}function vw(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function ww(e,t){return e.button===0&&(!t||t==="_self")&&!vw(e)}function yh(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let i=e[n];return t.concat(Array.isArray(i)?i.map(l=>[n,l]):[[n,i]])},[]))}function _w(e,t){let n=yh(e);return t&&t.forEach((i,l)=>{n.has(l)||t.getAll(l).forEach(c=>{n.append(l,c)})}),n}const bw=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Cw=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],Ew="6";try{window.__reactRouterVersion=Ew}catch{}const Sw=H.createContext({isTransitioning:!1}),Aw="startTransition",E1=yy[Aw];function Nw(e){let{basename:t,children:n,future:i,window:l}=e,c=H.useRef();c.current==null&&(c.current=Iv({window:l,v5Compat:!0}));let m=c.current,[_,v]=H.useState({action:m.action,location:m.location}),{v7_startTransition:y}=i||{},S=H.useCallback(E=>{y&&E1?E1(()=>v(E)):v(E)},[v,y]);return H.useLayoutEffect(()=>m.listen(S),[m,S]),H.useEffect(()=>pw(i),[i]),H.createElement(xw,{basename:t,children:n,location:_.location,navigationType:_.action,navigator:m,future:i})}const Tw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Iw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,bs=H.forwardRef(function(t,n){let{onClick:i,relative:l,reloadDocument:c,replace:m,state:_,target:v,to:y,preventScrollReset:S,viewTransition:E}=t,T=Bp(t,bw),{basename:U}=H.useContext(Is),j,P=!1;if(typeof y=="string"&&Iw.test(y)&&(j=y,Tw))try{let k=new URL(window.location.href),z=y.startsWith("//")?new URL(k.protocol+y):new URL(y),G=ea(z.pathname,U);z.origin===k.origin&&G!=null?y=G+z.search+z.hash:P=!0}catch{}let D=ew(y,{relative:l}),R=Mw(y,{replace:m,state:_,target:v,preventScrollReset:S,relative:l,viewTransition:E});function I(k){i&&i(k),k.defaultPrevented||R(k)}return H.createElement("a",Xc({},T,{href:j||D,onClick:P||c?i:I,ref:n,target:v}))}),ts=H.forwardRef(function(t,n){let{"aria-current":i="page",caseSensitive:l=!1,className:c="",end:m=!1,style:_,to:v,viewTransition:y,children:S}=t,E=Bp(t,Cw),T=_u(v,{relative:E.relative}),U=Ms(),j=H.useContext(Op),{navigator:P,basename:D}=H.useContext(Is),R=j!=null&&Ow(T)&&y===!0,I=P.encodeLocation?P.encodeLocation(T).pathname:T.pathname,k=U.pathname,z=j&&j.navigation&&j.navigation.location?j.navigation.location.pathname:null;l||(k=k.toLowerCase(),z=z?z.toLowerCase():null,I=I.toLowerCase()),z&&D&&(z=ea(z,D)||z);const G=I!=="/"&&I.endsWith("/")?I.length-1:I.length;let Y=k===I||!m&&k.startsWith(I)&&k.charAt(G)==="/",Z=z!=null&&(z===I||!m&&z.startsWith(I)&&z.charAt(I.length)==="/"),J={isActive:Y,isPending:Z,isTransitioning:R},ie=Y?i:void 0,Ee;typeof c=="function"?Ee=c(J):Ee=[c,Y?"active":null,Z?"pending":null,R?"transitioning":null].filter(Boolean).join(" ");let ce=typeof _=="function"?_(J):_;return H.createElement(bs,Xc({},E,{"aria-current":ie,className:Ee,ref:n,style:ce,to:v,viewTransition:y}),typeof S=="function"?S(J):S)});var vh;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(vh||(vh={}));var S1;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(S1||(S1={}));function kw(e){let t=H.useContext(vu);return t||Jt(!1),t}function Mw(e,t){let{target:n,replace:i,state:l,preventScrollReset:c,relative:m,viewTransition:_}=t===void 0?{}:t,v=zi(),y=Ms(),S=_u(e,{relative:m});return H.useCallback(E=>{if(ww(E,n)){E.preventDefault();let T=i!==void 0?i:$c(y)===$c(S);v(e,{replace:T,state:l,preventScrollReset:c,relative:m,viewTransition:_})}},[y,v,S,i,l,n,e,c,m,_])}function Fp(e){let t=H.useRef(yh(e)),n=H.useRef(!1),i=Ms(),l=H.useMemo(()=>_w(i.search,n.current?null:t.current),[i.search]),c=zi(),m=H.useCallback((_,v)=>{const y=yh(typeof _=="function"?_(l):_);n.current=!0,c("?"+y,v)},[c,l]);return[l,m]}function Ow(e,t){t===void 0&&(t={});let n=H.useContext(Sw);n==null&&Jt(!1);let{basename:i}=kw(vh.useViewTransitionState),l=_u(e,{relative:t.relative});if(!n.isTransitioning)return!1;let c=ea(n.currentLocation.pathname,i)||n.currentLocation.pathname,m=ea(n.nextLocation.pathname,i)||n.nextLocation.pathname;return ph(l.pathname,m)!=null||ph(l.pathname,c)!=null}const Lw="modulepreload",Pw=function(e){return"/"+e},A1={},Nl=function(t,n,i){let l=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),_=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));l=Promise.allSettled(n.map(v=>{if(v=Pw(v),v in A1)return;A1[v]=!0;const y=v.endsWith(".css"),S=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${S}`))return;const E=document.createElement("link");if(E.rel=y?"stylesheet":Lw,y||(E.as="script"),E.crossOrigin="",E.href=v,_&&E.setAttribute("nonce",_),document.head.appendChild(E),y)return new Promise((T,U)=>{E.addEventListener("load",T),E.addEventListener("error",()=>U(new Error(`Unable to preload CSS for ${v}`)))})}))}function c(m){const _=new Event("vite:preloadError",{cancelable:!0});if(_.payload=m,window.dispatchEvent(_),!_.defaultPrevented)throw m}return l.then(m=>{for(const _ of m||[])_.status==="rejected"&&c(_.reason);return t().catch(c)})},Rw=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>Nl(async()=>{const{default:i}=await Promise.resolve().then(()=>aa);return{default:i}},void 0).then(({default:i})=>i(...n)):t=fetch,(...n)=>t(...n)};class Lf extends Error{constructor(t,n="FunctionsError",i){super(t),this.name=n,this.context=i}}class jw extends Lf{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class N1 extends Lf{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class T1 extends Lf{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var wh;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(wh||(wh={}));var Dw=function(e,t,n,i){function l(c){return c instanceof n?c:new n(function(m){m(c)})}return new(n||(n=Promise))(function(c,m){function _(S){try{y(i.next(S))}catch(E){m(E)}}function v(S){try{y(i.throw(S))}catch(E){m(E)}}function y(S){S.done?c(S.value):l(S.value).then(_,v)}y((i=i.apply(e,t||[])).next())})};class Bw{constructor(t,{headers:n={},customFetch:i,region:l=wh.Any}={}){this.url=t,this.headers=n,this.region=l,this.fetch=Rw(i)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,n={}){var i;return Dw(this,void 0,void 0,function*(){try{const{headers:l,method:c,body:m}=n;let _={},{region:v}=n;v||(v=this.region);const y=new URL(`${this.url}/${t}`);v&&v!=="any"&&(_["x-region"]=v,y.searchParams.set("forceFunctionRegion",v));let S;m&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)&&(typeof Blob<"u"&&m instanceof Blob||m instanceof ArrayBuffer?(_["Content-Type"]="application/octet-stream",S=m):typeof m=="string"?(_["Content-Type"]="text/plain",S=m):typeof FormData<"u"&&m instanceof FormData?S=m:(_["Content-Type"]="application/json",S=JSON.stringify(m)));const E=yield this.fetch(y.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},_),this.headers),l),body:S}).catch(P=>{throw new jw(P)}),T=E.headers.get("x-relay-error");if(T&&T==="true")throw new N1(E);if(!E.ok)throw new T1(E);let U=((i=E.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),j;return U==="application/json"?j=yield E.json():U==="application/octet-stream"?j=yield E.blob():U==="text/event-stream"?j=E:U==="multipart/form-data"?j=yield E.formData():j=yield E.text(),{data:j,error:null,response:E}}catch(l){return{data:null,error:l,response:l instanceof T1||l instanceof N1?l.context:void 0}}})}}var sr={},Pf={},bu={},Tl={},Cu={},Eu={},Fw=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ta=Fw();const Uw=ta.fetch,Up=ta.fetch.bind(ta),zp=ta.Headers,zw=ta.Request,Hw=ta.Response,aa=Object.freeze(Object.defineProperty({__proto__:null,Headers:zp,Request:zw,Response:Hw,default:Up,fetch:Uw},Symbol.toStringTag,{value:"Module"})),Ww=ny(aa);var Su={};Object.defineProperty(Su,"__esModule",{value:!0});let Vw=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Su.default=Vw;var Hp=Sn&&Sn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Eu,"__esModule",{value:!0});const Gw=Hp(Ww),Zw=Hp(Su);let Yw=class{constructor(t){var n,i;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(n=t.shouldThrowOnError)!==null&&n!==void 0?n:!1,this.signal=t.signal,this.isMaybeSingle=(i=t.isMaybeSingle)!==null&&i!==void 0?i:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=Gw.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,n){return this.headers=new Headers(this.headers),this.headers.set(t,n),this}then(t,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const i=this.fetch;let l=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var m,_,v,y;let S=null,E=null,T=null,U=c.status,j=c.statusText;if(c.ok){if(this.method!=="HEAD"){const I=await c.text();I===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((m=this.headers.get("Accept"))===null||m===void 0)&&m.includes("application/vnd.pgrst.plan+text"))?E=I:E=JSON.parse(I))}const D=(_=this.headers.get("Prefer"))===null||_===void 0?void 0:_.match(/count=(exact|planned|estimated)/),R=(v=c.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");D&&R&&R.length>1&&(T=parseInt(R[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(E)&&(E.length>1?(S={code:"PGRST116",details:`Results contain ${E.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},E=null,T=null,U=406,j="Not Acceptable"):E.length===1?E=E[0]:E=null)}else{const D=await c.text();try{S=JSON.parse(D),Array.isArray(S)&&c.status===404&&(E=[],S=null,U=200,j="OK")}catch{c.status===404&&D===""?(U=204,j="No Content"):S={message:D}}if(S&&this.isMaybeSingle&&(!((y=S==null?void 0:S.details)===null||y===void 0)&&y.includes("0 rows"))&&(S=null,U=200,j="OK"),S&&this.shouldThrowOnError)throw new Zw.default(S)}return{error:S,data:E,count:T,status:U,statusText:j}});return this.shouldThrowOnError||(l=l.catch(c=>{var m,_,v;return{error:{message:`${(m=c==null?void 0:c.name)!==null&&m!==void 0?m:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(_=c==null?void 0:c.stack)!==null&&_!==void 0?_:""}`,hint:"",code:`${(v=c==null?void 0:c.code)!==null&&v!==void 0?v:""}`},data:null,count:null,status:0,statusText:""}})),l.then(t,n)}returns(){return this}overrideTypes(){return this}};Eu.default=Yw;var $w=Sn&&Sn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Cu,"__esModule",{value:!0});const Xw=$w(Eu);let qw=class extends Xw.default{select(t){let n=!1;const i=(t??"*").split("").map(l=>/\s/.test(l)&&!n?"":(l==='"'&&(n=!n),l)).join("");return this.url.searchParams.set("select",i),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:n=!0,nullsFirst:i,foreignTable:l,referencedTable:c=l}={}){const m=c?`${c}.order`:"order",_=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${_?`${_},`:""}${t}.${n?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:n,referencedTable:i=n}={}){const l=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(l,`${t}`),this}range(t,n,{foreignTable:i,referencedTable:l=i}={}){const c=typeof l>"u"?"offset":`${l}.offset`,m=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${t}`),this.url.searchParams.set(m,`${n-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:n=!1,settings:i=!1,buffers:l=!1,wal:c=!1,format:m="text"}={}){var _;const v=[t?"analyze":null,n?"verbose":null,i?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),y=(_=this.headers.get("Accept"))!==null&&_!==void 0?_:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${y}"; options=${v};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};Cu.default=qw;var Kw=Sn&&Sn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Tl,"__esModule",{value:!0});const Qw=Kw(Cu);let Jw=class extends Qw.default{eq(t,n){return this.url.searchParams.append(t,`eq.${n}`),this}neq(t,n){return this.url.searchParams.append(t,`neq.${n}`),this}gt(t,n){return this.url.searchParams.append(t,`gt.${n}`),this}gte(t,n){return this.url.searchParams.append(t,`gte.${n}`),this}lt(t,n){return this.url.searchParams.append(t,`lt.${n}`),this}lte(t,n){return this.url.searchParams.append(t,`lte.${n}`),this}like(t,n){return this.url.searchParams.append(t,`like.${n}`),this}likeAllOf(t,n){return this.url.searchParams.append(t,`like(all).{${n.join(",")}}`),this}likeAnyOf(t,n){return this.url.searchParams.append(t,`like(any).{${n.join(",")}}`),this}ilike(t,n){return this.url.searchParams.append(t,`ilike.${n}`),this}ilikeAllOf(t,n){return this.url.searchParams.append(t,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(t,n){return this.url.searchParams.append(t,`ilike(any).{${n.join(",")}}`),this}is(t,n){return this.url.searchParams.append(t,`is.${n}`),this}in(t,n){const i=Array.from(new Set(n)).map(l=>typeof l=="string"&&new RegExp("[,()]").test(l)?`"${l}"`:`${l}`).join(",");return this.url.searchParams.append(t,`in.(${i})`),this}contains(t,n){return typeof n=="string"?this.url.searchParams.append(t,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(t,`cs.{${n.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(n)}`),this}containedBy(t,n){return typeof n=="string"?this.url.searchParams.append(t,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(t,`cd.{${n.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(n)}`),this}rangeGt(t,n){return this.url.searchParams.append(t,`sr.${n}`),this}rangeGte(t,n){return this.url.searchParams.append(t,`nxl.${n}`),this}rangeLt(t,n){return this.url.searchParams.append(t,`sl.${n}`),this}rangeLte(t,n){return this.url.searchParams.append(t,`nxr.${n}`),this}rangeAdjacent(t,n){return this.url.searchParams.append(t,`adj.${n}`),this}overlaps(t,n){return typeof n=="string"?this.url.searchParams.append(t,`ov.${n}`):this.url.searchParams.append(t,`ov.{${n.join(",")}}`),this}textSearch(t,n,{config:i,type:l}={}){let c="";l==="plain"?c="pl":l==="phrase"?c="ph":l==="websearch"&&(c="w");const m=i===void 0?"":`(${i})`;return this.url.searchParams.append(t,`${c}fts${m}.${n}`),this}match(t){return Object.entries(t).forEach(([n,i])=>{this.url.searchParams.append(n,`eq.${i}`)}),this}not(t,n,i){return this.url.searchParams.append(t,`not.${n}.${i}`),this}or(t,{foreignTable:n,referencedTable:i=n}={}){const l=i?`${i}.or`:"or";return this.url.searchParams.append(l,`(${t})`),this}filter(t,n,i){return this.url.searchParams.append(t,`${n}.${i}`),this}};Tl.default=Jw;var e_=Sn&&Sn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(bu,"__esModule",{value:!0});const ja=e_(Tl);let t_=class{constructor(t,{headers:n={},schema:i,fetch:l}){this.url=t,this.headers=new Headers(n),this.schema=i,this.fetch=l}select(t,{head:n=!1,count:i}={}){const l=n?"HEAD":"GET";let c=!1;const m=(t??"*").split("").map(_=>/\s/.test(_)&&!c?"":(_==='"'&&(c=!c),_)).join("");return this.url.searchParams.set("select",m),i&&this.headers.append("Prefer",`count=${i}`),new ja.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:n,defaultToNull:i=!0}={}){var l;const c="POST";if(n&&this.headers.append("Prefer",`count=${n}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const m=t.reduce((_,v)=>_.concat(Object.keys(v)),[]);if(m.length>0){const _=[...new Set(m)].map(v=>`"${v}"`);this.url.searchParams.set("columns",_.join(","))}}return new ja.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(t,{onConflict:n,ignoreDuplicates:i=!1,count:l,defaultToNull:c=!0}={}){var m;const _="POST";if(this.headers.append("Prefer",`resolution=${i?"ignore":"merge"}-duplicates`),n!==void 0&&this.url.searchParams.set("on_conflict",n),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const v=t.reduce((y,S)=>y.concat(Object.keys(S)),[]);if(v.length>0){const y=[...new Set(v)].map(S=>`"${S}"`);this.url.searchParams.set("columns",y.join(","))}}return new ja.default({method:_,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(t,{count:n}={}){var i;const l="PATCH";return n&&this.headers.append("Prefer",`count=${n}`),new ja.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}delete({count:t}={}){var n;const i="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new ja.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}};bu.default=t_;var Wp=Sn&&Sn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Pf,"__esModule",{value:!0});const n_=Wp(bu),r_=Wp(Tl);let i_=class Vp{constructor(t,{headers:n={},schema:i,fetch:l}={}){this.url=t,this.headers=new Headers(n),this.schemaName=i,this.fetch=l}from(t){const n=new URL(`${this.url}/${t}`);return new n_.default(n,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Vp(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,n={},{head:i=!1,get:l=!1,count:c}={}){var m;let _;const v=new URL(`${this.url}/rpc/${t}`);let y;i||l?(_=i?"HEAD":"GET",Object.entries(n).filter(([E,T])=>T!==void 0).map(([E,T])=>[E,Array.isArray(T)?`{${T.join(",")}}`:`${T}`]).forEach(([E,T])=>{v.searchParams.append(E,T)})):(_="POST",y=n);const S=new Headers(this.headers);return c&&S.set("Prefer",`count=${c}`),new r_.default({method:_,url:v,headers:S,schema:this.schemaName,body:y,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}};Pf.default=i_;var la=Sn&&Sn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(sr,"__esModule",{value:!0});sr.PostgrestError=sr.PostgrestBuilder=sr.PostgrestTransformBuilder=sr.PostgrestFilterBuilder=sr.PostgrestQueryBuilder=sr.PostgrestClient=void 0;const Gp=la(Pf);sr.PostgrestClient=Gp.default;const Zp=la(bu);sr.PostgrestQueryBuilder=Zp.default;const Yp=la(Tl);sr.PostgrestFilterBuilder=Yp.default;const $p=la(Cu);sr.PostgrestTransformBuilder=$p.default;const Xp=la(Eu);sr.PostgrestBuilder=Xp.default;const qp=la(Su);sr.PostgrestError=qp.default;var s_=sr.default={PostgrestClient:Gp.default,PostgrestQueryBuilder:Zp.default,PostgrestFilterBuilder:Yp.default,PostgrestTransformBuilder:$p.default,PostgrestBuilder:Xp.default,PostgrestError:qp.default};const{PostgrestClient:o_,PostgrestQueryBuilder:dE,PostgrestFilterBuilder:hE,PostgrestTransformBuilder:fE,PostgrestBuilder:gE,PostgrestError:mE}=s_;class a_{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const n=parseInt(process.versions.node.split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let n=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(n+=`

Suggested solution: ${t.workaround}`),new Error(n)}static createWebSocket(t,n){const i=this.getWebSocketConstructor();return new i(t,n)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const l_="2.15.1",c_=`realtime-js/${l_}`,u_="1.0.0",_h=1e4,d_=1e3,h_=100;var Qa;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Qa||(Qa={}));var fn;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(fn||(fn={}));var Kr;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Kr||(Kr={}));var bh;(function(e){e.websocket="websocket"})(bh||(bh={}));var qs;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(qs||(qs={}));class f_{constructor(){this.HEADER_LENGTH=1}decode(t,n){return t.constructor===ArrayBuffer?n(this._binaryDecode(t)):n(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const n=new DataView(t),i=new TextDecoder;return this._decodeBroadcast(t,n,i)}_decodeBroadcast(t,n,i){const l=n.getUint8(1),c=n.getUint8(2);let m=this.HEADER_LENGTH+2;const _=i.decode(t.slice(m,m+l));m=m+l;const v=i.decode(t.slice(m,m+c));m=m+c;const y=JSON.parse(i.decode(t.slice(m,t.byteLength)));return{ref:null,topic:_,event:v,payload:y}}}class Kp{constructor(t,n){this.callback=t,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var jt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(jt||(jt={}));const I1=(e,t,n={})=>{var i;const l=(i=n.skipTypes)!==null&&i!==void 0?i:[];return Object.keys(t).reduce((c,m)=>(c[m]=g_(m,e,t,l),c),{})},g_=(e,t,n,i)=>{const l=t.find(_=>_.name===e),c=l==null?void 0:l.type,m=n[e];return c&&!i.includes(c)?Qp(c,m):Ch(m)},Qp=(e,t)=>{if(e.charAt(0)==="_"){const n=e.slice(1,e.length);return y_(t,n)}switch(e){case jt.bool:return m_(t);case jt.float4:case jt.float8:case jt.int2:case jt.int4:case jt.int8:case jt.numeric:case jt.oid:return p_(t);case jt.json:case jt.jsonb:return x_(t);case jt.timestamp:return v_(t);case jt.abstime:case jt.date:case jt.daterange:case jt.int4range:case jt.int8range:case jt.money:case jt.reltime:case jt.text:case jt.time:case jt.timestamptz:case jt.timetz:case jt.tsrange:case jt.tstzrange:return Ch(t);default:return Ch(t)}},Ch=e=>e,m_=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},p_=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},x_=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},y_=(e,t)=>{if(typeof e!="string")return e;const n=e.length-1,i=e[n];if(e[0]==="{"&&i==="}"){let c;const m=e.slice(1,n);try{c=JSON.parse("["+m+"]")}catch{c=m?m.split(","):[]}return c.map(_=>Qp(t,_))}return e},v_=e=>typeof e=="string"?e.replace(" ","T"):e,Jp=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class fd{constructor(t,n,i={},l=_h){this.channel=t,this.event=n,this.payload=i,this.timeout=l,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,n){var i;return this._hasReceived(t)&&n((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:t,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:n}){this.recHooks.filter(i=>i.status===t).forEach(i=>i.callback(n))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var k1;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(k1||(k1={}));class Ja{constructor(t,n){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},l=>{const{onJoin:c,onLeave:m,onSync:_}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ja.syncState(this.state,l,c,m),this.pendingDiffs.forEach(v=>{this.state=Ja.syncDiff(this.state,v,c,m)}),this.pendingDiffs=[],_()}),this.channel._on(i.diff,{},l=>{const{onJoin:c,onLeave:m,onSync:_}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(l):(this.state=Ja.syncDiff(this.state,l,c,m),_())}),this.onJoin((l,c,m)=>{this.channel._trigger("presence",{event:"join",key:l,currentPresences:c,newPresences:m})}),this.onLeave((l,c,m)=>{this.channel._trigger("presence",{event:"leave",key:l,currentPresences:c,leftPresences:m})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,n,i,l){const c=this.cloneDeep(t),m=this.transformState(n),_={},v={};return this.map(c,(y,S)=>{m[y]||(v[y]=S)}),this.map(m,(y,S)=>{const E=c[y];if(E){const T=S.map(D=>D.presence_ref),U=E.map(D=>D.presence_ref),j=S.filter(D=>U.indexOf(D.presence_ref)<0),P=E.filter(D=>T.indexOf(D.presence_ref)<0);j.length>0&&(_[y]=j),P.length>0&&(v[y]=P)}else _[y]=S}),this.syncDiff(c,{joins:_,leaves:v},i,l)}static syncDiff(t,n,i,l){const{joins:c,leaves:m}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return i||(i=()=>{}),l||(l=()=>{}),this.map(c,(_,v)=>{var y;const S=(y=t[_])!==null&&y!==void 0?y:[];if(t[_]=this.cloneDeep(v),S.length>0){const E=t[_].map(U=>U.presence_ref),T=S.filter(U=>E.indexOf(U.presence_ref)<0);t[_].unshift(...T)}i(_,S,v)}),this.map(m,(_,v)=>{let y=t[_];if(!y)return;const S=v.map(E=>E.presence_ref);y=y.filter(E=>S.indexOf(E.presence_ref)<0),t[_]=y,l(_,y,v),y.length===0&&delete t[_]}),t}static map(t,n){return Object.getOwnPropertyNames(t).map(i=>n(i,t[i]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((n,i)=>{const l=t[i];return"metas"in l?n[i]=l.metas.map(c=>(c.presence_ref=c.phx_ref,delete c.phx_ref,delete c.phx_ref_prev,c)):n[i]=l,n},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var M1;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(M1||(M1={}));var el;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(el||(el={}));var ki;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(ki||(ki={}));class Rf{constructor(t,n={config:{}},i){this.topic=t,this.params=n,this.socket=i,this.bindings={},this.state=fn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new fd(this,Kr.join,this.params,this.timeout),this.rejoinTimer=new Kp(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=fn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=fn.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=fn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=fn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=fn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Kr.reply,{},(l,c)=>{this._trigger(this._replyEventName(c),l)}),this.presence=new Ja(this),this.broadcastEndpointURL=Jp(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,n=this.timeout){var i,l;if(this.socket.isConnected()||this.socket.connect(),this.state==fn.closed){const{config:{broadcast:c,presence:m,private:_}}=this.params,v=(l=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(T=>T.filter))!==null&&l!==void 0?l:[],y=!!this.bindings[el.PRESENCE]&&this.bindings[el.PRESENCE].length>0,S={},E={broadcast:c,presence:Object.assign(Object.assign({},m),{enabled:y}),postgres_changes:v,private:_};this.socket.accessTokenValue&&(S.access_token=this.socket.accessTokenValue),this._onError(T=>t==null?void 0:t(ki.CHANNEL_ERROR,T)),this._onClose(()=>t==null?void 0:t(ki.CLOSED)),this.updateJoinPayload(Object.assign({config:E},S)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:T})=>{var U;if(this.socket.setAuth(),T===void 0){t==null||t(ki.SUBSCRIBED);return}else{const j=this.bindings.postgres_changes,P=(U=j==null?void 0:j.length)!==null&&U!==void 0?U:0,D=[];for(let R=0;R<P;R++){const I=j[R],{filter:{event:k,schema:z,table:G,filter:Y}}=I,Z=T&&T[R];if(Z&&Z.event===k&&Z.schema===z&&Z.table===G&&Z.filter===Y)D.push(Object.assign(Object.assign({},I),{id:Z.id}));else{this.unsubscribe(),this.state=fn.errored,t==null||t(ki.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=D,t&&t(ki.SUBSCRIBED);return}}).receive("error",T=>{this.state=fn.errored,t==null||t(ki.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(T).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(ki.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,n={}){return await this.send({type:"presence",event:"track",payload:t},n.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,n,i){return this.state===fn.joined&&t===el.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,n,i)}async send(t,n={}){var i,l;if(!this._canPush()&&t.type==="broadcast"){const{event:c,payload:m}=t,v={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:c,payload:m,private:this.private}]})};try{const y=await this._fetchWithTimeout(this.broadcastEndpointURL,v,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);return await((l=y.body)===null||l===void 0?void 0:l.cancel()),y.ok?"ok":"error"}catch(y){return y.name==="AbortError"?"timed out":"error"}}else return new Promise(c=>{var m,_,v;const y=this._push(t.type,t,n.timeout||this.timeout);t.type==="broadcast"&&!(!((v=(_=(m=this.params)===null||m===void 0?void 0:m.config)===null||_===void 0?void 0:_.broadcast)===null||v===void 0)&&v.ack)&&c("ok"),y.receive("ok",()=>c("ok")),y.receive("error",()=>c("error")),y.receive("timeout",()=>c("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=fn.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Kr.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(l=>{i=new fd(this,Kr.leave,{},t),i.receive("ok",()=>{n(),l("ok")}).receive("timeout",()=>{n(),l("timed out")}).receive("error",()=>{l("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i==null||i.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=fn.closed,this.bindings={}}async _fetchWithTimeout(t,n,i){const l=new AbortController,c=setTimeout(()=>l.abort(),i),m=await this.socket.fetch(t,Object.assign(Object.assign({},n),{signal:l.signal}));return clearTimeout(c),m}_push(t,n,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let l=new fd(this,t,n,i);return this._canPush()?l.send():this._addToPushBuffer(l),l}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>h_){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(t,n,i){return n}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,n,i){var l,c;const m=t.toLocaleLowerCase(),{close:_,error:v,leave:y,join:S}=Kr;if(i&&[_,v,y,S].indexOf(m)>=0&&i!==this._joinRef())return;let T=this._onMessage(m,n,i);if(n&&!T)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(m)?(l=this.bindings.postgres_changes)===null||l===void 0||l.filter(U=>{var j,P,D;return((j=U.filter)===null||j===void 0?void 0:j.event)==="*"||((D=(P=U.filter)===null||P===void 0?void 0:P.event)===null||D===void 0?void 0:D.toLocaleLowerCase())===m}).map(U=>U.callback(T,i)):(c=this.bindings[m])===null||c===void 0||c.filter(U=>{var j,P,D,R,I,k;if(["broadcast","presence","postgres_changes"].includes(m))if("id"in U){const z=U.id,G=(j=U.filter)===null||j===void 0?void 0:j.event;return z&&((P=n.ids)===null||P===void 0?void 0:P.includes(z))&&(G==="*"||(G==null?void 0:G.toLocaleLowerCase())===((D=n.data)===null||D===void 0?void 0:D.type.toLocaleLowerCase()))}else{const z=(I=(R=U==null?void 0:U.filter)===null||R===void 0?void 0:R.event)===null||I===void 0?void 0:I.toLocaleLowerCase();return z==="*"||z===((k=n==null?void 0:n.event)===null||k===void 0?void 0:k.toLocaleLowerCase())}else return U.type.toLocaleLowerCase()===m}).map(U=>{if(typeof T=="object"&&"ids"in T){const j=T.data,{schema:P,table:D,commit_timestamp:R,type:I,errors:k}=j;T=Object.assign(Object.assign({},{schema:P,table:D,commit_timestamp:R,eventType:I,new:{},old:{},errors:k}),this._getPayloadRecords(j))}U.callback(T,i)})}_isClosed(){return this.state===fn.closed}_isJoined(){return this.state===fn.joined}_isJoining(){return this.state===fn.joining}_isLeaving(){return this.state===fn.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,n,i){const l=t.toLocaleLowerCase(),c={type:l,filter:n,callback:i};return this.bindings[l]?this.bindings[l].push(c):this.bindings[l]=[c],this}_off(t,n){const i=t.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(l=>{var c;return!(((c=l.type)===null||c===void 0?void 0:c.toLocaleLowerCase())===i&&Rf.isEqual(l.filter,n))})),this}static isEqual(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const i in t)if(t[i]!==n[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Kr.close,{},t)}_onError(t){this._on(Kr.error,{},n=>t(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=fn.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const n={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(n.new=I1(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(n.old=I1(t.columns,t.old_record)),n}}const O1=()=>{},oc={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},w_=[1e3,2e3,5e3,1e4],__=1e4,b_=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class C_{constructor(t,n){var i;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=_h,this.transport=null,this.heartbeatIntervalMs=oc.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=O1,this.ref=0,this.reconnectTimer=null,this.logger=O1,this.conn=null,this.sendBuffer=[],this.serializer=new f_,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=l=>{let c;return l?c=l:typeof fetch>"u"?c=(...m)=>Nl(async()=>{const{default:_}=await Promise.resolve().then(()=>aa);return{default:_}},void 0).then(({default:_})=>_(...m)).catch(_=>{throw new Error(`Failed to load @supabase/node-fetch: ${_.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):c=fetch,(...m)=>c(...m)},!(!((i=n==null?void 0:n.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${t}/${bh.websocket}`,this.httpEndpoint=Jp(t),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=a_.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const n=t.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:u_}))}disconnect(t,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},t?this.conn.close(t,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const n=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const t=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,n,i){this.logger(t,n,i)}connectionState(){switch(this.conn&&this.conn.readyState){case Qa.connecting:return qs.Connecting;case Qa.open:return qs.Open;case Qa.closing:return qs.Closing;default:return qs.Closed}}isConnected(){return this.connectionState()===qs.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,n={config:{}}){const i=`realtime:${t}`,l=this.getChannels().find(c=>c.topic===i);if(l)return l;{const c=new Rf(`realtime:${t}`,n,this);return this.channels.push(c),c}}push(t){const{topic:n,event:i,payload:l,ref:c}=t,m=()=>{this.encode(t,_=>{var v;(v=this.conn)===null||v===void 0||v.send(_)})};this.log("push",`${n} ${i} (${c})`,l),this.isConnected()?m():this.sendBuffer.push(m)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(d_,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},oc.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let n=this.channels.find(i=>i.topic===t&&(i._isJoined()||i._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${t}"`),n.unsubscribe())}_remove(t){this.channels=this.channels.filter(n=>n.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,n=>{n.topic==="phoenix"&&n.event==="phx_reply"&&this.heartbeatCallback(n.payload.status==="ok"?"ok":"error"),n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:i,event:l,payload:c,ref:m}=n,_=m?`(${m})`:"",v=c.status||"";this.log("receive",`${v} ${i} ${l} ${_}`.trim(),c),this.channels.filter(y=>y._isMember(i)).forEach(y=>y._trigger(l,c,m)),this._triggerStateCallbacks("message",n)})}_clearTimer(t){var n;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var n;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Kr.error))}_appendParams(t,n){if(Object.keys(n).length===0)return t;const i=t.match(/\?/)?"&":"?",l=new URLSearchParams(n);return`${t}${i}${l}`}_workerObjectUrl(t){let n;if(t)n=t;else{const i=new Blob([b_],{type:"application/javascript"});n=URL.createObjectURL(i)}return n}_setConnectionState(t,n=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(t=null){let n;t?n=t:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(i=>{const l={access_token:n,version:c_};n&&i.updateJoinPayload(l),i.joinedOnce&&i._isJoined()&&i._push(Kr.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${t}`,n)})}_triggerStateCallbacks(t,n){try{this.stateChangeCallbacks[t].forEach(i=>{try{i(n)}catch(l){this.log("error",`error in ${t} callback`,l)}})}catch(i){this.log("error",`error triggering ${t} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new Kp(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},oc.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var n,i,l,c,m,_,v,y;if(this.transport=(n=t==null?void 0:t.transport)!==null&&n!==void 0?n:null,this.timeout=(i=t==null?void 0:t.timeout)!==null&&i!==void 0?i:_h,this.heartbeatIntervalMs=(l=t==null?void 0:t.heartbeatIntervalMs)!==null&&l!==void 0?l:oc.HEARTBEAT_INTERVAL,this.worker=(c=t==null?void 0:t.worker)!==null&&c!==void 0?c:!1,this.accessToken=(m=t==null?void 0:t.accessToken)!==null&&m!==void 0?m:null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(_=t==null?void 0:t.reconnectAfterMs)!==null&&_!==void 0?_:S=>w_[S-1]||__,this.encode=(v=t==null?void 0:t.encode)!==null&&v!==void 0?v:(S,E)=>E(JSON.stringify(S)),this.decode=(y=t==null?void 0:t.decode)!==null&&y!==void 0?y:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class jf extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function gn(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class E_ extends jf{constructor(t,n,i){super(t),this.name="StorageApiError",this.status=n,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Eh extends jf{constructor(t,n){super(t),this.name="StorageUnknownError",this.originalError=n}}var S_=function(e,t,n,i){function l(c){return c instanceof n?c:new n(function(m){m(c)})}return new(n||(n=Promise))(function(c,m){function _(S){try{y(i.next(S))}catch(E){m(E)}}function v(S){try{y(i.throw(S))}catch(E){m(E)}}function y(S){S.done?c(S.value):l(S.value).then(_,v)}y((i=i.apply(e,t||[])).next())})};const ex=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>Nl(async()=>{const{default:i}=await Promise.resolve().then(()=>aa);return{default:i}},void 0).then(({default:i})=>i(...n)):t=fetch,(...n)=>t(...n)},A_=()=>S_(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Nl(()=>Promise.resolve().then(()=>aa),void 0)).Response:Response}),Sh=e=>{if(Array.isArray(e))return e.map(n=>Sh(n));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([n,i])=>{const l=n.replace(/([-_][a-z])/gi,c=>c.toUpperCase().replace(/[-_]/g,""));t[l]=Sh(i)}),t},N_=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var uo=function(e,t,n,i){function l(c){return c instanceof n?c:new n(function(m){m(c)})}return new(n||(n=Promise))(function(c,m){function _(S){try{y(i.next(S))}catch(E){m(E)}}function v(S){try{y(i.throw(S))}catch(E){m(E)}}function y(S){S.done?c(S.value):l(S.value).then(_,v)}y((i=i.apply(e,t||[])).next())})};const gd=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),T_=(e,t,n)=>uo(void 0,void 0,void 0,function*(){const i=yield A_();e instanceof i&&!(n!=null&&n.noResolveJson)?e.json().then(l=>{const c=e.status||500,m=(l==null?void 0:l.statusCode)||c+"";t(new E_(gd(l),c,m))}).catch(l=>{t(new Eh(gd(l),l))}):t(new Eh(gd(e),e))}),I_=(e,t,n,i)=>{const l={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!i?l:(N_(i)?(l.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),l.body=JSON.stringify(i)):l.body=i,t!=null&&t.duplex&&(l.duplex=t.duplex),Object.assign(Object.assign({},l),n))};function Il(e,t,n,i,l,c){return uo(this,void 0,void 0,function*(){return new Promise((m,_)=>{e(n,I_(t,i,l,c)).then(v=>{if(!v.ok)throw v;return i!=null&&i.noResolveJson?v:v.json()}).then(v=>m(v)).catch(v=>T_(v,_,i))})})}function qc(e,t,n,i){return uo(this,void 0,void 0,function*(){return Il(e,"GET",t,n,i)})}function hi(e,t,n,i,l){return uo(this,void 0,void 0,function*(){return Il(e,"POST",t,i,l,n)})}function Ah(e,t,n,i,l){return uo(this,void 0,void 0,function*(){return Il(e,"PUT",t,i,l,n)})}function k_(e,t,n,i){return uo(this,void 0,void 0,function*(){return Il(e,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),i)})}function tx(e,t,n,i,l){return uo(this,void 0,void 0,function*(){return Il(e,"DELETE",t,i,l,n)})}var $n=function(e,t,n,i){function l(c){return c instanceof n?c:new n(function(m){m(c)})}return new(n||(n=Promise))(function(c,m){function _(S){try{y(i.next(S))}catch(E){m(E)}}function v(S){try{y(i.throw(S))}catch(E){m(E)}}function y(S){S.done?c(S.value):l(S.value).then(_,v)}y((i=i.apply(e,t||[])).next())})};const M_={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},L1={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class O_{constructor(t,n={},i,l){this.url=t,this.headers=n,this.bucketId=i,this.fetch=ex(l)}uploadOrUpdate(t,n,i,l){return $n(this,void 0,void 0,function*(){try{let c;const m=Object.assign(Object.assign({},L1),l);let _=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(m.upsert)});const v=m.metadata;typeof Blob<"u"&&i instanceof Blob?(c=new FormData,c.append("cacheControl",m.cacheControl),v&&c.append("metadata",this.encodeMetadata(v)),c.append("",i)):typeof FormData<"u"&&i instanceof FormData?(c=i,c.append("cacheControl",m.cacheControl),v&&c.append("metadata",this.encodeMetadata(v))):(c=i,_["cache-control"]=`max-age=${m.cacheControl}`,_["content-type"]=m.contentType,v&&(_["x-metadata"]=this.toBase64(this.encodeMetadata(v)))),l!=null&&l.headers&&(_=Object.assign(Object.assign({},_),l.headers));const y=this._removeEmptyFolders(n),S=this._getFinalPath(y),E=yield(t=="PUT"?Ah:hi)(this.fetch,`${this.url}/object/${S}`,c,Object.assign({headers:_},m!=null&&m.duplex?{duplex:m.duplex}:{}));return{data:{path:y,id:E.Id,fullPath:E.Key},error:null}}catch(c){if(gn(c))return{data:null,error:c};throw c}})}upload(t,n,i){return $n(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,n,i)})}uploadToSignedUrl(t,n,i,l){return $n(this,void 0,void 0,function*(){const c=this._removeEmptyFolders(t),m=this._getFinalPath(c),_=new URL(this.url+`/object/upload/sign/${m}`);_.searchParams.set("token",n);try{let v;const y=Object.assign({upsert:L1.upsert},l),S=Object.assign(Object.assign({},this.headers),{"x-upsert":String(y.upsert)});typeof Blob<"u"&&i instanceof Blob?(v=new FormData,v.append("cacheControl",y.cacheControl),v.append("",i)):typeof FormData<"u"&&i instanceof FormData?(v=i,v.append("cacheControl",y.cacheControl)):(v=i,S["cache-control"]=`max-age=${y.cacheControl}`,S["content-type"]=y.contentType);const E=yield Ah(this.fetch,_.toString(),v,{headers:S});return{data:{path:c,fullPath:E.Key},error:null}}catch(v){if(gn(v))return{data:null,error:v};throw v}})}createSignedUploadUrl(t,n){return $n(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t);const l=Object.assign({},this.headers);n!=null&&n.upsert&&(l["x-upsert"]="true");const c=yield hi(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:l}),m=new URL(this.url+c.url),_=m.searchParams.get("token");if(!_)throw new jf("No token returned by API");return{data:{signedUrl:m.toString(),path:t,token:_},error:null}}catch(i){if(gn(i))return{data:null,error:i};throw i}})}update(t,n,i){return $n(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,n,i)})}move(t,n,i){return $n(this,void 0,void 0,function*(){try{return{data:yield hi(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers}),error:null}}catch(l){if(gn(l))return{data:null,error:l};throw l}})}copy(t,n,i){return $n(this,void 0,void 0,function*(){try{return{data:{path:(yield hi(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers})).Key},error:null}}catch(l){if(gn(l))return{data:null,error:l};throw l}})}createSignedUrl(t,n,i){return $n(this,void 0,void 0,function*(){try{let l=this._getFinalPath(t),c=yield hi(this.fetch,`${this.url}/object/sign/${l}`,Object.assign({expiresIn:n},i!=null&&i.transform?{transform:i.transform}:{}),{headers:this.headers});const m=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return c={signedUrl:encodeURI(`${this.url}${c.signedURL}${m}`)},{data:c,error:null}}catch(l){if(gn(l))return{data:null,error:l};throw l}})}createSignedUrls(t,n,i){return $n(this,void 0,void 0,function*(){try{const l=yield hi(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:t},{headers:this.headers}),c=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return{data:l.map(m=>Object.assign(Object.assign({},m),{signedUrl:m.signedURL?encodeURI(`${this.url}${m.signedURL}${c}`):null})),error:null}}catch(l){if(gn(l))return{data:null,error:l};throw l}})}download(t,n){return $n(this,void 0,void 0,function*(){const l=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",c=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),m=c?`?${c}`:"";try{const _=this._getFinalPath(t);return{data:yield(yield qc(this.fetch,`${this.url}/${l}/${_}${m}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(_){if(gn(_))return{data:null,error:_};throw _}})}info(t){return $n(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{const i=yield qc(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Sh(i),error:null}}catch(i){if(gn(i))return{data:null,error:i};throw i}})}exists(t){return $n(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{return yield k_(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(i){if(gn(i)&&i instanceof Eh){const l=i.originalError;if([400,404].includes(l==null?void 0:l.status))return{data:!1,error:i}}throw i}})}getPublicUrl(t,n){const i=this._getFinalPath(t),l=[],c=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";c!==""&&l.push(c);const _=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",v=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});v!==""&&l.push(v);let y=l.join("&");return y!==""&&(y=`?${y}`),{data:{publicUrl:encodeURI(`${this.url}/${_}/public/${i}${y}`)}}}remove(t){return $n(this,void 0,void 0,function*(){try{return{data:yield tx(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(n){if(gn(n))return{data:null,error:n};throw n}})}list(t,n,i){return $n(this,void 0,void 0,function*(){try{const l=Object.assign(Object.assign(Object.assign({},M_),n),{prefix:t||""});return{data:yield hi(this.fetch,`${this.url}/object/list/${this.bucketId}`,l,{headers:this.headers},i),error:null}}catch(l){if(gn(l))return{data:null,error:l};throw l}})}listV2(t,n){return $n(this,void 0,void 0,function*(){try{const i=Object.assign({},t);return{data:yield hi(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(gn(i))return{data:null,error:i};throw i}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const n=[];return t.width&&n.push(`width=${t.width}`),t.height&&n.push(`height=${t.height}`),t.resize&&n.push(`resize=${t.resize}`),t.format&&n.push(`format=${t.format}`),t.quality&&n.push(`quality=${t.quality}`),n.join("&")}}const L_="2.11.0",P_={"X-Client-Info":`storage-js/${L_}`};var _o=function(e,t,n,i){function l(c){return c instanceof n?c:new n(function(m){m(c)})}return new(n||(n=Promise))(function(c,m){function _(S){try{y(i.next(S))}catch(E){m(E)}}function v(S){try{y(i.throw(S))}catch(E){m(E)}}function y(S){S.done?c(S.value):l(S.value).then(_,v)}y((i=i.apply(e,t||[])).next())})};class R_{constructor(t,n={},i,l){const c=new URL(t);l!=null&&l.useNewHostname&&/supabase\.(co|in|red)$/.test(c.hostname)&&!c.hostname.includes("storage.supabase.")&&(c.hostname=c.hostname.replace("supabase.","storage.supabase.")),this.url=c.href,this.headers=Object.assign(Object.assign({},P_),n),this.fetch=ex(i)}listBuckets(){return _o(this,void 0,void 0,function*(){try{return{data:yield qc(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(gn(t))return{data:null,error:t};throw t}})}getBucket(t){return _o(this,void 0,void 0,function*(){try{return{data:yield qc(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(n){if(gn(n))return{data:null,error:n};throw n}})}createBucket(t,n={public:!1}){return _o(this,void 0,void 0,function*(){try{return{data:yield hi(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(gn(i))return{data:null,error:i};throw i}})}updateBucket(t,n){return _o(this,void 0,void 0,function*(){try{return{data:yield Ah(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(gn(i))return{data:null,error:i};throw i}})}emptyBucket(t){return _o(this,void 0,void 0,function*(){try{return{data:yield hi(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(gn(n))return{data:null,error:n};throw n}})}deleteBucket(t){return _o(this,void 0,void 0,function*(){try{return{data:yield tx(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(gn(n))return{data:null,error:n};throw n}})}}class j_ extends R_{constructor(t,n={},i,l){super(t,n,i,l)}from(t){return new O_(this.url,this.headers,t,this.fetch)}}const D_="2.56.0";let za="";typeof Deno<"u"?za="deno":typeof document<"u"?za="web":typeof navigator<"u"&&navigator.product==="ReactNative"?za="react-native":za="node";const B_={"X-Client-Info":`supabase-js-${za}/${D_}`},F_={headers:B_},U_={schema:"public"},z_={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},H_={};var W_=function(e,t,n,i){function l(c){return c instanceof n?c:new n(function(m){m(c)})}return new(n||(n=Promise))(function(c,m){function _(S){try{y(i.next(S))}catch(E){m(E)}}function v(S){try{y(i.throw(S))}catch(E){m(E)}}function y(S){S.done?c(S.value):l(S.value).then(_,v)}y((i=i.apply(e,t||[])).next())})};const V_=e=>{let t;return e?t=e:typeof fetch>"u"?t=Up:t=fetch,(...n)=>t(...n)},G_=()=>typeof Headers>"u"?zp:Headers,Z_=(e,t,n)=>{const i=V_(n),l=G_();return(c,m)=>W_(void 0,void 0,void 0,function*(){var _;const v=(_=yield t())!==null&&_!==void 0?_:e;let y=new l(m==null?void 0:m.headers);return y.has("apikey")||y.set("apikey",e),y.has("Authorization")||y.set("Authorization",`Bearer ${v}`),i(c,Object.assign(Object.assign({},m),{headers:y}))})};var Y_=function(e,t,n,i){function l(c){return c instanceof n?c:new n(function(m){m(c)})}return new(n||(n=Promise))(function(c,m){function _(S){try{y(i.next(S))}catch(E){m(E)}}function v(S){try{y(i.throw(S))}catch(E){m(E)}}function y(S){S.done?c(S.value):l(S.value).then(_,v)}y((i=i.apply(e,t||[])).next())})};function $_(e){return e.endsWith("/")?e:e+"/"}function X_(e,t){var n,i;const{db:l,auth:c,realtime:m,global:_}=e,{db:v,auth:y,realtime:S,global:E}=t,T={db:Object.assign(Object.assign({},v),l),auth:Object.assign(Object.assign({},y),c),realtime:Object.assign(Object.assign({},S),m),storage:{},global:Object.assign(Object.assign(Object.assign({},E),_),{headers:Object.assign(Object.assign({},(n=E==null?void 0:E.headers)!==null&&n!==void 0?n:{}),(i=_==null?void 0:_.headers)!==null&&i!==void 0?i:{})}),accessToken:()=>Y_(this,void 0,void 0,function*(){return""})};return e.accessToken?T.accessToken=e.accessToken:delete T.accessToken,T}const nx="2.71.1",Ao=30*1e3,Nh=3,md=Nh*Ao,q_="http://localhost:9999",K_="supabase.auth.token",Q_={"X-Client-Info":`gotrue-js/${nx}`},Th="X-Supabase-Api-Version",rx={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},J_=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,eb=10*60*1e3;class Df extends Error{constructor(t,n,i){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=i}}function Ke(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class tb extends Df{constructor(t,n,i){super(t,n,i),this.name="AuthApiError",this.status=n,this.code=i}}function nb(e){return Ke(e)&&e.name==="AuthApiError"}class ix extends Df{constructor(t,n){super(t),this.name="AuthUnknownError",this.originalError=n}}class Os extends Df{constructor(t,n,i,l){super(t,i,l),this.name=n,this.status=i}}class is extends Os{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function rb(e){return Ke(e)&&e.name==="AuthSessionMissingError"}class ac extends Os{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class lc extends Os{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class cc extends Os{constructor(t,n=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function ib(e){return Ke(e)&&e.name==="AuthImplicitGrantRedirectError"}class P1 extends Os{constructor(t,n=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ih extends Os{constructor(t,n){super(t,"AuthRetryableFetchError",n,void 0)}}function pd(e){return Ke(e)&&e.name==="AuthRetryableFetchError"}class R1 extends Os{constructor(t,n,i){super(t,"AuthWeakPasswordError",n,"weak_password"),this.reasons=i}}class kh extends Os{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Kc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),j1=` 	
\r=`.split(""),sb=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<j1.length;t+=1)e[j1[t].charCodeAt(0)]=-2;for(let t=0;t<Kc.length;t+=1)e[Kc[t].charCodeAt(0)]=t;return e})();function D1(e,t,n){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const i=t.queue>>t.queuedBits-6&63;n(Kc[i]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const i=t.queue>>t.queuedBits-6&63;n(Kc[i]),t.queuedBits-=6}}function sx(e,t,n){const i=sb[e];if(i>-1)for(t.queue=t.queue<<6|i,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function B1(e){const t=[],n=m=>{t.push(String.fromCodePoint(m))},i={utf8seq:0,codepoint:0},l={queue:0,queuedBits:0},c=m=>{lb(m,i,n)};for(let m=0;m<e.length;m+=1)sx(e.charCodeAt(m),l,c);return t.join("")}function ob(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function ab(e,t){for(let n=0;n<e.length;n+=1){let i=e.charCodeAt(n);if(i>55295&&i<=56319){const l=(i-55296)*1024&65535;i=(e.charCodeAt(n+1)-56320&65535|l)+65536,n+=1}ob(i,t)}}function lb(e,t,n){if(t.utf8seq===0){if(e<=127){n(e);return}for(let i=1;i<6;i+=1)if(!(e>>7-i&1)){t.utf8seq=i;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&n(t.codepoint)}}function cb(e){const t=[],n={queue:0,queuedBits:0},i=l=>{t.push(l)};for(let l=0;l<e.length;l+=1)sx(e.charCodeAt(l),n,i);return new Uint8Array(t)}function ub(e){const t=[];return ab(e,n=>t.push(n)),new Uint8Array(t)}function db(e){const t=[],n={queue:0,queuedBits:0},i=l=>{t.push(l)};return e.forEach(l=>D1(l,n,i)),D1(null,n,i),t.join("")}function hb(e){return Math.round(Date.now()/1e3)+e}function fb(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const $r=()=>typeof window<"u"&&typeof document<"u",Vs={tested:!1,writable:!1},ox=()=>{if(!$r())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Vs.tested)return Vs.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Vs.tested=!0,Vs.writable=!0}catch{Vs.tested=!0,Vs.writable=!1}return Vs.writable};function gb(e){const t={},n=new URL(e);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((l,c)=>{t[c]=l})}catch{}return n.searchParams.forEach((i,l)=>{t[l]=i}),t}const ax=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>Nl(async()=>{const{default:i}=await Promise.resolve().then(()=>aa);return{default:i}},void 0).then(({default:i})=>i(...n)):t=fetch,(...n)=>t(...n)},mb=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",No=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},Gs=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch{return n}},ns=async(e,t)=>{await e.removeItem(t)};class Au{constructor(){this.promise=new Au.promiseConstructor((t,n)=>{this.resolve=t,this.reject=n})}}Au.promiseConstructor=Promise;function xd(e){const t=e.split(".");if(t.length!==3)throw new kh("Invalid JWT structure");for(let i=0;i<t.length;i++)if(!J_.test(t[i]))throw new kh("JWT not in base64url format");return{header:JSON.parse(B1(t[0])),payload:JSON.parse(B1(t[1])),signature:cb(t[2]),raw:{header:t[0],payload:t[1]}}}async function pb(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function xb(e,t){return new Promise((i,l)=>{(async()=>{for(let c=0;c<1/0;c++)try{const m=await e(c);if(!t(c,null,m)){i(m);return}}catch(m){if(!t(c,m)){l(m);return}}})()})}function yb(e){return("0"+e.toString(16)).substr(-2)}function vb(){const t=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=n.length;let l="";for(let c=0;c<56;c++)l+=n.charAt(Math.floor(Math.random()*i));return l}return crypto.getRandomValues(t),Array.from(t,yb).join("")}async function wb(e){const n=new TextEncoder().encode(e),i=await crypto.subtle.digest("SHA-256",n),l=new Uint8Array(i);return Array.from(l).map(c=>String.fromCharCode(c)).join("")}async function _b(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const n=await wb(e);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function bo(e,t,n=!1){const i=vb();let l=i;n&&(l+="/PASSWORD_RECOVERY"),await No(e,`${t}-code-verifier`,l);const c=await _b(i);return[c,i===c?"plain":"s256"]}const bb=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Cb(e){const t=e.headers.get(Th);if(!t||!t.match(bb))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Eb(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function Sb(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Ab=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Co(e){if(!Ab.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function yd(){const e={};return new Proxy(e,{get:(t,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const i=n.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function F1(e){return JSON.parse(JSON.stringify(e))}var Nb=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,i=Object.getOwnPropertySymbols(e);l<i.length;l++)t.indexOf(i[l])<0&&Object.prototype.propertyIsEnumerable.call(e,i[l])&&(n[i[l]]=e[i[l]]);return n};const Xs=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Tb=[502,503,504];async function U1(e){var t;if(!mb(e))throw new Ih(Xs(e),0);if(Tb.includes(e.status))throw new Ih(Xs(e),e.status);let n;try{n=await e.json()}catch(c){throw new ix(Xs(c),c)}let i;const l=Cb(e);if(l&&l.getTime()>=rx["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?i=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(i=n.error_code),i){if(i==="weak_password")throw new R1(Xs(n),e.status,((t=n.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(i==="session_not_found")throw new is}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((c,m)=>c&&typeof m=="string",!0))throw new R1(Xs(n),e.status,n.weak_password.reasons);throw new tb(Xs(n),e.status||500,i)}const Ib=(e,t,n,i)=>{const l={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?l:(l.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),l.body=JSON.stringify(i),Object.assign(Object.assign({},l),n))};async function lt(e,t,n,i){var l;const c=Object.assign({},i==null?void 0:i.headers);c[Th]||(c[Th]=rx["2024-01-01"].name),i!=null&&i.jwt&&(c.Authorization=`Bearer ${i.jwt}`);const m=(l=i==null?void 0:i.query)!==null&&l!==void 0?l:{};i!=null&&i.redirectTo&&(m.redirect_to=i.redirectTo);const _=Object.keys(m).length?"?"+new URLSearchParams(m).toString():"",v=await kb(e,t,n+_,{headers:c,noResolveJson:i==null?void 0:i.noResolveJson},{},i==null?void 0:i.body);return i!=null&&i.xform?i==null?void 0:i.xform(v):{data:Object.assign({},v),error:null}}async function kb(e,t,n,i,l,c){const m=Ib(t,i,l,c);let _;try{_=await e(n,Object.assign({},m))}catch(v){throw console.error(v),new Ih(Xs(v),0)}if(_.ok||await U1(_),i!=null&&i.noResolveJson)return _;try{return await _.json()}catch(v){await U1(v)}}function Ti(e){var t;let n=null;Pb(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=hb(e.expires_in)));const i=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:n,user:i},error:null}}function z1(e){const t=Ti(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((n,i)=>n&&typeof i=="string",!0)&&(t.data.weak_password=e.weak_password),t}function cs(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Mb(e){return{data:e,error:null}}function Ob(e){const{action_link:t,email_otp:n,hashed_token:i,redirect_to:l,verification_type:c}=e,m=Nb(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),_={action_link:t,email_otp:n,hashed_token:i,redirect_to:l,verification_type:c},v=Object.assign({},m);return{data:{properties:_,user:v},error:null}}function Lb(e){return e}function Pb(e){return e.access_token&&e.refresh_token&&e.expires_in}const vd=["global","local","others"];var Rb=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,i=Object.getOwnPropertySymbols(e);l<i.length;l++)t.indexOf(i[l])<0&&Object.prototype.propertyIsEnumerable.call(e,i[l])&&(n[i[l]]=e[i[l]]);return n};class jb{constructor({url:t="",headers:n={},fetch:i}){this.url=t,this.headers=n,this.fetch=ax(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,n=vd[0]){if(vd.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${vd.join(", ")}`);try{return await lt(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(i){if(Ke(i))return{data:null,error:i};throw i}}async inviteUserByEmail(t,n={}){try{return await lt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:cs})}catch(i){if(Ke(i))return{data:{user:null},error:i};throw i}}async generateLink(t){try{const{options:n}=t,i=Rb(t,["options"]),l=Object.assign(Object.assign({},i),n);return"newEmail"in i&&(l.new_email=i==null?void 0:i.newEmail,delete l.newEmail),await lt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:l,headers:this.headers,xform:Ob,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(Ke(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(t){try{return await lt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:cs})}catch(n){if(Ke(n))return{data:{user:null},error:n};throw n}}async listUsers(t){var n,i,l,c,m,_,v;try{const y={nextPage:null,lastPage:0,total:0},S=await lt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:"",per_page:(c=(l=t==null?void 0:t.perPage)===null||l===void 0?void 0:l.toString())!==null&&c!==void 0?c:""},xform:Lb});if(S.error)throw S.error;const E=await S.json(),T=(m=S.headers.get("x-total-count"))!==null&&m!==void 0?m:0,U=(v=(_=S.headers.get("link"))===null||_===void 0?void 0:_.split(","))!==null&&v!==void 0?v:[];return U.length>0&&(U.forEach(j=>{const P=parseInt(j.split(";")[0].split("=")[1].substring(0,1)),D=JSON.parse(j.split(";")[1].split("=")[1]);y[`${D}Page`]=P}),y.total=parseInt(T)),{data:Object.assign(Object.assign({},E),y),error:null}}catch(y){if(Ke(y))return{data:{users:[]},error:y};throw y}}async getUserById(t){Co(t);try{return await lt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:cs})}catch(n){if(Ke(n))return{data:{user:null},error:n};throw n}}async updateUserById(t,n){Co(t);try{return await lt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:n,headers:this.headers,xform:cs})}catch(i){if(Ke(i))return{data:{user:null},error:i};throw i}}async deleteUser(t,n=!1){Co(t);try{return await lt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:n},xform:cs})}catch(i){if(Ke(i))return{data:{user:null},error:i};throw i}}async _listFactors(t){Co(t.userId);try{const{data:n,error:i}=await lt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:l=>({data:{factors:l},error:null})});return{data:n,error:i}}catch(n){if(Ke(n))return{data:null,error:n};throw n}}async _deleteFactor(t){Co(t.userId),Co(t.id);try{return{data:await lt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(n){if(Ke(n))return{data:null,error:n};throw n}}}function H1(e={}){return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}function Db(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Eo={debug:!!(globalThis&&ox()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class lx extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Bb extends lx{}async function Fb(e,t,n){Eo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const i=new globalThis.AbortController;return t>0&&setTimeout(()=>{i.abort(),Eo.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async l=>{if(l){Eo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,l.name);try{return await n()}finally{Eo.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,l.name)}}else{if(t===0)throw Eo.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Bb(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Eo.debug)try{const c=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(c,null,"  "))}catch(c){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",c)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}Db();const Ub={url:q_,storageKey:K_,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Q_,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function W1(e,t,n){return await n()}const So={};class wl{constructor(t){var n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=wl.nextInstanceID,wl.nextInstanceID+=1,this.instanceID>0&&$r()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const l=Object.assign(Object.assign({},Ub),t);if(this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.persistSession=l.persistSession,this.storageKey=l.storageKey,this.autoRefreshToken=l.autoRefreshToken,this.admin=new jb({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=ax(l.fetch),this.lock=l.lock||W1,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,l.lock?this.lock=l.lock:$r()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=Fb:this.lock=W1,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:ox()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=H1(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=H1(this.memoryStorage)),$r()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c),await this._notifyAllSubscribers(c.data.event,c.data.session,!1)})}this.initialize()}get jwks(){var t,n;return(n=(t=So[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(t){So[this.storageKey]=Object.assign(Object.assign({},So[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,n;return(n=(t=So[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){So[this.storageKey]=Object.assign(Object.assign({},So[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${nx}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const n=gb(window.location.href);let i="none";if(this._isImplicitGrantCallback(n)?i="implicit":await this._isPKCECallback(n)&&(i="pkce"),$r()&&this.detectSessionInUrl&&i!=="none"){const{data:l,error:c}=await this._getSessionFromURL(n,i);if(c){if(this._debug("#_initialize()","error detecting session from URL",c),ib(c)){const v=(t=c.details)===null||t===void 0?void 0:t.code;if(v==="identity_already_exists"||v==="identity_not_found"||v==="single_identity_not_deletable")return{error:c}}return await this._removeSession(),{error:c}}const{session:m,redirectType:_}=l;return this._debug("#_initialize()","detected session in URL",m,"redirect type",_),await this._saveSession(m),setTimeout(async()=>{_==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",m):await this._notifyAllSubscribers("SIGNED_IN",m)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Ke(n)?{error:n}:{error:new ix("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var n,i,l;try{const c=await lt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(l=t==null?void 0:t.options)===null||l===void 0?void 0:l.captchaToken}},xform:Ti}),{data:m,error:_}=c;if(_||!m)return{data:{user:null,session:null},error:_};const v=m.session,y=m.user;return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",v)),{data:{user:y,session:v},error:null}}catch(c){if(Ke(c))return{data:{user:null,session:null},error:c};throw c}}async signUp(t){var n,i,l;try{let c;if("email"in t){const{email:S,password:E,options:T}=t;let U=null,j=null;this.flowType==="pkce"&&([U,j]=await bo(this.storage,this.storageKey)),c=await lt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:T==null?void 0:T.emailRedirectTo,body:{email:S,password:E,data:(n=T==null?void 0:T.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:T==null?void 0:T.captchaToken},code_challenge:U,code_challenge_method:j},xform:Ti})}else if("phone"in t){const{phone:S,password:E,options:T}=t;c=await lt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:S,password:E,data:(i=T==null?void 0:T.data)!==null&&i!==void 0?i:{},channel:(l=T==null?void 0:T.channel)!==null&&l!==void 0?l:"sms",gotrue_meta_security:{captcha_token:T==null?void 0:T.captchaToken}},xform:Ti})}else throw new lc("You must provide either an email or phone number and a password");const{data:m,error:_}=c;if(_||!m)return{data:{user:null,session:null},error:_};const v=m.session,y=m.user;return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",v)),{data:{user:y,session:v},error:null}}catch(c){if(Ke(c))return{data:{user:null,session:null},error:c};throw c}}async signInWithPassword(t){try{let n;if("email"in t){const{email:c,password:m,options:_}=t;n=await lt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:c,password:m,gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken}},xform:z1})}else if("phone"in t){const{phone:c,password:m,options:_}=t;n=await lt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:c,password:m,gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken}},xform:z1})}else throw new lc("You must provide either an email or phone number and a password");const{data:i,error:l}=n;return l?{data:{user:null,session:null},error:l}:!i||!i.session||!i.user?{data:{user:null,session:null},error:new ac}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:l})}catch(n){if(Ke(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(t){var n,i,l,c;return await this._handleProviderSignIn(t.provider,{redirectTo:(n=t.options)===null||n===void 0?void 0:n.redirectTo,scopes:(i=t.options)===null||i===void 0?void 0:i.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:(c=t.options)===null||c===void 0?void 0:c.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:n}=t;if(n==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(t){var n,i,l,c,m,_,v,y,S,E,T,U;let j,P;if("message"in t)j=t.message,P=t.signature;else{const{chain:D,wallet:R,statement:I,options:k}=t;let z;if($r())if(typeof R=="object")z=R;else{const Y=window;if("solana"in Y&&typeof Y.solana=="object"&&("signIn"in Y.solana&&typeof Y.solana.signIn=="function"||"signMessage"in Y.solana&&typeof Y.solana.signMessage=="function"))z=Y.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof R!="object"||!(k!=null&&k.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");z=R}const G=new URL((n=k==null?void 0:k.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in z&&z.signIn){const Y=await z.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},k==null?void 0:k.signInWithSolana),{version:"1",domain:G.host,uri:G.href}),I?{statement:I}:null));let Z;if(Array.isArray(Y)&&Y[0]&&typeof Y[0]=="object")Z=Y[0];else if(Y&&typeof Y=="object"&&"signedMessage"in Y&&"signature"in Y)Z=Y;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in Z&&"signature"in Z&&(typeof Z.signedMessage=="string"||Z.signedMessage instanceof Uint8Array)&&Z.signature instanceof Uint8Array)j=typeof Z.signedMessage=="string"?Z.signedMessage:new TextDecoder().decode(Z.signedMessage),P=Z.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in z)||typeof z.signMessage!="function"||!("publicKey"in z)||typeof z!="object"||!z.publicKey||!("toBase58"in z.publicKey)||typeof z.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");j=[`${G.host} wants you to sign in with your Solana account:`,z.publicKey.toBase58(),...I?["",I,""]:[""],"Version: 1",`URI: ${G.href}`,`Issued At: ${(l=(i=k==null?void 0:k.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&l!==void 0?l:new Date().toISOString()}`,...!((c=k==null?void 0:k.signInWithSolana)===null||c===void 0)&&c.notBefore?[`Not Before: ${k.signInWithSolana.notBefore}`]:[],...!((m=k==null?void 0:k.signInWithSolana)===null||m===void 0)&&m.expirationTime?[`Expiration Time: ${k.signInWithSolana.expirationTime}`]:[],...!((_=k==null?void 0:k.signInWithSolana)===null||_===void 0)&&_.chainId?[`Chain ID: ${k.signInWithSolana.chainId}`]:[],...!((v=k==null?void 0:k.signInWithSolana)===null||v===void 0)&&v.nonce?[`Nonce: ${k.signInWithSolana.nonce}`]:[],...!((y=k==null?void 0:k.signInWithSolana)===null||y===void 0)&&y.requestId?[`Request ID: ${k.signInWithSolana.requestId}`]:[],...!((E=(S=k==null?void 0:k.signInWithSolana)===null||S===void 0?void 0:S.resources)===null||E===void 0)&&E.length?["Resources",...k.signInWithSolana.resources.map(Z=>`- ${Z}`)]:[]].join(`
`);const Y=await z.signMessage(new TextEncoder().encode(j),"utf8");if(!Y||!(Y instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");P=Y}}try{const{data:D,error:R}=await lt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:j,signature:db(P)},!((T=t.options)===null||T===void 0)&&T.captchaToken?{gotrue_meta_security:{captcha_token:(U=t.options)===null||U===void 0?void 0:U.captchaToken}}:null),xform:Ti});if(R)throw R;return!D||!D.session||!D.user?{data:{user:null,session:null},error:new ac}:(D.session&&(await this._saveSession(D.session),await this._notifyAllSubscribers("SIGNED_IN",D.session)),{data:Object.assign({},D),error:R})}catch(D){if(Ke(D))return{data:{user:null,session:null},error:D};throw D}}async _exchangeCodeForSession(t){const n=await Gs(this.storage,`${this.storageKey}-code-verifier`),[i,l]=(n??"").split("/");try{const{data:c,error:m}=await lt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:i},xform:Ti});if(await ns(this.storage,`${this.storageKey}-code-verifier`),m)throw m;return!c||!c.session||!c.user?{data:{user:null,session:null,redirectType:null},error:new ac}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:Object.assign(Object.assign({},c),{redirectType:l??null}),error:m})}catch(c){if(Ke(c))return{data:{user:null,session:null,redirectType:null},error:c};throw c}}async signInWithIdToken(t){try{const{options:n,provider:i,token:l,access_token:c,nonce:m}=t,_=await lt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:l,access_token:c,nonce:m,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Ti}),{data:v,error:y}=_;return y?{data:{user:null,session:null},error:y}:!v||!v.session||!v.user?{data:{user:null,session:null},error:new ac}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),{data:v,error:y})}catch(n){if(Ke(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(t){var n,i,l,c,m;try{if("email"in t){const{email:_,options:v}=t;let y=null,S=null;this.flowType==="pkce"&&([y,S]=await bo(this.storage,this.storageKey));const{error:E}=await lt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:_,data:(n=v==null?void 0:v.data)!==null&&n!==void 0?n:{},create_user:(i=v==null?void 0:v.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken},code_challenge:y,code_challenge_method:S},redirectTo:v==null?void 0:v.emailRedirectTo});return{data:{user:null,session:null},error:E}}if("phone"in t){const{phone:_,options:v}=t,{data:y,error:S}=await lt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:_,data:(l=v==null?void 0:v.data)!==null&&l!==void 0?l:{},create_user:(c=v==null?void 0:v.shouldCreateUser)!==null&&c!==void 0?c:!0,gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken},channel:(m=v==null?void 0:v.channel)!==null&&m!==void 0?m:"sms"}});return{data:{user:null,session:null,messageId:y==null?void 0:y.message_id},error:S}}throw new lc("You must provide either an email or phone number.")}catch(_){if(Ke(_))return{data:{user:null,session:null},error:_};throw _}}async verifyOtp(t){var n,i;try{let l,c;"options"in t&&(l=(n=t.options)===null||n===void 0?void 0:n.redirectTo,c=(i=t.options)===null||i===void 0?void 0:i.captchaToken);const{data:m,error:_}=await lt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:c}}),redirectTo:l,xform:Ti});if(_)throw _;if(!m)throw new Error("An error occurred on token verification.");const v=m.session,y=m.user;return v!=null&&v.access_token&&(await this._saveSession(v),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",v)),{data:{user:y,session:v},error:null}}catch(l){if(Ke(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithSSO(t){var n,i,l;try{let c=null,m=null;return this.flowType==="pkce"&&([c,m]=await bo(this.storage,this.storageKey)),await lt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(i=(n=t.options)===null||n===void 0?void 0:n.redirectTo)!==null&&i!==void 0?i:void 0}),!((l=t==null?void 0:t.options)===null||l===void 0)&&l.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:m}),headers:this.headers,xform:Mb})}catch(c){if(Ke(c))return{data:null,error:c};throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:n},error:i}=t;if(i)throw i;if(!n)throw new is;const{error:l}=await lt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:l}})}catch(t){if(Ke(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const n=`${this.url}/resend`;if("email"in t){const{email:i,type:l,options:c}=t,{error:m}=await lt(this.fetch,"POST",n,{headers:this.headers,body:{email:i,type:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:m}}else if("phone"in t){const{phone:i,type:l,options:c}=t,{data:m,error:_}=await lt(this.fetch,"POST",n,{headers:this.headers,body:{phone:i,type:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}}});return{data:{user:null,session:null,messageId:m==null?void 0:m.message_id},error:_}}throw new lc("You must provide either an email or phone number and a type")}catch(n){if(Ke(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(t,n){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),l=(async()=>(await i,await n()))();return this.pendingInLock.push((async()=>{try{await l}catch{}})()),l}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=n();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const l=[...this.pendingInLock];await Promise.all(l),this.pendingInLock.splice(0,l.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await t(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const n=await Gs(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?t=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const i=t.expires_at?t.expires_at*1e3-Date.now()<md:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",t.expires_at),!i){if(this.userStorage){const m=await Gs(this.userStorage,this.storageKey+"-user");m!=null&&m.user?t.user=m.user:t.user=yd()}if(this.storage.isServer&&t.user){let m=this.suppressGetSessionWarning;t=new Proxy(t,{get:(v,y,S)=>(!m&&y==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),m=!0,this.suppressGetSessionWarning=!0),Reflect.get(v,y,S))})}return{data:{session:t},error:null}}const{session:l,error:c}=await this._callRefreshToken(t.refresh_token);return c?{data:{session:null},error:c}:{data:{session:l},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await lt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:cs}):await this._useSession(async n=>{var i,l,c;const{data:m,error:_}=n;if(_)throw _;return!(!((i=m.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new is}:await lt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(c=(l=m.session)===null||l===void 0?void 0:l.access_token)!==null&&c!==void 0?c:void 0,xform:cs})})}catch(n){if(Ke(n))return rb(n)&&(await this._removeSession(),await ns(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(t,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,n))}async _updateUser(t,n={}){try{return await this._useSession(async i=>{const{data:l,error:c}=i;if(c)throw c;if(!l.session)throw new is;const m=l.session;let _=null,v=null;this.flowType==="pkce"&&t.email!=null&&([_,v]=await bo(this.storage,this.storageKey));const{data:y,error:S}=await lt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:_,code_challenge_method:v}),jwt:m.access_token,xform:cs});if(S)throw S;return m.user=y.user,await this._saveSession(m),await this._notifyAllSubscribers("USER_UPDATED",m),{data:{user:m.user},error:null}})}catch(i){if(Ke(i))return{data:{user:null},error:i};throw i}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new is;const n=Date.now()/1e3;let i=n,l=!0,c=null;const{payload:m}=xd(t.access_token);if(m.exp&&(i=m.exp,l=i<=n),l){const{session:_,error:v}=await this._callRefreshToken(t.refresh_token);if(v)return{data:{user:null,session:null},error:v};if(!_)return{data:{user:null,session:null},error:null};c=_}else{const{data:_,error:v}=await this._getUser(t.access_token);if(v)throw v;c={access_token:t.access_token,refresh_token:t.refresh_token,user:_.user,token_type:"bearer",expires_in:i-n,expires_at:i},await this._saveSession(c),await this._notifyAllSubscribers("SIGNED_IN",c)}return{data:{user:c.user,session:c},error:null}}catch(n){if(Ke(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async n=>{var i;if(!t){const{data:m,error:_}=n;if(_)throw _;t=(i=m.session)!==null&&i!==void 0?i:void 0}if(!(t!=null&&t.refresh_token))throw new is;const{session:l,error:c}=await this._callRefreshToken(t.refresh_token);return c?{data:{user:null,session:null},error:c}:l?{data:{user:l.user,session:l},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(Ke(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(t,n){try{if(!$r())throw new cc("No browser detected.");if(t.error||t.error_description||t.error_code)throw new cc(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new P1("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new cc("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new P1("No code detected.");const{data:I,error:k}=await this._exchangeCodeForSession(t.code);if(k)throw k;const z=new URL(window.location.href);return z.searchParams.delete("code"),window.history.replaceState(window.history.state,"",z.toString()),{data:{session:I.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:l,access_token:c,refresh_token:m,expires_in:_,expires_at:v,token_type:y}=t;if(!c||!_||!m||!y)throw new cc("No session defined in URL");const S=Math.round(Date.now()/1e3),E=parseInt(_);let T=S+E;v&&(T=parseInt(v));const U=T-S;U*1e3<=Ao&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${U}s, should have been closer to ${E}s`);const j=T-E;S-j>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",j,T,S):S-j<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",j,T,S);const{data:P,error:D}=await this._getUser(c);if(D)throw D;const R={provider_token:i,provider_refresh_token:l,access_token:c,expires_in:E,expires_at:T,refresh_token:m,token_type:y,user:P.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:R,redirectType:t.type},error:null}}catch(i){if(Ke(i))return{data:{session:null,redirectType:null},error:i};throw i}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const n=await Gs(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&n)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async n=>{var i;const{data:l,error:c}=n;if(c)return{error:c};const m=(i=l.session)===null||i===void 0?void 0:i.access_token;if(m){const{error:_}=await this.admin.signOut(m,t);if(_&&!(nb(_)&&(_.status===404||_.status===401||_.status===403)))return{error:_}}return t!=="others"&&(await this._removeSession(),await ns(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const n=fb(),i={id:n,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,i),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:i}}}async _emitInitialSession(t){return await this._useSession(async n=>{var i,l;try{const{data:{session:c},error:m}=n;if(m)throw m;await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",c)),this._debug("INITIAL_SESSION","callback id",t,"session",c)}catch(c){await((l=this.stateChangeEmitters.get(t))===null||l===void 0?void 0:l.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",c),console.error(c)}})}async resetPasswordForEmail(t,n={}){let i=null,l=null;this.flowType==="pkce"&&([i,l]=await bo(this.storage,this.storageKey,!0));try{return await lt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:i,code_challenge_method:l,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(c){if(Ke(c))return{data:null,error:c};throw c}}async getUserIdentities(){var t;try{const{data:n,error:i}=await this.getUser();if(i)throw i;return{data:{identities:(t=n.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(n){if(Ke(n))return{data:null,error:n};throw n}}async linkIdentity(t){var n;try{const{data:i,error:l}=await this._useSession(async c=>{var m,_,v,y,S;const{data:E,error:T}=c;if(T)throw T;const U=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(m=t.options)===null||m===void 0?void 0:m.redirectTo,scopes:(_=t.options)===null||_===void 0?void 0:_.scopes,queryParams:(v=t.options)===null||v===void 0?void 0:v.queryParams,skipBrowserRedirect:!0});return await lt(this.fetch,"GET",U,{headers:this.headers,jwt:(S=(y=E.session)===null||y===void 0?void 0:y.access_token)!==null&&S!==void 0?S:void 0})});if(l)throw l;return $r()&&!(!((n=t.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(i==null?void 0:i.url),{data:{provider:t.provider,url:i==null?void 0:i.url},error:null}}catch(i){if(Ke(i))return{data:{provider:t.provider,url:null},error:i};throw i}}async unlinkIdentity(t){try{return await this._useSession(async n=>{var i,l;const{data:c,error:m}=n;if(m)throw m;return await lt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(l=(i=c.session)===null||i===void 0?void 0:i.access_token)!==null&&l!==void 0?l:void 0})})}catch(n){if(Ke(n))return{data:null,error:n};throw n}}async _refreshAccessToken(t){const n=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{const i=Date.now();return await xb(async l=>(l>0&&await pb(200*Math.pow(2,l-1)),this._debug(n,"refreshing attempt",l),await lt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Ti})),(l,c)=>{const m=200*Math.pow(2,l);return c&&pd(c)&&Date.now()+m-i<Ao})}catch(i){if(this._debug(n,"error",i),Ke(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(n,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,n){const i=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",n,"url",i),$r()&&!n.skipBrowserRedirect&&window.location.assign(i),{data:{provider:t,url:i},error:null}}async _recoverAndRefresh(){var t,n;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const l=await Gs(this.storage,this.storageKey);if(l&&this.userStorage){let m=await Gs(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!m&&(m={user:l.user},await No(this.userStorage,this.storageKey+"-user",m)),l.user=(t=m==null?void 0:m.user)!==null&&t!==void 0?t:yd()}else if(l&&!l.user&&!l.user){const m=await Gs(this.storage,this.storageKey+"-user");m&&(m!=null&&m.user)?(l.user=m.user,await ns(this.storage,this.storageKey+"-user"),await No(this.storage,this.storageKey,l)):l.user=yd()}if(this._debug(i,"session from storage",l),!this._isValidSession(l)){this._debug(i,"session is not valid"),l!==null&&await this._removeSession();return}const c=((n=l.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<md;if(this._debug(i,`session has${c?"":" not"} expired with margin of ${md}s`),c){if(this.autoRefreshToken&&l.refresh_token){const{error:m}=await this._callRefreshToken(l.refresh_token);m&&(console.error(m),pd(m)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",m),await this._removeSession()))}}else if(l.user&&l.user.__isUserNotAvailableProxy===!0)try{const{data:m,error:_}=await this._getUser(l.access_token);!_&&(m!=null&&m.user)?(l.user=m.user,await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(m){console.error("Error getting user data:",m),this._debug(i,"error getting user data, skipping SIGNED_IN notification",m)}else await this._notifyAllSubscribers("SIGNED_IN",l)}catch(l){this._debug(i,"error",l),console.error(l);return}finally{this._debug(i,"end")}}async _callRefreshToken(t){var n,i;if(!t)throw new is;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const l=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(l,"begin");try{this.refreshingDeferred=new Au;const{data:c,error:m}=await this._refreshAccessToken(t);if(m)throw m;if(!c.session)throw new is;await this._saveSession(c.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",c.session);const _={session:c.session,error:null};return this.refreshingDeferred.resolve(_),_}catch(c){if(this._debug(l,"error",c),Ke(c)){const m={session:null,error:c};return pd(c)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(m),m}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(c),c}finally{this.refreshingDeferred=null,this._debug(l,"end")}}async _notifyAllSubscribers(t,n,i=!0){const l=`#_notifyAllSubscribers(${t})`;this._debug(l,"begin",n,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:t,session:n});const c=[],m=Array.from(this.stateChangeEmitters.values()).map(async _=>{try{await _.callback(t,n)}catch(v){c.push(v)}});if(await Promise.all(m),c.length>0){for(let _=0;_<c.length;_+=1)console.error(c[_]);throw c[0]}}finally{this._debug(l,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const n=Object.assign({},t),i=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&n.user&&await No(this.userStorage,this.storageKey+"-user",{user:n.user});const l=Object.assign({},n);delete l.user;const c=F1(l);await No(this.storage,this.storageKey,c)}else{const l=F1(n);await No(this.storage,this.storageKey,l)}}async _removeSession(){this._debug("#_removeSession()"),await ns(this.storage,this.storageKey),await ns(this.storage,this.storageKey+"-code-verifier"),await ns(this.storage,this.storageKey+"-user"),this.userStorage&&await ns(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&$r()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Ao);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async n=>{const{data:{session:i}}=n;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const l=Math.floor((i.expires_at*1e3-t)/Ao);this._debug("#_autoRefreshTokenTick()",`access token expires in ${l} ticks, a tick lasts ${Ao}ms, refresh threshold is ${Nh} ticks`),l<=Nh&&await this._callRefreshToken(i.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof lx)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!$r()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const n=`#_onVisibilityChanged(${t})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,n,i){const l=[`provider=${encodeURIComponent(n)}`];if(i!=null&&i.redirectTo&&l.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i!=null&&i.scopes&&l.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[c,m]=await bo(this.storage,this.storageKey),_=new URLSearchParams({code_challenge:`${encodeURIComponent(c)}`,code_challenge_method:`${encodeURIComponent(m)}`});l.push(_.toString())}if(i!=null&&i.queryParams){const c=new URLSearchParams(i.queryParams);l.push(c.toString())}return i!=null&&i.skipBrowserRedirect&&l.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${t}?${l.join("&")}`}async _unenroll(t){try{return await this._useSession(async n=>{var i;const{data:l,error:c}=n;return c?{data:null,error:c}:await lt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(i=l==null?void 0:l.session)===null||i===void 0?void 0:i.access_token})})}catch(n){if(Ke(n))return{data:null,error:n};throw n}}async _enroll(t){try{return await this._useSession(async n=>{var i,l;const{data:c,error:m}=n;if(m)return{data:null,error:m};const _=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:v,error:y}=await lt(this.fetch,"POST",`${this.url}/factors`,{body:_,headers:this.headers,jwt:(i=c==null?void 0:c.session)===null||i===void 0?void 0:i.access_token});return y?{data:null,error:y}:(t.factorType==="totp"&&(!((l=v==null?void 0:v.totp)===null||l===void 0)&&l.qr_code)&&(v.totp.qr_code=`data:image/svg+xml;utf-8,${v.totp.qr_code}`),{data:v,error:null})})}catch(n){if(Ke(n))return{data:null,error:n};throw n}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var i;const{data:l,error:c}=n;if(c)return{data:null,error:c};const{data:m,error:_}=await lt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(i=l==null?void 0:l.session)===null||i===void 0?void 0:i.access_token});return _?{data:null,error:_}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+m.expires_in},m)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",m),{data:m,error:_})})}catch(n){if(Ke(n))return{data:null,error:n};throw n}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var i;const{data:l,error:c}=n;return c?{data:null,error:c}:await lt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(i=l==null?void 0:l.session)===null||i===void 0?void 0:i.access_token})})}catch(n){if(Ke(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(t){const{data:n,error:i}=await this._challenge({factorId:t.factorId});return i?{data:null,error:i}:await this._verify({factorId:t.factorId,challengeId:n.id,code:t.code})}async _listFactors(){const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const i=(t==null?void 0:t.factors)||[],l=i.filter(m=>m.factor_type==="totp"&&m.status==="verified"),c=i.filter(m=>m.factor_type==="phone"&&m.status==="verified");return{data:{all:i,totp:l,phone:c},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var n,i;const{data:{session:l},error:c}=t;if(c)return{data:null,error:c};if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:m}=xd(l.access_token);let _=null;m.aal&&(_=m.aal);let v=_;((i=(n=l.user.factors)===null||n===void 0?void 0:n.filter(E=>E.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(v="aal2");const S=m.amr||[];return{data:{currentLevel:_,nextLevel:v,currentAuthenticationMethods:S},error:null}}))}async fetchJwk(t,n={keys:[]}){let i=n.keys.find(_=>_.kid===t);if(i)return i;const l=Date.now();if(i=this.jwks.keys.find(_=>_.kid===t),i&&this.jwks_cached_at+eb>l)return i;const{data:c,error:m}=await lt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(m)throw m;return!c.keys||c.keys.length===0||(this.jwks=c,this.jwks_cached_at=l,i=c.keys.find(_=>_.kid===t),!i)?null:i}async getClaims(t,n={}){try{let i=t;if(!i){const{data:U,error:j}=await this.getSession();if(j||!U.session)return{data:null,error:j};i=U.session.access_token}const{header:l,payload:c,signature:m,raw:{header:_,payload:v}}=xd(i);n!=null&&n.allowExpired||Eb(c.exp);const y=!l.alg||l.alg.startsWith("HS")||!l.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(l.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!y){const{error:U}=await this.getUser(i);if(U)throw U;return{data:{claims:c,header:l,signature:m},error:null}}const S=Sb(l.alg),E=await crypto.subtle.importKey("jwk",y,S,!0,["verify"]);if(!await crypto.subtle.verify(S,E,m,ub(`${_}.${v}`)))throw new kh("Invalid JWT signature");return{data:{claims:c,header:l,signature:m},error:null}}catch(i){if(Ke(i))return{data:null,error:i};throw i}}}wl.nextInstanceID=0;const zb=wl;class Hb extends zb{constructor(t){super(t)}}var Wb=function(e,t,n,i){function l(c){return c instanceof n?c:new n(function(m){m(c)})}return new(n||(n=Promise))(function(c,m){function _(S){try{y(i.next(S))}catch(E){m(E)}}function v(S){try{y(i.throw(S))}catch(E){m(E)}}function y(S){S.done?c(S.value):l(S.value).then(_,v)}y((i=i.apply(e,t||[])).next())})};class Vb{constructor(t,n,i){var l,c,m;if(this.supabaseUrl=t,this.supabaseKey=n,!t)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const _=$_(t),v=new URL(_);this.realtimeUrl=new URL("realtime/v1",v),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",v),this.storageUrl=new URL("storage/v1",v),this.functionsUrl=new URL("functions/v1",v);const y=`sb-${v.hostname.split(".")[0]}-auth-token`,S={db:U_,realtime:H_,auth:Object.assign(Object.assign({},z_),{storageKey:y}),global:F_},E=X_(i??{},S);this.storageKey=(l=E.auth.storageKey)!==null&&l!==void 0?l:"",this.headers=(c=E.global.headers)!==null&&c!==void 0?c:{},E.accessToken?(this.accessToken=E.accessToken,this.auth=new Proxy({},{get:(T,U)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(U)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((m=E.auth)!==null&&m!==void 0?m:{},this.headers,E.global.fetch),this.fetch=Z_(n,this._getAccessToken.bind(this),E.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},E.realtime)),this.rest=new o_(new URL("rest/v1",v).href,{headers:this.headers,schema:E.db.schema,fetch:this.fetch}),this.storage=new j_(this.storageUrl.href,this.headers,this.fetch,i==null?void 0:i.storage),E.accessToken||this._listenForAuthEvents()}get functions(){return new Bw(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,n={},i={}){return this.rest.rpc(t,n,i)}channel(t,n={config:{}}){return this.realtime.channel(t,n)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,n;return Wb(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:i}=yield this.auth.getSession();return(n=(t=i.session)===null||t===void 0?void 0:t.access_token)!==null&&n!==void 0?n:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:n,detectSessionInUrl:i,storage:l,storageKey:c,flowType:m,lock:_,debug:v},y,S){const E={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Hb({url:this.authUrl.href,headers:Object.assign(Object.assign({},E),y),storageKey:c,autoRefreshToken:t,persistSession:n,detectSessionInUrl:i,storage:l,flowType:m,lock:_,debug:v,fetch:S,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new C_(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,i)=>{this._handleTokenChanged(n,"CLIENT",i==null?void 0:i.access_token)})}_handleTokenChanged(t,n,i){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==i?this.changedAccessToken=i:t==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Gb=(e,t,n)=>new Vb(e,t,n);function Zb(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}Zb()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");console.log("[Supabase] VITE_SUPABASE_URL:","https://***REMOVED***.supabase.co");console.log("[Supabase] VITE_SUPABASE_ANON_KEY:","Set");const Re=Gb("https://***REMOVED***.supabase.co","***REMOVED***J9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFkeXdmd2xhZmttcG5hbG5mYmxpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU5MzcxNDMsImV4cCI6MjA3MTUxMzE0M30.z-aKaja3OiEv2yhu-hND5cbaxmiY11822cJisiC_pu4"),Zs="suki_user",cx=null,ux=H.createContext({user:cx,pendingEmail:"",emailSent:!1,signInWithEmail:e=>{},signOut:()=>{},updateProfile:e=>{},signInWithApple:()=>{},signInWithFacebook:()=>{},signInWithGoogle:()=>{}});function Yb({children:e}){const[t,n]=H.useState(cx),[i,l]=H.useState(""),[c,m]=H.useState(!1),[_,v]=H.useState(!1);H.useEffect(()=>{Re.auth.getSession().then(({data:{session:R}})=>{var I,k,z,G;if(R!=null&&R.user){let Y=null;try{const Z=`suki_profile_photo_${R.user.id}`,J=localStorage.getItem(Z);console.log("[Suki] Initial session: Looking for profile photo with key:",Z),console.log("[Suki] Initial session: Found photo in localStorage:",!!J),J?(Y=J,console.log("[Suki] Initial session: Successfully restored profile photo from localStorage for user:",R.user.id)):console.log("[Suki] Initial session: No profile photo found in localStorage for user:",R.user.id)}catch(Z){console.warn("Could not restore profile photo from localStorage:",Z)}n({id:R.user.id,email:R.user.email,city:((I=R.user.user_metadata)==null?void 0:I.city)||"HCMC",interests:((k=R.user.user_metadata)==null?void 0:k.interests)||[],isOrganizer:((z=R.user.user_metadata)==null?void 0:z.isOrganizer)||!1,createdAt:R.user.created_at,provider:((G=R.user.app_metadata)==null?void 0:G.provider)||"email",profilePhoto:Y})}});const{data:{subscription:D}}=Re.auth.onAuthStateChange(async(R,I)=>{var k,z,G,Y;if(console.log("Auth state changed:",R,I),R==="SIGNED_IN"&&(I!=null&&I.user)){const Z=JSON.parse(localStorage.getItem(Zs)||"{}"),J=t;if(Z.id&&Z.id!==I.user.id||J&&J.id!==I.user.id){const ue=Z.id||(J==null?void 0:J.id);console.log("[Suki] Account switch detected from",ue,"to",I.user.id),window.dispatchEvent(new CustomEvent("suki:account_switched",{detail:{previousUserId:ue,newUserId:I.user.id}})),setTimeout(()=>{window.dispatchEvent(new CustomEvent("suki:events_updated"))},100)}let Ee=null;try{const ue=`suki_profile_photo_${I.user.id}`,Ie=localStorage.getItem(ue);console.log("[Suki] Looking for profile photo with key:",ue),console.log("[Suki] Found photo in localStorage:",!!Ie),Ie?(Ee=Ie,console.log("[Suki] Successfully restored profile photo from localStorage for user:",I.user.id)):console.log("[Suki] No profile photo found in localStorage for user:",I.user.id)}catch(ue){console.warn("Could not restore profile photo from localStorage:",ue)}const ce={id:I.user.id,email:I.user.email,city:((k=I.user.user_metadata)==null?void 0:k.city)||"HCMC",interests:((z=I.user.user_metadata)==null?void 0:z.interests)||[],isOrganizer:((G=I.user.user_metadata)==null?void 0:G.isOrganizer)||!1,createdAt:I.user.created_at,provider:((Y=I.user.app_metadata)==null?void 0:Y.provider)||"email",profilePhoto:Ee};n(ce),localStorage.setItem(Zs,JSON.stringify(ce))}else R==="SIGNED_OUT"?(n(null),localStorage.removeItem(Zs)):R==="TOKEN_REFRESHED"&&(I!=null&&I.user)&&n(Z=>Z?{...Z,id:I.user.id}:null)});return()=>D.unsubscribe()},[]);const y=async(D,R=!0)=>{try{v(!0);const I=String(D||"").trim().toLowerCase();if(!I||!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(I))throw new Error("Invalid email");if(l(I),console.log("[Suki] Attempting to send email to:",I,"isSignUp:",R),!R){console.log("[Suki] Clearing existing sessions for fresh magic link...");try{await Re.auth.signOut(),console.log("[Suki] Existing sessions cleared")}catch(G){console.warn("[Suki] Could not clear existing sessions:",G)}}const k=`${window.location.origin}/auth/callback`;console.log("[Suki] Magic link redirect URL:",k);const{error:z}=await Re.auth.signInWithOtp({email:I,options:{emailRedirectTo:k,shouldCreateUser:R,data:{timestamp:Date.now(),fresh:!0}}});if(z)throw console.error("[Suki] Supabase error:",z),!R&&z.message.includes("User not found")?new Error("No account found with this email. Please sign up first."):new Error(z.message);return m(!0),console.log("[Suki] Confirmation email sent to",I),{success:!0,message:R?"Check your email for the confirmation link!":"Check your email for the sign-in link!"}}catch(I){throw console.error("Error in signInWithEmail:",I),I}finally{v(!1)}},S=async()=>{try{v(!0);const{error:D}=await Re.auth.signInWithOAuth({provider:"apple",options:{redirectTo:`${window.location.origin}/auth/callback`}});if(D)throw D;return{success:!0}}catch(D){throw console.error("Apple sign-in error:",D),new Error("Apple sign-in failed")}finally{v(!1)}},E=async()=>{try{v(!0);const{error:D}=await Re.auth.signInWithOAuth({provider:"facebook",options:{redirectTo:`${window.location.origin}/auth/callback`}});if(D)throw D;return{success:!0}}catch(D){throw console.error("Facebook sign-in error:",D),new Error("Facebook sign-in failed")}finally{v(!1)}},T=async()=>{try{v(!0);const{error:D}=await Re.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/auth/callback`}});if(D)throw D;return{success:!0}}catch(D){throw console.error("Google sign-in error:",D),new Error("Google sign-in failed")}finally{v(!1)}},U=async()=>{try{const{error:D}=await Re.auth.signOut();if(D)throw D;console.log("[Suki] User signed out, keeping profile photo in localStorage for future sign-ins"),n(null),l(""),m(!1),localStorage.removeItem(Zs)}catch(D){console.error("Sign out error:",D)}},j=async D=>{if(t)try{const{profilePhoto:R,...I}=D,{error:k}=await Re.auth.updateUser({data:I});if(k)throw k;if(R)try{localStorage.setItem(`suki_profile_photo_${t.id}`,R)}catch{console.warn("localStorage quota exceeded for photo, clearing and retrying...");try{Object.keys(localStorage).forEach(J=>{J.startsWith("suki_profile_photo_")&&localStorage.removeItem(J)}),localStorage.setItem(`suki_profile_photo_${t.id}`,R)}catch(Z){console.warn("Still cannot save profile photo to localStorage:",Z)}}const z={...t,...D};n(z);try{localStorage.setItem(Zs,JSON.stringify(z))}catch(Y){console.warn("Could not update user in localStorage:",Y)}const G={...t,...I};try{localStorage.setItem(Zs,JSON.stringify(G))}catch{console.warn("localStorage quota exceeded, clearing old data and retrying..."),localStorage.clear();try{localStorage.setItem(Zs,JSON.stringify(G))}catch(Z){console.warn("Still cannot save to localStorage:",Z)}}}catch(R){throw console.error("Profile update error:",R),R}},P=H.useMemo(()=>({user:t,pendingEmail:i,emailSent:c,loading:_,signInWithEmail:y,signOut:U,updateProfile:j,signInWithApple:S,signInWithFacebook:E,signInWithGoogle:T}),[t,i,c,_]);return g.jsx(ux.Provider,{value:P,children:e})}function ur(){return H.useContext(ux)}const dx=H.createContext();function $b({children:e}){const[t,n]=H.useState(()=>{const c=localStorage.getItem("suki_user_location");if(c)try{return JSON.parse(c)}catch(m){console.error("Error parsing saved location:",m),localStorage.removeItem("suki_user_location")}return{city:"HCMC",lat:10.7769,lng:106.7009}}),i=c=>{n(c),localStorage.setItem("suki_user_location",JSON.stringify(c))},l=c=>{if(!c)return;const _=(v=>{switch((v||"").toLowerCase().trim()){case"hcmc":case"ho chi minh city":case"saigon":return{city:"HCMC",lat:10.7769,lng:106.7009};case"hanoi":return{city:"Hanoi",lat:21.0278,lng:105.8342};case"danang":case"da nang":return{city:"Danang",lat:16.0544,lng:108.2208};default:return t}})(c);_.city!==t.city&&(i(_),console.log(`[LocationContext] Updated location from profile city: ${c} → ${_.city}`))};return g.jsx(dx.Provider,{value:{userLocation:t,setUserLocation:i,updateLocationFromProfile:l},children:e})}function Nu(){const e=H.useContext(dx);if(!e)throw new Error("useLocation must be used within a LocationProvider");return e}/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xb=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),hx=(...e)=>e.filter((t,n,i)=>!!t&&i.indexOf(t)===n).join(" ");/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var qb={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kb=H.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:l="",children:c,iconNode:m,..._},v)=>H.createElement("svg",{ref:v,...qb,width:t,height:t,stroke:e,strokeWidth:i?Number(n)*24/Number(t):n,className:hx("lucide",l),..._},[...m.map(([y,S])=>H.createElement(y,S)),...Array.isArray(c)?c:[c]]));/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=(e,t)=>{const n=H.forwardRef(({className:i,...l},c)=>H.createElement(Kb,{ref:c,iconNode:t,className:hx(`lucide-${Xb(e)}`,i),...l}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qc=At("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jc=At("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bf=At("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qb=At("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jb=At("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e3=At("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V1=At("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t3=At("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n3=At("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r3=At("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i3=At("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s3=At("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ff=At("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o3=At("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a3=At("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l3=At("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=At("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c3=At("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uf=At("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G1=At("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fx=At("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u3=At("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d3=At("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h3=At("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gx=At("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z1=At("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f3=At("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mh=At("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zf=At("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Y1=[{city:"Ho Chi Minh City",lat:10.7769,lng:106.7009},{city:"Hanoi",lat:21.0278,lng:105.8342},{city:"Da Nang",lat:16.0544,lng:108.2022},{city:"Hai Phong",lat:20.8449,lng:106.6881},{city:"Can Tho",lat:10.0452,lng:105.7469},{city:"Bien Hoa",lat:10.9447,lng:106.8243},{city:"Hue",lat:16.4637,lng:107.5909},{city:"Nha Trang",lat:12.2388,lng:109.1967},{city:"Buon Ma Thuot",lat:12.6667,lng:108.05},{city:"Quy Nhon",lat:13.7563,lng:109.2237},{city:"Vung Tau",lat:10.3459,lng:107.0843},{city:"Thai Nguyen",lat:21.5944,lng:105.8481},{city:"Thanh Hoa",lat:19.8067,lng:105.7847},{city:"Nam Dinh",lat:20.4201,lng:106.1683},{city:"Vinh",lat:18.6792,lng:105.6919},{city:"My Tho",lat:10.36,lng:106.36},{city:"Ca Mau",lat:9.1767,lng:105.15},{city:"Rach Gia",lat:10.0167,lng:105.0833},{city:"Long Xuyen",lat:10.3833,lng:105.4167},{city:"Soc Trang",lat:9.6,lng:105.9833},{city:"Tra Vinh",lat:9.9333,lng:106.35},{city:"Bac Lieu",lat:9.2833,lng:105.7167},{city:"Dong Thap",lat:10.5167,lng:105.6167},{city:"An Giang",lat:10.5167,lng:105.1167},{city:"Kien Giang",lat:9.8167,lng:105.1167},{city:"Tien Giang",lat:10.35,lng:106.35},{city:"Ben Tre",lat:10.2333,lng:106.3833},{city:"Vinh Long",lat:10.25,lng:105.9667},{city:"Hau Giang",lat:9.7833,lng:105.4667},{city:"Dong Nai",lat:10.95,lng:106.8167},{city:"Binh Duong",lat:11.3167,lng:106.6333},{city:"Tay Ninh",lat:11.3167,lng:106.1},{city:"Binh Phuoc",lat:11.75,lng:106.6},{city:"Lam Dong",lat:11.9333,lng:108.45},{city:"Ninh Thuan",lat:11.5667,lng:108.9833},{city:"Binh Thuan",lat:10.9333,lng:108.1},{city:"Khanh Hoa",lat:12.25,lng:109.1833},{city:"Phu Yen",lat:13.0833,lng:109.3167},{city:"Dak Lak",lat:12.6667,lng:108.05},{city:"Dak Nong",lat:12,lng:107.6833},{city:"Gia Lai",lat:13.9833,lng:108},{city:"Kon Tum",lat:14.35,lng:108},{city:"Quang Nam",lat:15.8833,lng:108.3333},{city:"Quang Ngai",lat:15.1167,lng:108.8},{city:"Binh Dinh",lat:13.7667,lng:109.2333},{city:"Quang Binh",lat:17.4667,lng:106.6},{city:"Quang Tri",lat:16.75,lng:107.2},{city:"Thua Thien Hue",lat:16.4637,lng:107.5909},{city:"Ha Tinh",lat:18.3333,lng:105.9},{city:"Nghe An",lat:18.6792,lng:105.6919},{city:"Lao Cai",lat:22.4833,lng:103.95},{city:"Dien Bien",lat:21.3833,lng:103.0167},{city:"Lai Chau",lat:22,lng:103.3333},{city:"Son La",lat:21.3167,lng:103.9167},{city:"Yen Bai",lat:21.7,lng:104.8667},{city:"Hoa Binh",lat:20.8167,lng:105.3333},{city:"Lang Son",lat:21.8333,lng:106.75},{city:"Quang Ninh",lat:21.0167,lng:107.3},{city:"Bac Giang",lat:21.2667,lng:106.2},{city:"Phu Tho",lat:21.3,lng:105.4333},{city:"Vinh Phuc",lat:21.3167,lng:105.6},{city:"Bac Ninh",lat:21.1833,lng:106.05},{city:"Hai Duong",lat:20.9333,lng:106.3167},{city:"Hung Yen",lat:20.65,lng:106.0667},{city:"Thai Binh",lat:20.45,lng:106.3333},{city:"Ha Nam",lat:20.55,lng:105.9167},{city:"Ninh Binh",lat:20.25,lng:105.9667},{city:"Long An",lat:10.6,lng:106.1667},{city:"Ba Ria - Vung Tau",lat:10.3459,lng:107.0843}];function It({searchTerm:e,setSearchTerm:t}){const{user:n,signOut:i}=ur(),{userLocation:l,setUserLocation:c}=Nu(),[m,_]=H.useState((l==null?void 0:l.city)||""),[v,y]=H.useState(!1),[S,E]=H.useState(!1),[T,U]=H.useState(!1),[j,P]=H.useState([]),D=H.useRef(null),R=H.useRef(null);H.useEffect(()=>{const ce=localStorage.getItem("suki_user_location");if(ce)try{const ue=JSON.parse(ce);console.log("Loading saved location:",ue),c(ue),_(ue.city)}catch(ue){console.error("Error parsing saved location:",ue),localStorage.removeItem("suki_user_location")}else _((l==null?void 0:l.city)||"")},[]),H.useEffect(()=>{l!=null&&l.city&&(console.log("Syncing location input with userLocation:",l.city),_(l.city))},[l==null?void 0:l.city]),H.useEffect(()=>{const ce=localStorage.getItem("suki_recent_searches");if(ce)try{const ue=JSON.parse(ce);P(ue)}catch(ue){console.error("Error parsing recent searches:",ue),localStorage.removeItem("suki_recent_searches")}},[]),H.useEffect(()=>{const ce=ue=>{D.current&&(D.current.contains(ue.target)||y(!1))};return window.addEventListener("click",ce),()=>window.removeEventListener("click",ce)},[]),H.useEffect(()=>{const ce=ue=>{R.current&&(R.current.contains(ue.target)||E(!1))};return window.addEventListener("click",ce),()=>window.removeEventListener("click",ce)},[]);const I=H.useMemo(()=>{const ce=(m||"").trim().toLowerCase();if(!ce)return[];let ue=Y1.filter(Ie=>Ie.city.toLowerCase().includes(ce));return ue.sort((Ie,Te)=>{const Q=Ie.city.toLowerCase(),pe=Te.city.toLowerCase();return Q===ce?-1:pe===ce?1:Q.startsWith(ce)&&!pe.startsWith(ce)?-1:pe.startsWith(ce)&&!Q.startsWith(ce)?1:Q.localeCompare(pe)}),ue.slice(0,4)},[m]),k=ce=>{const ue={city:ce.city,lat:ce.lat,lng:ce.lng};c(ue),_(ce.city),y(!1)},z=()=>{i(),E(!1)},G=ce=>{if(!ce.trim())return;const ue=[ce.trim(),...j.filter(Ie=>Ie!==ce.trim())].slice(0,5);P(ue),localStorage.setItem("suki_recent_searches",JSON.stringify(ue))},Y=ce=>{const ue=j.filter(Ie=>Ie!==ce);P(ue),localStorage.setItem("suki_recent_searches",JSON.stringify(ue))},Z=ce=>{ce.preventDefault(),e.trim()&&(G(e),U(!1))},J=ce=>{t(ce),G(ce),U(!1)},ie=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(async ce=>{const ue=ce.coords.latitude,Ie=ce.coords.longitude,Q=((ne,K)=>{const me=Y1.map(we=>({name:we.city,lat:we.lat,lng:we.lng,radius:.5}));let le=null,be=1/0;for(const we of me){const Qe=Math.sqrt(Math.pow(ne-we.lat,2)+Math.pow(K-we.lng,2));Qe<we.radius&&Qe<be&&(be=Qe,le=we.name)}return le||"Current Location"})(ue,Ie),pe={city:Q,lat:ue,lng:Ie};console.log("Setting location to:",pe),c(pe),_(Q),localStorage.setItem("suki_user_location",JSON.stringify(pe)),y(!1)},ce=>{console.error("Error getting current location:",ce),alert("Could not get your current location. Please choose a city manually."),y(!1)}):(alert("Geolocation is not supported by your browser."),y(!1))},Ee=()=>{c({city:"Online Events",lat:0,lng:0}),_("Online Events"),y(!1)};return g.jsx("header",{className:"border-b border-neutral-200/80 bg-white/80 sticky top-0 backdrop-blur z-50",children:g.jsxs("div",{className:"w-full px-6 py-4 flex items-center justify-between gap-6",children:[g.jsx(bs,{to:"/",className:"flex items-center gap-2",children:g.jsx("img",{src:"/Suki.png",alt:"Suki logo",className:"size-12"})}),g.jsx("div",{className:"hidden md:flex items-center flex-1 mx-8",ref:D,children:g.jsxs("div",{className:"flex border border-neutral-300 bg-white w-full max-w-4xl",children:[g.jsxs("div",{className:"relative flex-1",children:[g.jsxs("form",{onSubmit:Z,children:[g.jsx(G1,{className:"size-4 absolute left-3 top-1/2 -translate-y-1/2 text-neutral-500 pointer-events-none"}),g.jsx("input",{type:"text",className:"w-full px-3 py-2 pl-10 border-0 focus:outline-none focus:ring-0",placeholder:"Search events",value:e,onChange:ce=>t(ce.target.value),onFocus:()=>U(!0),onBlur:()=>setTimeout(()=>U(!1),200)})]}),T&&j.length>0&&g.jsx("div",{className:"absolute z-20 mt-1 w-full bg-white border border-neutral-200 rounded-lg shadow-lg",children:g.jsxs("div",{className:"p-2",children:[g.jsx("div",{className:"text-xs font-medium text-neutral-500 mb-2 px-2",children:"Recent searches"}),j.map((ce,ue)=>g.jsxs("div",{className:"flex items-center justify-between group hover:bg-neutral-50 rounded px-2 py-2",children:[g.jsxs("button",{type:"button",className:"flex-1 text-left text-sm text-neutral-700 hover:text-neutral-900",onClick:()=>J(ce),children:[g.jsx(G1,{className:"w-4 h-4 inline mr-2 text-neutral-400"}),ce]}),g.jsx("button",{type:"button",onClick:()=>Y(ce),className:"opacity-0 group-hover:opacity-100 text-neutral-400 hover:text-neutral-600 p-1 rounded",children:g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},ue))]})})]}),g.jsx("div",{className:"border-l border-neutral-300"}),g.jsxs("div",{className:"relative flex-1",children:[g.jsx(na,{className:"size-4 absolute left-3 top-1/2 -translate-y-1/2 text-neutral-500 pointer-events-none"}),g.jsx("input",{type:"text",className:"w-full px-3 py-2 pl-10 border-0 focus:outline-none focus:ring-0",placeholder:"Choose a location",value:m,onChange:ce=>{_(ce.target.value),y(!0)},onFocus:()=>y(!0)}),v&&g.jsxs("div",{className:"absolute z-10 mt-2 w-full bg-white border border-neutral-200 shadow-soft",children:[g.jsx("button",{type:"button",className:"w-full text-left px-3 py-2 hover:bg-neutral-100 border-b border-neutral-100",onClick:()=>ie(),children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(na,{className:"w-4 h-4 text-blue-500"}),g.jsx("span",{className:"text-blue-600 font-medium",children:"Use my current location"})]})}),g.jsx("button",{type:"button",className:"w-full text-left px-3 py-2 hover:bg-neutral-100 border-b border-neutral-100",onClick:()=>Ee(),children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("svg",{className:"w-4 h-4 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),g.jsx("span",{className:"text-green-600 font-medium",children:"Browse online events"})]})}),I.length>0&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"px-3 py-2 text-xs font-medium text-neutral-500 bg-neutral-50 border-b border-neutral-100",children:"Cities"}),I.map(ce=>g.jsx("button",{type:"button",className:"w-full text-left px-3 py-2 hover:bg-neutral-100 text-sm",onClick:()=>k(ce),children:ce.city},ce.city))]})]})]})]})}),g.jsxs("nav",{className:"flex items-center gap-1",children:[g.jsxs(ts,{to:"/",className:"btn btn-ghost",style:{flexDirection:"column",height:"auto",padding:"0.5rem 0.75rem"},children:[g.jsx(d3,{className:"w-5 h-5 mb-1"}),g.jsx("span",{className:"text-xs",children:"Discover"})]}),g.jsxs(ts,{to:"/tickets",className:"btn btn-ghost",style:{flexDirection:"column",height:"auto",padding:"0.5rem 0.75rem"},children:[g.jsx(h3,{className:"w-5 h-5 mb-1"}),g.jsx("span",{className:"text-xs",children:"My Tickets"})]}),n&&g.jsxs(ts,{to:"/saved",className:"btn btn-ghost",style:{flexDirection:"column",height:"auto",padding:"0.5rem 0.75rem"},children:[g.jsx(Ff,{className:"w-5 h-5 mb-1"}),g.jsx("span",{className:"text-xs",children:"Saved"})]}),g.jsxs(ts,{to:"/create",className:"btn btn-ghost",style:{flexDirection:"column",height:"auto",padding:"0.5rem 0.75rem"},children:[g.jsx(Uf,{className:"w-5 h-5 mb-1"}),g.jsx("span",{className:"text-xs",children:"Create an event"})]}),n?g.jsxs("div",{className:"relative",ref:R,children:[g.jsxs("button",{className:"flex items-center gap-2 btn btn-ghost hover:bg-neutral-100",onMouseEnter:()=>E(!0),onClick:()=>E(!S),children:[n.profilePhoto?g.jsx("img",{src:n.profilePhoto,alt:"Profile",className:"w-8 h-8 rounded-full object-cover border-2 border-neutral-200"}):g.jsx("div",{className:"w-8 h-8 rounded-full bg-neutral-200 flex items-center justify-center",children:g.jsx(f3,{className:"size-4 text-neutral-500"})}),g.jsx("span",{className:"hidden sm:inline text-sm font-medium text-neutral-700",children:n.email}),g.jsx(Bf,{className:"size-4 text-neutral-500"})]}),S&&g.jsx("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-xl border border-neutral-200 shadow-soft z-50",children:g.jsxs("div",{className:"py-2",children:[g.jsx(ts,{to:"/browse-events",className:"flex items-center px-4 py-3 text-sm text-neutral-700 hover:bg-neutral-50 transition-colors",onClick:()=>E(!1),children:"Browse Events"}),g.jsx(ts,{to:"/manage-events",className:"flex items-center px-4 py-3 text-sm text-neutral-700 hover:bg-neutral-50 transition-colors",onClick:()=>E(!1),children:"Manage My Events"}),g.jsx(ts,{to:"/profile",className:"flex items-center px-4 py-3 text-sm text-neutral-700 hover:bg-neutral-50 transition-colors",onClick:()=>E(!1),children:"Account Settings"}),g.jsx("hr",{className:"my-2 border-neutral-200"}),g.jsx("button",{onClick:z,className:"flex items-center w-full px-4 py-3 text-sm text-red-600 hover:bg-red-50 transition-colors",children:"Log Out"})]})})]}):g.jsxs(ts,{to:"/auth",className:"btn btn-ghost",children:[g.jsx(l3,{className:"size-4 mr-1"})," Sign in"]})]})]})})}function mx({selectedCategory:e,onCategoryChange:t,browsingLocation:n,onLocationChange:i,selectedTimeFilter:l,onTimeFilterChange:c}){const[m,_]=H.useState(!1),[v,y]=H.useState(!1),S=["Music","Business & Professional","Food & Drink","Community & Culture","Performing & Visual Arts","Film, Media & Entertainment","Sports & Fitness","Health & Wellness","Science & Technology","Travel & Outdoor","Charity & Causes","Religion & Spirituality","Family & Education","Seasonal & Holiday","Government & Politics","Fashion & Beauty","Home & Lifestyle","Hobbies & Special Interests","School Activities","Others"],E=m?S:S.slice(0,8),T=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(async j=>{const P=j.coords.latitude,D=j.coords.longitude,I=((k,z)=>{const G=[{name:"Ho Chi Minh City",lat:10.7769,lng:106.7009,radius:.5},{name:"Hanoi",lat:21.0278,lng:105.8342,radius:.5},{name:"Da Nang",lat:16.0544,lng:108.2022,radius:.3},{name:"Hai Phong",lat:20.8449,lng:106.6881,radius:.3},{name:"Can Tho",lat:10.0452,lng:105.7469,radius:.3},{name:"Bien Hoa",lat:10.9447,lng:106.8243,radius:.3},{name:"Hue",lat:16.4637,lng:107.5909,radius:.3},{name:"Nha Trang",lat:12.2388,lng:109.1967,radius:.3},{name:"Buon Ma Thuot",lat:12.6667,lng:108.05,radius:.3},{name:"Quy Nhon",lat:13.7563,lng:109.2237,radius:.3},{name:"Vung Tau",lat:10.3459,lng:107.0843,radius:.3},{name:"Thai Nguyen",lat:21.5944,lng:105.8481,radius:.3},{name:"Thanh Hoa",lat:19.8067,lng:105.7847,radius:.3},{name:"Nam Dinh",lat:20.4201,lng:106.1683,radius:.3},{name:"Vinh",lat:18.6792,lng:105.6919,radius:.3},{name:"My Tho",lat:10.36,lng:106.36,radius:.3},{name:"Ca Mau",lat:9.1767,lng:105.15,radius:.3},{name:"Rach Gia",lat:10.0167,lng:105.0833,radius:.3},{name:"Long Xuyen",lat:10.3833,lng:105.4167,radius:.3},{name:"Soc Trang",lat:9.6,lng:105.9833,radius:.3},{name:"Tra Vinh",lat:9.9333,lng:106.35,radius:.3},{name:"Bac Lieu",lat:9.2833,lng:105.7167,radius:.3},{name:"Dong Thap",lat:10.5167,lng:105.6167,radius:.3},{name:"An Giang",lat:10.5167,lng:105.1167,radius:.3},{name:"Kien Giang",lat:9.8167,lng:105.1167,radius:.3},{name:"Tien Giang",lat:10.35,lng:106.35,radius:.3},{name:"Ben Tre",lat:10.2333,lng:106.3833,radius:.3},{name:"Vinh Long",lat:10.25,lng:105.9667,radius:.3},{name:"Hau Giang",lat:9.7833,lng:105.4667,radius:.3},{name:"Dong Nai",lat:10.95,lng:106.8167,radius:.3},{name:"Binh Duong",lat:11.3167,lng:106.6333,radius:.3},{name:"Tay Ninh",lat:11.3167,lng:106.1,radius:.3},{name:"Binh Phuoc",lat:11.75,lng:106.6,radius:.3},{name:"Lam Dong",lat:11.9333,lng:108.45,radius:.3},{name:"Ninh Thuan",lat:11.5667,lng:108.9833,radius:.3},{name:"Binh Thuan",lat:10.9333,lng:108.1,radius:.3},{name:"Khanh Hoa",lat:12.25,lng:109.1833,radius:.3},{name:"Phu Yen",lat:13.0833,lng:109.3167,radius:.3},{name:"Dak Lak",lat:12.6667,lng:108.05,radius:.3},{name:"Dak Nong",lat:12,lng:107.6833,radius:.3},{name:"Gia Lai",lat:13.9833,lng:108,radius:.3},{name:"Kon Tum",lat:14.35,lng:108,radius:.3},{name:"Quang Nam",lat:15.8833,lng:108.3333,radius:.3},{name:"Quang Ngai",lat:15.1167,lng:108.8,radius:.3},{name:"Binh Dinh",lat:13.7667,lng:109.2333,radius:.3},{name:"Quang Binh",lat:17.4667,lng:106.6,radius:.3},{name:"Quang Tri",lat:16.75,lng:107.2,radius:.3},{name:"Thua Thien Hue",lat:16.4637,lng:107.5909,radius:.3},{name:"Ha Tinh",lat:18.3333,lng:105.9,radius:.3},{name:"Nghe An",lat:18.6792,lng:105.6919,radius:.3},{name:"Lao Cai",lat:22.4833,lng:103.95,radius:.3},{name:"Dien Bien",lat:21.3833,lng:103.0167,radius:.3},{name:"Lai Chau",lat:22,lng:103.3333,radius:.3},{name:"Son La",lat:21.3167,lng:103.9167,radius:.3},{name:"Yen Bai",lat:21.7,lng:104.8667,radius:.3},{name:"Hoa Binh",lat:20.8167,lng:105.3333,radius:.3},{name:"Lang Son",lat:21.8333,lng:106.75,radius:.3},{name:"Quang Ninh",lat:21.0167,lng:107.3,radius:.3},{name:"Bac Giang",lat:21.2667,lng:106.2,radius:.3},{name:"Phu Tho",lat:21.3,lng:105.4333,radius:.3},{name:"Vinh Phuc",lat:21.3167,lng:105.6,radius:.3},{name:"Bac Ninh",lat:21.1833,lng:106.05,radius:.3},{name:"Hai Duong",lat:20.9333,lng:106.3167,radius:.3},{name:"Hung Yen",lat:20.65,lng:106.0667,radius:.3},{name:"Thai Binh",lat:20.45,lng:106.3333,radius:.3},{name:"Ha Nam",lat:20.55,lng:105.9167,radius:.3},{name:"Ninh Binh",lat:20.25,lng:105.9667,radius:.3},{name:"Long An",lat:10.6,lng:106.1667,radius:.3},{name:"Ba Ria - Vung Tau",lat:10.3459,lng:107.0843,radius:.3}];let Y=null,Z=1/0;for(const J of G){const ie=Math.sqrt(Math.pow(k-J.lat,2)+Math.pow(z-J.lng,2));ie<J.radius&&ie<Z&&(Z=ie,Y=J.name)}return Y||"Current Location"})(P,D);i({city:I,lat:P,lng:D}),y(!1)},j=>{console.error("Error getting current location:",j),alert("Could not get your current location. Please choose a city manually."),y(!1)}):(alert("Geolocation is not supported by your browser."),y(!1))},U=()=>{i({city:"Online Events",lat:0,lng:0}),y(!1)};return g.jsxs("section",{className:"space-y-6",children:[g.jsxs("div",{children:[g.jsx("label",{className:"text-sm text-neutral-500 mb-3 block font-medium",children:"Category"}),g.jsxs("div",{className:"space-y-3",children:[g.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-2",children:[g.jsx("button",{className:`px-4 py-2.5 text-sm rounded-xl border-2 transition-all duration-200 ${e==="all"?"bg-brand-500 text-white border-brand-500 shadow-lg shadow-brand-500/25":"bg-white text-neutral-700 border-neutral-200 hover:border-brand-300 hover:bg-brand-50 hover:shadow-md"}`,onClick:()=>t("all"),children:"All Events"}),E.map(j=>g.jsx("button",{className:`px-4 py-2.5 text-sm rounded-xl border-2 transition-all duration-200 ${e===j?"bg-brand-500 text-white border-brand-500 shadow-lg shadow-brand-500/25":"bg-white text-neutral-700 border-neutral-200 hover:border-brand-300 hover:bg-brand-50 hover:shadow-md"}`,onClick:()=>t(j),children:j},j))]}),g.jsx("button",{className:"text-sm text-brand-600 hover:text-brand-700 font-medium transition-colors",onClick:()=>_(!m),children:m?"Show Less":"Show More"})]})]}),g.jsxs("div",{children:[g.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[g.jsx("span",{className:"text-base text-neutral-700 font-medium",children:"Browsing events in"}),g.jsxs("button",{className:"flex items-center gap-1 text-brand-600 hover:text-brand-700 transition-colors",onClick:()=>y(!v),children:[g.jsx(Bf,{className:`w-4 h-4 transition-transform duration-200 ${v?"rotate-180":""}`}),g.jsx("span",{className:"font-medium",children:n||"All locations"})]})]}),v&&g.jsxs("div",{className:"absolute z-20 mt-2 w-64 bg-white border border-neutral-200 rounded-xl shadow-xl",children:[g.jsx("button",{type:"button",className:"w-full text-left px-4 py-3 hover:bg-neutral-50 border-b border-neutral-100 transition-colors",onClick:T,children:g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsxs("svg",{className:"w-5 h-5 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),g.jsx("span",{className:"text-blue-600 font-medium",children:"Use my current location"})]})}),g.jsx("button",{type:"button",className:"w-full text-left px-4 py-3 hover:bg-neutral-50 transition-colors",onClick:U,children:g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),g.jsx("span",{className:"text-green-600 font-medium",children:"Browse online events"})]})})]})]}),g.jsx("div",{children:g.jsx("div",{className:"border-b border-neutral-200",children:g.jsxs("div",{className:"flex space-x-8",children:[g.jsx("button",{className:`pb-3 px-1 font-medium transition-all duration-200 ${l==="all"?"text-brand-600 border-b-2 border-brand-600":"text-neutral-600 hover:text-neutral-800"}`,onClick:()=>c("all"),children:"All"}),g.jsx("button",{className:`pb-3 px-1 font-medium transition-all duration-200 ${l==="today"?"text-brand-600 border-b-2 border-brand-600":"text-neutral-600 hover:text-neutral-800"}`,onClick:()=>c("today"),children:"Today"}),g.jsx("button",{className:`pb-3 px-1 font-medium transition-all duration-200 ${l==="weekend"?"text-brand-600 border-b-2 border-brand-600":"text-neutral-600 hover:text-neutral-800"}`,onClick:()=>c("weekend"),children:"This weekend"})]})})})]})}const g3="https://images.unsplash.com/photo-1544025162-d76694265947?q=80&w=1600&auto=format&fit=crop";function m3({event:e}){var i,l;const n=new Date(e.start_at).toLocaleString([],{weekday:"short",day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"});return g.jsxs("article",{className:"card overflow-hidden hover:border-neutral-300 transition",children:[g.jsx(bs,{to:`/events/${e.id}`,className:"block",children:g.jsx("div",{className:"aspect-[16/9] bg-neutral-100",children:e.cover_url?g.jsx("img",{src:e.cover_url,alt:e.title,className:"w-full h-full object-cover",loading:"lazy",referrerPolicy:"no-referrer",onError:c=>{const m=c.currentTarget;m.dataset.fallback||(m.dataset.fallback="1",m.src=g3)}}):g.jsx("div",{className:"w-full h-full grid place-items-center text-neutral-400",children:"No image"})})}),g.jsxs("div",{className:"p-4 space-y-3",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"badge",children:e.category}),e.distance_m!=null&&g.jsxs("span",{className:"badge",children:[(e.distance_m/1e3).toFixed(1)," km"]}),g.jsxs("span",{className:"badge",children:[Math.max(0,e.remaining??0)," left"]}),g.jsxs("span",{className:"ml-auto text-sm text-neutral-600",children:["From ",(e.min_price/1e3).toFixed(0),"k VND"]})]}),g.jsxs(bs,{to:`/events/${e.id}`,className:"block",children:[g.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:e.title}),g.jsx("p",{className:"text-sm text-neutral-600 line-clamp-2",children:e.description}),g.jsxs("div",{className:"flex items-center gap-4 text-sm text-neutral-700",children:[g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx(Qc,{className:"size-4"})," ",n]}),g.jsxs("div",{className:"flex items-start gap-1",children:[g.jsx(na,{className:"size-4 mt-0.5 flex-shrink-0"}),g.jsxs("div",{children:[g.jsx("div",{className:"font-medium",children:((i=e.venue)==null?void 0:i.name)||"TBA"}),((l=e.venue)==null?void 0:l.address)&&g.jsx("div",{className:"text-xs text-neutral-500 mt-0.5",children:e.venue.address})]})]})]})]})]})]})}function px({events:e}){return e.length===0?g.jsx("div",{className:"card p-10 text-center text-neutral-400",children:"No events match your filters. Try widening your search."}):g.jsx("section",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(t=>g.jsx(m3,{event:t},t.id))})}function p3(){const{user:e}=ur(),{userLocation:t}=Nu(),[n,i]=H.useState([]),[l,c]=H.useState(!0),[m,_]=H.useState(""),[v,y]=H.useState("all"),[S,E]=H.useState(""),[T,U]=H.useState("all"),j=H.useCallback(async()=>{c(!0);try{const D=(t==null?void 0:t.lat)??null,R=(t==null?void 0:t.lng)??null,{data:I,error:k}=await Re.rpc("events_explore",{p_lat:D,p_lng:R,p_radius_km:50,p_start_from:new Date().toISOString(),p_q:m||null,p_category:v==="all"?null:v,p_price_min:null,p_price_max:null});if(k){console.error("events_explore RPC error",k),i([]);return}if(I)for(const G of I){const{data:Y,error:Z}=await Re.rpc("tier_inventory",{p_event:G.id});!Z&&Y&&(G.ticket_tiers=Y.map(J=>({id:J.id,name:J.name,price:J.price,quota:J.quota,sold:Number(J.sold)||0,remaining:J.remaining})))}const z=(I||[]).map(G=>({id:G.id,title:G.title,description:G.description,category:G.category,start_at:G.start_at,end_at:G.end_at,venue:{name:G.venue_name||"TBD",latitude:G.venue_latitude,longitude:G.venue_longitude,address:G.venue_address},capacity:G.capacity||0,min_price:G.min_price||0,max_price:G.max_price||0,cover_url:G.cover_url||"",status:G.status,creator_id:G.creator_id,tiers:G.ticket_tiers||[],distance_m:G.distance_m}));i(z)}catch(D){console.error("Error loading events:",D),i([])}finally{c(!1)}},[t.lat,t.lng,v,m]);H.useEffect(()=>{j();const D=()=>{console.log("Events update event received, reloading events..."),j()},R=()=>{console.log("Account switch detected, reloading events..."),j()};return window.addEventListener("suki:events_updated",D),window.addEventListener("suki:account_switched",R),()=>{window.removeEventListener("suki:events_updated",D),window.removeEventListener("suki:account_switched",R)}},[j]),H.useEffect(()=>{const D=Re.channel("all-event-tickets").on("postgres_changes",{event:"*",schema:"public",table:"tickets"},R=>{j()}).subscribe();return()=>{D.unsubscribe()}},[j]),H.useEffect(()=>{const D=()=>{document.hidden||j()};return document.addEventListener("visibilitychange",D),()=>{document.removeEventListener("visibilitychange",D)}},[j]),H.useEffect(()=>{var D;if((D=e==null?void 0:e.user_metadata)!=null&&D.city){const R=e.user_metadata.city;E(R)}},[e]),H.useEffect(()=>{E(t.city)},[t]);const P=H.useMemo(()=>n.filter(R=>{let I=!0;if(T!=="all"){const k=new Date(R.start_at),z=new Date,G=new Date(z.getFullYear(),z.getMonth(),z.getDate()),Y=new Date(G);if(Y.setDate(Y.getDate()+1),T==="today")I=k>=G&&k<Y;else if(T==="weekend"){const Z=G.getDay();let J,ie;if(Z===0)J=new Date(G),J.setDate(J.getDate()-1),ie=new Date(G),ie.setDate(ie.getDate()+1);else if(Z===6)J=new Date(G),ie=new Date(G),ie.setDate(ie.getDate()+2);else{const Ee=(6-Z+7)%7;J=new Date(G),J.setDate(J.getDate()+Ee),ie=new Date(J),ie.setDate(ie.getDate()+2)}I=k>=J&&k<ie}}return I}),[n,T]);return l?g.jsxs("div",{className:"min-h-screen bg-gray-50",children:[g.jsx(It,{searchTerm:m,setSearchTerm:_}),g.jsx("div",{className:"container mx-auto px-4 py-8",children:g.jsx("div",{className:"flex justify-center items-center h-64",children:g.jsx("div",{className:"loading loading-spinner loading-lg"})})})]}):g.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-white",children:[g.jsx(It,{searchTerm:m,setSearchTerm:_}),g.jsxs("div",{className:"container mx-auto px-6 py-12",children:[g.jsx("div",{className:"mb-16",children:g.jsxs("div",{className:"text-center relative",children:[g.jsxs("div",{className:"absolute inset-0 -z-10",children:[g.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 w-96 h-96 bg-gradient-to-br from-brand-100/30 to-purple-100/30 rounded-full blur-3xl"}),g.jsx("div",{className:"absolute bottom-0 right-0 w-64 h-64 bg-gradient-to-tl from-blue-100/30 to-cyan-100/30 rounded-full blur-2xl"}),g.jsx("div",{className:"absolute top-1/2 left-0 w-48 h-48 bg-gradient-to-r from-pink-100/30 to-rose-100/30 rounded-full blur-xl"})]}),g.jsx("h1",{className:"text-6xl md:text-7xl font-black bg-gradient-to-r from-gray-900 via-brand-600 to-purple-700 bg-clip-text text-transparent mb-8",style:{lineHeight:"1.6"},children:"Discover Amazing Events"}),g.jsxs("p",{className:"text-xl md:text-2xl text-gray-600 max-w-4xl mx-auto mb-12 leading-relaxed font-light",children:["Find and join events that match your interests, happening",g.jsx("span",{className:"text-brand-600 font-semibold",children:" near you "}),"or",g.jsx("span",{className:"text-purple-600 font-semibold",children:" online"})]}),g.jsx("div",{className:"w-24 h-1 bg-gradient-to-r from-brand-500 to-purple-500 mx-auto rounded-full mb-8"})]})}),g.jsx("div",{className:"mb-12",children:g.jsx(mx,{selectedCategory:v,onCategoryChange:y,browsingLocation:S||"All locations",onLocationChange:D=>{D.city==="Online Events"?E("Online Events"):D.city==="Current Location"&&E("Current Location")},selectedTimeFilter:T,onTimeFilterChange:U})}),g.jsxs("div",{className:"mb-12",children:[g.jsxs("div",{className:"flex items-center justify-between mb-8",children:[g.jsxs("h2",{className:"text-3xl font-bold text-gray-900",children:[P.length," Event",P.length!==1?"s":""," Found"]}),S&&S!=="All locations"&&g.jsxs("div",{className:"text-sm text-gray-500 bg-gray-100 px-3 py-1 rounded-full",children:["in ",S]})]}),g.jsx(px,{events:P})]})]})]})}var x3=Object.defineProperty,eu=Object.getOwnPropertySymbols,xx=Object.prototype.hasOwnProperty,yx=Object.prototype.propertyIsEnumerable,$1=(e,t,n)=>t in e?x3(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,X1=(e,t)=>{for(var n in t||(t={}))xx.call(t,n)&&$1(e,n,t[n]);if(eu)for(var n of eu(t))yx.call(t,n)&&$1(e,n,t[n]);return e},y3=(e,t)=>{var n={};for(var i in e)xx.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&eu)for(var i of eu(e))t.indexOf(i)<0&&yx.call(e,i)&&(n[i]=e[i]);return n};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var ao;(e=>{const t=class{constructor(v,y,S,E){if(this.version=v,this.errorCorrectionLevel=y,this.modules=[],this.isFunction=[],v<t.MIN_VERSION||v>t.MAX_VERSION)throw new RangeError("Version value out of range");if(E<-1||E>7)throw new RangeError("Mask value out of range");this.size=v*4+17;let T=[];for(let j=0;j<this.size;j++)T.push(!1);for(let j=0;j<this.size;j++)this.modules.push(T.slice()),this.isFunction.push(T.slice());this.drawFunctionPatterns();const U=this.addEccAndInterleave(S);if(this.drawCodewords(U),E==-1){let j=1e9;for(let P=0;P<8;P++){this.applyMask(P),this.drawFormatBits(P);const D=this.getPenaltyScore();D<j&&(E=P,j=D),this.applyMask(P)}}c(0<=E&&E<=7),this.mask=E,this.applyMask(E),this.drawFormatBits(E),this.isFunction=[]}static encodeText(v,y){const S=e.QrSegment.makeSegments(v);return t.encodeSegments(S,y)}static encodeBinary(v,y){const S=e.QrSegment.makeBytes(v);return t.encodeSegments([S],y)}static encodeSegments(v,y,S=1,E=40,T=-1,U=!0){if(!(t.MIN_VERSION<=S&&S<=E&&E<=t.MAX_VERSION)||T<-1||T>7)throw new RangeError("Invalid value");let j,P;for(j=S;;j++){const k=t.getNumDataCodewords(j,y)*8,z=_.getTotalBits(v,j);if(z<=k){P=z;break}if(j>=E)throw new RangeError("Data too long")}for(const k of[t.Ecc.MEDIUM,t.Ecc.QUARTILE,t.Ecc.HIGH])U&&P<=t.getNumDataCodewords(j,k)*8&&(y=k);let D=[];for(const k of v){i(k.mode.modeBits,4,D),i(k.numChars,k.mode.numCharCountBits(j),D);for(const z of k.getData())D.push(z)}c(D.length==P);const R=t.getNumDataCodewords(j,y)*8;c(D.length<=R),i(0,Math.min(4,R-D.length),D),i(0,(8-D.length%8)%8,D),c(D.length%8==0);for(let k=236;D.length<R;k^=253)i(k,8,D);let I=[];for(;I.length*8<D.length;)I.push(0);return D.forEach((k,z)=>I[z>>>3]|=k<<7-(z&7)),new t(j,y,I,T)}getModule(v,y){return 0<=v&&v<this.size&&0<=y&&y<this.size&&this.modules[y][v]}getModules(){return this.modules}drawFunctionPatterns(){for(let S=0;S<this.size;S++)this.setFunctionModule(6,S,S%2==0),this.setFunctionModule(S,6,S%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const v=this.getAlignmentPatternPositions(),y=v.length;for(let S=0;S<y;S++)for(let E=0;E<y;E++)S==0&&E==0||S==0&&E==y-1||S==y-1&&E==0||this.drawAlignmentPattern(v[S],v[E]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(v){const y=this.errorCorrectionLevel.formatBits<<3|v;let S=y;for(let T=0;T<10;T++)S=S<<1^(S>>>9)*1335;const E=(y<<10|S)^21522;c(E>>>15==0);for(let T=0;T<=5;T++)this.setFunctionModule(8,T,l(E,T));this.setFunctionModule(8,7,l(E,6)),this.setFunctionModule(8,8,l(E,7)),this.setFunctionModule(7,8,l(E,8));for(let T=9;T<15;T++)this.setFunctionModule(14-T,8,l(E,T));for(let T=0;T<8;T++)this.setFunctionModule(this.size-1-T,8,l(E,T));for(let T=8;T<15;T++)this.setFunctionModule(8,this.size-15+T,l(E,T));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let v=this.version;for(let S=0;S<12;S++)v=v<<1^(v>>>11)*7973;const y=this.version<<12|v;c(y>>>18==0);for(let S=0;S<18;S++){const E=l(y,S),T=this.size-11+S%3,U=Math.floor(S/3);this.setFunctionModule(T,U,E),this.setFunctionModule(U,T,E)}}drawFinderPattern(v,y){for(let S=-4;S<=4;S++)for(let E=-4;E<=4;E++){const T=Math.max(Math.abs(E),Math.abs(S)),U=v+E,j=y+S;0<=U&&U<this.size&&0<=j&&j<this.size&&this.setFunctionModule(U,j,T!=2&&T!=4)}}drawAlignmentPattern(v,y){for(let S=-2;S<=2;S++)for(let E=-2;E<=2;E++)this.setFunctionModule(v+E,y+S,Math.max(Math.abs(E),Math.abs(S))!=1)}setFunctionModule(v,y,S){this.modules[y][v]=S,this.isFunction[y][v]=!0}addEccAndInterleave(v){const y=this.version,S=this.errorCorrectionLevel;if(v.length!=t.getNumDataCodewords(y,S))throw new RangeError("Invalid argument");const E=t.NUM_ERROR_CORRECTION_BLOCKS[S.ordinal][y],T=t.ECC_CODEWORDS_PER_BLOCK[S.ordinal][y],U=Math.floor(t.getNumRawDataModules(y)/8),j=E-U%E,P=Math.floor(U/E);let D=[];const R=t.reedSolomonComputeDivisor(T);for(let k=0,z=0;k<E;k++){let G=v.slice(z,z+P-T+(k<j?0:1));z+=G.length;const Y=t.reedSolomonComputeRemainder(G,R);k<j&&G.push(0),D.push(G.concat(Y))}let I=[];for(let k=0;k<D[0].length;k++)D.forEach((z,G)=>{(k!=P-T||G>=j)&&I.push(z[k])});return c(I.length==U),I}drawCodewords(v){if(v.length!=Math.floor(t.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let y=0;for(let S=this.size-1;S>=1;S-=2){S==6&&(S=5);for(let E=0;E<this.size;E++)for(let T=0;T<2;T++){const U=S-T,P=(S+1&2)==0?this.size-1-E:E;!this.isFunction[P][U]&&y<v.length*8&&(this.modules[P][U]=l(v[y>>>3],7-(y&7)),y++)}}c(y==v.length*8)}applyMask(v){if(v<0||v>7)throw new RangeError("Mask value out of range");for(let y=0;y<this.size;y++)for(let S=0;S<this.size;S++){let E;switch(v){case 0:E=(S+y)%2==0;break;case 1:E=y%2==0;break;case 2:E=S%3==0;break;case 3:E=(S+y)%3==0;break;case 4:E=(Math.floor(S/3)+Math.floor(y/2))%2==0;break;case 5:E=S*y%2+S*y%3==0;break;case 6:E=(S*y%2+S*y%3)%2==0;break;case 7:E=((S+y)%2+S*y%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[y][S]&&E&&(this.modules[y][S]=!this.modules[y][S])}}getPenaltyScore(){let v=0;for(let T=0;T<this.size;T++){let U=!1,j=0,P=[0,0,0,0,0,0,0];for(let D=0;D<this.size;D++)this.modules[T][D]==U?(j++,j==5?v+=t.PENALTY_N1:j>5&&v++):(this.finderPenaltyAddHistory(j,P),U||(v+=this.finderPenaltyCountPatterns(P)*t.PENALTY_N3),U=this.modules[T][D],j=1);v+=this.finderPenaltyTerminateAndCount(U,j,P)*t.PENALTY_N3}for(let T=0;T<this.size;T++){let U=!1,j=0,P=[0,0,0,0,0,0,0];for(let D=0;D<this.size;D++)this.modules[D][T]==U?(j++,j==5?v+=t.PENALTY_N1:j>5&&v++):(this.finderPenaltyAddHistory(j,P),U||(v+=this.finderPenaltyCountPatterns(P)*t.PENALTY_N3),U=this.modules[D][T],j=1);v+=this.finderPenaltyTerminateAndCount(U,j,P)*t.PENALTY_N3}for(let T=0;T<this.size-1;T++)for(let U=0;U<this.size-1;U++){const j=this.modules[T][U];j==this.modules[T][U+1]&&j==this.modules[T+1][U]&&j==this.modules[T+1][U+1]&&(v+=t.PENALTY_N2)}let y=0;for(const T of this.modules)y=T.reduce((U,j)=>U+(j?1:0),y);const S=this.size*this.size,E=Math.ceil(Math.abs(y*20-S*10)/S)-1;return c(0<=E&&E<=9),v+=E*t.PENALTY_N4,c(0<=v&&v<=2568888),v}getAlignmentPatternPositions(){if(this.version==1)return[];{const v=Math.floor(this.version/7)+2,y=this.version==32?26:Math.ceil((this.version*4+4)/(v*2-2))*2;let S=[6];for(let E=this.size-7;S.length<v;E-=y)S.splice(1,0,E);return S}}static getNumRawDataModules(v){if(v<t.MIN_VERSION||v>t.MAX_VERSION)throw new RangeError("Version number out of range");let y=(16*v+128)*v+64;if(v>=2){const S=Math.floor(v/7)+2;y-=(25*S-10)*S-55,v>=7&&(y-=36)}return c(208<=y&&y<=29648),y}static getNumDataCodewords(v,y){return Math.floor(t.getNumRawDataModules(v)/8)-t.ECC_CODEWORDS_PER_BLOCK[y.ordinal][v]*t.NUM_ERROR_CORRECTION_BLOCKS[y.ordinal][v]}static reedSolomonComputeDivisor(v){if(v<1||v>255)throw new RangeError("Degree out of range");let y=[];for(let E=0;E<v-1;E++)y.push(0);y.push(1);let S=1;for(let E=0;E<v;E++){for(let T=0;T<y.length;T++)y[T]=t.reedSolomonMultiply(y[T],S),T+1<y.length&&(y[T]^=y[T+1]);S=t.reedSolomonMultiply(S,2)}return y}static reedSolomonComputeRemainder(v,y){let S=y.map(E=>0);for(const E of v){const T=E^S.shift();S.push(0),y.forEach((U,j)=>S[j]^=t.reedSolomonMultiply(U,T))}return S}static reedSolomonMultiply(v,y){if(v>>>8||y>>>8)throw new RangeError("Byte out of range");let S=0;for(let E=7;E>=0;E--)S=S<<1^(S>>>7)*285,S^=(y>>>E&1)*v;return c(S>>>8==0),S}finderPenaltyCountPatterns(v){const y=v[1];c(y<=this.size*3);const S=y>0&&v[2]==y&&v[3]==y*3&&v[4]==y&&v[5]==y;return(S&&v[0]>=y*4&&v[6]>=y?1:0)+(S&&v[6]>=y*4&&v[0]>=y?1:0)}finderPenaltyTerminateAndCount(v,y,S){return v&&(this.finderPenaltyAddHistory(y,S),y=0),y+=this.size,this.finderPenaltyAddHistory(y,S),this.finderPenaltyCountPatterns(S)}finderPenaltyAddHistory(v,y){y[0]==0&&(v+=this.size),y.pop(),y.unshift(v)}};let n=t;n.MIN_VERSION=1,n.MAX_VERSION=40,n.PENALTY_N1=3,n.PENALTY_N2=3,n.PENALTY_N3=40,n.PENALTY_N4=10,n.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],n.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=n;function i(v,y,S){if(y<0||y>31||v>>>y)throw new RangeError("Value out of range");for(let E=y-1;E>=0;E--)S.push(v>>>E&1)}function l(v,y){return(v>>>y&1)!=0}function c(v){if(!v)throw new Error("Assertion error")}const m=class{constructor(v,y,S){if(this.mode=v,this.numChars=y,this.bitData=S,y<0)throw new RangeError("Invalid argument");this.bitData=S.slice()}static makeBytes(v){let y=[];for(const S of v)i(S,8,y);return new m(m.Mode.BYTE,v.length,y)}static makeNumeric(v){if(!m.isNumeric(v))throw new RangeError("String contains non-numeric characters");let y=[];for(let S=0;S<v.length;){const E=Math.min(v.length-S,3);i(parseInt(v.substr(S,E),10),E*3+1,y),S+=E}return new m(m.Mode.NUMERIC,v.length,y)}static makeAlphanumeric(v){if(!m.isAlphanumeric(v))throw new RangeError("String contains unencodable characters in alphanumeric mode");let y=[],S;for(S=0;S+2<=v.length;S+=2){let E=m.ALPHANUMERIC_CHARSET.indexOf(v.charAt(S))*45;E+=m.ALPHANUMERIC_CHARSET.indexOf(v.charAt(S+1)),i(E,11,y)}return S<v.length&&i(m.ALPHANUMERIC_CHARSET.indexOf(v.charAt(S)),6,y),new m(m.Mode.ALPHANUMERIC,v.length,y)}static makeSegments(v){return v==""?[]:m.isNumeric(v)?[m.makeNumeric(v)]:m.isAlphanumeric(v)?[m.makeAlphanumeric(v)]:[m.makeBytes(m.toUtf8ByteArray(v))]}static makeEci(v){let y=[];if(v<0)throw new RangeError("ECI assignment value out of range");if(v<128)i(v,8,y);else if(v<16384)i(2,2,y),i(v,14,y);else if(v<1e6)i(6,3,y),i(v,21,y);else throw new RangeError("ECI assignment value out of range");return new m(m.Mode.ECI,0,y)}static isNumeric(v){return m.NUMERIC_REGEX.test(v)}static isAlphanumeric(v){return m.ALPHANUMERIC_REGEX.test(v)}getData(){return this.bitData.slice()}static getTotalBits(v,y){let S=0;for(const E of v){const T=E.mode.numCharCountBits(y);if(E.numChars>=1<<T)return 1/0;S+=4+T+E.bitData.length}return S}static toUtf8ByteArray(v){v=encodeURI(v);let y=[];for(let S=0;S<v.length;S++)v.charAt(S)!="%"?y.push(v.charCodeAt(S)):(y.push(parseInt(v.substr(S+1,2),16)),S+=2);return y}};let _=m;_.NUMERIC_REGEX=/^[0-9]*$/,_.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,_.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",e.QrSegment=_})(ao||(ao={}));(e=>{(t=>{const n=class{constructor(l,c){this.ordinal=l,this.formatBits=c}};let i=n;i.LOW=new n(0,1),i.MEDIUM=new n(1,0),i.QUARTILE=new n(2,3),i.HIGH=new n(3,2),t.Ecc=i})(e.QrCode||(e.QrCode={}))})(ao||(ao={}));(e=>{(t=>{const n=class{constructor(l,c){this.modeBits=l,this.numBitsCharCount=c}numCharCountBits(l){return this.numBitsCharCount[Math.floor((l+7)/17)]}};let i=n;i.NUMERIC=new n(1,[10,12,14]),i.ALPHANUMERIC=new n(2,[9,11,13]),i.BYTE=new n(4,[8,16,16]),i.KANJI=new n(8,[8,10,12]),i.ECI=new n(7,[0,0,0]),t.Mode=i})(e.QrSegment||(e.QrSegment={}))})(ao||(ao={}));var Ha=ao;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var v3={L:Ha.QrCode.Ecc.LOW,M:Ha.QrCode.Ecc.MEDIUM,Q:Ha.QrCode.Ecc.QUARTILE,H:Ha.QrCode.Ecc.HIGH},w3=128,_3="L",b3="#FFFFFF",C3="#000000",E3=!1,vx=4,S3=.1;function A3(e,t=0){const n=[];return e.forEach(function(i,l){let c=null;i.forEach(function(m,_){if(!m&&c!==null){n.push(`M${c+t} ${l+t}h${_-c}v1H${c+t}z`),c=null;return}if(_===i.length-1){if(!m)return;c===null?n.push(`M${_+t},${l+t} h1v1H${_+t}z`):n.push(`M${c+t},${l+t} h${_+1-c}v1H${c+t}z`);return}m&&c===null&&(c=_)})}),n.join("")}function N3(e,t){return e.slice().map((n,i)=>i<t.y||i>=t.y+t.h?n:n.map((l,c)=>c<t.x||c>=t.x+t.w?l:!1))}function T3(e,t,n,i){if(i==null)return null;const l=n?vx:0,c=e.length+l*2,m=Math.floor(t*S3),_=c/t,v=(i.width||m)*_,y=(i.height||m)*_,S=i.x==null?e.length/2-v/2:i.x*_,E=i.y==null?e.length/2-y/2:i.y*_;let T=null;if(i.excavate){let U=Math.floor(S),j=Math.floor(E),P=Math.ceil(v+S-U),D=Math.ceil(y+E-j);T={x:U,y:j,w:P,h:D}}return{x:S,y:E,h:y,w:v,excavation:T}}var I3=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}();function wx(e){const t=e,{value:n,size:i=w3,level:l=_3,bgColor:c=b3,fgColor:m=C3,includeMargin:_=E3,style:v,imageSettings:y}=t,S=y3(t,["value","size","level","bgColor","fgColor","includeMargin","style","imageSettings"]),E=y==null?void 0:y.src,T=qn.useRef(null),U=qn.useRef(null),[j,P]=qn.useState(!1);qn.useEffect(()=>{if(T.current!=null){const I=T.current,k=I.getContext("2d");if(!k)return;let z=Ha.QrCode.encodeText(n,v3[l]).getModules();const G=_?vx:0,Y=z.length+G*2,Z=T3(z,i,_,y),J=U.current,ie=Z!=null&&J!==null&&J.complete&&J.naturalHeight!==0&&J.naturalWidth!==0;ie&&Z.excavation!=null&&(z=N3(z,Z.excavation));const Ee=window.devicePixelRatio||1;I.height=I.width=i*Ee;const ce=i/Y*Ee;k.scale(ce,ce),k.fillStyle=c,k.fillRect(0,0,Y,Y),k.fillStyle=m,I3?k.fill(new Path2D(A3(z,G))):z.forEach(function(ue,Ie){ue.forEach(function(Te,Q){Te&&k.fillRect(Q+G,Ie+G,1,1)})}),ie&&k.drawImage(J,Z.x+G,Z.y+G,Z.w,Z.h)}}),qn.useEffect(()=>{P(!1)},[E]);const D=X1({height:i,width:i},v);let R=null;return E!=null&&(R=qn.createElement("img",{src:E,key:E,style:{display:"none"},onLoad:()=>{P(!0)},ref:U})),qn.createElement(qn.Fragment,null,qn.createElement("canvas",X1({style:D,height:i,width:i,ref:T},S)),R)}const wd="suki_offline_tickets",_d="suki_offline_tickets_timestamp",k3=24*60*60*1e3;function M3(){const{user:e}=ur(),{userLocation:t}=Nu(),[n,i]=H.useState([]),[l,c]=H.useState(!0),[m,_]=H.useState(!1),v=E=>{try{localStorage.setItem(wd,JSON.stringify(E)),localStorage.setItem(_d,Date.now().toString()),console.log("Tickets saved to offline storage")}catch(T){console.error("Error saving tickets to offline storage:",T)}},y=()=>{try{const E=localStorage.getItem(_d),T=localStorage.getItem(wd);if(E&&T){if(Date.now()-parseInt(E)<k3)return console.log("Loading tickets from offline storage"),JSON.parse(T);console.log("Offline cache expired, clearing old data"),localStorage.removeItem(wd),localStorage.removeItem(_d)}}catch(E){console.error("Error loading tickets from offline storage:",E)}return null},S=()=>{const E=navigator.onLine;return _(!E),E};return H.useEffect(()=>{if(!e){c(!1);return}const E=async()=>{try{if(c(!0),S())try{const{data:D,error:R}=await Re.from("tickets").select(`
                id,
                qr_token,
                created_at,
                event_id,
                tier_id,
                orders!inner(
                  id,
                  total_amount,
                  status,
                  created_at
                ),
                events!inner(
                  id,
                  title,
                  description,
                  start_at,
                  end_at,
                  cover_url,
                  venue_id,
                  venues(name)
                ),
                ticket_tiers(
                  id,
                  name,
                  price
                )
              `).eq("orders.user_id",e.id).order("created_at",{ascending:!1});if(R)throw console.error("Error fetching tickets from Supabase:",R),R;console.log("Tickets loaded from Supabase:",D),D&&D.length>0&&v(D),i(D||[]);return}catch(D){console.error("Supabase fetch failed, trying offline storage:",D)}const P=y();P?(console.log("Using offline tickets:",P),i(P)):(console.log("No offline tickets available"),i([]))}catch(j){console.error("Error loading tickets:",j);const P=y();i(P||[])}finally{c(!1)}};E();const T=()=>{console.log("Events update event received in Tickets, reloading tickets..."),e&&E()},U=()=>{S()&&e&&(console.log("Back online, refreshing tickets..."),E())};return window.addEventListener("suki:events_updated",T),window.addEventListener("online",U),window.addEventListener("offline",U),()=>{window.removeEventListener("suki:events_updated",T),window.removeEventListener("online",U),window.removeEventListener("offline",U)}},[e]),g.jsxs("div",{className:"min-h-screen",children:[g.jsx(It,{searchTerm:"",setSearchTerm:()=>{}}),g.jsxs("main",{className:"container mt-6 space-y-4",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("h1",{className:"text-2xl font-semibold",children:"My Tickets"}),m&&g.jsxs("div",{className:"badge badge-warning gap-2",children:[g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),"Offline Mode"]})]}),e?l?g.jsxs("div",{className:"card p-10 text-center text-neutral-700",children:[g.jsx("div",{className:"loading loading-spinner loading-lg mb-4"}),g.jsx("p",{children:"Loading your tickets..."})]}):n.length===0?g.jsxs("div",{className:"card p-10 text-center text-neutral-700",children:[g.jsx("p",{className:"mb-4",children:"You don't have any tickets yet."}),g.jsx("p",{className:"text-sm text-neutral-500",children:"Discover events and purchase tickets to see them here."})]}):g.jsxs(g.Fragment,{children:[m&&g.jsxs("div",{className:"card p-4 bg-blue-50 border-blue-200",children:[g.jsxs("div",{className:"flex items-center gap-2 text-blue-800",children:[g.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"})}),g.jsx("span",{className:"font-medium",children:"Offline Mode Active"})]}),g.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Your tickets are loaded from offline storage. QR codes are fully functional without internet connection."})]}),g.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(E=>{var T;return g.jsxs("article",{className:"card p-4 space-y-3",children:[g.jsxs("div",{className:"flex items-start justify-between",children:[g.jsx("h3",{className:"font-semibold text-neutral-900",children:E.events.title}),g.jsx("span",{className:`badge ${E.orders.status==="paid"?"badge-success":"badge-warning"}`,children:E.orders.status})]}),g.jsxs("div",{className:"text-sm text-neutral-600",children:[g.jsx("p",{children:new Date(E.events.start_at).toLocaleDateString()}),g.jsxs("p",{children:[new Date(E.events.start_at).toLocaleTimeString()," - ",new Date(E.events.end_at).toLocaleTimeString()]}),g.jsx("p",{className:"text-neutral-500",children:((T=E.events.venues)==null?void 0:T.name)||"TBD"}),E.ticket_tiers&&g.jsxs("div",{className:"mt-2 p-2 bg-blue-50 rounded border border-blue-200",children:[g.jsx("div",{className:"text-xs font-medium text-blue-900",children:E.ticket_tiers.name}),g.jsx("div",{className:"text-xs text-blue-700",children:E.ticket_tiers.price===0?"Free":`${E.ticket_tiers.price.toLocaleString()} VND`})]})]}),g.jsx("div",{className:"bg-white inline-block p-2 rounded border border-neutral-200",children:g.jsx(wx,{value:E.qr_token||`ticket-${E.id}`,size:120})}),g.jsxs("div",{className:"text-xs text-neutral-500",children:[g.jsxs("p",{children:["Order: #",E.orders.id]}),g.jsxs("p",{children:["Ticket ID: ",E.id]}),g.jsxs("p",{children:["Purchased: ",new Date(E.orders.created_at).toLocaleDateString()]})]})]},E.id)})})]}):g.jsxs("div",{className:"card p-10 text-center text-neutral-700",children:[g.jsx("p",{className:"mb-4",children:"Please sign in to view your tickets."}),g.jsx("a",{href:"/auth",className:"btn btn-primary",children:"Sign In"})]})]})]})}function O3(){const{user:e,signInWithEmail:t,signInWithApple:n,signInWithFacebook:i,signInWithGoogle:l,loading:c,emailSent:m}=ur(),[_,v]=H.useState(""),[y,S]=H.useState("signup"),[E,T]=H.useState(""),[U,j]=H.useState(""),P=async()=>{try{T(""),j("");const R=y==="signup";console.log("[Auth] Calling signInWithEmail with:",{email:_,isSignUp:R});const I=await t(_,R);console.log("[Auth] Result received:",I),I&&I.success?j(I.message):T("Unexpected response from sign-in service")}catch(R){console.error("[Auth] Error in handleSend:",R),T(R.message||"An unexpected error occurred")}},D=async R=>{try{T(""),j("");let I;switch(R){case"apple":I=await n();break;case"facebook":I=await i();break;case"google":I=await l();break;default:throw new Error("Unknown provider")}I.success&&j("Redirecting to sign in...")}catch(I){T(I.message)}};return e?g.jsxs("div",{className:"min-h-screen",children:[g.jsx(It,{userLocation:{city:"HCMC",lat:10.7769,lng:106.7009},setUserLocation:()=>{}}),g.jsx("div",{className:"container mt-10",children:g.jsxs("div",{className:"card p-6",children:[g.jsxs("p",{children:["You are signed in as ",g.jsx("span",{className:"font-medium",children:e.email}),"."]}),g.jsx("a",{href:"/profile",className:"btn btn-primary mt-4",children:"Go to Profile"})]})})]}):g.jsxs("div",{className:"min-h-screen",children:[g.jsx(It,{userLocation:{city:"HCMC",lat:10.7769,lng:106.7009},setUserLocation:()=>{}}),g.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-80px)]",children:g.jsx("div",{className:"w-full max-w-md",children:g.jsxs("div",{className:"card p-8 space-y-6",children:[g.jsxs("div",{className:"text-center",children:[g.jsx("h1",{className:"text-2xl font-semibold mb-2",children:"Welcome!"}),g.jsx("p",{className:"text-gray-600",children:"Choose your preferred sign-in method"})]}),g.jsxs("div",{className:"flex border-b border-gray-200",children:[g.jsx("button",{className:`flex-1 py-2 px-4 text-sm font-medium border-b-2 transition-colors ${y==="signup"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>S("signup"),children:"Sign Up"}),g.jsx("button",{className:`flex-1 py-2 px-4 text-sm font-medium border-b-2 transition-colors ${y==="signin"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>S("signin"),children:"Sign In"})]}),!m&&g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"space-y-3",children:[g.jsx("button",{className:"btn btn-ghost w-full",onClick:()=>D("apple"),disabled:c,children:"Continue with Apple"}),g.jsx("button",{className:"btn btn-ghost w-full",onClick:()=>D("facebook"),disabled:c,children:"Continue with Facebook"}),g.jsx("button",{className:"btn btn-ghost w-full",onClick:()=>D("google"),disabled:c,children:"Continue with Google"})]}),g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"absolute inset-0 flex items-center",children:g.jsx("div",{className:"w-full border-t border-gray-300"})}),g.jsx("div",{className:"relative flex justify-center text-sm",children:g.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or continue with email"})})]}),g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium mb-2",children:"Email Address"}),g.jsx("input",{className:"input w-full",type:"email",placeholder:"you@email.com",value:_,onChange:R=>v(R.target.value),disabled:c,autoFocus:!0})]}),y==="signup"&&g.jsx("p",{className:"text-xs text-gray-500",children:"We'll send you a confirmation email to verify your account."}),y==="signin"&&g.jsx("p",{className:"text-xs text-gray-500",children:"Enter your email to receive a sign-in link."}),g.jsx("button",{className:"btn btn-primary w-full",onClick:P,disabled:c||!_.trim(),children:c?"Sending...":y==="signup"?"Sign Up":"Sign In"})]})]}),m&&g.jsxs("div",{className:"space-y-4 text-center",children:[g.jsxs("div",{className:"text-blue-600",children:[g.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),g.jsx("p",{className:"text-lg font-medium",children:"Check your email!"}),g.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["We've sent a confirmation link to ",g.jsx("span",{className:"font-medium",children:_})]}),g.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Click the link in your email to ",y==="signup"?"complete your sign up":"sign in",". The link will expire in 24 hours."]})]}),g.jsxs("div",{className:"space-y-3",children:[g.jsx("button",{className:"btn btn-link text-sm",onClick:()=>{setEmailSent(!1),v(""),j("")},children:"Use a different email"}),g.jsx("button",{className:"btn btn-link text-sm",onClick:P,disabled:c,children:c?"Sending...":"Resend confirmation email"})]})]}),U&&g.jsx("div",{className:"alert alert-success",children:g.jsx("span",{children:U})}),E&&g.jsx("div",{className:"alert alert-error",children:g.jsx("span",{children:E})})]})})})]})}function L3(){const e=zi(),[t]=Fp(),[n,i]=H.useState("Processing..."),[l,c]=H.useState(null);return H.useEffect(()=>{(async()=>{try{i("Processing authentication..."),console.log("[AuthCallback] Current URL:",window.location.href),console.log("[AuthCallback] Search params:",Object.fromEntries(t.entries())),console.log("[AuthCallback] Hash:",window.location.hash),console.log("[AuthCallback] Origin:",window.location.origin),console.log("[AuthCallback] Expected callback URL:",`${window.location.origin}/auth/callback`),window.location.href.includes("/auth/callback")||console.warn("[AuthCallback] Warning: Not on expected callback URL");const _=t.get("error"),v=t.get("error_description");if(_)throw new Error(v||`Authentication failed: ${_}`);const y=new URLSearchParams(window.location.hash.substring(1)),S=y.get("access_token"),E=y.get("refresh_token"),T=y.get("error"),U=y.get("error_description"),j=y.get("error_code");if(console.log("[AuthCallback] Hash params:",{accessToken:!!S,refreshToken:!!E,hashError:T,hashErrorDescription:U,errorCode:j}),T)throw j==="otp_expired"?new Error(`Your magic link has expired. This usually happens when:
1. The link is older than the configured expiry time
2. You've already used this link
3. The link was sent from a different device/browser

Please try signing up again to get a fresh magic link.`):new Error(U||T);if(S&&E){console.log("[AuthCallback] Setting session with tokens...");const{data:G,error:Y}=await Re.auth.setSession({access_token:S,refresh_token:E});if(Y)throw Y;if(G.session){console.log("[AuthCallback] Session set successfully:",G.session.user.email),i("Email confirmed! Redirecting..."),setTimeout(()=>{e("/profile",{replace:!0})},1500);return}}if(console.log("[AuthCallback] No tokens found in hash, checking URL parameters..."),!window.location.hash)throw new Error("Invalid magic link format. Please check your email and try again.");console.log("[AuthCallback] No tokens in hash, checking for existing session...");const{data:P,error:D}=await Re.auth.getSession();if(console.log("[AuthCallback] Initial session check:",{data:P,error:D}),P.session){console.log("[AuthCallback] Found existing session:",P.session.user.email),i("Email confirmed! Redirecting..."),setTimeout(()=>{e("/profile",{replace:!0})},1500);return}console.error("[AuthCallback] Magic link failed - no tokens and no session"),console.log("[AuthCallback] Checking if this is an OAuth callback..."),console.log("[AuthCallback] OAuth callback detected, waiting for session..."),await new Promise(G=>setTimeout(G,1e3));const{data:{session:R},error:I}=await Re.auth.getSession();if(I)throw console.error("[AuthCallback] Session error:",I),new Error("Failed to establish session after OAuth authentication");if(R!=null&&R.user){console.log("[AuthCallback] OAuth authentication successful:",R.user.email),i("Authentication successful! Redirecting..."),setTimeout(()=>{e("/profile",{replace:!0})},1500);return}console.log("[AuthCallback] No session yet, waiting a bit more..."),await new Promise(G=>setTimeout(G,2e3));const{data:{session:k},error:z}=await Re.auth.getSession();if(z)throw new Error("Failed to establish session after OAuth authentication");if(k!=null&&k.user){console.log("[AuthCallback] OAuth authentication successful on retry:",k.user.email),i("Authentication successful! Redirecting..."),setTimeout(()=>{e("/profile",{replace:!0})},1500);return}throw new Error(`Authentication failed. This usually means:
1. For magic links: The link has expired or is invalid
2. For OAuth: There's a mismatch in Supabase OAuth redirect URL settings
3. The authentication provider configuration is incorrect

Please try signing in again or check your Supabase project settings.`)}catch(_){console.error("Auth callback error:",_),c(_.message),i("Authentication failed")}})()},[e,t]),l?g.jsxs("div",{className:"min-h-screen",children:[g.jsx(It,{userLocation:{city:"HCMC",lat:10.7769,lng:106.7009},setUserLocation:()=>{}}),g.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-80px)]",children:g.jsx("div",{className:"w-full max-w-md",children:g.jsxs("div",{className:"card p-8 text-center space-y-4",children:[g.jsxs("div",{className:"text-red-600",children:[g.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),g.jsx("p",{className:"text-lg font-medium",children:"Authentication Failed"})]}),g.jsx("p",{className:"text-gray-600",children:l}),g.jsxs("div",{className:"space-y-3",children:[g.jsx("button",{className:"btn btn-primary w-full",onClick:()=>e("/auth",{replace:!0}),children:"Try Again"}),g.jsx("button",{className:"btn btn-ghost w-full",onClick:()=>e("/",{replace:!0}),children:"Go Home"})]})]})})})]}):g.jsxs("div",{className:"min-h-screen",children:[g.jsx(It,{userLocation:{city:"HCMC",lat:10.7769,lng:106.7009},setUserLocation:()=>{}}),g.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-80px)]",children:g.jsx("div",{className:"w-full max-w-md",children:g.jsxs("div",{className:"card p-8 text-center space-y-4",children:[g.jsxs("div",{className:"text-blue-600",children:[g.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),g.jsx("p",{className:"text-lg font-medium",children:n})]}),g.jsx("div",{className:"text-sm text-gray-600",children:"Please wait while we complete your authentication..."})]})})})]})}function P3({userId:e,onDone:t}){const[n,i]=H.useState(null),[l,c]=H.useState(!1),[m,_]=H.useState(""),[v,y]=H.useState(!1);async function S(){if(_(""),!!n){if(!n.type.startsWith("image/")){_("Please choose an image.");return}if(n.size>3*1024*1024){_("Max file size is 3 MB.");return}c(!0);try{const{data:{user:j}}=await Re.auth.getUser();if(!j){_("Not signed in"),c(!1);return}console.log("[Avatar] Authenticated user:",j.id);const P=n.name.replace(/\s+/g,"_"),R=`${j.id}/${Date.now()}-${P}`.replace(/^avatars\//,"").replace(/^\/+/,"");console.log("[Avatar] uploading to path:",R);const{error:I}=await Re.storage.from("avatars").upload(R,n,{upsert:!0,contentType:n.type,cacheControl:"3600"});if(I){console.error("[Avatar] Storage upload error:",I),_(I.message),c(!1);return}console.log("[Avatar] Storage upload successful");const{data:k}=Re.storage.from("avatars").getPublicUrl(R),z=k.publicUrl;console.log("[Avatar] Generated public URL:",z);const{error:G}=await Re.from("profiles").update({avatar_url:z}).eq("id",j.id);if(G){console.error("[Avatar] Profiles update error:",G),_(G.message),c(!1);return}console.log("[Avatar] Profile update successful"),t==null||t(z)}catch(j){console.error("[Avatar] Unexpected error:",j),_(j.message)}finally{c(!1)}}}const E=j=>{j.preventDefault(),j.stopPropagation(),j.type==="dragenter"||j.type==="dragover"?y(!0):j.type==="dragleave"&&y(!1)},T=j=>{if(j.preventDefault(),j.stopPropagation(),y(!1),j.dataTransfer.files&&j.dataTransfer.files[0]){const P=j.dataTransfer.files[0];P.type.startsWith("image/")?(i(P),_("")):_("Please drop an image file")}},U=j=>{j.target.files&&j.target.files[0]&&(i(j.target.files[0]),_(""))};return g.jsxs("div",{className:"space-y-3",children:[g.jsxs("div",{className:`relative border-2 border-dashed rounded-xl p-6 text-center transition-all duration-200 ${v?"border-blue-400 bg-blue-50":n?"border-green-300 bg-green-50":"border-gray-300 hover:border-blue-400 hover:bg-blue-50"}`,onDragEnter:E,onDragLeave:E,onDragOver:E,onDrop:T,children:[g.jsx("input",{type:"file",accept:"image/*",onChange:U,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),n?g.jsxs("div",{className:"space-y-3",children:[g.jsx("div",{className:"w-16 h-16 mx-auto rounded-full overflow-hidden border-2 border-white shadow-lg",children:g.jsx("img",{src:URL.createObjectURL(n),alt:"Preview",className:"w-full h-full object-cover"})}),g.jsxs("div",{children:[g.jsx("p",{className:"text-sm font-medium text-green-700",children:n.name}),g.jsx("p",{className:"text-xs text-green-600",children:"Ready to upload"})]})]}):g.jsxs("div",{className:"space-y-3",children:[g.jsx("div",{className:"w-12 h-12 mx-auto bg-gray-100 rounded-full flex items-center justify-center",children:g.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),g.jsxs("div",{children:[g.jsx("p",{className:"text-sm font-medium text-gray-700",children:v?"Drop your image here":"Drag & drop your photo here"}),g.jsx("p",{className:"text-xs text-gray-500",children:"or click to browse"})]})]})]}),n&&g.jsx("button",{className:"w-full btn btn-primary",onClick:S,disabled:l,children:l?"Uploading…":"Upload Photo"}),m&&g.jsx("div",{className:"text-sm text-red-500 text-center bg-red-50 p-2 rounded-lg",children:m}),n&&g.jsx("div",{className:"text-xs text-gray-500 text-center",children:"Max file size: 3MB • Supported: JPG, PNG, GIF"})]})}function R3(){const{user:e,signOut:t,updateProfile:n}=ur(),{updateLocationFromProfile:i}=Nu(),[l,c]=H.useState({profilePhoto:null,avatar_url:null,prefix:"Mr.",firstName:"",lastName:"",suffix:"",homePhone:"",cellPhone:"",jobTitle:"",company:"",website:"",blog:"",address:"",address2:"",city:"",interests:[],country:"Vietnam",zipCode:"",state:""}),[m,_]=H.useState(!1),[v,y]=H.useState(""),[S,E]=H.useState(!1);H.useEffect(()=>{l.city&&l.city.trim()&&i(l.city.trim())},[l.city,i]),H.useEffect(()=>{if(e)try{const P=localStorage.getItem(`suki_profile_${e.id}`);if(P){const D=JSON.parse(P);D.interests&&typeof D.interests=="string"?D.interests=D.interests.split(",").map(k=>k.trim()).filter(Boolean):D.interests||(D.interests=[]);let R=null;try{const k=`suki_profile_photo_${e.id}`,z=localStorage.getItem(k);console.log("[Profile] Looking for profile photo with key:",k),console.log("[Profile] Found photo in localStorage:",!!z),z?(R=z,console.log("[Profile] Successfully loaded photo from localStorage for user:",e.id)):console.log("[Profile] No photo found in localStorage for user:",e.id)}catch(k){console.warn("Could not load profile photo from localStorage:",k)}!R&&e.profilePhoto&&(R=e.profilePhoto,console.log("[Profile] Loaded photo from user metadata for user:",e.id));const I={...D,profilePhoto:R};c(I),R?(e.profilePhoto=R,console.log("[Profile] Profile photo set successfully for user:",e.id)):console.log("[Profile] No profile photo found for user:",e.id)}else{c(R=>({...R,city:e.city||"HCMC",interests:e.interests||[]}));let D=null;try{const R=`suki_profile_photo_${e.id}`,I=localStorage.getItem(R);console.log("[Profile] Looking for profile photo with key:",R),console.log("[Profile] Found photo in localStorage:",!!I),I?(D=I,console.log("[Profile] Successfully loaded photo from localStorage for user:",e.id)):console.log("[Profile] No photo found in localStorage for user:",e.id)}catch(R){console.warn("Could not load profile photo from localStorage:",R)}!D&&e.profilePhoto&&(D=e.profilePhoto,console.log("[Profile] Loaded photo from user metadata for user:",e.id)),D?(c(R=>({...R,profilePhoto:D})),e.profilePhoto=D,console.log("[Profile] Profile photo set successfully for user:",e.id)):console.log("[Profile] No profile photo found for user:",e.id)}}catch(P){console.warn("Error loading profile from localStorage:",P),c(D=>({...D,city:e.city||"HCMC",profilePhoto:e.profilePhoto||null,interests:e.interests||[]}))}},[e]),H.useEffect(()=>{e&&(async()=>{try{const{data:D,error:R}=await Re.from("profiles").select("avatar_url").eq("id",e.id).single();if(R&&R.code!=="PGRST116"){console.error("Error loading avatar:",R);return}D!=null&&D.avatar_url&&c(I=>({...I,avatar_url:D.avatar_url}))}catch(D){console.error("Error loading avatar from database:",D)}})()},[e]);const T=(P,D)=>{c(R=>({...R,[P]:D}))},U=async()=>{if(e){E(!0);try{const P={city:l.city,interests:l.interests||[],profilePhoto:l.profilePhoto,firstName:l.firstName,lastName:l.lastName,prefix:l.prefix,suffix:l.suffix,homePhone:l.homePhone,cellPhone:l.cellPhone,jobTitle:l.jobTitle,company:l.company,website:l.website,blog:l.blog,address:l.address,address2:l.address2,country:l.country,zipCode:l.zipCode,state:l.state};await n(P),l.city&&l.city.trim()&&i(l.city.trim());try{const D={...l,profilePhoto:null};localStorage.setItem(`suki_profile_${e.id}`,JSON.stringify(D)),console.log("[Profile] Saved profile metadata to localStorage for user:",e.id)}catch{console.warn("localStorage quota exceeded, clearing and retrying...");try{localStorage.clear();const R={...l,profilePhoto:null};localStorage.setItem(`suki_profile_${e.id}`,JSON.stringify(R))}catch(R){console.warn("Still cannot save to localStorage:",R)}}y("Profile saved successfully!"),_(!1),setTimeout(()=>y(""),3e3)}catch(P){console.error("Error saving profile:",P),y(`Error saving profile: ${P.message}`),setTimeout(()=>y(""),5e3)}finally{E(!1)}}},j=()=>{t()};return e?g.jsxs("div",{className:"min-h-screen bg-gray-50",children:[g.jsx(It,{searchTerm:"",setSearchTerm:()=>{}}),g.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[g.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8 mb-8",children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Profile Settings"}),g.jsx("p",{className:"text-gray-600 mt-2",children:"Manage your account information and preferences"})]}),g.jsxs("div",{className:"flex gap-3",children:[!m&&g.jsx("button",{className:"px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors font-medium",onClick:()=>_(!0),children:"Edit Profile"}),g.jsx("button",{className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors font-medium",onClick:j,children:"Sign Out"})]})]})}),v&&g.jsx("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 mb-6",children:g.jsxs("div",{className:"flex items-center",children:[g.jsx("svg",{className:"w-5 h-5 text-green-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),g.jsx("span",{className:"text-green-800 font-medium",children:v})]})}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[g.jsx("div",{className:"lg:col-span-1",children:g.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6 sticky top-8",children:[g.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Profile Photo"}),g.jsxs("div",{className:"text-center",children:[l.avatar_url||l.profilePhoto?g.jsx("div",{className:"mb-6",children:g.jsx("img",{src:l.avatar_url||l.profilePhoto,alt:"Profile",className:"w-32 h-32 rounded-full object-cover border-4 border-white shadow-lg mx-auto"})}):g.jsx("div",{className:"w-32 h-32 rounded-full bg-gray-200 flex items-center justify-center mx-auto mb-6 border-4 border-white shadow-lg",children:g.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),m&&e&&g.jsx(P3,{userId:e.id,onDone:P=>{c(D=>({...D,avatar_url:P})),e&&(e.profilePhoto=P)}})]})]})}),g.jsx("div",{className:"lg:col-span-2",children:g.jsxs("div",{className:"space-y-6",children:[g.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[g.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Personal Information"}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prefix"}),g.jsxs("select",{className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:l.prefix,onChange:P=>T("prefix",P.target.value),disabled:!m,children:[g.jsx("option",{value:"Mr.",children:"Mr."}),g.jsx("option",{value:"Ms.",children:"Ms."}),g.jsx("option",{value:"Mrs.",children:"Mrs."}),g.jsx("option",{value:"Dr.",children:"Dr."}),g.jsx("option",{value:"Prof.",children:"Prof."})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name"}),g.jsx("input",{type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:l.firstName,onChange:P=>T("firstName",P.target.value),disabled:!m,placeholder:"First Name"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name"}),g.jsx("input",{type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:l.lastName,onChange:P=>T("lastName",P.target.value),disabled:!m,placeholder:"Last Name"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Suffix"}),g.jsx("input",{type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:l.suffix,onChange:P=>T("suffix",P.target.value),disabled:!m,placeholder:"Suffix"})]})]})]}),g.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[g.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Contact Information"}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Home Phone"}),g.jsx("input",{type:"tel",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:l.homePhone,onChange:P=>T("homePhone",P.target.value),disabled:!m,placeholder:"Home Phone"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cell Phone"}),g.jsx("input",{type:"tel",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:l.cellPhone,onChange:P=>T("cellPhone",P.target.value),disabled:!m,placeholder:"Cell Phone"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Job Title"}),g.jsx("input",{type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:l.jobTitle,onChange:P=>T("jobTitle",P.target.value),disabled:!m,placeholder:"Job Title"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company / Organization"}),g.jsx("input",{type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:l.company,onChange:P=>T("company",P.target.value),disabled:!m,placeholder:"Company / Organization"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Website"}),g.jsx("input",{type:"url",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:l.website,onChange:P=>T("website",P.target.value),disabled:!m,placeholder:"Website"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Blog"}),g.jsx("input",{type:"url",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:l.blog,onChange:P=>T("blog",P.target.value),disabled:!m,placeholder:"Blog"})]})]})]}),g.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[g.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Interests"}),g.jsxs("div",{children:[g.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:["Select your interests",l.interests.length>0&&g.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",l.interests.length," selected)"]})]}),g.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:["Music","Business & Professional","Food & Drink","Community & Culture","Performing & Visual Arts","Film, Media & Entertainment","Sports & Fitness","Health & Wellness","Science & Technology","Travel & Outdoor","Charity & Causes","Religion & Spirituality","Family & Education","Seasonal & Holiday","Government & Politics","Fashion & Beauty","Home & Lifestyle","Hobbies & Special Interests","School Activities","Others"].map(P=>g.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer p-3 rounded-lg hover:bg-gray-50 transition-colors",children:[g.jsx("input",{type:"checkbox",className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500",checked:l.interests.includes(P),onChange:D=>{D.target.checked?T("interests",[...l.interests,P]):T("interests",l.interests.filter(R=>R!==P))},disabled:!m}),g.jsx("span",{className:"text-sm text-gray-700",children:P})]},P))})]})]}),g.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[g.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Address"}),g.jsxs("div",{className:"space-y-6",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),g.jsx("input",{type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:l.address,onChange:P=>T("address",P.target.value),disabled:!m,placeholder:"Address"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address 2"}),g.jsx("input",{type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:l.address2,onChange:P=>T("address2",P.target.value),disabled:!m,placeholder:"Address 2"})]}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City"}),g.jsx("input",{type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:l.city,onChange:P=>T("city",P.target.value),disabled:!m,placeholder:"City"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Country"}),g.jsx("input",{type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:l.country,onChange:P=>T("country",P.target.value),disabled:!m,placeholder:"Country"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Zip/Postal Code"}),g.jsx("input",{type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:l.zipCode,onChange:P=>T("zipCode",P.target.value),disabled:!m,placeholder:"Zip/Postal Code"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"State"}),g.jsx("input",{type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:l.state,onChange:P=>T("state",P.target.value),disabled:!m,placeholder:"State"})]})]})]})]}),m&&g.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:g.jsxs("div",{className:"flex gap-4",children:[g.jsx("button",{className:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors font-medium",onClick:U,disabled:S,children:S?"Saving...":"Save Changes"}),g.jsx("button",{className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors font-medium",onClick:()=>_(!1),disabled:S,children:"Cancel"})]})})]})})]})]})]}):g.jsxs("div",{className:"min-h-screen",children:[g.jsx(It,{searchTerm:"",setSearchTerm:()=>{}}),g.jsx("div",{className:"container mt-10",children:g.jsxs("div",{className:"card p-6 text-center",children:[g.jsx("p",{children:"Please sign in to view your profile."}),g.jsx("a",{href:"/auth",className:"btn btn-primary mt-4",children:"Sign In"})]})})]})}const _x="suki_org_events";function j3(){try{return JSON.parse(localStorage.getItem(_x)||"[]")}catch{return[]}}function q1(e){localStorage.setItem(_x,JSON.stringify(e))}function D3(){const[e,t]=H.useState([]),[n,i]=H.useState(!1),[l,c]=H.useState(null);H.useEffect(()=>{t(j3())},[]);const m=H.useMemo(()=>{const E=e.reduce((U,j)=>U+(j.sold||0),0),T=e.reduce((U,j)=>U+(j.capacity||0),0);return{sold:E,capacity:T,remaining:Math.max(T-E,0)}},[e]),_=()=>{c(null),i(!0)},v=E=>{c(E),i(!0)},y=E=>{const T=e.filter(U=>U.id!==E);t(T),q1(T)},S=E=>{let T;l?T=e.map(U=>U.id===l.id?{...l,...E}:U):T=[{id:crypto.randomUUID(),sold:0,...E},...e],t(T),q1(T),i(!1)};return g.jsxs("div",{className:"min-h-screen",children:[g.jsx(It,{userLocation:{city:"HCMC",lat:10.7769,lng:106.7009},setUserLocation:()=>{}}),g.jsxs("div",{className:"container mt-6 space-y-4",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("h1",{className:"text-2xl font-semibold",children:"Organizer Dashboard"}),g.jsxs("button",{className:"btn btn-primary",onClick:_,children:[g.jsx(Uf,{className:"size-4 mr-1"})," Create event"]})]}),g.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(E=>{var T;return g.jsxs("article",{className:"card p-4 space-y-2",children:[g.jsx("h3",{className:"font-semibold",children:E.title}),g.jsxs("p",{className:"text-sm text-neutral-400",children:[new Date(E.start_at).toLocaleString()," @ ",(T=E.venue)==null?void 0:T.name]}),g.jsxs("div",{className:"text-sm",children:["Sold ",E.sold||0," / ",E.capacity||0]}),g.jsxs("div",{className:"flex gap-2 pt-2",children:[g.jsxs("button",{className:"btn btn-ghost",onClick:()=>v(E),children:[g.jsx(c3,{className:"size-4 mr-1"})," Edit"]}),g.jsxs("button",{className:"btn btn-ghost",onClick:()=>y(E.id),children:[g.jsx(gx,{className:"size-4 mr-1"})," Delete"]})]})]},E.id)})}),g.jsx("div",{className:"card p-4",children:g.jsxs("div",{className:"flex gap-6 text-sm",children:[g.jsxs("div",{children:["Sold: ",g.jsx("span",{className:"font-medium",children:m.sold})]}),g.jsxs("div",{children:["Remaining: ",g.jsx("span",{className:"font-medium",children:m.remaining})]}),g.jsxs("div",{children:["Capacity: ",g.jsx("span",{className:"font-medium",children:m.capacity})]})]})}),n&&g.jsx(B3,{initial:l,onClose:()=>i(!1),onSave:S})]})]})}function B3({initial:e,onClose:t,onSave:n}){var I;const[i,l]=H.useState((e==null?void 0:e.title)||""),[c,m]=H.useState(e!=null&&e.start_at?e.start_at.slice(0,16):""),[_,v]=H.useState(e!=null&&e.end_at?e.end_at.slice(0,16):""),[y,S]=H.useState(((I=e==null?void 0:e.venue)==null?void 0:I.name)||""),[E,T]=H.useState((e==null?void 0:e.capacity)||0),[U,j]=H.useState((e==null?void 0:e.min_price)||0),[P,D]=H.useState((e==null?void 0:e.max_price)||0),R=()=>{n({title:i,start_at:new Date(c).toISOString(),end_at:new Date(_).toISOString(),venue:{name:y},capacity:Number(E||0),min_price:Number(U||0),max_price:Number(P||0)})};return g.jsx("div",{className:"fixed inset-0 z-50 bg-black/60 backdrop-blur-sm grid place-items-center p-4",children:g.jsxs("div",{className:"w-full max-w-xl card p-4 space-y-3",children:[g.jsxs("h2",{className:"text-lg font-semibold",children:[e?"Edit":"Create"," event"]}),g.jsx("input",{className:"input",placeholder:"Title",value:i,onChange:k=>l(k.target.value)}),g.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[g.jsxs("div",{children:[g.jsx("label",{className:"text-sm text-neutral-400",children:"Start"}),g.jsx("input",{type:"datetime-local",className:"input w-full",value:c,onChange:k=>m(k.target.value)})]}),g.jsxs("div",{children:[g.jsx("label",{className:"text-sm text-neutral-400",children:"End"}),g.jsx("input",{type:"datetime-local",className:"input w-full",value:_,onChange:k=>v(k.target.value)})]})]}),g.jsx("input",{className:"input",placeholder:"Venue name",value:y,onChange:k=>S(k.target.value)}),g.jsxs("div",{className:"grid md:grid-cols-3 gap-3",children:[g.jsx("input",{className:"input",type:"number",placeholder:"Capacity",value:E,onChange:k=>T(k.target.value)}),g.jsx("input",{className:"input",type:"number",placeholder:"Min price",value:U,onChange:k=>j(k.target.value)}),g.jsx("input",{className:"input",type:"number",placeholder:"Max price",value:P,onChange:k=>D(k.target.value)})]}),g.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[g.jsx("button",{className:"btn btn-ghost",onClick:t,children:"Cancel"}),g.jsx("button",{className:"btn btn-primary",onClick:R,children:"Save"})]})]})})}const bx="suki_saved_events";function F3(){try{return JSON.parse(localStorage.getItem(bx)||"[]")}catch{return[]}}function U3(){const{user:e}=ur(),[t,n]=H.useState([]),[i,l]=H.useState([]),[c,m]=H.useState(!0);H.useEffect(()=>{n(F3())},[]),H.useEffect(()=>{(async()=>{m(!0);try{const{data:S,error:E}=await Re.from("events").select("*, venue:venues(*)").eq("status","published").order("start_at",{ascending:!0});if(E)console.error("Error loading events:",E),l([]);else{const T=(S||[]).map(U=>({id:U.id,title:U.title,description:U.description,category:U.category,start_at:U.start_at,end_at:U.end_at,venue:U.venue||{name:"TBD"},capacity:U.capacity||0,min_price:U.min_price||0,max_price:U.max_price||0,cover_url:U.cover_url||"",status:U.status,creator_id:U.creator_id}));l(T)}}catch(S){console.error("Error loading events:",S),l([])}finally{m(!1)}})()},[]);const _=H.useMemo(()=>{const y=new Set(t);return i.filter(S=>y.has(S.id))},[t,i]),v=y=>{const S=t.filter(E=>E!==y);n(S),localStorage.setItem(bx,JSON.stringify(S))};return e?c?g.jsxs("div",{className:"min-h-screen bg-gray-50",children:[g.jsx(It,{searchTerm:"",setSearchTerm:()=>{}}),g.jsx("div",{className:"container mx-auto px-4 py-8",children:g.jsx("div",{className:"flex justify-center items-center h-64",children:g.jsx("div",{className:"loading loading-spinner loading-lg"})})})]}):g.jsxs("div",{className:"min-h-screen bg-white",children:[g.jsx(It,{searchTerm:"",setSearchTerm:()=>{}}),g.jsxs("div",{className:"max-w-4xl mx-auto px-6 py-8",children:[g.jsx("div",{className:"mb-8",children:g.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Likes"})}),_.length===0?g.jsxs("div",{className:"text-center py-16",children:[g.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:g.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),g.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:"No saved events yet"}),g.jsx("p",{className:"text-gray-600 mb-6",children:"Tap the heart on any event to save it for later."}),g.jsx(bs,{to:"/",className:"btn btn-primary",children:"Discover Events"})]}):g.jsx("div",{className:"space-y-6",children:_.map(y=>{var j,P;const S=new Date(y.start_at),E=S.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),T=S.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),U=async()=>{const D=`${window.location.origin}/events/${y.id}`;try{navigator.share?await navigator.share({title:y.title,text:"Check out this event on Suki",url:D}):(await navigator.clipboard.writeText(D),alert("Link copied to clipboard"))}catch{}};return g.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:g.jsxs("div",{className:"flex gap-6",children:[g.jsxs("div",{className:"flex-1",children:[g.jsx("div",{className:"mb-2",children:g.jsx(bs,{to:`/events/${y.id}`,className:"text-xl font-semibold text-gray-900 hover:text-gray-700",children:y.title})}),g.jsxs("div",{className:"text-sm text-orange-600 mb-1",children:[E,", ",T]}),g.jsxs("div",{className:"text-sm text-gray-600 mb-1",children:[((j=y.venue)==null?void 0:j.name)||"TBD",((P=y.venue)==null?void 0:P.address)&&`, ${y.venue.address}`]}),g.jsx("div",{className:"text-sm text-gray-600",children:y.min_price===0?"Free":`From ${(y.min_price/1e3).toFixed(0)}k VND`})]}),g.jsxs("div",{className:"flex-shrink-0",children:[g.jsx(bs,{to:`/events/${y.id}`,className:"block w-48 h-32 bg-gray-100 rounded-lg overflow-hidden mb-4 hover:opacity-90 transition-opacity",children:y.cover_url?g.jsx("img",{src:y.cover_url,alt:y.title,className:"w-full h-full object-cover"}):g.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:g.jsx("svg",{className:"w-8 h-8 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),g.jsxs("div",{className:"flex gap-2",children:[g.jsx("button",{className:"w-10 h-10 bg-white border border-red-300 rounded-full flex items-center justify-center hover:bg-red-50 transition-colors",onClick:()=>v(y.id),title:"Remove from saved",children:g.jsx(Ff,{className:"w-5 h-5 text-red-500 fill-current"})}),g.jsx("button",{className:"w-10 h-10 bg-white border border-gray-300 rounded-full flex items-center justify-center hover:bg-gray-50 transition-colors",onClick:U,title:"Share event",children:g.jsx(fx,{className:"w-5 h-5 text-gray-500"})})]})]})]})},y.id)})})]})]}):g.jsxs("div",{className:"min-h-screen bg-gray-50",children:[g.jsx(It,{searchTerm:"",setSearchTerm:()=>{}}),g.jsx("div",{className:"container mx-auto px-4 py-8",children:g.jsxs("div",{className:"text-center",children:[g.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Please Sign In"}),g.jsx("p",{className:"text-gray-600",children:"You need to sign in to view saved events."})]})})]})}const z3=[{name:"Early Bird",price:0,quota:50},{name:"General Admission",price:1e5,quota:100},{name:"VIP",price:25e4,quota:30},{name:"VVIP",price:5e5,quota:20}];function Cx({tiers:e=[],onChange:t,eventId:n=null,originalEvent:i=null,isEditing:l=!1}){const[c,m]=H.useState(e),[_,v]=H.useState(!1),[y,S]=H.useState({name:"",price:"",quota:""});H.useEffect(()=>{const z=e.map(G=>({...G,price:Number(G.price)||0,quota:Number(G.quota)||0,sold:Number(G.sold)||0}));m(z)},[e]);const E=()=>{if(!y.name.trim()||!y.quota)return;const z={id:`temp-${Date.now()}`,name:y.name.trim(),price:Number(y.price)||0,quota:Number(y.quota),sold:0},G=[...c,z];m(G),S({name:"",price:"",quota:"",description:""}),v(!1),I.length===0?t(G):t(null)},T=z=>{var Z;const G=c.find(J=>J.id===z);if(l&&i&&G){const J=(Z=i.ticket_tiers)==null?void 0:Z.find(ie=>ie.name===G.name);if(J&&(J.sold||0)>0){alert(`Cannot delete "${G.name}" tier - ${J.sold} tickets already sold. Please keep this tier or contact support.`);return}}const Y=c.filter(J=>J.id!==z);m(Y),I.length===0?t(Y):t(null)},U=(z,G,Y)=>{let Z=Y;(G==="price"||G==="quota")&&(Z=Number(Y)||0);const J=c.map(ie=>ie.id===z?{...ie,[G]:Z}:ie);m(J),I.length===0?t(J):t(null)},j=z=>{const G={name:z.name,price:z.price,quota:z.quota,id:`temp-${Date.now()}`,sold:0},Y=[...c,G];m(Y),I.length===0?t(Y):t(null)},P=c.reduce((z,G)=>z+(Number(G.quota)||0),0),D=c.reduce((z,G)=>z+(Number(G.sold)||0),0),I=(()=>{if(!l||!(i!=null&&i.ticket_tiers))return[];const z=[];for(const G of c){const Y=i.ticket_tiers.find(Z=>Z.name===G.name);if(Y&&G.quota<Y.quota){const Z=Y.sold||0;G.quota<Z&&z.push({tierName:G.name,newQuota:G.quota,ticketsSold:Z,message:`Cannot reduce "${G.name}" quota to ${G.quota} - ${Z} tickets already sold`})}}return z})(),k=(()=>{if(!l||!(i!=null&&i.ticket_tiers))return null;const z=i.ticket_tiers.filter(G=>(G.sold||0)>0);return z.length===0?null:{tiers:z,hasWarnings:!0}})();return g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("h3",{className:"text-lg font-medium",children:"Ticket Tiers"}),g.jsxs("button",{type:"button",className:"btn btn-sm btn-primary",onClick:()=>v(!0),children:[g.jsx(Uf,{className:"size-4 mr-1"}),"Add Tier"]})]}),I.length>0&&g.jsxs("div",{className:"card p-4 bg-red-50 border-red-200",children:[g.jsx("h4",{className:"font-medium text-red-900 mb-3",children:"⚠️ Validation Warnings"}),g.jsx("div",{className:"space-y-2",children:I.map((z,G)=>g.jsx("div",{className:"text-sm text-red-700 p-2 bg-red-100 rounded",children:z.message},G))}),g.jsx("p",{className:"text-xs text-red-600 mt-2",children:"Please fix these issues before saving. You cannot reduce quota below tickets already sold."})]}),k&&g.jsxs("div",{className:"card p-4 bg-amber-50 border-amber-200",children:[g.jsx("h4",{className:"font-medium text-amber-900 mb-3",children:"ℹ️ Tier Management Notice"}),g.jsx("div",{className:"space-y-2",children:k.tiers.map((z,G)=>g.jsxs("div",{className:"text-sm text-amber-700 p-2 bg-amber-100 rounded",children:[g.jsx("strong",{children:z.name}),": ",z.sold," tickets sold - This tier cannot be deleted"]},G))}),g.jsx("p",{className:"text-xs text-amber-600 mt-2",children:"Tiers with sold tickets are protected from deletion to maintain data integrity."})]}),!l&&c.length===0&&g.jsxs("div",{className:"card p-4 bg-blue-50 border-blue-200",children:[g.jsx("h4",{className:"font-medium text-blue-900 mb-3",children:"Quick Start - Suggested Tiers"}),g.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:z3.map((z,G)=>g.jsxs("button",{type:"button",className:"btn btn-sm btn-outline btn-blue text-xs p-2 h-auto",onClick:()=>j(z),children:[g.jsx("div",{className:"font-medium",children:z.name}),g.jsx("div",{className:"text-blue-600",children:z.price===0?"Free":`${z.price.toLocaleString()} VND`}),g.jsxs("div",{className:"text-blue-500",children:[z.quota," tickets"]})]},G))})]}),c.length>0&&g.jsxs("div",{className:"space-y-3",children:[c.map(z=>g.jsx("div",{className:"card p-4 border border-neutral-200",children:g.jsxs("div",{className:"grid md:grid-cols-4 gap-3 items-center",children:[g.jsx("div",{children:g.jsx("input",{type:"text",className:"input w-full text-sm",placeholder:"Tier name",value:z.name,onChange:G=>U(z.id,"name",G.target.value)})}),g.jsx("div",{children:g.jsx("input",{type:"number",className:"input w-full text-sm",placeholder:"Price (VND)",value:z.price,onChange:G=>U(z.id,"price",G.target.value)})}),g.jsxs("div",{children:[g.jsx("input",{type:"number",className:`input w-full text-sm ${I.some(G=>G.tierName===z.name)?"border-red-300 bg-red-50":""}`,placeholder:"Quota",value:z.quota,onChange:G=>U(z.id,"quota",G.target.value)}),z.sold>0&&g.jsxs("div",{className:"text-xs text-neutral-500 mt-1",children:[z.sold," sold • ",z.remaining||z.quota," remaining"]}),I.some(G=>G.tierName===z.name)&&g.jsx("div",{className:"text-xs text-red-600 mt-1",children:"⚠️ Quota too low for tickets sold"})]}),g.jsx("div",{className:"flex items-center gap-2",children:l&&i&&(()=>{var Z;const G=(Z=i.ticket_tiers)==null?void 0:Z.find(J=>J.name===z.name);return G&&(G.sold||0)>0?g.jsxs("div",{className:"flex items-center gap-1 text-xs text-amber-600",children:[g.jsx("span",{children:"⚠️"}),g.jsxs("span",{children:[G.sold," sold"]})]}):g.jsx("button",{type:"button",className:"btn btn-sm btn-ghost text-red-500 hover:text-red-700",onClick:()=>T(z.id),title:"Delete tier",children:g.jsx(zf,{className:"size-4"})})})()})]})},z.id)),g.jsx("div",{className:"card p-3 bg-neutral-50",children:g.jsxs("div",{className:"flex justify-between text-sm",children:[g.jsxs("span",{children:["Total Capacity: ",g.jsx("strong",{children:P})]}),D>0&&g.jsxs("span",{children:["Total Sold: ",g.jsx("strong",{children:D})]}),g.jsxs("span",{children:["Available: ",g.jsx("strong",{children:P-D})]})]})})]}),_&&g.jsx("div",{className:"card p-4 border-2 border-dashed border-neutral-300",children:g.jsxs("div",{className:"grid md:grid-cols-4 gap-3 items-end",children:[g.jsxs("div",{children:[g.jsx("label",{className:"text-sm text-neutral-500 block mb-1",children:"Tier Name"}),g.jsx("input",{type:"text",className:"input w-full",placeholder:"e.g., Early Bird",value:y.name,onChange:z=>S(G=>({...G,name:z.target.value}))})]}),g.jsxs("div",{children:[g.jsx("label",{className:"text-sm text-neutral-500 block mb-1",children:"Price (VND)"}),g.jsx("input",{type:"number",className:"input w-full",placeholder:"0 for free",value:y.price,onChange:z=>S(G=>({...G,price:z.target.value}))})]}),g.jsxs("div",{children:[g.jsx("label",{className:"text-sm text-neutral-500 block mb-1",children:"Quota"}),g.jsx("input",{type:"number",className:"input w-full",placeholder:"Number of tickets",value:y.quota,onChange:z=>S(G=>({...G,quota:z.target.value}))})]}),g.jsxs("div",{className:"flex gap-2",children:[g.jsx("button",{type:"button",className:"btn btn-sm btn-primary flex-1",onClick:E,children:"Add Tier"}),g.jsx("button",{type:"button",className:"btn btn-sm btn-ghost",onClick:()=>v(!1),children:"Cancel"})]})]})})]})}function Ex(e,t){const n=H.useRef(t);H.useEffect(function(){t!==n.current&&e.attributionControl!=null&&(n.current!=null&&e.attributionControl.removeAttribution(n.current),t!=null&&e.attributionControl.addAttribution(t)),n.current=t},[e,t])}const H3=1;function W3(e){return Object.freeze({__version:H3,map:e})}function V3(e,t){return Object.freeze({...e,...t})}const Sx=H.createContext(null),Ax=Sx.Provider;function Hf(){const e=H.useContext(Sx);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function G3(e){function t(n,i){const{instance:l,context:c}=e(n).current;return H.useImperativeHandle(i,()=>l),n.children==null?null:qn.createElement(Ax,{value:c},n.children)}return H.forwardRef(t)}function Z3(e){function t(n,i){const[l,c]=H.useState(!1),{instance:m}=e(n,c).current;H.useImperativeHandle(i,()=>m),H.useEffect(function(){l&&m.update()},[m,l,n.children]);const _=m._contentNode;return _?Sp.createPortal(n.children,_):null}return H.forwardRef(t)}function Y3(e){function t(n,i){const{instance:l}=e(n).current;return H.useImperativeHandle(i,()=>l),null}return H.forwardRef(t)}function Nx(e,t){const n=H.useRef();H.useEffect(function(){return t!=null&&e.instance.on(t),n.current=t,function(){n.current!=null&&e.instance.off(n.current),n.current=null}},[e,t])}function Wf(e,t){const n=e.pane??t.pane;return n?{...e,pane:n}:e}function $3(e,t){return function(i,l){const c=Hf(),m=e(Wf(i,c),c);return Ex(c.map,i.attribution),Nx(m.current,i.eventHandlers),t(m.current,c,i,l),m}}var Oh={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(n,i){i(t)})(Sn,function(n){var i="1.9.4";function l(o){var h,x,C,N;for(x=1,C=arguments.length;x<C;x++){N=arguments[x];for(h in N)o[h]=N[h]}return o}var c=Object.create||function(){function o(){}return function(h){return o.prototype=h,new o}}();function m(o,h){var x=Array.prototype.slice;if(o.bind)return o.bind.apply(o,x.call(arguments,1));var C=x.call(arguments,2);return function(){return o.apply(h,C.length?C.concat(x.call(arguments)):arguments)}}var _=0;function v(o){return"_leaflet_id"in o||(o._leaflet_id=++_),o._leaflet_id}function y(o,h,x){var C,N,F,$;return $=function(){C=!1,N&&(F.apply(x,N),N=!1)},F=function(){C?N=arguments:(o.apply(x,arguments),setTimeout($,h),C=!0)},F}function S(o,h,x){var C=h[1],N=h[0],F=C-N;return o===C&&x?o:((o-N)%F+F)%F+N}function E(){return!1}function T(o,h){if(h===!1)return o;var x=Math.pow(10,h===void 0?6:h);return Math.round(o*x)/x}function U(o){return o.trim?o.trim():o.replace(/^\s+|\s+$/g,"")}function j(o){return U(o).split(/\s+/)}function P(o,h){Object.prototype.hasOwnProperty.call(o,"options")||(o.options=o.options?c(o.options):{});for(var x in h)o.options[x]=h[x];return o.options}function D(o,h,x){var C=[];for(var N in o)C.push(encodeURIComponent(x?N.toUpperCase():N)+"="+encodeURIComponent(o[N]));return(!h||h.indexOf("?")===-1?"?":"&")+C.join("&")}var R=/\{ *([\w_ -]+) *\}/g;function I(o,h){return o.replace(R,function(x,C){var N=h[C];if(N===void 0)throw new Error("No value provided for variable "+x);return typeof N=="function"&&(N=N(h)),N})}var k=Array.isArray||function(o){return Object.prototype.toString.call(o)==="[object Array]"};function z(o,h){for(var x=0;x<o.length;x++)if(o[x]===h)return x;return-1}var G="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Y(o){return window["webkit"+o]||window["moz"+o]||window["ms"+o]}var Z=0;function J(o){var h=+new Date,x=Math.max(0,16-(h-Z));return Z=h+x,window.setTimeout(o,x)}var ie=window.requestAnimationFrame||Y("RequestAnimationFrame")||J,Ee=window.cancelAnimationFrame||Y("CancelAnimationFrame")||Y("CancelRequestAnimationFrame")||function(o){window.clearTimeout(o)};function ce(o,h,x){if(x&&ie===J)o.call(h);else return ie.call(window,m(o,h))}function ue(o){o&&Ee.call(window,o)}var Ie={__proto__:null,extend:l,create:c,bind:m,get lastId(){return _},stamp:v,throttle:y,wrapNum:S,falseFn:E,formatNum:T,trim:U,splitWords:j,setOptions:P,getParamString:D,template:I,isArray:k,indexOf:z,emptyImageUrl:G,requestFn:ie,cancelFn:Ee,requestAnimFrame:ce,cancelAnimFrame:ue};function Te(){}Te.extend=function(o){var h=function(){P(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},x=h.__super__=this.prototype,C=c(x);C.constructor=h,h.prototype=C;for(var N in this)Object.prototype.hasOwnProperty.call(this,N)&&N!=="prototype"&&N!=="__super__"&&(h[N]=this[N]);return o.statics&&l(h,o.statics),o.includes&&(Q(o.includes),l.apply(null,[C].concat(o.includes))),l(C,o),delete C.statics,delete C.includes,C.options&&(C.options=x.options?c(x.options):{},l(C.options,o.options)),C._initHooks=[],C.callInitHooks=function(){if(!this._initHooksCalled){x.callInitHooks&&x.callInitHooks.call(this),this._initHooksCalled=!0;for(var F=0,$=C._initHooks.length;F<$;F++)C._initHooks[F].call(this)}},h},Te.include=function(o){var h=this.prototype.options;return l(this.prototype,o),o.options&&(this.prototype.options=h,this.mergeOptions(o.options)),this},Te.mergeOptions=function(o){return l(this.prototype.options,o),this},Te.addInitHook=function(o){var h=Array.prototype.slice.call(arguments,1),x=typeof o=="function"?o:function(){this[o].apply(this,h)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(x),this};function Q(o){if(!(typeof L>"u"||!L||!L.Mixin)){o=k(o)?o:[o];for(var h=0;h<o.length;h++)o[h]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var pe={on:function(o,h,x){if(typeof o=="object")for(var C in o)this._on(C,o[C],h);else{o=j(o);for(var N=0,F=o.length;N<F;N++)this._on(o[N],h,x)}return this},off:function(o,h,x){if(!arguments.length)delete this._events;else if(typeof o=="object")for(var C in o)this._off(C,o[C],h);else{o=j(o);for(var N=arguments.length===1,F=0,$=o.length;F<$;F++)N?this._off(o[F]):this._off(o[F],h,x)}return this},_on:function(o,h,x,C){if(typeof h!="function"){console.warn("wrong listener type: "+typeof h);return}if(this._listens(o,h,x)===!1){x===this&&(x=void 0);var N={fn:h,ctx:x};C&&(N.once=!0),this._events=this._events||{},this._events[o]=this._events[o]||[],this._events[o].push(N)}},_off:function(o,h,x){var C,N,F;if(this._events&&(C=this._events[o],!!C)){if(arguments.length===1){if(this._firingCount)for(N=0,F=C.length;N<F;N++)C[N].fn=E;delete this._events[o];return}if(typeof h!="function"){console.warn("wrong listener type: "+typeof h);return}var $=this._listens(o,h,x);if($!==!1){var re=C[$];this._firingCount&&(re.fn=E,this._events[o]=C=C.slice()),C.splice($,1)}}},fire:function(o,h,x){if(!this.listens(o,x))return this;var C=l({},h,{type:o,target:this,sourceTarget:h&&h.sourceTarget||this});if(this._events){var N=this._events[o];if(N){this._firingCount=this._firingCount+1||1;for(var F=0,$=N.length;F<$;F++){var re=N[F],ae=re.fn;re.once&&this.off(o,ae,re.ctx),ae.call(re.ctx||this,C)}this._firingCount--}}return x&&this._propagateEvent(C),this},listens:function(o,h,x,C){typeof o!="string"&&console.warn('"string" type argument expected');var N=h;typeof h!="function"&&(C=!!h,N=void 0,x=void 0);var F=this._events&&this._events[o];if(F&&F.length&&this._listens(o,N,x)!==!1)return!0;if(C){for(var $ in this._eventParents)if(this._eventParents[$].listens(o,h,x,C))return!0}return!1},_listens:function(o,h,x){if(!this._events)return!1;var C=this._events[o]||[];if(!h)return!!C.length;x===this&&(x=void 0);for(var N=0,F=C.length;N<F;N++)if(C[N].fn===h&&C[N].ctx===x)return N;return!1},once:function(o,h,x){if(typeof o=="object")for(var C in o)this._on(C,o[C],h,!0);else{o=j(o);for(var N=0,F=o.length;N<F;N++)this._on(o[N],h,x,!0)}return this},addEventParent:function(o){return this._eventParents=this._eventParents||{},this._eventParents[v(o)]=o,this},removeEventParent:function(o){return this._eventParents&&delete this._eventParents[v(o)],this},_propagateEvent:function(o){for(var h in this._eventParents)this._eventParents[h].fire(o.type,l({layer:o.target,propagatedFrom:o.target},o),!0)}};pe.addEventListener=pe.on,pe.removeEventListener=pe.clearAllEventListeners=pe.off,pe.addOneTimeEventListener=pe.once,pe.fireEvent=pe.fire,pe.hasEventListeners=pe.listens;var ne=Te.extend(pe);function K(o,h,x){this.x=x?Math.round(o):o,this.y=x?Math.round(h):h}var me=Math.trunc||function(o){return o>0?Math.floor(o):Math.ceil(o)};K.prototype={clone:function(){return new K(this.x,this.y)},add:function(o){return this.clone()._add(le(o))},_add:function(o){return this.x+=o.x,this.y+=o.y,this},subtract:function(o){return this.clone()._subtract(le(o))},_subtract:function(o){return this.x-=o.x,this.y-=o.y,this},divideBy:function(o){return this.clone()._divideBy(o)},_divideBy:function(o){return this.x/=o,this.y/=o,this},multiplyBy:function(o){return this.clone()._multiplyBy(o)},_multiplyBy:function(o){return this.x*=o,this.y*=o,this},scaleBy:function(o){return new K(this.x*o.x,this.y*o.y)},unscaleBy:function(o){return new K(this.x/o.x,this.y/o.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=me(this.x),this.y=me(this.y),this},distanceTo:function(o){o=le(o);var h=o.x-this.x,x=o.y-this.y;return Math.sqrt(h*h+x*x)},equals:function(o){return o=le(o),o.x===this.x&&o.y===this.y},contains:function(o){return o=le(o),Math.abs(o.x)<=Math.abs(this.x)&&Math.abs(o.y)<=Math.abs(this.y)},toString:function(){return"Point("+T(this.x)+", "+T(this.y)+")"}};function le(o,h,x){return o instanceof K?o:k(o)?new K(o[0],o[1]):o==null?o:typeof o=="object"&&"x"in o&&"y"in o?new K(o.x,o.y):new K(o,h,x)}function be(o,h){if(o)for(var x=h?[o,h]:o,C=0,N=x.length;C<N;C++)this.extend(x[C])}be.prototype={extend:function(o){var h,x;if(!o)return this;if(o instanceof K||typeof o[0]=="number"||"x"in o)h=x=le(o);else if(o=we(o),h=o.min,x=o.max,!h||!x)return this;return!this.min&&!this.max?(this.min=h.clone(),this.max=x.clone()):(this.min.x=Math.min(h.x,this.min.x),this.max.x=Math.max(x.x,this.max.x),this.min.y=Math.min(h.y,this.min.y),this.max.y=Math.max(x.y,this.max.y)),this},getCenter:function(o){return le((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,o)},getBottomLeft:function(){return le(this.min.x,this.max.y)},getTopRight:function(){return le(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(o){var h,x;return typeof o[0]=="number"||o instanceof K?o=le(o):o=we(o),o instanceof be?(h=o.min,x=o.max):h=x=o,h.x>=this.min.x&&x.x<=this.max.x&&h.y>=this.min.y&&x.y<=this.max.y},intersects:function(o){o=we(o);var h=this.min,x=this.max,C=o.min,N=o.max,F=N.x>=h.x&&C.x<=x.x,$=N.y>=h.y&&C.y<=x.y;return F&&$},overlaps:function(o){o=we(o);var h=this.min,x=this.max,C=o.min,N=o.max,F=N.x>h.x&&C.x<x.x,$=N.y>h.y&&C.y<x.y;return F&&$},isValid:function(){return!!(this.min&&this.max)},pad:function(o){var h=this.min,x=this.max,C=Math.abs(h.x-x.x)*o,N=Math.abs(h.y-x.y)*o;return we(le(h.x-C,h.y-N),le(x.x+C,x.y+N))},equals:function(o){return o?(o=we(o),this.min.equals(o.getTopLeft())&&this.max.equals(o.getBottomRight())):!1}};function we(o,h){return!o||o instanceof be?o:new be(o,h)}function Qe(o,h){if(o)for(var x=h?[o,h]:o,C=0,N=x.length;C<N;C++)this.extend(x[C])}Qe.prototype={extend:function(o){var h=this._southWest,x=this._northEast,C,N;if(o instanceof Ve)C=o,N=o;else if(o instanceof Qe){if(C=o._southWest,N=o._northEast,!C||!N)return this}else return o?this.extend(fe(o)||Fe(o)):this;return!h&&!x?(this._southWest=new Ve(C.lat,C.lng),this._northEast=new Ve(N.lat,N.lng)):(h.lat=Math.min(C.lat,h.lat),h.lng=Math.min(C.lng,h.lng),x.lat=Math.max(N.lat,x.lat),x.lng=Math.max(N.lng,x.lng)),this},pad:function(o){var h=this._southWest,x=this._northEast,C=Math.abs(h.lat-x.lat)*o,N=Math.abs(h.lng-x.lng)*o;return new Qe(new Ve(h.lat-C,h.lng-N),new Ve(x.lat+C,x.lng+N))},getCenter:function(){return new Ve((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Ve(this.getNorth(),this.getWest())},getSouthEast:function(){return new Ve(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(o){typeof o[0]=="number"||o instanceof Ve||"lat"in o?o=fe(o):o=Fe(o);var h=this._southWest,x=this._northEast,C,N;return o instanceof Qe?(C=o.getSouthWest(),N=o.getNorthEast()):C=N=o,C.lat>=h.lat&&N.lat<=x.lat&&C.lng>=h.lng&&N.lng<=x.lng},intersects:function(o){o=Fe(o);var h=this._southWest,x=this._northEast,C=o.getSouthWest(),N=o.getNorthEast(),F=N.lat>=h.lat&&C.lat<=x.lat,$=N.lng>=h.lng&&C.lng<=x.lng;return F&&$},overlaps:function(o){o=Fe(o);var h=this._southWest,x=this._northEast,C=o.getSouthWest(),N=o.getNorthEast(),F=N.lat>h.lat&&C.lat<x.lat,$=N.lng>h.lng&&C.lng<x.lng;return F&&$},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(o,h){return o?(o=Fe(o),this._southWest.equals(o.getSouthWest(),h)&&this._northEast.equals(o.getNorthEast(),h)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Fe(o,h){return o instanceof Qe?o:new Qe(o,h)}function Ve(o,h,x){if(isNaN(o)||isNaN(h))throw new Error("Invalid LatLng object: ("+o+", "+h+")");this.lat=+o,this.lng=+h,x!==void 0&&(this.alt=+x)}Ve.prototype={equals:function(o,h){if(!o)return!1;o=fe(o);var x=Math.max(Math.abs(this.lat-o.lat),Math.abs(this.lng-o.lng));return x<=(h===void 0?1e-9:h)},toString:function(o){return"LatLng("+T(this.lat,o)+", "+T(this.lng,o)+")"},distanceTo:function(o){return Je.distance(this,fe(o))},wrap:function(){return Je.wrapLatLng(this)},toBounds:function(o){var h=180*o/40075017,x=h/Math.cos(Math.PI/180*this.lat);return Fe([this.lat-h,this.lng-x],[this.lat+h,this.lng+x])},clone:function(){return new Ve(this.lat,this.lng,this.alt)}};function fe(o,h,x){return o instanceof Ve?o:k(o)&&typeof o[0]!="object"?o.length===3?new Ve(o[0],o[1],o[2]):o.length===2?new Ve(o[0],o[1]):null:o==null?o:typeof o=="object"&&"lat"in o?new Ve(o.lat,"lng"in o?o.lng:o.lon,o.alt):h===void 0?null:new Ve(o,h,x)}var je={latLngToPoint:function(o,h){var x=this.projection.project(o),C=this.scale(h);return this.transformation._transform(x,C)},pointToLatLng:function(o,h){var x=this.scale(h),C=this.transformation.untransform(o,x);return this.projection.unproject(C)},project:function(o){return this.projection.project(o)},unproject:function(o){return this.projection.unproject(o)},scale:function(o){return 256*Math.pow(2,o)},zoom:function(o){return Math.log(o/256)/Math.LN2},getProjectedBounds:function(o){if(this.infinite)return null;var h=this.projection.bounds,x=this.scale(o),C=this.transformation.transform(h.min,x),N=this.transformation.transform(h.max,x);return new be(C,N)},infinite:!1,wrapLatLng:function(o){var h=this.wrapLng?S(o.lng,this.wrapLng,!0):o.lng,x=this.wrapLat?S(o.lat,this.wrapLat,!0):o.lat,C=o.alt;return new Ve(x,h,C)},wrapLatLngBounds:function(o){var h=o.getCenter(),x=this.wrapLatLng(h),C=h.lat-x.lat,N=h.lng-x.lng;if(C===0&&N===0)return o;var F=o.getSouthWest(),$=o.getNorthEast(),re=new Ve(F.lat-C,F.lng-N),ae=new Ve($.lat-C,$.lng-N);return new Qe(re,ae)}},Je=l({},je,{wrapLng:[-180,180],R:6371e3,distance:function(o,h){var x=Math.PI/180,C=o.lat*x,N=h.lat*x,F=Math.sin((h.lat-o.lat)*x/2),$=Math.sin((h.lng-o.lng)*x/2),re=F*F+Math.cos(C)*Math.cos(N)*$*$,ae=2*Math.atan2(Math.sqrt(re),Math.sqrt(1-re));return this.R*ae}}),Nn=6378137,Ue={R:Nn,MAX_LATITUDE:85.0511287798,project:function(o){var h=Math.PI/180,x=this.MAX_LATITUDE,C=Math.max(Math.min(x,o.lat),-x),N=Math.sin(C*h);return new K(this.R*o.lng*h,this.R*Math.log((1+N)/(1-N))/2)},unproject:function(o){var h=180/Math.PI;return new Ve((2*Math.atan(Math.exp(o.y/this.R))-Math.PI/2)*h,o.x*h/this.R)},bounds:function(){var o=Nn*Math.PI;return new be([-o,-o],[o,o])}()};function tt(o,h,x,C){if(k(o)){this._a=o[0],this._b=o[1],this._c=o[2],this._d=o[3];return}this._a=o,this._b=h,this._c=x,this._d=C}tt.prototype={transform:function(o,h){return this._transform(o.clone(),h)},_transform:function(o,h){return h=h||1,o.x=h*(this._a*o.x+this._b),o.y=h*(this._c*o.y+this._d),o},untransform:function(o,h){return h=h||1,new K((o.x/h-this._b)/this._a,(o.y/h-this._d)/this._c)}};function gt(o,h,x,C){return new tt(o,h,x,C)}var Le=l({},Je,{code:"EPSG:3857",projection:Ue,transformation:function(){var o=.5/(Math.PI*Ue.R);return gt(o,.5,-o,.5)}()}),yt=l({},Le,{code:"EPSG:900913"});function Ot(o){return document.createElementNS("http://www.w3.org/2000/svg",o)}function Ze(o,h){var x="",C,N,F,$,re,ae;for(C=0,F=o.length;C<F;C++){for(re=o[C],N=0,$=re.length;N<$;N++)ae=re[N],x+=(N?"L":"M")+ae.x+" "+ae.y;x+=h?Pe.svg?"z":"x":""}return x||"M0 0"}var nt=document.documentElement.style,qe="ActiveXObject"in window,Ge=qe&&!document.addEventListener,xi="msLaunchUri"in navigator&&!("documentMode"in document),ke=Bt("webkit"),dr=Bt("android"),yi=Bt("android 2")||Bt("android 3"),Sr=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Hi=dr&&Bt("Google")&&Sr<537&&!("AudioNode"in window),rt=!!window.opera,Tn=!xi&&Bt("chrome"),In=Bt("gecko")&&!ke&&!rt&&!qe,en=!Tn&&Bt("safari"),rn=Bt("phantom"),tr="OTransition"in nt,zn=navigator.platform.indexOf("Win")===0,_t=qe&&"transition"in nt,_e="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!yi,qt="MozPerspective"in nt,bt=!window.L_DISABLE_3D&&(_t||_e||qt)&&!tr&&!rn,Nt=typeof orientation<"u"||Bt("mobile"),Ls=Nt&&ke,ca=Nt&&_e,ua=!window.PointerEvent&&window.MSPointerEvent,ht=!!(window.PointerEvent||ua),ri="ontouchstart"in window||!!window.TouchEvent,Ml=!window.L_NO_TOUCH&&(ri||ht),Ol=Nt&&rt,hr=Nt&&In,da=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,xn=function(){var o=!1;try{var h=Object.defineProperty({},"passive",{get:function(){o=!0}});window.addEventListener("testPassiveEventSupport",E,h),window.removeEventListener("testPassiveEventSupport",E,h)}catch{}return o}(),Wi=function(){return!!document.createElement("canvas").getContext}(),Vi=!!(document.createElementNS&&Ot("svg").createSVGRect),Ar=!!Vi&&function(){var o=document.createElement("div");return o.innerHTML="<svg/>",(o.firstChild&&o.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Iu=!Vi&&function(){try{var o=document.createElement("div");o.innerHTML='<v:shape adj="1"/>';var h=o.firstChild;return h.style.behavior="url(#default#VML)",h&&typeof h.adj=="object"}catch{return!1}}(),vi=navigator.platform.indexOf("Mac")===0,ha=navigator.platform.indexOf("Linux")===0;function Bt(o){return navigator.userAgent.toLowerCase().indexOf(o)>=0}var Pe={ie:qe,ielt9:Ge,edge:xi,webkit:ke,android:dr,android23:yi,androidStock:Hi,opera:rt,chrome:Tn,gecko:In,safari:en,phantom:rn,opera12:tr,win:zn,ie3d:_t,webkit3d:_e,gecko3d:qt,any3d:bt,mobile:Nt,mobileWebkit:Ls,mobileWebkit3d:ca,msPointer:ua,pointer:ht,touch:Ml,touchNative:ri,mobileOpera:Ol,mobileGecko:hr,retina:da,passiveEvents:xn,canvas:Wi,svg:Vi,vml:Iu,inlineSvg:Ar,mac:vi,linux:ha},Hn=Pe.msPointer?"MSPointerDown":"pointerdown",Ae=Pe.msPointer?"MSPointerMove":"pointermove",wi=Pe.msPointer?"MSPointerUp":"pointerup",ho=Pe.msPointer?"MSPointerCancel":"pointercancel",yn={touchstart:Hn,touchmove:Ae,touchend:wi,touchcancel:ho},_i={touchstart:ii,touchmove:Rs,touchend:Rs,touchcancel:Rs},zr={},Ps=!1;function Nr(o,h,x){return h==="touchstart"&&Lt(),_i[h]?(x=_i[h].bind(this,x),o.addEventListener(yn[h],x,!1),x):(console.warn("wrong event specified:",h),E)}function ku(o,h,x){if(!yn[h]){console.warn("wrong event specified:",h);return}o.removeEventListener(yn[h],x,!1)}function Mu(o){zr[o.pointerId]=o}function Tr(o){zr[o.pointerId]&&(zr[o.pointerId]=o)}function vn(o){delete zr[o.pointerId]}function Lt(){Ps||(document.addEventListener(Hn,Mu,!0),document.addEventListener(Ae,Tr,!0),document.addEventListener(wi,vn,!0),document.addEventListener(ho,vn,!0),Ps=!0)}function Rs(o,h){if(h.pointerType!==(h.MSPOINTER_TYPE_MOUSE||"mouse")){h.touches=[];for(var x in zr)h.touches.push(zr[x]);h.changedTouches=[h],o(h)}}function ii(o,h){h.MSPOINTER_TYPE_TOUCH&&h.pointerType===h.MSPOINTER_TYPE_TOUCH&&un(h),Rs(o,h)}function fa(o){var h={},x,C;for(C in o)x=o[C],h[C]=x&&x.bind?x.bind(o):x;return o=h,h.type="dblclick",h.detail=2,h.isTrusted=!1,h._simulated=!0,h}var de=200;function Ou(o,h){o.addEventListener("dblclick",h);var x=0,C;function N(F){if(F.detail!==1){C=F.detail;return}if(!(F.pointerType==="mouse"||F.sourceCapabilities&&!F.sourceCapabilities.firesTouchEvents)){var $=Zi(F);if(!($.some(function(ae){return ae instanceof HTMLLabelElement&&ae.attributes.for})&&!$.some(function(ae){return ae instanceof HTMLInputElement||ae instanceof HTMLSelectElement}))){var re=Date.now();re-x<=de?(C++,C===2&&h(fa(F))):C=1,x=re}}}return o.addEventListener("click",N),{dblclick:h,simDblclick:N}}function Vt(o,h){o.removeEventListener("dblclick",h.dblclick),o.removeEventListener("click",h.simDblclick)}var si=te(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),js=te(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),mt=js==="webkitTransition"||js==="OTransition"?js+"End":"transitionend";function ft(o){return typeof o=="string"?document.getElementById(o):o}function et(o,h){var x=o.style[h]||o.currentStyle&&o.currentStyle[h];if((!x||x==="auto")&&document.defaultView){var C=document.defaultView.getComputedStyle(o,null);x=C?C[h]:null}return x==="auto"?null:x}function ut(o,h,x){var C=document.createElement(o);return C.className=h||"",x&&x.appendChild(C),C}function kt(o){var h=o.parentNode;h&&h.removeChild(o)}function Gi(o){for(;o.firstChild;)o.removeChild(o.firstChild)}function Pt(o){var h=o.parentNode;h&&h.lastChild!==o&&h.appendChild(o)}function Wn(o){var h=o.parentNode;h&&h.firstChild!==o&&h.insertBefore(o,h.firstChild)}function ga(o,h){if(o.classList!==void 0)return o.classList.contains(h);var x=Hr(o);return x.length>0&&new RegExp("(^|\\s)"+h+"(\\s|$)").test(x)}function De(o,h){if(o.classList!==void 0)for(var x=j(h),C=0,N=x.length;C<N;C++)o.classList.add(x[C]);else if(!ga(o,h)){var F=Hr(o);ma(o,(F?F+" ":"")+h)}}function vt(o,h){o.classList!==void 0?o.classList.remove(h):ma(o,U((" "+Hr(o)+" ").replace(" "+h+" "," ")))}function ma(o,h){o.className.baseVal===void 0?o.className=h:o.className.baseVal=h}function Hr(o){return o.correspondingElement&&(o=o.correspondingElement),o.className.baseVal===void 0?o.className:o.className.baseVal}function it(o,h){"opacity"in o.style?o.style.opacity=h:"filter"in o.style&&wn(o,h)}function wn(o,h){var x=!1,C="DXImageTransform.Microsoft.Alpha";try{x=o.filters.item(C)}catch{if(h===1)return}h=Math.round(h*100),x?(x.Enabled=h!==100,x.Opacity=h):o.style.filter+=" progid:"+C+"(opacity="+h+")"}function te(o){for(var h=document.documentElement.style,x=0;x<o.length;x++)if(o[x]in h)return o[x];return!1}function W(o,h,x){var C=h||new K(0,0);o.style[si]=(Pe.ie3d?"translate("+C.x+"px,"+C.y+"px)":"translate3d("+C.x+"px,"+C.y+"px,0)")+(x?" scale("+x+")":"")}function Ce(o,h){o._leaflet_pos=h,Pe.any3d?W(o,h):(o.style.left=h.x+"px",o.style.top=h.y+"px")}function Rt(o){return o._leaflet_pos||new K(0,0)}var _n,Ds,Bs;if("onselectstart"in document)_n=function(){We(window,"selectstart",un)},Ds=function(){Se(window,"selectstart",un)};else{var bn=te(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);_n=function(){if(bn){var o=document.documentElement.style;Bs=o[bn],o[bn]="none"}},Ds=function(){bn&&(document.documentElement.style[bn]=Bs,Bs=void 0)}}function Be(){We(window,"dragstart",un)}function Mt(){Se(window,"dragstart",un)}var Fs,pa;function Us(o){for(;o.tabIndex===-1;)o=o.parentNode;o.style&&(bi(),Fs=o,pa=o.style.outlineStyle,o.style.outlineStyle="none",We(window,"keydown",bi))}function bi(){Fs&&(Fs.style.outlineStyle=pa,Fs=void 0,pa=void 0,Se(window,"keydown",bi))}function fo(o){do o=o.parentNode;while((!o.offsetWidth||!o.offsetHeight)&&o!==document.body);return o}function xa(o){var h=o.getBoundingClientRect();return{x:h.width/o.offsetWidth||1,y:h.height/o.offsetHeight||1,boundingClientRect:h}}var sn={__proto__:null,TRANSFORM:si,TRANSITION:js,TRANSITION_END:mt,get:ft,getStyle:et,create:ut,remove:kt,empty:Gi,toFront:Pt,toBack:Wn,hasClass:ga,addClass:De,removeClass:vt,setClass:ma,getClass:Hr,setOpacity:it,testProp:te,setTransform:W,setPosition:Ce,getPosition:Rt,get disableTextSelection(){return _n},get enableTextSelection(){return Ds},disableImageDrag:Be,enableImageDrag:Mt,preventOutline:Us,restoreOutline:bi,getSizedParentNode:fo,getScale:xa};function We(o,h,x,C){if(h&&typeof h=="object")for(var N in h)tn(o,N,h[N],x);else{h=j(h);for(var F=0,$=h.length;F<$;F++)tn(o,h[F],x,C)}return this}var cn="_leaflet_events";function Se(o,h,x,C){if(arguments.length===1)Ll(o),delete o[cn];else if(h&&typeof h=="object")for(var N in h)ya(o,N,h[N],x);else if(h=j(h),arguments.length===2)Ll(o,function(re){return z(h,re)!==-1});else for(var F=0,$=h.length;F<$;F++)ya(o,h[F],x,C);return this}function Ll(o,h){for(var x in o[cn]){var C=x.split(/\d/)[0];(!h||h(C))&&ya(o,C,null,null,x)}}var Ye={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function tn(o,h,x,C){var N=h+v(x)+(C?"_"+v(C):"");if(o[cn]&&o[cn][N])return this;var F=function(re){return x.call(C||o,re||window.event)},$=F;!Pe.touchNative&&Pe.pointer&&h.indexOf("touch")===0?F=Nr(o,h,F):Pe.touch&&h==="dblclick"?F=Ou(o,F):"addEventListener"in o?h==="touchstart"||h==="touchmove"||h==="wheel"||h==="mousewheel"?o.addEventListener(Ye[h]||h,F,Pe.passiveEvents?{passive:!1}:!1):h==="mouseenter"||h==="mouseleave"?(F=function(re){re=re||window.event,Ci(o,re)&&$(re)},o.addEventListener(Ye[h],F,!1)):o.addEventListener(h,$,!1):o.attachEvent("on"+h,F),o[cn]=o[cn]||{},o[cn][N]=F}function ya(o,h,x,C,N){N=N||h+v(x)+(C?"_"+v(C):"");var F=o[cn]&&o[cn][N];if(!F)return this;!Pe.touchNative&&Pe.pointer&&h.indexOf("touch")===0?ku(o,h,F):Pe.touch&&h==="dblclick"?Vt(o,F):"removeEventListener"in o?o.removeEventListener(Ye[h]||h,F,!1):o.detachEvent("on"+h,F),o[cn][N]=null}function Wr(o){return o.stopPropagation?o.stopPropagation():o.originalEvent?o.originalEvent._stopped=!0:o.cancelBubble=!0,this}function go(o){return tn(o,"wheel",Wr),this}function fr(o){return We(o,"mousedown touchstart dblclick contextmenu",Wr),o._leaflet_disable_click=!0,this}function un(o){return o.preventDefault?o.preventDefault():o.returnValue=!1,this}function gr(o){return un(o),Wr(o),this}function Zi(o){if(o.composedPath)return o.composedPath();for(var h=[],x=o.target;x;)h.push(x),x=x.parentNode;return h}function Yi(o,h){if(!h)return new K(o.clientX,o.clientY);var x=xa(h),C=x.boundingClientRect;return new K((o.clientX-C.left)/x.x-h.clientLeft,(o.clientY-C.top)/x.y-h.clientTop)}var Pl=Pe.linux&&Pe.chrome?window.devicePixelRatio:Pe.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function $i(o){return Pe.edge?o.wheelDeltaY/2:o.deltaY&&o.deltaMode===0?-o.deltaY/Pl:o.deltaY&&o.deltaMode===1?-o.deltaY*20:o.deltaY&&o.deltaMode===2?-o.deltaY*60:o.deltaX||o.deltaZ?0:o.wheelDelta?(o.wheelDeltaY||o.wheelDelta)/2:o.detail&&Math.abs(o.detail)<32765?-o.detail*20:o.detail?o.detail/-32765*60:0}function Ci(o,h){var x=h.relatedTarget;if(!x)return!0;try{for(;x&&x!==o;)x=x.parentNode}catch{return!1}return x!==o}var Ln={__proto__:null,on:We,off:Se,stopPropagation:Wr,disableScrollPropagation:go,disableClickPropagation:fr,preventDefault:un,stop:gr,getPropagationPath:Zi,getMousePosition:Yi,getWheelDelta:$i,isExternalTarget:Ci,addListener:We,removeListener:Se},va=ne.extend({run:function(o,h,x,C){this.stop(),this._el=o,this._inProgress=!0,this._duration=x||.25,this._easeOutPower=1/Math.max(C||.5,.2),this._startPos=Rt(o),this._offset=h.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=ce(this._animate,this),this._step()},_step:function(o){var h=+new Date-this._startTime,x=this._duration*1e3;h<x?this._runFrame(this._easeOut(h/x),o):(this._runFrame(1),this._complete())},_runFrame:function(o,h){var x=this._startPos.add(this._offset.multiplyBy(o));h&&x._round(),Ce(this._el,x),this.fire("step")},_complete:function(){ue(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(o){return 1-Math.pow(1-o,this._easeOutPower)}}),at=ne.extend({options:{crs:Le,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(o,h){h=P(this,h),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(o),this._initLayout(),this._onResize=m(this._onResize,this),this._initEvents(),h.maxBounds&&this.setMaxBounds(h.maxBounds),h.zoom!==void 0&&(this._zoom=this._limitZoom(h.zoom)),h.center&&h.zoom!==void 0&&this.setView(fe(h.center),h.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=js&&Pe.any3d&&!Pe.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),We(this._proxy,mt,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(o,h,x){if(h=h===void 0?this._zoom:this._limitZoom(h),o=this._limitCenter(fe(o),h,this.options.maxBounds),x=x||{},this._stop(),this._loaded&&!x.reset&&x!==!0){x.animate!==void 0&&(x.zoom=l({animate:x.animate},x.zoom),x.pan=l({animate:x.animate,duration:x.duration},x.pan));var C=this._zoom!==h?this._tryAnimatedZoom&&this._tryAnimatedZoom(o,h,x.zoom):this._tryAnimatedPan(o,x.pan);if(C)return clearTimeout(this._sizeTimer),this}return this._resetView(o,h,x.pan&&x.pan.noMoveStart),this},setZoom:function(o,h){return this._loaded?this.setView(this.getCenter(),o,{zoom:h}):(this._zoom=o,this)},zoomIn:function(o,h){return o=o||(Pe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+o,h)},zoomOut:function(o,h){return o=o||(Pe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-o,h)},setZoomAround:function(o,h,x){var C=this.getZoomScale(h),N=this.getSize().divideBy(2),F=o instanceof K?o:this.latLngToContainerPoint(o),$=F.subtract(N).multiplyBy(1-1/C),re=this.containerPointToLatLng(N.add($));return this.setView(re,h,{zoom:x})},_getBoundsCenterZoom:function(o,h){h=h||{},o=o.getBounds?o.getBounds():Fe(o);var x=le(h.paddingTopLeft||h.padding||[0,0]),C=le(h.paddingBottomRight||h.padding||[0,0]),N=this.getBoundsZoom(o,!1,x.add(C));if(N=typeof h.maxZoom=="number"?Math.min(h.maxZoom,N):N,N===1/0)return{center:o.getCenter(),zoom:N};var F=C.subtract(x).divideBy(2),$=this.project(o.getSouthWest(),N),re=this.project(o.getNorthEast(),N),ae=this.unproject($.add(re).divideBy(2).add(F),N);return{center:ae,zoom:N}},fitBounds:function(o,h){if(o=Fe(o),!o.isValid())throw new Error("Bounds are not valid.");var x=this._getBoundsCenterZoom(o,h);return this.setView(x.center,x.zoom,h)},fitWorld:function(o){return this.fitBounds([[-90,-180],[90,180]],o)},panTo:function(o,h){return this.setView(o,this._zoom,{pan:h})},panBy:function(o,h){if(o=le(o).round(),h=h||{},!o.x&&!o.y)return this.fire("moveend");if(h.animate!==!0&&!this.getSize().contains(o))return this._resetView(this.unproject(this.project(this.getCenter()).add(o)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new va,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),h.noMoveStart||this.fire("movestart"),h.animate!==!1){De(this._mapPane,"leaflet-pan-anim");var x=this._getMapPanePos().subtract(o).round();this._panAnim.run(this._mapPane,x,h.duration||.25,h.easeLinearity)}else this._rawPanBy(o),this.fire("move").fire("moveend");return this},flyTo:function(o,h,x){if(x=x||{},x.animate===!1||!Pe.any3d)return this.setView(o,h,x);this._stop();var C=this.project(this.getCenter()),N=this.project(o),F=this.getSize(),$=this._zoom;o=fe(o),h=h===void 0?$:h;var re=Math.max(F.x,F.y),ae=re*this.getZoomScale($,h),he=N.distanceTo(C)||1,Ne=1.42,He=Ne*Ne;function ot(an){var Hl=an?-1:1,Qx=an?ae:re,Jx=ae*ae-re*re+Hl*He*He*he*he,ey=2*Qx*He*he,Fu=Jx/ey,c0=Math.sqrt(Fu*Fu+1)-Fu,ty=c0<1e-9?-18:Math.log(c0);return ty}function Yn(an){return(Math.exp(an)-Math.exp(-an))/2}function Cn(an){return(Math.exp(an)+Math.exp(-an))/2}function Pr(an){return Yn(an)/Cn(an)}var rr=ot(0);function vo(an){return re*(Cn(rr)/Cn(rr+Ne*an))}function $x(an){return re*(Cn(rr)*Pr(rr+Ne*an)-Yn(rr))/He}function Xx(an){return 1-Math.pow(1-an,1.5)}var qx=Date.now(),a0=(ot(1)-rr)/Ne,Kx=x.duration?1e3*x.duration:1e3*a0*.8;function l0(){var an=(Date.now()-qx)/Kx,Hl=Xx(an)*a0;an<=1?(this._flyToFrame=ce(l0,this),this._move(this.unproject(C.add(N.subtract(C).multiplyBy($x(Hl)/he)),$),this.getScaleZoom(re/vo(Hl),$),{flyTo:!0})):this._move(o,h)._moveEnd(!0)}return this._moveStart(!0,x.noMoveStart),l0.call(this),this},flyToBounds:function(o,h){var x=this._getBoundsCenterZoom(o,h);return this.flyTo(x.center,x.zoom,h)},setMaxBounds:function(o){return o=Fe(o),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),o.isValid()?(this.options.maxBounds=o,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(o){var h=this.options.minZoom;return this.options.minZoom=o,this._loaded&&h!==o&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(o):this},setMaxZoom:function(o){var h=this.options.maxZoom;return this.options.maxZoom=o,this._loaded&&h!==o&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(o):this},panInsideBounds:function(o,h){this._enforcingBounds=!0;var x=this.getCenter(),C=this._limitCenter(x,this._zoom,Fe(o));return x.equals(C)||this.panTo(C,h),this._enforcingBounds=!1,this},panInside:function(o,h){h=h||{};var x=le(h.paddingTopLeft||h.padding||[0,0]),C=le(h.paddingBottomRight||h.padding||[0,0]),N=this.project(this.getCenter()),F=this.project(o),$=this.getPixelBounds(),re=we([$.min.add(x),$.max.subtract(C)]),ae=re.getSize();if(!re.contains(F)){this._enforcingBounds=!0;var he=F.subtract(re.getCenter()),Ne=re.extend(F).getSize().subtract(ae);N.x+=he.x<0?-Ne.x:Ne.x,N.y+=he.y<0?-Ne.y:Ne.y,this.panTo(this.unproject(N),h),this._enforcingBounds=!1}return this},invalidateSize:function(o){if(!this._loaded)return this;o=l({animate:!1,pan:!0},o===!0?{animate:!0}:o);var h=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var x=this.getSize(),C=h.divideBy(2).round(),N=x.divideBy(2).round(),F=C.subtract(N);return!F.x&&!F.y?this:(o.animate&&o.pan?this.panBy(F):(o.pan&&this._rawPanBy(F),this.fire("move"),o.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(m(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:h,newSize:x}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(o){if(o=this._locateOptions=l({timeout:1e4,watch:!1},o),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var h=m(this._handleGeolocationResponse,this),x=m(this._handleGeolocationError,this);return o.watch?this._locationWatchId=navigator.geolocation.watchPosition(h,x,o):navigator.geolocation.getCurrentPosition(h,x,o),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(o){if(this._container._leaflet_id){var h=o.code,x=o.message||(h===1?"permission denied":h===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:h,message:"Geolocation error: "+x+"."})}},_handleGeolocationResponse:function(o){if(this._container._leaflet_id){var h=o.coords.latitude,x=o.coords.longitude,C=new Ve(h,x),N=C.toBounds(o.coords.accuracy*2),F=this._locateOptions;if(F.setView){var $=this.getBoundsZoom(N);this.setView(C,F.maxZoom?Math.min($,F.maxZoom):$)}var re={latlng:C,bounds:N,timestamp:o.timestamp};for(var ae in o.coords)typeof o.coords[ae]=="number"&&(re[ae]=o.coords[ae]);this.fire("locationfound",re)}},addHandler:function(o,h){if(!h)return this;var x=this[o]=new h(this);return this._handlers.push(x),this.options[o]&&x.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),kt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(ue(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var o;for(o in this._layers)this._layers[o].remove();for(o in this._panes)kt(this._panes[o]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(o,h){var x="leaflet-pane"+(o?" leaflet-"+o.replace("Pane","")+"-pane":""),C=ut("div",x,h||this._mapPane);return o&&(this._panes[o]=C),C},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var o=this.getPixelBounds(),h=this.unproject(o.getBottomLeft()),x=this.unproject(o.getTopRight());return new Qe(h,x)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(o,h,x){o=Fe(o),x=le(x||[0,0]);var C=this.getZoom()||0,N=this.getMinZoom(),F=this.getMaxZoom(),$=o.getNorthWest(),re=o.getSouthEast(),ae=this.getSize().subtract(x),he=we(this.project(re,C),this.project($,C)).getSize(),Ne=Pe.any3d?this.options.zoomSnap:1,He=ae.x/he.x,ot=ae.y/he.y,Yn=h?Math.max(He,ot):Math.min(He,ot);return C=this.getScaleZoom(Yn,C),Ne&&(C=Math.round(C/(Ne/100))*(Ne/100),C=h?Math.ceil(C/Ne)*Ne:Math.floor(C/Ne)*Ne),Math.max(N,Math.min(F,C))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new K(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(o,h){var x=this._getTopLeftPoint(o,h);return new be(x,x.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(o){return this.options.crs.getProjectedBounds(o===void 0?this.getZoom():o)},getPane:function(o){return typeof o=="string"?this._panes[o]:o},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(o,h){var x=this.options.crs;return h=h===void 0?this._zoom:h,x.scale(o)/x.scale(h)},getScaleZoom:function(o,h){var x=this.options.crs;h=h===void 0?this._zoom:h;var C=x.zoom(o*x.scale(h));return isNaN(C)?1/0:C},project:function(o,h){return h=h===void 0?this._zoom:h,this.options.crs.latLngToPoint(fe(o),h)},unproject:function(o,h){return h=h===void 0?this._zoom:h,this.options.crs.pointToLatLng(le(o),h)},layerPointToLatLng:function(o){var h=le(o).add(this.getPixelOrigin());return this.unproject(h)},latLngToLayerPoint:function(o){var h=this.project(fe(o))._round();return h._subtract(this.getPixelOrigin())},wrapLatLng:function(o){return this.options.crs.wrapLatLng(fe(o))},wrapLatLngBounds:function(o){return this.options.crs.wrapLatLngBounds(Fe(o))},distance:function(o,h){return this.options.crs.distance(fe(o),fe(h))},containerPointToLayerPoint:function(o){return le(o).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(o){return le(o).add(this._getMapPanePos())},containerPointToLatLng:function(o){var h=this.containerPointToLayerPoint(le(o));return this.layerPointToLatLng(h)},latLngToContainerPoint:function(o){return this.layerPointToContainerPoint(this.latLngToLayerPoint(fe(o)))},mouseEventToContainerPoint:function(o){return Yi(o,this._container)},mouseEventToLayerPoint:function(o){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(o))},mouseEventToLatLng:function(o){return this.layerPointToLatLng(this.mouseEventToLayerPoint(o))},_initContainer:function(o){var h=this._container=ft(o);if(h){if(h._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");We(h,"scroll",this._onScroll,this),this._containerId=v(h)},_initLayout:function(){var o=this._container;this._fadeAnimated=this.options.fadeAnimation&&Pe.any3d,De(o,"leaflet-container"+(Pe.touch?" leaflet-touch":"")+(Pe.retina?" leaflet-retina":"")+(Pe.ielt9?" leaflet-oldie":"")+(Pe.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var h=et(o,"position");h!=="absolute"&&h!=="relative"&&h!=="fixed"&&h!=="sticky"&&(o.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var o=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Ce(this._mapPane,new K(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(De(o.markerPane,"leaflet-zoom-hide"),De(o.shadowPane,"leaflet-zoom-hide"))},_resetView:function(o,h,x){Ce(this._mapPane,new K(0,0));var C=!this._loaded;this._loaded=!0,h=this._limitZoom(h),this.fire("viewprereset");var N=this._zoom!==h;this._moveStart(N,x)._move(o,h)._moveEnd(N),this.fire("viewreset"),C&&this.fire("load")},_moveStart:function(o,h){return o&&this.fire("zoomstart"),h||this.fire("movestart"),this},_move:function(o,h,x,C){h===void 0&&(h=this._zoom);var N=this._zoom!==h;return this._zoom=h,this._lastCenter=o,this._pixelOrigin=this._getNewPixelOrigin(o),C?x&&x.pinch&&this.fire("zoom",x):((N||x&&x.pinch)&&this.fire("zoom",x),this.fire("move",x)),this},_moveEnd:function(o){return o&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return ue(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(o){Ce(this._mapPane,this._getMapPanePos().subtract(o))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(o){this._targets={},this._targets[v(this._container)]=this;var h=o?Se:We;h(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&h(window,"resize",this._onResize,this),Pe.any3d&&this.options.transform3DLimit&&(o?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){ue(this._resizeRequest),this._resizeRequest=ce(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var o=this._getMapPanePos();Math.max(Math.abs(o.x),Math.abs(o.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(o,h){for(var x=[],C,N=h==="mouseout"||h==="mouseover",F=o.target||o.srcElement,$=!1;F;){if(C=this._targets[v(F)],C&&(h==="click"||h==="preclick")&&this._draggableMoved(C)){$=!0;break}if(C&&C.listens(h,!0)&&(N&&!Ci(F,o)||(x.push(C),N))||F===this._container)break;F=F.parentNode}return!x.length&&!$&&!N&&this.listens(h,!0)&&(x=[this]),x},_isClickDisabled:function(o){for(;o&&o!==this._container;){if(o._leaflet_disable_click)return!0;o=o.parentNode}},_handleDOMEvent:function(o){var h=o.target||o.srcElement;if(!(!this._loaded||h._leaflet_disable_events||o.type==="click"&&this._isClickDisabled(h))){var x=o.type;x==="mousedown"&&Us(h),this._fireDOMEvent(o,x)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(o,h,x){if(o.type==="click"){var C=l({},o);C.type="preclick",this._fireDOMEvent(C,C.type,x)}var N=this._findEventTargets(o,h);if(x){for(var F=[],$=0;$<x.length;$++)x[$].listens(h,!0)&&F.push(x[$]);N=F.concat(N)}if(N.length){h==="contextmenu"&&un(o);var re=N[0],ae={originalEvent:o};if(o.type!=="keypress"&&o.type!=="keydown"&&o.type!=="keyup"){var he=re.getLatLng&&(!re._radius||re._radius<=10);ae.containerPoint=he?this.latLngToContainerPoint(re.getLatLng()):this.mouseEventToContainerPoint(o),ae.layerPoint=this.containerPointToLayerPoint(ae.containerPoint),ae.latlng=he?re.getLatLng():this.layerPointToLatLng(ae.layerPoint)}for($=0;$<N.length;$++)if(N[$].fire(h,ae,!0),ae.originalEvent._stopped||N[$].options.bubblingMouseEvents===!1&&z(this._mouseEvents,h)!==-1)return}},_draggableMoved:function(o){return o=o.dragging&&o.dragging.enabled()?o:this,o.dragging&&o.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var o=0,h=this._handlers.length;o<h;o++)this._handlers[o].disable()},whenReady:function(o,h){return this._loaded?o.call(h||this,{target:this}):this.on("load",o,h),this},_getMapPanePos:function(){return Rt(this._mapPane)||new K(0,0)},_moved:function(){var o=this._getMapPanePos();return o&&!o.equals([0,0])},_getTopLeftPoint:function(o,h){var x=o&&h!==void 0?this._getNewPixelOrigin(o,h):this.getPixelOrigin();return x.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(o,h){var x=this.getSize()._divideBy(2);return this.project(o,h)._subtract(x)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(o,h,x){var C=this._getNewPixelOrigin(x,h);return this.project(o,h)._subtract(C)},_latLngBoundsToNewLayerBounds:function(o,h,x){var C=this._getNewPixelOrigin(x,h);return we([this.project(o.getSouthWest(),h)._subtract(C),this.project(o.getNorthWest(),h)._subtract(C),this.project(o.getSouthEast(),h)._subtract(C),this.project(o.getNorthEast(),h)._subtract(C)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(o){return this.latLngToLayerPoint(o).subtract(this._getCenterLayerPoint())},_limitCenter:function(o,h,x){if(!x)return o;var C=this.project(o,h),N=this.getSize().divideBy(2),F=new be(C.subtract(N),C.add(N)),$=this._getBoundsOffset(F,x,h);return Math.abs($.x)<=1&&Math.abs($.y)<=1?o:this.unproject(C.add($),h)},_limitOffset:function(o,h){if(!h)return o;var x=this.getPixelBounds(),C=new be(x.min.add(o),x.max.add(o));return o.add(this._getBoundsOffset(C,h))},_getBoundsOffset:function(o,h,x){var C=we(this.project(h.getNorthEast(),x),this.project(h.getSouthWest(),x)),N=C.min.subtract(o.min),F=C.max.subtract(o.max),$=this._rebound(N.x,-F.x),re=this._rebound(N.y,-F.y);return new K($,re)},_rebound:function(o,h){return o+h>0?Math.round(o-h)/2:Math.max(0,Math.ceil(o))-Math.max(0,Math.floor(h))},_limitZoom:function(o){var h=this.getMinZoom(),x=this.getMaxZoom(),C=Pe.any3d?this.options.zoomSnap:1;return C&&(o=Math.round(o/C)*C),Math.max(h,Math.min(x,o))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){vt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(o,h){var x=this._getCenterOffset(o)._trunc();return(h&&h.animate)!==!0&&!this.getSize().contains(x)?!1:(this.panBy(x,h),!0)},_createAnimProxy:function(){var o=this._proxy=ut("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(o),this.on("zoomanim",function(h){var x=si,C=this._proxy.style[x];W(this._proxy,this.project(h.center,h.zoom),this.getZoomScale(h.zoom,1)),C===this._proxy.style[x]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){kt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var o=this.getCenter(),h=this.getZoom();W(this._proxy,this.project(o,h),this.getZoomScale(h,1))},_catchTransitionEnd:function(o){this._animatingZoom&&o.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(o,h,x){if(this._animatingZoom)return!0;if(x=x||{},!this._zoomAnimated||x.animate===!1||this._nothingToAnimate()||Math.abs(h-this._zoom)>this.options.zoomAnimationThreshold)return!1;var C=this.getZoomScale(h),N=this._getCenterOffset(o)._divideBy(1-1/C);return x.animate!==!0&&!this.getSize().contains(N)?!1:(ce(function(){this._moveStart(!0,x.noMoveStart||!1)._animateZoom(o,h,!0)},this),!0)},_animateZoom:function(o,h,x,C){this._mapPane&&(x&&(this._animatingZoom=!0,this._animateToCenter=o,this._animateToZoom=h,De(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:o,zoom:h,noUpdate:C}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(m(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&vt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Rl(o,h){return new at(o,h)}var mr=Te.extend({options:{position:"topright"},initialize:function(o){P(this,o)},getPosition:function(){return this.options.position},setPosition:function(o){var h=this._map;return h&&h.removeControl(this),this.options.position=o,h&&h.addControl(this),this},getContainer:function(){return this._container},addTo:function(o){this.remove(),this._map=o;var h=this._container=this.onAdd(o),x=this.getPosition(),C=o._controlCorners[x];return De(h,"leaflet-control"),x.indexOf("bottom")!==-1?C.insertBefore(h,C.firstChild):C.appendChild(h),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(kt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(o){this._map&&o&&o.screenX>0&&o.screenY>0&&this._map.getContainer().focus()}}),zs=function(o){return new mr(o)};at.include({addControl:function(o){return o.addTo(this),this},removeControl:function(o){return o.remove(),this},_initControlPos:function(){var o=this._controlCorners={},h="leaflet-",x=this._controlContainer=ut("div",h+"control-container",this._container);function C(N,F){var $=h+N+" "+h+F;o[N+F]=ut("div",$,x)}C("top","left"),C("top","right"),C("bottom","left"),C("bottom","right")},_clearControlPos:function(){for(var o in this._controlCorners)kt(this._controlCorners[o]);kt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var jl=mr.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(o,h,x,C){return x<C?-1:C<x?1:0}},initialize:function(o,h,x){P(this,x),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var C in o)this._addLayer(o[C],C);for(C in h)this._addLayer(h[C],C,!0)},onAdd:function(o){this._initLayout(),this._update(),this._map=o,o.on("zoomend",this._checkDisabledLayers,this);for(var h=0;h<this._layers.length;h++)this._layers[h].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(o){return mr.prototype.addTo.call(this,o),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var o=0;o<this._layers.length;o++)this._layers[o].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(o,h){return this._addLayer(o,h),this._map?this._update():this},addOverlay:function(o,h){return this._addLayer(o,h,!0),this._map?this._update():this},removeLayer:function(o){o.off("add remove",this._onLayerChange,this);var h=this._getLayer(v(o));return h&&this._layers.splice(this._layers.indexOf(h),1),this._map?this._update():this},expand:function(){De(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var o=this._map.getSize().y-(this._container.offsetTop+50);return o<this._section.clientHeight?(De(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=o+"px"):vt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return vt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var o="leaflet-control-layers",h=this._container=ut("div",o),x=this.options.collapsed;h.setAttribute("aria-haspopup",!0),fr(h),go(h);var C=this._section=ut("section",o+"-list");x&&(this._map.on("click",this.collapse,this),We(h,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var N=this._layersLink=ut("a",o+"-toggle",h);N.href="#",N.title="Layers",N.setAttribute("role","button"),We(N,{keydown:function(F){F.keyCode===13&&this._expandSafely()},click:function(F){un(F),this._expandSafely()}},this),x||this.expand(),this._baseLayersList=ut("div",o+"-base",C),this._separator=ut("div",o+"-separator",C),this._overlaysList=ut("div",o+"-overlays",C),h.appendChild(C)},_getLayer:function(o){for(var h=0;h<this._layers.length;h++)if(this._layers[h]&&v(this._layers[h].layer)===o)return this._layers[h]},_addLayer:function(o,h,x){this._map&&o.on("add remove",this._onLayerChange,this),this._layers.push({layer:o,name:h,overlay:x}),this.options.sortLayers&&this._layers.sort(m(function(C,N){return this.options.sortFunction(C.layer,N.layer,C.name,N.name)},this)),this.options.autoZIndex&&o.setZIndex&&(this._lastZIndex++,o.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Gi(this._baseLayersList),Gi(this._overlaysList),this._layerControlInputs=[];var o,h,x,C,N=0;for(x=0;x<this._layers.length;x++)C=this._layers[x],this._addItem(C),h=h||C.overlay,o=o||!C.overlay,N+=C.overlay?0:1;return this.options.hideSingleBase&&(o=o&&N>1,this._baseLayersList.style.display=o?"":"none"),this._separator.style.display=h&&o?"":"none",this},_onLayerChange:function(o){this._handlingClick||this._update();var h=this._getLayer(v(o.target)),x=h.overlay?o.type==="add"?"overlayadd":"overlayremove":o.type==="add"?"baselayerchange":null;x&&this._map.fire(x,h)},_createRadioElement:function(o,h){var x='<input type="radio" class="leaflet-control-layers-selector" name="'+o+'"'+(h?' checked="checked"':"")+"/>",C=document.createElement("div");return C.innerHTML=x,C.firstChild},_addItem:function(o){var h=document.createElement("label"),x=this._map.hasLayer(o.layer),C;o.overlay?(C=document.createElement("input"),C.type="checkbox",C.className="leaflet-control-layers-selector",C.defaultChecked=x):C=this._createRadioElement("leaflet-base-layers_"+v(this),x),this._layerControlInputs.push(C),C.layerId=v(o.layer),We(C,"click",this._onInputClick,this);var N=document.createElement("span");N.innerHTML=" "+o.name;var F=document.createElement("span");h.appendChild(F),F.appendChild(C),F.appendChild(N);var $=o.overlay?this._overlaysList:this._baseLayersList;return $.appendChild(h),this._checkDisabledLayers(),h},_onInputClick:function(){if(!this._preventClick){var o=this._layerControlInputs,h,x,C=[],N=[];this._handlingClick=!0;for(var F=o.length-1;F>=0;F--)h=o[F],x=this._getLayer(h.layerId).layer,h.checked?C.push(x):h.checked||N.push(x);for(F=0;F<N.length;F++)this._map.hasLayer(N[F])&&this._map.removeLayer(N[F]);for(F=0;F<C.length;F++)this._map.hasLayer(C[F])||this._map.addLayer(C[F]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var o=this._layerControlInputs,h,x,C=this._map.getZoom(),N=o.length-1;N>=0;N--)h=o[N],x=this._getLayer(h.layerId).layer,h.disabled=x.options.minZoom!==void 0&&C<x.options.minZoom||x.options.maxZoom!==void 0&&C>x.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var o=this._section;this._preventClick=!0,We(o,"click",un),this.expand();var h=this;setTimeout(function(){Se(o,"click",un),h._preventClick=!1})}}),wt=function(o,h,x){return new jl(o,h,x)},mo=mr.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(o){var h="leaflet-control-zoom",x=ut("div",h+" leaflet-bar"),C=this.options;return this._zoomInButton=this._createButton(C.zoomInText,C.zoomInTitle,h+"-in",x,this._zoomIn),this._zoomOutButton=this._createButton(C.zoomOutText,C.zoomOutTitle,h+"-out",x,this._zoomOut),this._updateDisabled(),o.on("zoomend zoomlevelschange",this._updateDisabled,this),x},onRemove:function(o){o.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(o){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(o.shiftKey?3:1))},_zoomOut:function(o){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(o.shiftKey?3:1))},_createButton:function(o,h,x,C,N){var F=ut("a",x,C);return F.innerHTML=o,F.href="#",F.title=h,F.setAttribute("role","button"),F.setAttribute("aria-label",h),fr(F),We(F,"click",gr),We(F,"click",N,this),We(F,"click",this._refocusOnMap,this),F},_updateDisabled:function(){var o=this._map,h="leaflet-disabled";vt(this._zoomInButton,h),vt(this._zoomOutButton,h),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||o._zoom===o.getMinZoom())&&(De(this._zoomOutButton,h),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||o._zoom===o.getMaxZoom())&&(De(this._zoomInButton,h),this._zoomInButton.setAttribute("aria-disabled","true"))}});at.mergeOptions({zoomControl:!0}),at.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new mo,this.addControl(this.zoomControl))});var po=function(o){return new mo(o)},Vr=mr.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(o){var h="leaflet-control-scale",x=ut("div",h),C=this.options;return this._addScales(C,h+"-line",x),o.on(C.updateWhenIdle?"moveend":"move",this._update,this),o.whenReady(this._update,this),x},onRemove:function(o){o.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(o,h,x){o.metric&&(this._mScale=ut("div",h,x)),o.imperial&&(this._iScale=ut("div",h,x))},_update:function(){var o=this._map,h=o.getSize().y/2,x=o.distance(o.containerPointToLatLng([0,h]),o.containerPointToLatLng([this.options.maxWidth,h]));this._updateScales(x)},_updateScales:function(o){this.options.metric&&o&&this._updateMetric(o),this.options.imperial&&o&&this._updateImperial(o)},_updateMetric:function(o){var h=this._getRoundNum(o),x=h<1e3?h+" m":h/1e3+" km";this._updateScale(this._mScale,x,h/o)},_updateImperial:function(o){var h=o*3.2808399,x,C,N;h>5280?(x=h/5280,C=this._getRoundNum(x),this._updateScale(this._iScale,C+" mi",C/x)):(N=this._getRoundNum(h),this._updateScale(this._iScale,N+" ft",N/h))},_updateScale:function(o,h,x){o.style.width=Math.round(this.options.maxWidth*x)+"px",o.innerHTML=h},_getRoundNum:function(o){var h=Math.pow(10,(Math.floor(o)+"").length-1),x=o/h;return x=x>=10?10:x>=5?5:x>=3?3:x>=2?2:1,h*x}}),Lu=function(o){return new Vr(o)},oe='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Xe=mr.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Pe.inlineSvg?oe+" ":"")+"Leaflet</a>"},initialize:function(o){P(this,o),this._attributions={}},onAdd:function(o){o.attributionControl=this,this._container=ut("div","leaflet-control-attribution"),fr(this._container);for(var h in o._layers)o._layers[h].getAttribution&&this.addAttribution(o._layers[h].getAttribution());return this._update(),o.on("layeradd",this._addAttribution,this),this._container},onRemove:function(o){o.off("layeradd",this._addAttribution,this)},_addAttribution:function(o){o.layer.getAttribution&&(this.addAttribution(o.layer.getAttribution()),o.layer.once("remove",function(){this.removeAttribution(o.layer.getAttribution())},this))},setPrefix:function(o){return this.options.prefix=o,this._update(),this},addAttribution:function(o){return o?(this._attributions[o]||(this._attributions[o]=0),this._attributions[o]++,this._update(),this):this},removeAttribution:function(o){return o?(this._attributions[o]&&(this._attributions[o]--,this._update()),this):this},_update:function(){if(this._map){var o=[];for(var h in this._attributions)this._attributions[h]&&o.push(h);var x=[];this.options.prefix&&x.push(this.options.prefix),o.length&&x.push(o.join(", ")),this._container.innerHTML=x.join(' <span aria-hidden="true">|</span> ')}}});at.mergeOptions({attributionControl:!0}),at.addInitHook(function(){this.options.attributionControl&&new Xe().addTo(this)});var dn=function(o){return new Xe(o)};mr.Layers=jl,mr.Zoom=mo,mr.Scale=Vr,mr.Attribution=Xe,zs.layers=wt,zs.zoom=po,zs.scale=Lu,zs.attribution=dn;var Vn=Te.extend({initialize:function(o){this._map=o},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Vn.addTo=function(o,h){return o.addHandler(h,this),this};var Dl={Events:pe},Bl=Pe.touch?"touchstart mousedown":"mousedown",oi=ne.extend({options:{clickTolerance:3},initialize:function(o,h,x,C){P(this,C),this._element=o,this._dragStartTarget=h||o,this._preventOutline=x},enable:function(){this._enabled||(We(this._dragStartTarget,Bl,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(oi._dragging===this&&this.finishDrag(!0),Se(this._dragStartTarget,Bl,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(o){if(this._enabled&&(this._moved=!1,!ga(this._element,"leaflet-zoom-anim"))){if(o.touches&&o.touches.length!==1){oi._dragging===this&&this.finishDrag();return}if(!(oi._dragging||o.shiftKey||o.which!==1&&o.button!==1&&!o.touches)&&(oi._dragging=this,this._preventOutline&&Us(this._element),Be(),_n(),!this._moving)){this.fire("down");var h=o.touches?o.touches[0]:o,x=fo(this._element);this._startPoint=new K(h.clientX,h.clientY),this._startPos=Rt(this._element),this._parentScale=xa(x);var C=o.type==="mousedown";We(document,C?"mousemove":"touchmove",this._onMove,this),We(document,C?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(o){if(this._enabled){if(o.touches&&o.touches.length>1){this._moved=!0;return}var h=o.touches&&o.touches.length===1?o.touches[0]:o,x=new K(h.clientX,h.clientY)._subtract(this._startPoint);!x.x&&!x.y||Math.abs(x.x)+Math.abs(x.y)<this.options.clickTolerance||(x.x/=this._parentScale.x,x.y/=this._parentScale.y,un(o),this._moved||(this.fire("dragstart"),this._moved=!0,De(document.body,"leaflet-dragging"),this._lastTarget=o.target||o.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),De(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(x),this._moving=!0,this._lastEvent=o,this._updatePosition())}},_updatePosition:function(){var o={originalEvent:this._lastEvent};this.fire("predrag",o),Ce(this._element,this._newPos),this.fire("drag",o)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(o){vt(document.body,"leaflet-dragging"),this._lastTarget&&(vt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Se(document,"mousemove touchmove",this._onMove,this),Se(document,"mouseup touchend touchcancel",this._onUp,this),Mt(),Ds();var h=this._moved&&this._moving;this._moving=!1,oi._dragging=!1,h&&this.fire("dragend",{noInertia:o,distance:this._newPos.distanceTo(this._startPos)})}});function Fl(o,h,x){var C,N=[1,4,2,8],F,$,re,ae,he,Ne,He,ot;for(F=0,Ne=o.length;F<Ne;F++)o[F]._code=Si(o[F],h);for(re=0;re<4;re++){for(He=N[re],C=[],F=0,Ne=o.length,$=Ne-1;F<Ne;$=F++)ae=o[F],he=o[$],ae._code&He?he._code&He||(ot=Gr(he,ae,He,h,x),ot._code=Si(ot,h),C.push(ot)):(he._code&He&&(ot=Gr(he,ae,He,h,x),ot._code=Si(ot,h),C.push(ot)),C.push(ae));o=C}return o}function xo(o,h){var x,C,N,F,$,re,ae,he,Ne;if(!o||o.length===0)throw new Error("latlngs not passed");Gn(o)||(console.warn("latlngs are not flat! Only the first ring will be used"),o=o[0]);var He=fe([0,0]),ot=Fe(o),Yn=ot.getNorthWest().distanceTo(ot.getSouthWest())*ot.getNorthEast().distanceTo(ot.getNorthWest());Yn<1700&&(He=Zt(o));var Cn=o.length,Pr=[];for(x=0;x<Cn;x++){var rr=fe(o[x]);Pr.push(h.project(fe([rr.lat-He.lat,rr.lng-He.lng])))}for(re=ae=he=0,x=0,C=Cn-1;x<Cn;C=x++)N=Pr[x],F=Pr[C],$=N.y*F.x-F.y*N.x,ae+=(N.x+F.x)*$,he+=(N.y+F.y)*$,re+=$*3;re===0?Ne=Pr[0]:Ne=[ae/re,he/re];var vo=h.unproject(le(Ne));return fe([vo.lat+He.lat,vo.lng+He.lng])}function Zt(o){for(var h=0,x=0,C=0,N=0;N<o.length;N++){var F=fe(o[N]);h+=F.lat,x+=F.lng,C++}return fe([h/C,x/C])}var wa={__proto__:null,clipPolygon:Fl,polygonCenter:xo,centroid:Zt};function Ft(o,h){if(!h||!o.length)return o.slice();var x=h*h;return o=Pu(o,x),o=Ct(o,x),o}function Hs(o,h,x){return Math.sqrt(Ai(o,h,x,!0))}function Ei(o,h,x){return Ai(o,h,x)}function Ct(o,h){var x=o.length,C=typeof Uint8Array<"u"?Uint8Array:Array,N=new C(x);N[0]=N[x-1]=1,ze(o,N,h,0,x-1);var F,$=[];for(F=0;F<x;F++)N[F]&&$.push(o[F]);return $}function ze(o,h,x,C,N){var F=0,$,re,ae;for(re=C+1;re<=N-1;re++)ae=Ai(o[re],o[C],o[N],!0),ae>F&&($=re,F=ae);F>x&&(h[$]=1,ze(o,h,x,C,$),ze(o,h,x,$,N))}function Pu(o,h){for(var x=[o[0]],C=1,N=0,F=o.length;C<F;C++)Ir(o[C],o[N])>h&&(x.push(o[C]),N=C);return N<F-1&&x.push(o[F-1]),x}var Tt;function ai(o,h,x,C,N){var F=C?Tt:Si(o,x),$=Si(h,x),re,ae,he;for(Tt=$;;){if(!(F|$))return[o,h];if(F&$)return!1;re=F||$,ae=Gr(o,h,re,x,N),he=Si(ae,x),re===F?(o=ae,F=he):(h=ae,$=he)}}function Gr(o,h,x,C,N){var F=h.x-o.x,$=h.y-o.y,re=C.min,ae=C.max,he,Ne;return x&8?(he=o.x+F*(ae.y-o.y)/$,Ne=ae.y):x&4?(he=o.x+F*(re.y-o.y)/$,Ne=re.y):x&2?(he=ae.x,Ne=o.y+$*(ae.x-o.x)/F):x&1&&(he=re.x,Ne=o.y+$*(re.x-o.x)/F),new K(he,Ne,N)}function Si(o,h){var x=0;return o.x<h.min.x?x|=1:o.x>h.max.x&&(x|=2),o.y<h.min.y?x|=4:o.y>h.max.y&&(x|=8),x}function Ir(o,h){var x=h.x-o.x,C=h.y-o.y;return x*x+C*C}function Ai(o,h,x,C){var N=h.x,F=h.y,$=x.x-N,re=x.y-F,ae=$*$+re*re,he;return ae>0&&(he=((o.x-N)*$+(o.y-F)*re)/ae,he>1?(N=x.x,F=x.y):he>0&&(N+=$*he,F+=re*he)),$=o.x-N,re=o.y-F,C?$*$+re*re:new K(N,F)}function Gn(o){return!k(o[0])||typeof o[0][0]!="object"&&typeof o[0][0]<"u"}function yo(o){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Gn(o)}function _a(o,h){var x,C,N,F,$,re,ae,he;if(!o||o.length===0)throw new Error("latlngs not passed");Gn(o)||(console.warn("latlngs are not flat! Only the first ring will be used"),o=o[0]);var Ne=fe([0,0]),He=Fe(o),ot=He.getNorthWest().distanceTo(He.getSouthWest())*He.getNorthEast().distanceTo(He.getNorthWest());ot<1700&&(Ne=Zt(o));var Yn=o.length,Cn=[];for(x=0;x<Yn;x++){var Pr=fe(o[x]);Cn.push(h.project(fe([Pr.lat-Ne.lat,Pr.lng-Ne.lng])))}for(x=0,C=0;x<Yn-1;x++)C+=Cn[x].distanceTo(Cn[x+1])/2;if(C===0)he=Cn[0];else for(x=0,F=0;x<Yn-1;x++)if($=Cn[x],re=Cn[x+1],N=$.distanceTo(re),F+=N,F>C){ae=(F-C)/N,he=[re.x-ae*(re.x-$.x),re.y-ae*(re.y-$.y)];break}var rr=h.unproject(le(he));return fe([rr.lat+Ne.lat,rr.lng+Ne.lng])}var Ul={__proto__:null,simplify:Ft,pointToSegmentDistance:Hs,closestPointOnSegment:Ei,clipSegment:ai,_getEdgeIntersection:Gr,_getBitCode:Si,_sqClosestPointOnSegment:Ai,isFlat:Gn,_flat:yo,polylineCenter:_a},ba={project:function(o){return new K(o.lng,o.lat)},unproject:function(o){return new Ve(o.y,o.x)},bounds:new be([-180,-90],[180,90])},li={R:6378137,R_MINOR:6356752314245179e-9,bounds:new be([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(o){var h=Math.PI/180,x=this.R,C=o.lat*h,N=this.R_MINOR/x,F=Math.sqrt(1-N*N),$=F*Math.sin(C),re=Math.tan(Math.PI/4-C/2)/Math.pow((1-$)/(1+$),F/2);return C=-x*Math.log(Math.max(re,1e-10)),new K(o.lng*h*x,C)},unproject:function(o){for(var h=180/Math.PI,x=this.R,C=this.R_MINOR/x,N=Math.sqrt(1-C*C),F=Math.exp(-o.y/x),$=Math.PI/2-2*Math.atan(F),re=0,ae=.1,he;re<15&&Math.abs(ae)>1e-7;re++)he=N*Math.sin($),he=Math.pow((1-he)/(1+he),N/2),ae=Math.PI/2-2*Math.atan(F*he)-$,$+=ae;return new Ve($*h,o.x*h/x)}},Ca={__proto__:null,LonLat:ba,Mercator:li,SphericalMercator:Ue},Ru=l({},Je,{code:"EPSG:3395",projection:li,transformation:function(){var o=.5/(Math.PI*li.R);return gt(o,.5,-o,.5)}()}),Xi=l({},Je,{code:"EPSG:4326",projection:ba,transformation:gt(1/180,1,-1/180,.5)}),ju=l({},je,{projection:ba,transformation:gt(1,0,-1,0),scale:function(o){return Math.pow(2,o)},zoom:function(o){return Math.log(o)/Math.LN2},distance:function(o,h){var x=h.lng-o.lng,C=h.lat-o.lat;return Math.sqrt(x*x+C*C)},infinite:!0});je.Earth=Je,je.EPSG3395=Ru,je.EPSG3857=Le,je.EPSG900913=yt,je.EPSG4326=Xi,je.Simple=ju;var on=ne.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(o){return o.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(o){return o&&o.removeLayer(this),this},getPane:function(o){return this._map.getPane(o?this.options[o]||o:this.options.pane)},addInteractiveTarget:function(o){return this._map._targets[v(o)]=this,this},removeInteractiveTarget:function(o){return delete this._map._targets[v(o)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(o){var h=o.target;if(h.hasLayer(this)){if(this._map=h,this._zoomAnimated=h._zoomAnimated,this.getEvents){var x=this.getEvents();h.on(x,this),this.once("remove",function(){h.off(x,this)},this)}this.onAdd(h),this.fire("add"),h.fire("layeradd",{layer:this})}}});at.include({addLayer:function(o){if(!o._layerAdd)throw new Error("The provided object is not a Layer.");var h=v(o);return this._layers[h]?this:(this._layers[h]=o,o._mapToAdd=this,o.beforeAdd&&o.beforeAdd(this),this.whenReady(o._layerAdd,o),this)},removeLayer:function(o){var h=v(o);return this._layers[h]?(this._loaded&&o.onRemove(this),delete this._layers[h],this._loaded&&(this.fire("layerremove",{layer:o}),o.fire("remove")),o._map=o._mapToAdd=null,this):this},hasLayer:function(o){return v(o)in this._layers},eachLayer:function(o,h){for(var x in this._layers)o.call(h,this._layers[x]);return this},_addLayers:function(o){o=o?k(o)?o:[o]:[];for(var h=0,x=o.length;h<x;h++)this.addLayer(o[h])},_addZoomLimit:function(o){(!isNaN(o.options.maxZoom)||!isNaN(o.options.minZoom))&&(this._zoomBoundLayers[v(o)]=o,this._updateZoomLevels())},_removeZoomLimit:function(o){var h=v(o);this._zoomBoundLayers[h]&&(delete this._zoomBoundLayers[h],this._updateZoomLevels())},_updateZoomLevels:function(){var o=1/0,h=-1/0,x=this._getZoomSpan();for(var C in this._zoomBoundLayers){var N=this._zoomBoundLayers[C].options;o=N.minZoom===void 0?o:Math.min(o,N.minZoom),h=N.maxZoom===void 0?h:Math.max(h,N.maxZoom)}this._layersMaxZoom=h===-1/0?void 0:h,this._layersMinZoom=o===1/0?void 0:o,x!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Zr=on.extend({initialize:function(o,h){P(this,h),this._layers={};var x,C;if(o)for(x=0,C=o.length;x<C;x++)this.addLayer(o[x])},addLayer:function(o){var h=this.getLayerId(o);return this._layers[h]=o,this._map&&this._map.addLayer(o),this},removeLayer:function(o){var h=o in this._layers?o:this.getLayerId(o);return this._map&&this._layers[h]&&this._map.removeLayer(this._layers[h]),delete this._layers[h],this},hasLayer:function(o){var h=typeof o=="number"?o:this.getLayerId(o);return h in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(o){var h=Array.prototype.slice.call(arguments,1),x,C;for(x in this._layers)C=this._layers[x],C[o]&&C[o].apply(C,h);return this},onAdd:function(o){this.eachLayer(o.addLayer,o)},onRemove:function(o){this.eachLayer(o.removeLayer,o)},eachLayer:function(o,h){for(var x in this._layers)o.call(h,this._layers[x]);return this},getLayer:function(o){return this._layers[o]},getLayers:function(){var o=[];return this.eachLayer(o.push,o),o},setZIndex:function(o){return this.invoke("setZIndex",o)},getLayerId:function(o){return v(o)}}),nr=function(o,h){return new Zr(o,h)},kr=Zr.extend({addLayer:function(o){return this.hasLayer(o)?this:(o.addEventParent(this),Zr.prototype.addLayer.call(this,o),this.fire("layeradd",{layer:o}))},removeLayer:function(o){return this.hasLayer(o)?(o in this._layers&&(o=this._layers[o]),o.removeEventParent(this),Zr.prototype.removeLayer.call(this,o),this.fire("layerremove",{layer:o})):this},setStyle:function(o){return this.invoke("setStyle",o)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var o=new Qe;for(var h in this._layers){var x=this._layers[h];o.extend(x.getBounds?x.getBounds():x.getLatLng())}return o}}),Mr=function(o,h){return new kr(o,h)},qi=Te.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(o){P(this,o)},createIcon:function(o){return this._createIcon("icon",o)},createShadow:function(o){return this._createIcon("shadow",o)},_createIcon:function(o,h){var x=this._getIconUrl(o);if(!x){if(o==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var C=this._createImg(x,h&&h.tagName==="IMG"?h:null);return this._setIconStyles(C,o),(this.options.crossOrigin||this.options.crossOrigin==="")&&(C.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),C},_setIconStyles:function(o,h){var x=this.options,C=x[h+"Size"];typeof C=="number"&&(C=[C,C]);var N=le(C),F=le(h==="shadow"&&x.shadowAnchor||x.iconAnchor||N&&N.divideBy(2,!0));o.className="leaflet-marker-"+h+" "+(x.className||""),F&&(o.style.marginLeft=-F.x+"px",o.style.marginTop=-F.y+"px"),N&&(o.style.width=N.x+"px",o.style.height=N.y+"px")},_createImg:function(o,h){return h=h||document.createElement("img"),h.src=o,h},_getIconUrl:function(o){return Pe.retina&&this.options[o+"RetinaUrl"]||this.options[o+"Url"]}});function Ea(o){return new qi(o)}var Ws=qi.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(o){return typeof Ws.imagePath!="string"&&(Ws.imagePath=this._detectIconPath()),(this.options.imagePath||Ws.imagePath)+qi.prototype._getIconUrl.call(this,o)},_stripUrl:function(o){var h=function(x,C,N){var F=C.exec(x);return F&&F[N]};return o=h(o,/^url\((['"])?(.+)\1\)$/,2),o&&h(o,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var o=ut("div","leaflet-default-icon-path",document.body),h=et(o,"background-image")||et(o,"backgroundImage");if(document.body.removeChild(o),h=this._stripUrl(h),h)return h;var x=document.querySelector('link[href$="leaflet.css"]');return x?x.href.substring(0,x.href.length-11-1):""}}),Sa=Vn.extend({initialize:function(o){this._marker=o},addHooks:function(){var o=this._marker._icon;this._draggable||(this._draggable=new oi(o,o,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),De(o,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&vt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(o){var h=this._marker,x=h._map,C=this._marker.options.autoPanSpeed,N=this._marker.options.autoPanPadding,F=Rt(h._icon),$=x.getPixelBounds(),re=x.getPixelOrigin(),ae=we($.min._subtract(re).add(N),$.max._subtract(re).subtract(N));if(!ae.contains(F)){var he=le((Math.max(ae.max.x,F.x)-ae.max.x)/($.max.x-ae.max.x)-(Math.min(ae.min.x,F.x)-ae.min.x)/($.min.x-ae.min.x),(Math.max(ae.max.y,F.y)-ae.max.y)/($.max.y-ae.max.y)-(Math.min(ae.min.y,F.y)-ae.min.y)/($.min.y-ae.min.y)).multiplyBy(C);x.panBy(he,{animate:!1}),this._draggable._newPos._add(he),this._draggable._startPos._add(he),Ce(h._icon,this._draggable._newPos),this._onDrag(o),this._panRequest=ce(this._adjustPan.bind(this,o))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(o){this._marker.options.autoPan&&(ue(this._panRequest),this._panRequest=ce(this._adjustPan.bind(this,o)))},_onDrag:function(o){var h=this._marker,x=h._shadow,C=Rt(h._icon),N=h._map.layerPointToLatLng(C);x&&Ce(x,C),h._latlng=N,o.latlng=N,o.oldLatLng=this._oldLatLng,h.fire("move",o).fire("drag",o)},_onDragEnd:function(o){ue(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",o)}}),Zn=on.extend({options:{icon:new Ws,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(o,h){P(this,h),this._latlng=fe(o)},onAdd:function(o){this._zoomAnimated=this._zoomAnimated&&o.options.markerZoomAnimation,this._zoomAnimated&&o.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(o){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&o.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(o){var h=this._latlng;return this._latlng=fe(o),this.update(),this.fire("move",{oldLatLng:h,latlng:this._latlng})},setZIndexOffset:function(o){return this.options.zIndexOffset=o,this.update()},getIcon:function(){return this.options.icon},setIcon:function(o){return this.options.icon=o,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var o=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(o)}return this},_initIcon:function(){var o=this.options,h="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),x=o.icon.createIcon(this._icon),C=!1;x!==this._icon&&(this._icon&&this._removeIcon(),C=!0,o.title&&(x.title=o.title),x.tagName==="IMG"&&(x.alt=o.alt||"")),De(x,h),o.keyboard&&(x.tabIndex="0",x.setAttribute("role","button")),this._icon=x,o.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&We(x,"focus",this._panOnFocus,this);var N=o.icon.createShadow(this._shadow),F=!1;N!==this._shadow&&(this._removeShadow(),F=!0),N&&(De(N,h),N.alt=""),this._shadow=N,o.opacity<1&&this._updateOpacity(),C&&this.getPane().appendChild(this._icon),this._initInteraction(),N&&F&&this.getPane(o.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Se(this._icon,"focus",this._panOnFocus,this),kt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&kt(this._shadow),this._shadow=null},_setPos:function(o){this._icon&&Ce(this._icon,o),this._shadow&&Ce(this._shadow,o),this._zIndex=o.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(o){this._icon&&(this._icon.style.zIndex=this._zIndex+o)},_animateZoom:function(o){var h=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center).round();this._setPos(h)},_initInteraction:function(){if(this.options.interactive&&(De(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Sa)){var o=this.options.draggable;this.dragging&&(o=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Sa(this),o&&this.dragging.enable()}},setOpacity:function(o){return this.options.opacity=o,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var o=this.options.opacity;this._icon&&it(this._icon,o),this._shadow&&it(this._shadow,o)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var o=this._map;if(o){var h=this.options.icon.options,x=h.iconSize?le(h.iconSize):le(0,0),C=h.iconAnchor?le(h.iconAnchor):le(0,0);o.panInside(this._latlng,{paddingTopLeft:C,paddingBottomRight:x.subtract(C)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Du(o,h){return new Zn(o,h)}var Or=on.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(o){this._renderer=o.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(o){return P(this,o),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&o&&Object.prototype.hasOwnProperty.call(o,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),ci=Or.extend({options:{fill:!0,radius:10},initialize:function(o,h){P(this,h),this._latlng=fe(o),this._radius=this.options.radius},setLatLng:function(o){var h=this._latlng;return this._latlng=fe(o),this.redraw(),this.fire("move",{oldLatLng:h,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(o){return this.options.radius=this._radius=o,this.redraw()},getRadius:function(){return this._radius},setStyle:function(o){var h=o&&o.radius||this._radius;return Or.prototype.setStyle.call(this,o),this.setRadius(h),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var o=this._radius,h=this._radiusY||o,x=this._clickTolerance(),C=[o+x,h+x];this._pxBounds=new be(this._point.subtract(C),this._point.add(C))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(o){return o.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function dt(o,h){return new ci(o,h)}var Ki=ci.extend({initialize:function(o,h,x){if(typeof h=="number"&&(h=l({},x,{radius:h})),P(this,h),this._latlng=fe(o),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(o){return this._mRadius=o,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var o=[this._radius,this._radiusY||this._radius];return new Qe(this._map.layerPointToLatLng(this._point.subtract(o)),this._map.layerPointToLatLng(this._point.add(o)))},setStyle:Or.prototype.setStyle,_project:function(){var o=this._latlng.lng,h=this._latlng.lat,x=this._map,C=x.options.crs;if(C.distance===Je.distance){var N=Math.PI/180,F=this._mRadius/Je.R/N,$=x.project([h+F,o]),re=x.project([h-F,o]),ae=$.add(re).divideBy(2),he=x.unproject(ae).lat,Ne=Math.acos((Math.cos(F*N)-Math.sin(h*N)*Math.sin(he*N))/(Math.cos(h*N)*Math.cos(he*N)))/N;(isNaN(Ne)||Ne===0)&&(Ne=F/Math.cos(Math.PI/180*h)),this._point=ae.subtract(x.getPixelOrigin()),this._radius=isNaN(Ne)?0:ae.x-x.project([he,o-Ne]).x,this._radiusY=ae.y-$.y}else{var He=C.unproject(C.project(this._latlng).subtract([this._mRadius,0]));this._point=x.latLngToLayerPoint(this._latlng),this._radius=this._point.x-x.latLngToLayerPoint(He).x}this._updateBounds()}});function M(o,h,x){return new Ki(o,h,x)}var r=Or.extend({options:{smoothFactor:1,noClip:!1},initialize:function(o,h){P(this,h),this._setLatLngs(o)},getLatLngs:function(){return this._latlngs},setLatLngs:function(o){return this._setLatLngs(o),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(o){for(var h=1/0,x=null,C=Ai,N,F,$=0,re=this._parts.length;$<re;$++)for(var ae=this._parts[$],he=1,Ne=ae.length;he<Ne;he++){N=ae[he-1],F=ae[he];var He=C(o,N,F,!0);He<h&&(h=He,x=C(o,N,F))}return x&&(x.distance=Math.sqrt(h)),x},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return _a(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(o,h){return h=h||this._defaultShape(),o=fe(o),h.push(o),this._bounds.extend(o),this.redraw()},_setLatLngs:function(o){this._bounds=new Qe,this._latlngs=this._convertLatLngs(o)},_defaultShape:function(){return Gn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(o){for(var h=[],x=Gn(o),C=0,N=o.length;C<N;C++)x?(h[C]=fe(o[C]),this._bounds.extend(h[C])):h[C]=this._convertLatLngs(o[C]);return h},_project:function(){var o=new be;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,o),this._bounds.isValid()&&o.isValid()&&(this._rawPxBounds=o,this._updateBounds())},_updateBounds:function(){var o=this._clickTolerance(),h=new K(o,o);this._rawPxBounds&&(this._pxBounds=new be([this._rawPxBounds.min.subtract(h),this._rawPxBounds.max.add(h)]))},_projectLatlngs:function(o,h,x){var C=o[0]instanceof Ve,N=o.length,F,$;if(C){for($=[],F=0;F<N;F++)$[F]=this._map.latLngToLayerPoint(o[F]),x.extend($[F]);h.push($)}else for(F=0;F<N;F++)this._projectLatlngs(o[F],h,x)},_clipPoints:function(){var o=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(o))){if(this.options.noClip){this._parts=this._rings;return}var h=this._parts,x,C,N,F,$,re,ae;for(x=0,N=0,F=this._rings.length;x<F;x++)for(ae=this._rings[x],C=0,$=ae.length;C<$-1;C++)re=ai(ae[C],ae[C+1],o,C,!0),re&&(h[N]=h[N]||[],h[N].push(re[0]),(re[1]!==ae[C+1]||C===$-2)&&(h[N].push(re[1]),N++))}},_simplifyPoints:function(){for(var o=this._parts,h=this.options.smoothFactor,x=0,C=o.length;x<C;x++)o[x]=Ft(o[x],h)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(o,h){var x,C,N,F,$,re,ae=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(o))return!1;for(x=0,F=this._parts.length;x<F;x++)for(re=this._parts[x],C=0,$=re.length,N=$-1;C<$;N=C++)if(!(!h&&C===0)&&Hs(o,re[N],re[C])<=ae)return!0;return!1}});function s(o,h){return new r(o,h)}r._flat=yo;var a=r.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return xo(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(o){var h=r.prototype._convertLatLngs.call(this,o),x=h.length;return x>=2&&h[0]instanceof Ve&&h[0].equals(h[x-1])&&h.pop(),h},_setLatLngs:function(o){r.prototype._setLatLngs.call(this,o),Gn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Gn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var o=this._renderer._bounds,h=this.options.weight,x=new K(h,h);if(o=new be(o.min.subtract(x),o.max.add(x)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(o))){if(this.options.noClip){this._parts=this._rings;return}for(var C=0,N=this._rings.length,F;C<N;C++)F=Fl(this._rings[C],o,!0),F.length&&this._parts.push(F)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(o){var h=!1,x,C,N,F,$,re,ae,he;if(!this._pxBounds||!this._pxBounds.contains(o))return!1;for(F=0,ae=this._parts.length;F<ae;F++)for(x=this._parts[F],$=0,he=x.length,re=he-1;$<he;re=$++)C=x[$],N=x[re],C.y>o.y!=N.y>o.y&&o.x<(N.x-C.x)*(o.y-C.y)/(N.y-C.y)+C.x&&(h=!h);return h||r.prototype._containsPoint.call(this,o,!0)}});function u(o,h){return new a(o,h)}var d=kr.extend({initialize:function(o,h){P(this,h),this._layers={},o&&this.addData(o)},addData:function(o){var h=k(o)?o:o.features,x,C,N;if(h){for(x=0,C=h.length;x<C;x++)N=h[x],(N.geometries||N.geometry||N.features||N.coordinates)&&this.addData(N);return this}var F=this.options;if(F.filter&&!F.filter(o))return this;var $=f(o,F);return $?($.feature=V(o),$.defaultOptions=$.options,this.resetStyle($),F.onEachFeature&&F.onEachFeature(o,$),this.addLayer($)):this},resetStyle:function(o){return o===void 0?this.eachLayer(this.resetStyle,this):(o.options=l({},o.defaultOptions),this._setLayerStyle(o,this.options.style),this)},setStyle:function(o){return this.eachLayer(function(h){this._setLayerStyle(h,o)},this)},_setLayerStyle:function(o,h){o.setStyle&&(typeof h=="function"&&(h=h(o.feature)),o.setStyle(h))}});function f(o,h){var x=o.type==="Feature"?o.geometry:o,C=x?x.coordinates:null,N=[],F=h&&h.pointToLayer,$=h&&h.coordsToLatLng||w,re,ae,he,Ne;if(!C&&!x)return null;switch(x.type){case"Point":return re=$(C),p(F,o,re,h);case"MultiPoint":for(he=0,Ne=C.length;he<Ne;he++)re=$(C[he]),N.push(p(F,o,re,h));return new kr(N);case"LineString":case"MultiLineString":return ae=b(C,x.type==="LineString"?0:1,$),new r(ae,h);case"Polygon":case"MultiPolygon":return ae=b(C,x.type==="Polygon"?1:2,$),new a(ae,h);case"GeometryCollection":for(he=0,Ne=x.geometries.length;he<Ne;he++){var He=f({geometry:x.geometries[he],type:"Feature",properties:o.properties},h);He&&N.push(He)}return new kr(N);case"FeatureCollection":for(he=0,Ne=x.features.length;he<Ne;he++){var ot=f(x.features[he],h);ot&&N.push(ot)}return new kr(N);default:throw new Error("Invalid GeoJSON object.")}}function p(o,h,x,C){return o?o(h,x):new Zn(x,C&&C.markersInheritOptions&&C)}function w(o){return new Ve(o[1],o[0],o[2])}function b(o,h,x){for(var C=[],N=0,F=o.length,$;N<F;N++)$=h?b(o[N],h-1,x):(x||w)(o[N]),C.push($);return C}function A(o,h){return o=fe(o),o.alt!==void 0?[T(o.lng,h),T(o.lat,h),T(o.alt,h)]:[T(o.lng,h),T(o.lat,h)]}function O(o,h,x,C){for(var N=[],F=0,$=o.length;F<$;F++)N.push(h?O(o[F],Gn(o[F])?0:h-1,x,C):A(o[F],C));return!h&&x&&N.length>0&&N.push(N[0].slice()),N}function B(o,h){return o.feature?l({},o.feature,{geometry:h}):V(h)}function V(o){return o.type==="Feature"||o.type==="FeatureCollection"?o:{type:"Feature",properties:{},geometry:o}}var X={toGeoJSON:function(o){return B(this,{type:"Point",coordinates:A(this.getLatLng(),o)})}};Zn.include(X),Ki.include(X),ci.include(X),r.include({toGeoJSON:function(o){var h=!Gn(this._latlngs),x=O(this._latlngs,h?1:0,!1,o);return B(this,{type:(h?"Multi":"")+"LineString",coordinates:x})}}),a.include({toGeoJSON:function(o){var h=!Gn(this._latlngs),x=h&&!Gn(this._latlngs[0]),C=O(this._latlngs,x?2:h?1:0,!0,o);return h||(C=[C]),B(this,{type:(x?"Multi":"")+"Polygon",coordinates:C})}}),Zr.include({toMultiPoint:function(o){var h=[];return this.eachLayer(function(x){h.push(x.toGeoJSON(o).geometry.coordinates)}),B(this,{type:"MultiPoint",coordinates:h})},toGeoJSON:function(o){var h=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(h==="MultiPoint")return this.toMultiPoint(o);var x=h==="GeometryCollection",C=[];return this.eachLayer(function(N){if(N.toGeoJSON){var F=N.toGeoJSON(o);if(x)C.push(F.geometry);else{var $=V(F);$.type==="FeatureCollection"?C.push.apply(C,$.features):C.push($)}}}),x?B(this,{geometries:C,type:"GeometryCollection"}):{type:"FeatureCollection",features:C}}});function q(o,h){return new d(o,h)}var ee=q,se=on.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(o,h,x){this._url=o,this._bounds=Fe(h),P(this,x)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(De(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){kt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(o){return this.options.opacity=o,this._image&&this._updateOpacity(),this},setStyle:function(o){return o.opacity&&this.setOpacity(o.opacity),this},bringToFront:function(){return this._map&&Pt(this._image),this},bringToBack:function(){return this._map&&Wn(this._image),this},setUrl:function(o){return this._url=o,this._image&&(this._image.src=o),this},setBounds:function(o){return this._bounds=Fe(o),this._map&&this._reset(),this},getEvents:function(){var o={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},setZIndex:function(o){return this.options.zIndex=o,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var o=this._url.tagName==="IMG",h=this._image=o?this._url:ut("img");if(De(h,"leaflet-image-layer"),this._zoomAnimated&&De(h,"leaflet-zoom-animated"),this.options.className&&De(h,this.options.className),h.onselectstart=E,h.onmousemove=E,h.onload=m(this.fire,this,"load"),h.onerror=m(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),o){this._url=h.src;return}h.src=this._url,h.alt=this.options.alt},_animateZoom:function(o){var h=this._map.getZoomScale(o.zoom),x=this._map._latLngBoundsToNewLayerBounds(this._bounds,o.zoom,o.center).min;W(this._image,x,h)},_reset:function(){var o=this._image,h=new be(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),x=h.getSize();Ce(o,h.min),o.style.width=x.x+"px",o.style.height=x.y+"px"},_updateOpacity:function(){it(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var o=this.options.errorOverlayUrl;o&&this._url!==o&&(this._url=o,this._image.src=o)},getCenter:function(){return this._bounds.getCenter()}}),xe=function(o,h,x){return new se(o,h,x)},ye=se.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var o=this._url.tagName==="VIDEO",h=this._image=o?this._url:ut("video");if(De(h,"leaflet-image-layer"),this._zoomAnimated&&De(h,"leaflet-zoom-animated"),this.options.className&&De(h,this.options.className),h.onselectstart=E,h.onmousemove=E,h.onloadeddata=m(this.fire,this,"load"),o){for(var x=h.getElementsByTagName("source"),C=[],N=0;N<x.length;N++)C.push(x[N].src);this._url=x.length>0?C:[h.src];return}k(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(h.style,"objectFit")&&(h.style.objectFit="fill"),h.autoplay=!!this.options.autoplay,h.loop=!!this.options.loop,h.muted=!!this.options.muted,h.playsInline=!!this.options.playsInline;for(var F=0;F<this._url.length;F++){var $=ut("source");$.src=this._url[F],h.appendChild($)}}});function ge(o,h,x){return new ye(o,h,x)}var st=se.extend({_initImage:function(){var o=this._image=this._url;De(o,"leaflet-image-layer"),this._zoomAnimated&&De(o,"leaflet-zoom-animated"),this.options.className&&De(o,this.options.className),o.onselectstart=E,o.onmousemove=E}});function $e(o,h,x){return new st(o,h,x)}var Ut=on.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(o,h){o&&(o instanceof Ve||k(o))?(this._latlng=fe(o),P(this,h)):(P(this,o),this._source=h),this.options.content&&(this._content=this.options.content)},openOn:function(o){return o=arguments.length?o:this._source._map,o.hasLayer(this)||o.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(o){return this._map?this.close():(arguments.length?this._source=o:o=this._source,this._prepareOpen(),this.openOn(o._map)),this},onAdd:function(o){this._zoomAnimated=o._zoomAnimated,this._container||this._initLayout(),o._fadeAnimated&&it(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),o._fadeAnimated&&it(this._container,1),this.bringToFront(),this.options.interactive&&(De(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(o){o._fadeAnimated?(it(this._container,0),this._removeTimeout=setTimeout(m(kt,void 0,this._container),200)):kt(this._container),this.options.interactive&&(vt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(o){return this._latlng=fe(o),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(o){return this._content=o,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var o={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Pt(this._container),this},bringToBack:function(){return this._map&&Wn(this._container),this},_prepareOpen:function(o){var h=this._source;if(!h._map)return!1;if(h instanceof kr){h=null;var x=this._source._layers;for(var C in x)if(x[C]._map){h=x[C];break}if(!h)return!1;this._source=h}if(!o)if(h.getCenter)o=h.getCenter();else if(h.getLatLng)o=h.getLatLng();else if(h.getBounds)o=h.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(o),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var o=this._contentNode,h=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof h=="string")o.innerHTML=h;else{for(;o.hasChildNodes();)o.removeChild(o.firstChild);o.appendChild(h)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var o=this._map.latLngToLayerPoint(this._latlng),h=le(this.options.offset),x=this._getAnchor();this._zoomAnimated?Ce(this._container,o.add(x)):h=h.add(o).add(x);var C=this._containerBottom=-h.y,N=this._containerLeft=-Math.round(this._containerWidth/2)+h.x;this._container.style.bottom=C+"px",this._container.style.left=N+"px"}},_getAnchor:function(){return[0,0]}});at.include({_initOverlay:function(o,h,x,C){var N=h;return N instanceof o||(N=new o(C).setContent(h)),x&&N.setLatLng(x),N}}),on.include({_initOverlay:function(o,h,x,C){var N=x;return N instanceof o?(P(N,C),N._source=this):(N=h&&!C?h:new o(C,this),N.setContent(x)),N}});var Pn=Ut.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(o){return o=arguments.length?o:this._source._map,!o.hasLayer(this)&&o._popup&&o._popup.options.autoClose&&o.removeLayer(o._popup),o._popup=this,Ut.prototype.openOn.call(this,o)},onAdd:function(o){Ut.prototype.onAdd.call(this,o),o.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Or||this._source.on("preclick",Wr))},onRemove:function(o){Ut.prototype.onRemove.call(this,o),o.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Or||this._source.off("preclick",Wr))},getEvents:function(){var o=Ut.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(o.preclick=this.close),this.options.keepInView&&(o.moveend=this._adjustPan),o},_initLayout:function(){var o="leaflet-popup",h=this._container=ut("div",o+" "+(this.options.className||"")+" leaflet-zoom-animated"),x=this._wrapper=ut("div",o+"-content-wrapper",h);if(this._contentNode=ut("div",o+"-content",x),fr(h),go(this._contentNode),We(h,"contextmenu",Wr),this._tipContainer=ut("div",o+"-tip-container",h),this._tip=ut("div",o+"-tip",this._tipContainer),this.options.closeButton){var C=this._closeButton=ut("a",o+"-close-button",h);C.setAttribute("role","button"),C.setAttribute("aria-label","Close popup"),C.href="#close",C.innerHTML='<span aria-hidden="true">&#215;</span>',We(C,"click",function(N){un(N),this.close()},this)}},_updateLayout:function(){var o=this._contentNode,h=o.style;h.width="",h.whiteSpace="nowrap";var x=o.offsetWidth;x=Math.min(x,this.options.maxWidth),x=Math.max(x,this.options.minWidth),h.width=x+1+"px",h.whiteSpace="",h.height="";var C=o.offsetHeight,N=this.options.maxHeight,F="leaflet-popup-scrolled";N&&C>N?(h.height=N+"px",De(o,F)):vt(o,F),this._containerWidth=this._container.offsetWidth},_animateZoom:function(o){var h=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center),x=this._getAnchor();Ce(this._container,h.add(x))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var o=this._map,h=parseInt(et(this._container,"marginBottom"),10)||0,x=this._container.offsetHeight+h,C=this._containerWidth,N=new K(this._containerLeft,-x-this._containerBottom);N._add(Rt(this._container));var F=o.layerPointToContainerPoint(N),$=le(this.options.autoPanPadding),re=le(this.options.autoPanPaddingTopLeft||$),ae=le(this.options.autoPanPaddingBottomRight||$),he=o.getSize(),Ne=0,He=0;F.x+C+ae.x>he.x&&(Ne=F.x+C-he.x+ae.x),F.x-Ne-re.x<0&&(Ne=F.x-re.x),F.y+x+ae.y>he.y&&(He=F.y+x-he.y+ae.y),F.y-He-re.y<0&&(He=F.y-re.y),(Ne||He)&&(this.options.keepInView&&(this._autopanning=!0),o.fire("autopanstart").panBy([Ne,He]))}},_getAnchor:function(){return le(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Rn=function(o,h){return new Pn(o,h)};at.mergeOptions({closePopupOnClick:!0}),at.include({openPopup:function(o,h,x){return this._initOverlay(Pn,o,h,x).openOn(this),this},closePopup:function(o){return o=arguments.length?o:this._popup,o&&o.close(),this}}),on.include({bindPopup:function(o,h){return this._popup=this._initOverlay(Pn,this._popup,o,h),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(o){return this._popup&&(this instanceof kr||(this._popup._source=this),this._popup._prepareOpen(o||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(o){return this._popup&&this._popup.setContent(o),this},getPopup:function(){return this._popup},_openPopup:function(o){if(!(!this._popup||!this._map)){gr(o);var h=o.layer||o.target;if(this._popup._source===h&&!(h instanceof Or)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(o.latlng);return}this._popup._source=h,this.openPopup(o.latlng)}},_movePopup:function(o){this._popup.setLatLng(o.latlng)},_onKeyPress:function(o){o.originalEvent.keyCode===13&&this._openPopup(o)}});var xt=Ut.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(o){Ut.prototype.onAdd.call(this,o),this.setOpacity(this.options.opacity),o.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(o){Ut.prototype.onRemove.call(this,o),o.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var o=Ut.prototype.getEvents.call(this);return this.options.permanent||(o.preclick=this.close),o},_initLayout:function(){var o="leaflet-tooltip",h=o+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=ut("div",h),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+v(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(o){var h,x,C=this._map,N=this._container,F=C.latLngToContainerPoint(C.getCenter()),$=C.layerPointToContainerPoint(o),re=this.options.direction,ae=N.offsetWidth,he=N.offsetHeight,Ne=le(this.options.offset),He=this._getAnchor();re==="top"?(h=ae/2,x=he):re==="bottom"?(h=ae/2,x=0):re==="center"?(h=ae/2,x=he/2):re==="right"?(h=0,x=he/2):re==="left"?(h=ae,x=he/2):$.x<F.x?(re="right",h=0,x=he/2):(re="left",h=ae+(Ne.x+He.x)*2,x=he/2),o=o.subtract(le(h,x,!0)).add(Ne).add(He),vt(N,"leaflet-tooltip-right"),vt(N,"leaflet-tooltip-left"),vt(N,"leaflet-tooltip-top"),vt(N,"leaflet-tooltip-bottom"),De(N,"leaflet-tooltip-"+re),Ce(N,o)},_updatePosition:function(){var o=this._map.latLngToLayerPoint(this._latlng);this._setPosition(o)},setOpacity:function(o){this.options.opacity=o,this._container&&it(this._container,o)},_animateZoom:function(o){var h=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center);this._setPosition(h)},_getAnchor:function(){return le(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),hn=function(o,h){return new xt(o,h)};at.include({openTooltip:function(o,h,x){return this._initOverlay(xt,o,h,x).openOn(this),this},closeTooltip:function(o){return o.close(),this}}),on.include({bindTooltip:function(o,h){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(xt,this._tooltip,o,h),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(o){if(!(!o&&this._tooltipHandlersAdded)){var h=o?"off":"on",x={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?x.add=this._openTooltip:(x.mouseover=this._openTooltip,x.mouseout=this.closeTooltip,x.click=this._openTooltip,this._map?this._addFocusListeners():x.add=this._addFocusListeners),this._tooltip.options.sticky&&(x.mousemove=this._moveTooltip),this[h](x),this._tooltipHandlersAdded=!o}},openTooltip:function(o){return this._tooltip&&(this instanceof kr||(this._tooltip._source=this),this._tooltip._prepareOpen(o)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(o){return this._tooltip&&this._tooltip.setContent(o),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(o){var h=typeof o.getElement=="function"&&o.getElement();h&&(We(h,"focus",function(){this._tooltip._source=o,this.openTooltip()},this),We(h,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(o){var h=typeof o.getElement=="function"&&o.getElement();h&&h.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(o){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var h=this;this._map.once("moveend",function(){h._openOnceFlag=!1,h._openTooltip(o)});return}this._tooltip._source=o.layer||o.target,this.openTooltip(this._tooltip.options.sticky?o.latlng:void 0)}},_moveTooltip:function(o){var h=o.latlng,x,C;this._tooltip.options.sticky&&o.originalEvent&&(x=this._map.mouseEventToContainerPoint(o.originalEvent),C=this._map.containerPointToLayerPoint(x),h=this._map.layerPointToLatLng(C)),this._tooltip.setLatLng(h)}});var jn=qi.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(o){var h=o&&o.tagName==="DIV"?o:document.createElement("div"),x=this.options;if(x.html instanceof Element?(Gi(h),h.appendChild(x.html)):h.innerHTML=x.html!==!1?x.html:"",x.bgPos){var C=le(x.bgPos);h.style.backgroundPosition=-C.x+"px "+-C.y+"px"}return this._setIconStyles(h,"icon"),h},createShadow:function(){return null}});function Qi(o){return new jn(o)}qi.Default=Ws;var Lr=on.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Pe.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(o){P(this,o)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(o){o._addZoomLimit(this)},onRemove:function(o){this._removeAllTiles(),kt(this._container),o._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Pt(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Wn(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(o){return this.options.opacity=o,this._updateOpacity(),this},setZIndex:function(o){return this.options.zIndex=o,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var o=this._clampZoom(this._map.getZoom());o!==this._tileZoom&&(this._tileZoom=o,this._updateLevels()),this._update()}return this},getEvents:function(){var o={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=y(this._onMoveEnd,this.options.updateInterval,this)),o.move=this._onMove),this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},createTile:function(){return document.createElement("div")},getTileSize:function(){var o=this.options.tileSize;return o instanceof K?o:new K(o,o)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(o){for(var h=this.getPane().children,x=-o(-1/0,1/0),C=0,N=h.length,F;C<N;C++)F=h[C].style.zIndex,h[C]!==this._container&&F&&(x=o(x,+F));isFinite(x)&&(this.options.zIndex=x+o(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Pe.ielt9){it(this._container,this.options.opacity);var o=+new Date,h=!1,x=!1;for(var C in this._tiles){var N=this._tiles[C];if(!(!N.current||!N.loaded)){var F=Math.min(1,(o-N.loaded)/200);it(N.el,F),F<1?h=!0:(N.active?x=!0:this._onOpaqueTile(N),N.active=!0)}}x&&!this._noPrune&&this._pruneTiles(),h&&(ue(this._fadeFrame),this._fadeFrame=ce(this._updateOpacity,this))}},_onOpaqueTile:E,_initContainer:function(){this._container||(this._container=ut("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var o=this._tileZoom,h=this.options.maxZoom;if(o!==void 0){for(var x in this._levels)x=Number(x),this._levels[x].el.children.length||x===o?(this._levels[x].el.style.zIndex=h-Math.abs(o-x),this._onUpdateLevel(x)):(kt(this._levels[x].el),this._removeTilesAtZoom(x),this._onRemoveLevel(x),delete this._levels[x]);var C=this._levels[o],N=this._map;return C||(C=this._levels[o]={},C.el=ut("div","leaflet-tile-container leaflet-zoom-animated",this._container),C.el.style.zIndex=h,C.origin=N.project(N.unproject(N.getPixelOrigin()),o).round(),C.zoom=o,this._setZoomTransform(C,N.getCenter(),N.getZoom()),E(C.el.offsetWidth),this._onCreateLevel(C)),this._level=C,C}},_onUpdateLevel:E,_onRemoveLevel:E,_onCreateLevel:E,_pruneTiles:function(){if(this._map){var o,h,x=this._map.getZoom();if(x>this.options.maxZoom||x<this.options.minZoom){this._removeAllTiles();return}for(o in this._tiles)h=this._tiles[o],h.retain=h.current;for(o in this._tiles)if(h=this._tiles[o],h.current&&!h.active){var C=h.coords;this._retainParent(C.x,C.y,C.z,C.z-5)||this._retainChildren(C.x,C.y,C.z,C.z+2)}for(o in this._tiles)this._tiles[o].retain||this._removeTile(o)}},_removeTilesAtZoom:function(o){for(var h in this._tiles)this._tiles[h].coords.z===o&&this._removeTile(h)},_removeAllTiles:function(){for(var o in this._tiles)this._removeTile(o)},_invalidateAll:function(){for(var o in this._levels)kt(this._levels[o].el),this._onRemoveLevel(Number(o)),delete this._levels[o];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(o,h,x,C){var N=Math.floor(o/2),F=Math.floor(h/2),$=x-1,re=new K(+N,+F);re.z=+$;var ae=this._tileCoordsToKey(re),he=this._tiles[ae];return he&&he.active?(he.retain=!0,!0):(he&&he.loaded&&(he.retain=!0),$>C?this._retainParent(N,F,$,C):!1)},_retainChildren:function(o,h,x,C){for(var N=2*o;N<2*o+2;N++)for(var F=2*h;F<2*h+2;F++){var $=new K(N,F);$.z=x+1;var re=this._tileCoordsToKey($),ae=this._tiles[re];if(ae&&ae.active){ae.retain=!0;continue}else ae&&ae.loaded&&(ae.retain=!0);x+1<C&&this._retainChildren(N,F,x+1,C)}},_resetView:function(o){var h=o&&(o.pinch||o.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),h,h)},_animateZoom:function(o){this._setView(o.center,o.zoom,!0,o.noUpdate)},_clampZoom:function(o){var h=this.options;return h.minNativeZoom!==void 0&&o<h.minNativeZoom?h.minNativeZoom:h.maxNativeZoom!==void 0&&h.maxNativeZoom<o?h.maxNativeZoom:o},_setView:function(o,h,x,C){var N=Math.round(h);this.options.maxZoom!==void 0&&N>this.options.maxZoom||this.options.minZoom!==void 0&&N<this.options.minZoom?N=void 0:N=this._clampZoom(N);var F=this.options.updateWhenZooming&&N!==this._tileZoom;(!C||F)&&(this._tileZoom=N,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),N!==void 0&&this._update(o),x||this._pruneTiles(),this._noPrune=!!x),this._setZoomTransforms(o,h)},_setZoomTransforms:function(o,h){for(var x in this._levels)this._setZoomTransform(this._levels[x],o,h)},_setZoomTransform:function(o,h,x){var C=this._map.getZoomScale(x,o.zoom),N=o.origin.multiplyBy(C).subtract(this._map._getNewPixelOrigin(h,x)).round();Pe.any3d?W(o.el,N,C):Ce(o.el,N)},_resetGrid:function(){var o=this._map,h=o.options.crs,x=this._tileSize=this.getTileSize(),C=this._tileZoom,N=this._map.getPixelWorldBounds(this._tileZoom);N&&(this._globalTileRange=this._pxBoundsToTileRange(N)),this._wrapX=h.wrapLng&&!this.options.noWrap&&[Math.floor(o.project([0,h.wrapLng[0]],C).x/x.x),Math.ceil(o.project([0,h.wrapLng[1]],C).x/x.y)],this._wrapY=h.wrapLat&&!this.options.noWrap&&[Math.floor(o.project([h.wrapLat[0],0],C).y/x.x),Math.ceil(o.project([h.wrapLat[1],0],C).y/x.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(o){var h=this._map,x=h._animatingZoom?Math.max(h._animateToZoom,h.getZoom()):h.getZoom(),C=h.getZoomScale(x,this._tileZoom),N=h.project(o,this._tileZoom).floor(),F=h.getSize().divideBy(C*2);return new be(N.subtract(F),N.add(F))},_update:function(o){var h=this._map;if(h){var x=this._clampZoom(h.getZoom());if(o===void 0&&(o=h.getCenter()),this._tileZoom!==void 0){var C=this._getTiledPixelBounds(o),N=this._pxBoundsToTileRange(C),F=N.getCenter(),$=[],re=this.options.keepBuffer,ae=new be(N.getBottomLeft().subtract([re,-re]),N.getTopRight().add([re,-re]));if(!(isFinite(N.min.x)&&isFinite(N.min.y)&&isFinite(N.max.x)&&isFinite(N.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var he in this._tiles){var Ne=this._tiles[he].coords;(Ne.z!==this._tileZoom||!ae.contains(new K(Ne.x,Ne.y)))&&(this._tiles[he].current=!1)}if(Math.abs(x-this._tileZoom)>1){this._setView(o,x);return}for(var He=N.min.y;He<=N.max.y;He++)for(var ot=N.min.x;ot<=N.max.x;ot++){var Yn=new K(ot,He);if(Yn.z=this._tileZoom,!!this._isValidTile(Yn)){var Cn=this._tiles[this._tileCoordsToKey(Yn)];Cn?Cn.current=!0:$.push(Yn)}}if($.sort(function(rr,vo){return rr.distanceTo(F)-vo.distanceTo(F)}),$.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Pr=document.createDocumentFragment();for(ot=0;ot<$.length;ot++)this._addTile($[ot],Pr);this._level.el.appendChild(Pr)}}}},_isValidTile:function(o){var h=this._map.options.crs;if(!h.infinite){var x=this._globalTileRange;if(!h.wrapLng&&(o.x<x.min.x||o.x>x.max.x)||!h.wrapLat&&(o.y<x.min.y||o.y>x.max.y))return!1}if(!this.options.bounds)return!0;var C=this._tileCoordsToBounds(o);return Fe(this.options.bounds).overlaps(C)},_keyToBounds:function(o){return this._tileCoordsToBounds(this._keyToTileCoords(o))},_tileCoordsToNwSe:function(o){var h=this._map,x=this.getTileSize(),C=o.scaleBy(x),N=C.add(x),F=h.unproject(C,o.z),$=h.unproject(N,o.z);return[F,$]},_tileCoordsToBounds:function(o){var h=this._tileCoordsToNwSe(o),x=new Qe(h[0],h[1]);return this.options.noWrap||(x=this._map.wrapLatLngBounds(x)),x},_tileCoordsToKey:function(o){return o.x+":"+o.y+":"+o.z},_keyToTileCoords:function(o){var h=o.split(":"),x=new K(+h[0],+h[1]);return x.z=+h[2],x},_removeTile:function(o){var h=this._tiles[o];h&&(kt(h.el),delete this._tiles[o],this.fire("tileunload",{tile:h.el,coords:this._keyToTileCoords(o)}))},_initTile:function(o){De(o,"leaflet-tile");var h=this.getTileSize();o.style.width=h.x+"px",o.style.height=h.y+"px",o.onselectstart=E,o.onmousemove=E,Pe.ielt9&&this.options.opacity<1&&it(o,this.options.opacity)},_addTile:function(o,h){var x=this._getTilePos(o),C=this._tileCoordsToKey(o),N=this.createTile(this._wrapCoords(o),m(this._tileReady,this,o));this._initTile(N),this.createTile.length<2&&ce(m(this._tileReady,this,o,null,N)),Ce(N,x),this._tiles[C]={el:N,coords:o,current:!0},h.appendChild(N),this.fire("tileloadstart",{tile:N,coords:o})},_tileReady:function(o,h,x){h&&this.fire("tileerror",{error:h,tile:x,coords:o});var C=this._tileCoordsToKey(o);x=this._tiles[C],x&&(x.loaded=+new Date,this._map._fadeAnimated?(it(x.el,0),ue(this._fadeFrame),this._fadeFrame=ce(this._updateOpacity,this)):(x.active=!0,this._pruneTiles()),h||(De(x.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:x.el,coords:o})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Pe.ielt9||!this._map._fadeAnimated?ce(this._pruneTiles,this):setTimeout(m(this._pruneTiles,this),250)))},_getTilePos:function(o){return o.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(o){var h=new K(this._wrapX?S(o.x,this._wrapX):o.x,this._wrapY?S(o.y,this._wrapY):o.y);return h.z=o.z,h},_pxBoundsToTileRange:function(o){var h=this.getTileSize();return new be(o.min.unscaleBy(h).floor(),o.max.unscaleBy(h).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var o in this._tiles)if(!this._tiles[o].loaded)return!1;return!0}});function Bu(o){return new Lr(o)}var Ji=Lr.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(o,h){this._url=o,h=P(this,h),h.detectRetina&&Pe.retina&&h.maxZoom>0?(h.tileSize=Math.floor(h.tileSize/2),h.zoomReverse?(h.zoomOffset--,h.minZoom=Math.min(h.maxZoom,h.minZoom+1)):(h.zoomOffset++,h.maxZoom=Math.max(h.minZoom,h.maxZoom-1)),h.minZoom=Math.max(0,h.minZoom)):h.zoomReverse?h.minZoom=Math.min(h.maxZoom,h.minZoom):h.maxZoom=Math.max(h.minZoom,h.maxZoom),typeof h.subdomains=="string"&&(h.subdomains=h.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(o,h){return this._url===o&&h===void 0&&(h=!0),this._url=o,h||this.redraw(),this},createTile:function(o,h){var x=document.createElement("img");return We(x,"load",m(this._tileOnLoad,this,h,x)),We(x,"error",m(this._tileOnError,this,h,x)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(x.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(x.referrerPolicy=this.options.referrerPolicy),x.alt="",x.src=this.getTileUrl(o),x},getTileUrl:function(o){var h={r:Pe.retina?"@2x":"",s:this._getSubdomain(o),x:o.x,y:o.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var x=this._globalTileRange.max.y-o.y;this.options.tms&&(h.y=x),h["-y"]=x}return I(this._url,l(h,this.options))},_tileOnLoad:function(o,h){Pe.ielt9?setTimeout(m(o,this,null,h),0):o(null,h)},_tileOnError:function(o,h,x){var C=this.options.errorTileUrl;C&&h.getAttribute("src")!==C&&(h.src=C),o(x,h)},_onTileRemove:function(o){o.tile.onload=null},_getZoomForUrl:function(){var o=this._tileZoom,h=this.options.maxZoom,x=this.options.zoomReverse,C=this.options.zoomOffset;return x&&(o=h-o),o+C},_getSubdomain:function(o){var h=Math.abs(o.x+o.y)%this.options.subdomains.length;return this.options.subdomains[h]},_abortLoading:function(){var o,h;for(o in this._tiles)if(this._tiles[o].coords.z!==this._tileZoom&&(h=this._tiles[o].el,h.onload=E,h.onerror=E,!h.complete)){h.src=G;var x=this._tiles[o].coords;kt(h),delete this._tiles[o],this.fire("tileabort",{tile:h,coords:x})}},_removeTile:function(o){var h=this._tiles[o];if(h)return h.el.setAttribute("src",G),Lr.prototype._removeTile.call(this,o)},_tileReady:function(o,h,x){if(!(!this._map||x&&x.getAttribute("src")===G))return Lr.prototype._tileReady.call(this,o,h,x)}});function $f(o,h){return new Ji(o,h)}var Xf=Ji.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(o,h){this._url=o;var x=l({},this.defaultWmsParams);for(var C in h)C in this.options||(x[C]=h[C]);h=P(this,h);var N=h.detectRetina&&Pe.retina?2:1,F=this.getTileSize();x.width=F.x*N,x.height=F.y*N,this.wmsParams=x},onAdd:function(o){this._crs=this.options.crs||o.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var h=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[h]=this._crs.code,Ji.prototype.onAdd.call(this,o)},getTileUrl:function(o){var h=this._tileCoordsToNwSe(o),x=this._crs,C=we(x.project(h[0]),x.project(h[1])),N=C.min,F=C.max,$=(this._wmsVersion>=1.3&&this._crs===Xi?[N.y,N.x,F.y,F.x]:[N.x,N.y,F.x,F.y]).join(","),re=Ji.prototype.getTileUrl.call(this,o);return re+D(this.wmsParams,re,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+$},setParams:function(o,h){return l(this.wmsParams,o),h||this.redraw(),this}});function Wx(o,h){return new Xf(o,h)}Ji.WMS=Xf,$f.wms=Wx;var Ni=on.extend({options:{padding:.1},initialize:function(o){P(this,o),v(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),De(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var o={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(o.zoomanim=this._onAnimZoom),o},_onAnimZoom:function(o){this._updateTransform(o.center,o.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(o,h){var x=this._map.getZoomScale(h,this._zoom),C=this._map.getSize().multiplyBy(.5+this.options.padding),N=this._map.project(this._center,h),F=C.multiplyBy(-x).add(N).subtract(this._map._getNewPixelOrigin(o,h));Pe.any3d?W(this._container,F,x):Ce(this._container,F)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var o in this._layers)this._layers[o]._reset()},_onZoomEnd:function(){for(var o in this._layers)this._layers[o]._project()},_updatePaths:function(){for(var o in this._layers)this._layers[o]._update()},_update:function(){var o=this.options.padding,h=this._map.getSize(),x=this._map.containerPointToLayerPoint(h.multiplyBy(-o)).round();this._bounds=new be(x,x.add(h.multiplyBy(1+o*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),qf=Ni.extend({options:{tolerance:0},getEvents:function(){var o=Ni.prototype.getEvents.call(this);return o.viewprereset=this._onViewPreReset,o},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Ni.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var o=this._container=document.createElement("canvas");We(o,"mousemove",this._onMouseMove,this),We(o,"click dblclick mousedown mouseup contextmenu",this._onClick,this),We(o,"mouseout",this._handleMouseOut,this),o._leaflet_disable_events=!0,this._ctx=o.getContext("2d")},_destroyContainer:function(){ue(this._redrawRequest),delete this._ctx,kt(this._container),Se(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var o;this._redrawBounds=null;for(var h in this._layers)o=this._layers[h],o._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ni.prototype._update.call(this);var o=this._bounds,h=this._container,x=o.getSize(),C=Pe.retina?2:1;Ce(h,o.min),h.width=C*x.x,h.height=C*x.y,h.style.width=x.x+"px",h.style.height=x.y+"px",Pe.retina&&this._ctx.scale(2,2),this._ctx.translate(-o.min.x,-o.min.y),this.fire("update")}},_reset:function(){Ni.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(o){this._updateDashArray(o),this._layers[v(o)]=o;var h=o._order={layer:o,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=h),this._drawLast=h,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(o){this._requestRedraw(o)},_removePath:function(o){var h=o._order,x=h.next,C=h.prev;x?x.prev=C:this._drawLast=C,C?C.next=x:this._drawFirst=x,delete o._order,delete this._layers[v(o)],this._requestRedraw(o)},_updatePath:function(o){this._extendRedrawBounds(o),o._project(),o._update(),this._requestRedraw(o)},_updateStyle:function(o){this._updateDashArray(o),this._requestRedraw(o)},_updateDashArray:function(o){if(typeof o.options.dashArray=="string"){var h=o.options.dashArray.split(/[, ]+/),x=[],C,N;for(N=0;N<h.length;N++){if(C=Number(h[N]),isNaN(C))return;x.push(C)}o.options._dashArray=x}else o.options._dashArray=o.options.dashArray},_requestRedraw:function(o){this._map&&(this._extendRedrawBounds(o),this._redrawRequest=this._redrawRequest||ce(this._redraw,this))},_extendRedrawBounds:function(o){if(o._pxBounds){var h=(o.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new be,this._redrawBounds.extend(o._pxBounds.min.subtract([h,h])),this._redrawBounds.extend(o._pxBounds.max.add([h,h]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var o=this._redrawBounds;if(o){var h=o.getSize();this._ctx.clearRect(o.min.x,o.min.y,h.x,h.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var o,h=this._redrawBounds;if(this._ctx.save(),h){var x=h.getSize();this._ctx.beginPath(),this._ctx.rect(h.min.x,h.min.y,x.x,x.y),this._ctx.clip()}this._drawing=!0;for(var C=this._drawFirst;C;C=C.next)o=C.layer,(!h||o._pxBounds&&o._pxBounds.intersects(h))&&o._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(o,h){if(this._drawing){var x,C,N,F,$=o._parts,re=$.length,ae=this._ctx;if(re){for(ae.beginPath(),x=0;x<re;x++){for(C=0,N=$[x].length;C<N;C++)F=$[x][C],ae[C?"lineTo":"moveTo"](F.x,F.y);h&&ae.closePath()}this._fillStroke(ae,o)}}},_updateCircle:function(o){if(!(!this._drawing||o._empty())){var h=o._point,x=this._ctx,C=Math.max(Math.round(o._radius),1),N=(Math.max(Math.round(o._radiusY),1)||C)/C;N!==1&&(x.save(),x.scale(1,N)),x.beginPath(),x.arc(h.x,h.y/N,C,0,Math.PI*2,!1),N!==1&&x.restore(),this._fillStroke(x,o)}},_fillStroke:function(o,h){var x=h.options;x.fill&&(o.globalAlpha=x.fillOpacity,o.fillStyle=x.fillColor||x.color,o.fill(x.fillRule||"evenodd")),x.stroke&&x.weight!==0&&(o.setLineDash&&o.setLineDash(h.options&&h.options._dashArray||[]),o.globalAlpha=x.opacity,o.lineWidth=x.weight,o.strokeStyle=x.color,o.lineCap=x.lineCap,o.lineJoin=x.lineJoin,o.stroke())},_onClick:function(o){for(var h=this._map.mouseEventToLayerPoint(o),x,C,N=this._drawFirst;N;N=N.next)x=N.layer,x.options.interactive&&x._containsPoint(h)&&(!(o.type==="click"||o.type==="preclick")||!this._map._draggableMoved(x))&&(C=x);this._fireEvent(C?[C]:!1,o)},_onMouseMove:function(o){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var h=this._map.mouseEventToLayerPoint(o);this._handleMouseHover(o,h)}},_handleMouseOut:function(o){var h=this._hoveredLayer;h&&(vt(this._container,"leaflet-interactive"),this._fireEvent([h],o,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(o,h){if(!this._mouseHoverThrottled){for(var x,C,N=this._drawFirst;N;N=N.next)x=N.layer,x.options.interactive&&x._containsPoint(h)&&(C=x);C!==this._hoveredLayer&&(this._handleMouseOut(o),C&&(De(this._container,"leaflet-interactive"),this._fireEvent([C],o,"mouseover"),this._hoveredLayer=C)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,o),this._mouseHoverThrottled=!0,setTimeout(m(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(o,h,x){this._map._fireDOMEvent(h,x||h.type,o)},_bringToFront:function(o){var h=o._order;if(h){var x=h.next,C=h.prev;if(x)x.prev=C;else return;C?C.next=x:x&&(this._drawFirst=x),h.prev=this._drawLast,this._drawLast.next=h,h.next=null,this._drawLast=h,this._requestRedraw(o)}},_bringToBack:function(o){var h=o._order;if(h){var x=h.next,C=h.prev;if(C)C.next=x;else return;x?x.prev=C:C&&(this._drawLast=C),h.prev=null,h.next=this._drawFirst,this._drawFirst.prev=h,this._drawFirst=h,this._requestRedraw(o)}}});function Kf(o){return Pe.canvas?new qf(o):null}var Aa=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(o){return document.createElement("<lvml:"+o+' class="lvml">')}}catch{}return function(o){return document.createElement("<"+o+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Vx={_initContainer:function(){this._container=ut("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Ni.prototype._update.call(this),this.fire("update"))},_initPath:function(o){var h=o._container=Aa("shape");De(h,"leaflet-vml-shape "+(this.options.className||"")),h.coordsize="1 1",o._path=Aa("path"),h.appendChild(o._path),this._updateStyle(o),this._layers[v(o)]=o},_addPath:function(o){var h=o._container;this._container.appendChild(h),o.options.interactive&&o.addInteractiveTarget(h)},_removePath:function(o){var h=o._container;kt(h),o.removeInteractiveTarget(h),delete this._layers[v(o)]},_updateStyle:function(o){var h=o._stroke,x=o._fill,C=o.options,N=o._container;N.stroked=!!C.stroke,N.filled=!!C.fill,C.stroke?(h||(h=o._stroke=Aa("stroke")),N.appendChild(h),h.weight=C.weight+"px",h.color=C.color,h.opacity=C.opacity,C.dashArray?h.dashStyle=k(C.dashArray)?C.dashArray.join(" "):C.dashArray.replace(/( *, *)/g," "):h.dashStyle="",h.endcap=C.lineCap.replace("butt","flat"),h.joinstyle=C.lineJoin):h&&(N.removeChild(h),o._stroke=null),C.fill?(x||(x=o._fill=Aa("fill")),N.appendChild(x),x.color=C.fillColor||C.color,x.opacity=C.fillOpacity):x&&(N.removeChild(x),o._fill=null)},_updateCircle:function(o){var h=o._point.round(),x=Math.round(o._radius),C=Math.round(o._radiusY||x);this._setPath(o,o._empty()?"M0 0":"AL "+h.x+","+h.y+" "+x+","+C+" 0,"+65535*360)},_setPath:function(o,h){o._path.v=h},_bringToFront:function(o){Pt(o._container)},_bringToBack:function(o){Wn(o._container)}},zl=Pe.vml?Aa:Ot,Na=Ni.extend({_initContainer:function(){this._container=zl("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=zl("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){kt(this._container),Se(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ni.prototype._update.call(this);var o=this._bounds,h=o.getSize(),x=this._container;(!this._svgSize||!this._svgSize.equals(h))&&(this._svgSize=h,x.setAttribute("width",h.x),x.setAttribute("height",h.y)),Ce(x,o.min),x.setAttribute("viewBox",[o.min.x,o.min.y,h.x,h.y].join(" ")),this.fire("update")}},_initPath:function(o){var h=o._path=zl("path");o.options.className&&De(h,o.options.className),o.options.interactive&&De(h,"leaflet-interactive"),this._updateStyle(o),this._layers[v(o)]=o},_addPath:function(o){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(o._path),o.addInteractiveTarget(o._path)},_removePath:function(o){kt(o._path),o.removeInteractiveTarget(o._path),delete this._layers[v(o)]},_updatePath:function(o){o._project(),o._update()},_updateStyle:function(o){var h=o._path,x=o.options;h&&(x.stroke?(h.setAttribute("stroke",x.color),h.setAttribute("stroke-opacity",x.opacity),h.setAttribute("stroke-width",x.weight),h.setAttribute("stroke-linecap",x.lineCap),h.setAttribute("stroke-linejoin",x.lineJoin),x.dashArray?h.setAttribute("stroke-dasharray",x.dashArray):h.removeAttribute("stroke-dasharray"),x.dashOffset?h.setAttribute("stroke-dashoffset",x.dashOffset):h.removeAttribute("stroke-dashoffset")):h.setAttribute("stroke","none"),x.fill?(h.setAttribute("fill",x.fillColor||x.color),h.setAttribute("fill-opacity",x.fillOpacity),h.setAttribute("fill-rule",x.fillRule||"evenodd")):h.setAttribute("fill","none"))},_updatePoly:function(o,h){this._setPath(o,Ze(o._parts,h))},_updateCircle:function(o){var h=o._point,x=Math.max(Math.round(o._radius),1),C=Math.max(Math.round(o._radiusY),1)||x,N="a"+x+","+C+" 0 1,0 ",F=o._empty()?"M0 0":"M"+(h.x-x)+","+h.y+N+x*2+",0 "+N+-x*2+",0 ";this._setPath(o,F)},_setPath:function(o,h){o._path.setAttribute("d",h)},_bringToFront:function(o){Pt(o._path)},_bringToBack:function(o){Wn(o._path)}});Pe.vml&&Na.include(Vx);function Qf(o){return Pe.svg||Pe.vml?new Na(o):null}at.include({getRenderer:function(o){var h=o.options.renderer||this._getPaneRenderer(o.options.pane)||this.options.renderer||this._renderer;return h||(h=this._renderer=this._createRenderer()),this.hasLayer(h)||this.addLayer(h),h},_getPaneRenderer:function(o){if(o==="overlayPane"||o===void 0)return!1;var h=this._paneRenderers[o];return h===void 0&&(h=this._createRenderer({pane:o}),this._paneRenderers[o]=h),h},_createRenderer:function(o){return this.options.preferCanvas&&Kf(o)||Qf(o)}});var Jf=a.extend({initialize:function(o,h){a.prototype.initialize.call(this,this._boundsToLatLngs(o),h)},setBounds:function(o){return this.setLatLngs(this._boundsToLatLngs(o))},_boundsToLatLngs:function(o){return o=Fe(o),[o.getSouthWest(),o.getNorthWest(),o.getNorthEast(),o.getSouthEast()]}});function Gx(o,h){return new Jf(o,h)}Na.create=zl,Na.pointsToPath=Ze,d.geometryToLayer=f,d.coordsToLatLng=w,d.coordsToLatLngs=b,d.latLngToCoords=A,d.latLngsToCoords=O,d.getFeature=B,d.asFeature=V,at.mergeOptions({boxZoom:!0});var e0=Vn.extend({initialize:function(o){this._map=o,this._container=o._container,this._pane=o._panes.overlayPane,this._resetStateTimeout=0,o.on("unload",this._destroy,this)},addHooks:function(){We(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Se(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){kt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(o){if(!o.shiftKey||o.which!==1&&o.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),_n(),Be(),this._startPoint=this._map.mouseEventToContainerPoint(o),We(document,{contextmenu:gr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(o){this._moved||(this._moved=!0,this._box=ut("div","leaflet-zoom-box",this._container),De(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(o);var h=new be(this._point,this._startPoint),x=h.getSize();Ce(this._box,h.min),this._box.style.width=x.x+"px",this._box.style.height=x.y+"px"},_finish:function(){this._moved&&(kt(this._box),vt(this._container,"leaflet-crosshair")),Ds(),Mt(),Se(document,{contextmenu:gr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(o){if(!(o.which!==1&&o.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(m(this._resetState,this),0);var h=new Qe(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(h).fire("boxzoomend",{boxZoomBounds:h})}},_onKeyDown:function(o){o.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});at.addInitHook("addHandler","boxZoom",e0),at.mergeOptions({doubleClickZoom:!0});var t0=Vn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(o){var h=this._map,x=h.getZoom(),C=h.options.zoomDelta,N=o.originalEvent.shiftKey?x-C:x+C;h.options.doubleClickZoom==="center"?h.setZoom(N):h.setZoomAround(o.containerPoint,N)}});at.addInitHook("addHandler","doubleClickZoom",t0),at.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var n0=Vn.extend({addHooks:function(){if(!this._draggable){var o=this._map;this._draggable=new oi(o._mapPane,o._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),o.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),o.on("zoomend",this._onZoomEnd,this),o.whenReady(this._onZoomEnd,this))}De(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){vt(this._map._container,"leaflet-grab"),vt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var o=this._map;if(o._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var h=Fe(this._map.options.maxBounds);this._offsetLimit=we(this._map.latLngToContainerPoint(h.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(h.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;o.fire("movestart").fire("dragstart"),o.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(o){if(this._map.options.inertia){var h=this._lastTime=+new Date,x=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(x),this._times.push(h),this._prunePositions(h)}this._map.fire("move",o).fire("drag",o)},_prunePositions:function(o){for(;this._positions.length>1&&o-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var o=this._map.getSize().divideBy(2),h=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=h.subtract(o).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(o,h){return o-(o-h)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var o=this._draggable._newPos.subtract(this._draggable._startPos),h=this._offsetLimit;o.x<h.min.x&&(o.x=this._viscousLimit(o.x,h.min.x)),o.y<h.min.y&&(o.y=this._viscousLimit(o.y,h.min.y)),o.x>h.max.x&&(o.x=this._viscousLimit(o.x,h.max.x)),o.y>h.max.y&&(o.y=this._viscousLimit(o.y,h.max.y)),this._draggable._newPos=this._draggable._startPos.add(o)}},_onPreDragWrap:function(){var o=this._worldWidth,h=Math.round(o/2),x=this._initialWorldOffset,C=this._draggable._newPos.x,N=(C-h+x)%o+h-x,F=(C+h+x)%o-h-x,$=Math.abs(N+x)<Math.abs(F+x)?N:F;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=$},_onDragEnd:function(o){var h=this._map,x=h.options,C=!x.inertia||o.noInertia||this._times.length<2;if(h.fire("dragend",o),C)h.fire("moveend");else{this._prunePositions(+new Date);var N=this._lastPos.subtract(this._positions[0]),F=(this._lastTime-this._times[0])/1e3,$=x.easeLinearity,re=N.multiplyBy($/F),ae=re.distanceTo([0,0]),he=Math.min(x.inertiaMaxSpeed,ae),Ne=re.multiplyBy(he/ae),He=he/(x.inertiaDeceleration*$),ot=Ne.multiplyBy(-He/2).round();!ot.x&&!ot.y?h.fire("moveend"):(ot=h._limitOffset(ot,h.options.maxBounds),ce(function(){h.panBy(ot,{duration:He,easeLinearity:$,noMoveStart:!0,animate:!0})}))}}});at.addInitHook("addHandler","dragging",n0),at.mergeOptions({keyboard:!0,keyboardPanDelta:80});var r0=Vn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(o){this._map=o,this._setPanDelta(o.options.keyboardPanDelta),this._setZoomDelta(o.options.zoomDelta)},addHooks:function(){var o=this._map._container;o.tabIndex<=0&&(o.tabIndex="0"),We(o,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Se(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var o=document.body,h=document.documentElement,x=o.scrollTop||h.scrollTop,C=o.scrollLeft||h.scrollLeft;this._map._container.focus(),window.scrollTo(C,x)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(o){var h=this._panKeys={},x=this.keyCodes,C,N;for(C=0,N=x.left.length;C<N;C++)h[x.left[C]]=[-1*o,0];for(C=0,N=x.right.length;C<N;C++)h[x.right[C]]=[o,0];for(C=0,N=x.down.length;C<N;C++)h[x.down[C]]=[0,o];for(C=0,N=x.up.length;C<N;C++)h[x.up[C]]=[0,-1*o]},_setZoomDelta:function(o){var h=this._zoomKeys={},x=this.keyCodes,C,N;for(C=0,N=x.zoomIn.length;C<N;C++)h[x.zoomIn[C]]=o;for(C=0,N=x.zoomOut.length;C<N;C++)h[x.zoomOut[C]]=-o},_addHooks:function(){We(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Se(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(o){if(!(o.altKey||o.ctrlKey||o.metaKey)){var h=o.keyCode,x=this._map,C;if(h in this._panKeys){if(!x._panAnim||!x._panAnim._inProgress)if(C=this._panKeys[h],o.shiftKey&&(C=le(C).multiplyBy(3)),x.options.maxBounds&&(C=x._limitOffset(le(C),x.options.maxBounds)),x.options.worldCopyJump){var N=x.wrapLatLng(x.unproject(x.project(x.getCenter()).add(C)));x.panTo(N)}else x.panBy(C)}else if(h in this._zoomKeys)x.setZoom(x.getZoom()+(o.shiftKey?3:1)*this._zoomKeys[h]);else if(h===27&&x._popup&&x._popup.options.closeOnEscapeKey)x.closePopup();else return;gr(o)}}});at.addInitHook("addHandler","keyboard",r0),at.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var i0=Vn.extend({addHooks:function(){We(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Se(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(o){var h=$i(o),x=this._map.options.wheelDebounceTime;this._delta+=h,this._lastMousePos=this._map.mouseEventToContainerPoint(o),this._startTime||(this._startTime=+new Date);var C=Math.max(x-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(m(this._performZoom,this),C),gr(o)},_performZoom:function(){var o=this._map,h=o.getZoom(),x=this._map.options.zoomSnap||0;o._stop();var C=this._delta/(this._map.options.wheelPxPerZoomLevel*4),N=4*Math.log(2/(1+Math.exp(-Math.abs(C))))/Math.LN2,F=x?Math.ceil(N/x)*x:N,$=o._limitZoom(h+(this._delta>0?F:-F))-h;this._delta=0,this._startTime=null,$&&(o.options.scrollWheelZoom==="center"?o.setZoom(h+$):o.setZoomAround(this._lastMousePos,h+$))}});at.addInitHook("addHandler","scrollWheelZoom",i0);var Zx=600;at.mergeOptions({tapHold:Pe.touchNative&&Pe.safari&&Pe.mobile,tapTolerance:15});var s0=Vn.extend({addHooks:function(){We(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Se(this._map._container,"touchstart",this._onDown,this)},_onDown:function(o){if(clearTimeout(this._holdTimeout),o.touches.length===1){var h=o.touches[0];this._startPos=this._newPos=new K(h.clientX,h.clientY),this._holdTimeout=setTimeout(m(function(){this._cancel(),this._isTapValid()&&(We(document,"touchend",un),We(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",h))},this),Zx),We(document,"touchend touchcancel contextmenu",this._cancel,this),We(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function o(){Se(document,"touchend",un),Se(document,"touchend touchcancel",o)},_cancel:function(){clearTimeout(this._holdTimeout),Se(document,"touchend touchcancel contextmenu",this._cancel,this),Se(document,"touchmove",this._onMove,this)},_onMove:function(o){var h=o.touches[0];this._newPos=new K(h.clientX,h.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(o,h){var x=new MouseEvent(o,{bubbles:!0,cancelable:!0,view:window,screenX:h.screenX,screenY:h.screenY,clientX:h.clientX,clientY:h.clientY});x._simulated=!0,h.target.dispatchEvent(x)}});at.addInitHook("addHandler","tapHold",s0),at.mergeOptions({touchZoom:Pe.touch,bounceAtZoomLimits:!0});var o0=Vn.extend({addHooks:function(){De(this._map._container,"leaflet-touch-zoom"),We(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){vt(this._map._container,"leaflet-touch-zoom"),Se(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(o){var h=this._map;if(!(!o.touches||o.touches.length!==2||h._animatingZoom||this._zooming)){var x=h.mouseEventToContainerPoint(o.touches[0]),C=h.mouseEventToContainerPoint(o.touches[1]);this._centerPoint=h.getSize()._divideBy(2),this._startLatLng=h.containerPointToLatLng(this._centerPoint),h.options.touchZoom!=="center"&&(this._pinchStartLatLng=h.containerPointToLatLng(x.add(C)._divideBy(2))),this._startDist=x.distanceTo(C),this._startZoom=h.getZoom(),this._moved=!1,this._zooming=!0,h._stop(),We(document,"touchmove",this._onTouchMove,this),We(document,"touchend touchcancel",this._onTouchEnd,this),un(o)}},_onTouchMove:function(o){if(!(!o.touches||o.touches.length!==2||!this._zooming)){var h=this._map,x=h.mouseEventToContainerPoint(o.touches[0]),C=h.mouseEventToContainerPoint(o.touches[1]),N=x.distanceTo(C)/this._startDist;if(this._zoom=h.getScaleZoom(N,this._startZoom),!h.options.bounceAtZoomLimits&&(this._zoom<h.getMinZoom()&&N<1||this._zoom>h.getMaxZoom()&&N>1)&&(this._zoom=h._limitZoom(this._zoom)),h.options.touchZoom==="center"){if(this._center=this._startLatLng,N===1)return}else{var F=x._add(C)._divideBy(2)._subtract(this._centerPoint);if(N===1&&F.x===0&&F.y===0)return;this._center=h.unproject(h.project(this._pinchStartLatLng,this._zoom).subtract(F),this._zoom)}this._moved||(h._moveStart(!0,!1),this._moved=!0),ue(this._animRequest);var $=m(h._move,h,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=ce($,this,!0),un(o)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,ue(this._animRequest),Se(document,"touchmove",this._onTouchMove,this),Se(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});at.addInitHook("addHandler","touchZoom",o0),at.BoxZoom=e0,at.DoubleClickZoom=t0,at.Drag=n0,at.Keyboard=r0,at.ScrollWheelZoom=i0,at.TapHold=s0,at.TouchZoom=o0,n.Bounds=be,n.Browser=Pe,n.CRS=je,n.Canvas=qf,n.Circle=Ki,n.CircleMarker=ci,n.Class=Te,n.Control=mr,n.DivIcon=jn,n.DivOverlay=Ut,n.DomEvent=Ln,n.DomUtil=sn,n.Draggable=oi,n.Evented=ne,n.FeatureGroup=kr,n.GeoJSON=d,n.GridLayer=Lr,n.Handler=Vn,n.Icon=qi,n.ImageOverlay=se,n.LatLng=Ve,n.LatLngBounds=Qe,n.Layer=on,n.LayerGroup=Zr,n.LineUtil=Ul,n.Map=at,n.Marker=Zn,n.Mixin=Dl,n.Path=Or,n.Point=K,n.PolyUtil=wa,n.Polygon=a,n.Polyline=r,n.Popup=Pn,n.PosAnimation=va,n.Projection=Ca,n.Rectangle=Jf,n.Renderer=Ni,n.SVG=Na,n.SVGOverlay=st,n.TileLayer=Ji,n.Tooltip=xt,n.Transformation=tt,n.Util=Ie,n.VideoOverlay=ye,n.bind=m,n.bounds=we,n.canvas=Kf,n.circle=M,n.circleMarker=dt,n.control=zs,n.divIcon=Qi,n.extend=l,n.featureGroup=Mr,n.geoJSON=q,n.geoJson=ee,n.gridLayer=Bu,n.icon=Ea,n.imageOverlay=xe,n.latLng=fe,n.latLngBounds=Fe,n.layerGroup=nr,n.map=Rl,n.marker=Du,n.point=le,n.polygon=u,n.polyline=s,n.popup=Rn,n.rectangle=Gx,n.setOptions=P,n.stamp=v,n.svg=Qf,n.svgOverlay=$e,n.tileLayer=$f,n.tooltip=hn,n.transformation=gt,n.version=i,n.videoOverlay=ge;var Yx=window.L;n.noConflict=function(){return window.L=Yx,this},window.L=n})})(Oh,Oh.exports);var kl=Oh.exports;const Tu=Dh(kl);function Vf(e,t,n){return Object.freeze({instance:e,context:t,container:n})}function Gf(e,t){return t==null?function(i,l){const c=H.useRef();return c.current||(c.current=e(i,l)),c}:function(i,l){const c=H.useRef();c.current||(c.current=e(i,l));const m=H.useRef(i),{instance:_}=c.current;return H.useEffect(function(){m.current!==i&&(t(_,i,m.current),m.current=i)},[_,i,l]),c}}function X3(e,t){H.useEffect(function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){var c;(c=t.layerContainer)==null||c.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function Tx(e){return function(n){const i=Hf(),l=e(Wf(n,i),i);return Ex(i.map,n.attribution),Nx(l.current,n.eventHandlers),X3(l.current,i),l}}function q3(e,t){const n=Gf(e,t),i=Tx(n);return G3(i)}function K3(e,t){const n=Gf(e),i=$3(n,t);return Z3(i)}function Q3(e,t){const n=Gf(e,t),i=Tx(n);return Y3(i)}function J3(e,t,n){const{opacity:i,zIndex:l}=t;i!=null&&i!==n.opacity&&e.setOpacity(i),l!=null&&l!==n.zIndex&&e.setZIndex(l)}function eC(){return Hf().map}function Ix(e){const t=eC();return H.useEffect(function(){return t.on(e),function(){t.off(e)}},[t,e]),t}function Lh(){return Lh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Lh.apply(this,arguments)}function tC({bounds:e,boundsOptions:t,center:n,children:i,className:l,id:c,placeholder:m,style:_,whenReady:v,zoom:y,...S},E){const[T]=H.useState({className:l,id:c,style:_}),[U,j]=H.useState(null);H.useImperativeHandle(E,()=>(U==null?void 0:U.map)??null,[U]);const P=H.useCallback(R=>{if(R!==null&&U===null){const I=new kl.Map(R,S);n!=null&&y!=null?I.setView(n,y):e!=null&&I.fitBounds(e,t),v!=null&&I.whenReady(v),j(W3(I))}},[]);H.useEffect(()=>()=>{U==null||U.map.remove()},[U]);const D=U?qn.createElement(Ax,{value:U},i):m??null;return qn.createElement("div",Lh({},T,{ref:P}),D)}const kx=H.forwardRef(tC),Mx=q3(function({position:t,...n},i){const l=new kl.Marker(t,n);return Vf(l,V3(i,{overlayContainer:l}))},function(t,n,i){n.position!==i.position&&t.setLatLng(n.position),n.icon!=null&&n.icon!==i.icon&&t.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==i.zIndexOffset&&t.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==i.opacity&&t.setOpacity(n.opacity),t.dragging!=null&&n.draggable!==i.draggable&&(n.draggable===!0?t.dragging.enable():t.dragging.disable())}),Ox=K3(function(t,n){const i=new kl.Popup(t,n.overlayContainer);return Vf(i,n)},function(t,n,{position:i},l){H.useEffect(function(){const{instance:m}=t;function _(y){y.popup===m&&(m.update(),l(!0))}function v(y){y.popup===m&&l(!1)}return n.map.on({popupopen:_,popupclose:v}),n.overlayContainer==null?(i!=null&&m.setLatLng(i),m.openOn(n.map)):n.overlayContainer.bindPopup(m),function(){var S;n.map.off({popupopen:_,popupclose:v}),(S=n.overlayContainer)==null||S.unbindPopup(),n.map.removeLayer(m)}},[t,n,l,i])}),Lx=Q3(function({url:t,...n},i){const l=new kl.TileLayer(t,Wf(n,i));return Vf(l,i)},function(t,n,i){J3(t,n,i);const{url:l}=n;l!=null&&l!==i.url&&t.setUrl(l)});delete Tu.Icon.Default.prototype._getIconUrl;Tu.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});function nC({onLocationSelect:e}){return Ix({click:t=>{const{lat:n,lng:i}=t.latlng;e(n,i)}}),null}function rC({selectedLocation:e}){const t=Ix({});return H.useEffect(()=>{e&&Ph(e)&&t.setView(e,15,{animate:!0,duration:1})},[e,t]),null}const Ph=e=>Array.isArray(e)&&e.length===2&&!isNaN(e[0])&&!isNaN(e[1])&&e[0]>=-90&&e[0]<=90&&e[1]>=-180&&e[1]<=180;function iC({initialPosition:e=[10.7769,106.7009],onLocationSelect:t,selectedLocation:n=null,height:i="400px",className:l=""}){const[c,m]=H.useState(e),[_,v]=H.useState(n||e);H.useEffect(()=>{n&&Ph(n)&&(v(n),m(n))},[n]);const y=(S,E)=>{v([S,E]),t&&t(S,E)};return g.jsx("div",{className:`map-picker ${l}`,style:{height:i},children:g.jsxs(kx,{center:c,zoom:13,style:{height:"100%",width:"100%"},className:"rounded-lg",children:[g.jsx(Lx,{url:"https://api.maptiler.com/maps/streets-v2/256/{z}/{x}/{y}.png?key=9e3tpg0oNZKgdnlQMV7x",attribution:'© <a href="https://www.openstreetmap.org/copyright">OSM</a> | © <a href="https://www.maptiler.com/">MapTiler</a>'}),g.jsx(nC,{onLocationSelect:y}),g.jsx(rC,{selectedLocation:n}),Ph(_)&&Number.isFinite(_[0])&&Number.isFinite(_[1])&&g.jsx(Mx,{position:_,children:g.jsx(Ox,{children:"Event Location"})})]})})}const uc=e=>typeof e=="number"&&!Number.isNaN(e);function sC({onPlaceSelect:e,placeholder:t="Tìm địa điểm (VN)..."}){const[n,i]=H.useState(""),[l,c]=H.useState([]),[m,_]=H.useState(!1),[v,y]=H.useState(!1),S=H.useRef(null),E=H.useRef(null),T=async P=>{const D="91213568f80640ee9ae790bac4081b3e";y(!0);try{const R=`https://api.geoapify.com/v1/geocode/autocomplete?text=${encodeURIComponent(P)}&filter=countrycode:vn&lang=vi&limit=8&apiKey=${D}`,I=await fetch(R);if(!I.ok)throw new Error("Geoapify failed");const z=((await I.json()).features||[]).map(G=>{const Y=G.properties||{},Z=[];Y.house_number&&Z.push(Y.house_number),Y.street&&Z.push(Y.street),Y.suburb&&Z.push(Y.suburb),Y.district&&Z.push(Y.district),Y.city&&Z.push(Y.city),Y.state&&Z.push(Y.state),Y.country&&Z.push(Y.country);const J=Z.join(", ");return{id:G.properties.place_id||`${Y.lat},${Y.lon}`,title:Y.name||Y.street||Y.formatted||Y.address_line1||Y.city||Y.county||"Địa điểm",subtitle:J||Y.formatted||[Y.address_line1,Y.address_line2].filter(Boolean).join(", "),lat:Number(Y.lat),lng:Number(Y.lon),fullAddress:J||Y.formatted||Y.address_line1||Y.address_line2||""}}).filter(G=>uc(G.lat)&&uc(G.lng));c(z),_(!0)}catch(R){console.warn(R),c([]),_(!1)}finally{y(!1)}},U=P=>{const D=P.target.value;if(i(D),S.current&&clearTimeout(S.current),D.trim().length<3){c([]),_(!1);return}S.current=setTimeout(()=>T(D.trim()),250)},j=P=>{if(!uc(P.lat)||!uc(P.lng))return;e({name:P.title,address:P.fullAddress||P.subtitle,coordinates:[P.lat,P.lng]});const D=P.fullAddress||P.subtitle||"",R=D?`${P.title}, ${D}`:P.title;i(R),_(!1)};return g.jsxs("div",{className:"relative",style:{zIndex:1e3},children:[g.jsx("input",{ref:E,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none transition-colors",placeholder:t,value:n,onChange:U,onFocus:()=>l.length&&_(!0)}),m&&g.jsxs("div",{className:"absolute bg-white border border-gray-200 rounded-xl shadow-xl max-h-72 overflow-auto w-full",style:{zIndex:99999,top:"100%",left:0,marginTop:"4px"},children:[v&&g.jsx("div",{className:"p-2 text-sm text-gray-500",children:"Đang tìm…"}),!v&&l.length===0&&g.jsx("div",{className:"p-2 text-sm text-gray-500",children:"Không có gợi ý"}),l.map(P=>g.jsxs("button",{className:"w-full text-left p-2 hover:bg-gray-100 border-b border-gray-100 last:border-b-0",onClick:()=>j(P),children:[g.jsx("div",{className:"font-medium text-gray-900",children:P.title}),P.subtitle&&g.jsx("div",{className:"text-xs text-gray-500",children:P.subtitle})]},P.id))]})]})}function Px({onLocationChange:e,initialLocation:t=null,className:n=""}){const[i,l]=H.useState("venue"),[c,m]=H.useState(""),[_,v]=H.useState(null),[y,S]=H.useState(""),[E,T]=H.useState(!1);H.useEffect(()=>{t&&(t.mode&&l(t.mode),t.name&&m(t.name),t.coordinates&&v(t.coordinates),t.address&&S(t.address))},[t]);const U=async(I,k)=>{T(!0);try{const z=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${I}&lon=${k}&zoom=18&addressdetails=1&accept-language=en`);if(z.ok){const Y=(await z.json()).address||{},Z=[];Y.house_number&&Z.push(Y.house_number),Y.road&&Z.push(Y.road),Y.suburb&&Z.push(Y.suburb),Y.city_district&&Z.push(Y.city_district),Y.city&&Z.push(Y.city),Y.state&&Z.push(Y.state),Y.country&&Z.push(Y.country);const J=Z.join(", ");S(J),c||m(J),e&&e({mode:i,name:c||J,coordinates:[I,k],address:J})}}catch(z){console.error("Error reverse geocoding:",z)}finally{T(!1)}},j=(I,k)=>{v([I,k]),U(I,k)},P=I=>{const k=I.target.value;m(k),e&&_&&e({mode:i,name:k,coordinates:_,address:y})},D=I=>{m(I.name),v(I.coordinates),S(I.address),e&&e({mode:i,name:I.name,coordinates:I.coordinates,address:I.address})},R=I=>{l(I),e&&e(I==="venue"&&_?{mode:I,name:c,coordinates:_,address:y}:{mode:I,name:I==="online"?"Online":"To be announced",coordinates:null,address:null})};return g.jsxs("div",{className:`location-selector ${n}`,children:[g.jsxs("div",{className:"mb-6",children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Location Type"}),g.jsxs("div",{className:"flex gap-3",children:[g.jsx("button",{className:`px-6 py-3 rounded-xl border-2 transition-all duration-200 ${i==="venue"?"bg-brand-500 text-white border-brand-500 shadow-lg shadow-brand-500/25":"bg-white text-gray-700 border-gray-200 hover:border-brand-300 hover:bg-brand-50"}`,onClick:()=>R("venue"),children:"📍 Venue"}),g.jsx("button",{className:`px-6 py-3 rounded-xl border-2 transition-all duration-200 ${i==="online"?"bg-brand-500 text-white border-brand-500 shadow-lg shadow-brand-500/25":"bg-white text-gray-700 border-gray-200 hover:border-brand-300 hover:bg-brand-50"}`,onClick:()=>R("online"),children:"💻 Online"}),g.jsx("button",{className:`px-6 py-3 rounded-xl border-2 transition-all duration-200 ${i==="tba"?"bg-brand-500 text-white border-brand-500 shadow-lg shadow-brand-500/25":"bg-white text-gray-700 border-gray-200 hover:border-brand-300 hover:bg-brand-50"}`,onClick:()=>R("tba"),children:"❓ TBA"})]})]}),i==="venue"&&g.jsxs("div",{className:"space-y-6",children:[g.jsxs("div",{style:{zIndex:1e3,position:"relative"},children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Search for a Place"}),g.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Type a place name to search and automatically pin the location on the map."}),g.jsx(sC,{onPlaceSelect:D,placeholder:"Search for a place (e.g., 'Hanoi Opera House', 'Ho Chi Minh City')"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Or Select Location on Map"}),g.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Click on the map to pinpoint your event location. The address will be automatically detected."}),g.jsx(iC,{onLocationSelect:j,selectedLocation:_,height:"300px",className:"border-2 border-gray-200 rounded-xl overflow-hidden"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Venue Name"}),g.jsx("input",{type:"text",value:c,onChange:P,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none transition-colors",placeholder:"Enter venue name (e.g., 'Hanoi Opera House')"}),g.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"You can customize the venue name while keeping the map location"})]}),y&&g.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsxs("svg",{className:"w-5 h-5 text-blue-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),g.jsxs("div",{children:[g.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-1",children:"Detected Address"}),g.jsx("p",{className:"text-sm text-blue-700",children:y}),_&&g.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:["Coordinates: ",_[0].toFixed(6),", ",_[1].toFixed(6)]})]})]})}),E&&g.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[g.jsx("div",{className:"loading loading-spinner loading-sm"}),g.jsx("span",{className:"text-sm",children:"Detecting address..."})]})]}),(i==="online"||i==="tba")&&g.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-6 text-center",children:[g.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:g.jsx("svg",{className:"w-8 h-8 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i==="online"?g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"}):g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),g.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:i==="online"?"Online Event":"Location TBA"}),g.jsx("p",{className:"text-gray-600",children:i==="online"?"This event will be held online. No physical location needed.":"The location for this event will be announced later."})]})]})}const oC=["Music","Business & Professional","Food & Drink","Community & Culture","Performing & Visual Arts","Film, Media & Entertainment","Sports & Fitness","Health & Wellness","Science & Technology","Travel & Outdoor","Charity & Causes","Religion & Spirituality","Family & Education","Seasonal & Holiday","Government & Politics","Fashion & Beauty","Home & Lifestyle","Hobbies & Special Interests","School Activities","Others"];function aC(e){return new Promise((t,n)=>{const i=new FileReader;i.onload=()=>t(i.result),i.onerror=n,i.readAsDataURL(e)})}function lC(){const e=zi(),{user:t}=ur(),[n,i]=H.useState(""),[l,c]=H.useState(""),[m,_]=H.useState("Music"),[v,y]=H.useState(""),[S,E]=H.useState(""),[T,U]=H.useState(""),[j,P]=H.useState({mode:"venue",name:"",coordinates:null,address:null}),[D,R]=H.useState(""),[I,k]=H.useState(!1),[z,G]=H.useState(""),[Y,Z]=H.useState([]),[J,ie]=H.useState([]),[Ee,ce]=H.useState([]),[ue,Ie]=H.useState(null),[Te,Q]=H.useState(""),[pe,ne]=H.useState(!1);qn.useEffect(()=>{const je=Y.reduce((Je,Nn)=>Je+Nn.quota,0);je>0&&G(je.toString())},[Y]);const K=()=>{e("/auth")};if(!t)return g.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-white",children:[g.jsx(It,{searchTerm:"",setSearchTerm:()=>{}}),g.jsx("div",{className:"container mx-auto px-6 py-16",children:g.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[g.jsx("div",{className:"mb-16",children:g.jsxs("div",{className:"text-center relative",children:[g.jsxs("div",{className:"absolute inset-0 -z-10",children:[g.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 w-96 h-96 bg-gradient-to-br from-brand-100/30 to-purple-100/30 rounded-full blur-3xl"}),g.jsx("div",{className:"absolute bottom-0 right-0 w-64 h-64 bg-gradient-to-tl from-blue-100/30 to-cyan-100/30 rounded-full blur-2xl"}),g.jsx("div",{className:"absolute top-1/2 left-0 w-48 h-48 bg-gradient-to-r from-pink-100/30 to-rose-100/30 rounded-full blur-xl"})]}),g.jsx("h1",{className:"text-6xl md:text-7xl font-black bg-gradient-to-r from-gray-900 via-brand-600 to-purple-700 bg-clip-text text-transparent mb-8",style:{lineHeight:"1.6"},children:"Create Amazing Events"}),g.jsx("p",{className:"text-xl md:text-2xl text-gray-600 max-w-4xl mx-auto mb-12 leading-relaxed font-light",children:"Easily create events for free on a platform that attendees love and trust"}),g.jsx("div",{className:"w-24 h-1 bg-gradient-to-r from-brand-500 to-purple-500 mx-auto rounded-full mb-8"})]})}),g.jsx("div",{className:"mb-16",children:g.jsx("button",{onClick:K,className:"btn btn-primary btn-lg text-lg px-8 py-4 bg-gradient-to-r from-brand-600 to-purple-600 border-0 hover:from-brand-700 hover:to-purple-700 transform hover:scale-105 transition-all duration-200 shadow-lg hover:shadow-xl",children:"Get Started"})}),g.jsxs("div",{className:"grid md:grid-cols-3 gap-8 mb-16",children:[g.jsxs("div",{className:"text-center p-6",children:[g.jsx("div",{className:"w-16 h-16 bg-brand-100 rounded-full flex items-center justify-center mx-auto mb-4",children:g.jsx("svg",{className:"w-8 h-8 text-brand-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),g.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Create in Minutes"}),g.jsx("p",{className:"text-gray-600",children:"Set up your event with our intuitive form in just a few clicks"})]}),g.jsxs("div",{className:"text-center p-6",children:[g.jsx("div",{className:"w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4",children:g.jsx("svg",{className:"w-8 h-8 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"})})}),g.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Reach More People"}),g.jsx("p",{className:"text-gray-600",children:"Connect with attendees who trust our platform for great events"})]}),g.jsxs("div",{className:"text-center p-6",children:[g.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:g.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),g.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"100% Free"}),g.jsx("p",{className:"text-gray-600",children:"No hidden fees, no subscriptions - create events completely free"})]})]}),g.jsxs("div",{className:"text-center",children:[g.jsx("p",{className:"text-gray-500 mb-4",children:"Trusted by event organizers in Vietnam"}),g.jsxs("div",{className:"flex justify-center items-center gap-8 text-gray-400",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("svg",{className:"w-5 h-5 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),g.jsx("span",{children:"4.9/5"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{d:"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3z"})}),g.jsx("span",{children:"10K+ Events"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),g.jsx("span",{children:"Free Forever"})]})]})]})]})})]});const me=100,le=(l||"").length,be=async je=>{if(!je)return;if(!je.type.startsWith("image/")){alert("Please select an image file (PNG, JPG, JPEG, etc.)");return}if(je.size>5*1024*1024){alert("Image file size must be less than 5MB");return}Ie(je);const Je=await aC(je);Q(Je)},we=je=>{je.preventDefault();const Je=Array.from(je.dataTransfer.files);Je.length>0&&be(Je[0])},Qe=je=>{je.preventDefault()},Fe=()=>{Ie(null),Q("")},Ve=(je,Je)=>!je||!Je?"":new Date(`${je}T${Je}:00`).toISOString(),fe=async()=>{var gt;if(!t){alert("Please sign in to create events");return}if(!n.trim()){alert("Please enter a title");return}if(!v||!S){alert("Please select a date and start time");return}const je=Ve(v,S),Je=T?Ve(v,T):je;j.mode==="online"||j.mode==="tba"||(j.name||"").trim();let Nn=Y.length>0?Math.min(...Y.map(Le=>Le.price)):0,Ue=Y.length>0?Math.max(...Y.map(Le=>Le.price)):0;const tt=Y.reduce((Le,yt)=>Le+yt.quota,0);I&&(Nn=0,Ue=0),ne(!0);try{let Le=null;if(j.mode==="venue"&&((gt=j.name)!=null&&gt.trim()))if(j.coordinates){const{data:Ze,error:nt}=await Re.rpc("upsert_custom_venue",{p_name:j.name.trim(),p_address:j.address||null,p_lat:j.coordinates[0],p_lng:j.coordinates[1]});if(nt){console.error("Error creating venue:",nt),alert("Could not create venue: "+nt.message),ne(!1);return}Le=Ze,console.log("Venue created successfully with coordinates:",Ze)}else{const{data:Ze,error:nt}=await Re.from("venues").insert({name:j.name.trim(),address:j.address||null}).select("id").single();if(nt){console.error("Error creating venue:",nt),alert("Could not create venue: "+nt.message),ne(!1);return}Le=Ze.id,console.log("Venue created successfully without coordinates:",Ze)}const{data:yt,error:Ot}=await Re.from("events").insert([{creator_id:t.id,venue_id:Le,title:n.trim(),description:l.trim(),category:m,start_at:je,end_at:Je,cover_url:Te||J[0]||"",status:"published",min_price:Nn,max_price:Ue,capacity:tt||Number(z||0)}]).select();if(Ot)console.error("Error creating event:",Ot),alert("Failed to create event: "+Ot.message);else{if(console.log("Event created successfully:",yt),Y.length>0){const Ze=yt[0].id,nt=Y.map(Ge=>({event_id:Ze,name:Ge.name,price:I?0:Ge.price,quota:Ge.quota})),{error:qe}=await Re.from("ticket_tiers").insert(nt);qe?(console.error("Error creating ticket tiers:",qe),alert("Event created but failed to create ticket tiers: "+qe.message)):console.log("Ticket tiers created successfully")}window.dispatchEvent(new CustomEvent("suki:events_updated")),console.log("Event created successfully, navigating to home page"),console.log("Created event data:",yt[0]),console.log("Created ticket tiers:",Y),e("/")}}catch(Le){console.error("Error creating event:",Le),alert("Failed to create event: "+Le.message)}finally{ne(!1)}};return g.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-white",children:[g.jsx(It,{userLocation:{city:"HCMC",lat:10.7769,lng:106.7009},setUserLocation:()=>{}}),g.jsxs("div",{className:"container mx-auto px-6 py-12",children:[g.jsx("div",{className:"mb-16",children:g.jsxs("div",{className:"text-center relative",children:[g.jsxs("div",{className:"absolute inset-0 -z-10",children:[g.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 w-96 h-96 bg-gradient-to-br from-brand-100/30 to-purple-100/30 rounded-full blur-3xl"}),g.jsx("div",{className:"absolute bottom-0 right-0 w-64 h-64 bg-gradient-to-tl from-blue-100/30 to-cyan-100/30 rounded-full blur-2xl"}),g.jsx("div",{className:"absolute top-1/2 left-0 w-48 h-48 bg-gradient-to-r from-pink-100/30 to-rose-100/30 rounded-full blur-xl"})]}),g.jsx("h1",{className:"text-6xl md:text-7xl font-black bg-gradient-to-r from-gray-900 via-brand-600 to-purple-700 bg-clip-text text-transparent mb-8",style:{lineHeight:"1.6"},children:"Create Event"}),g.jsx("p",{className:"text-xl md:text-2xl text-gray-600 max-w-4xl mx-auto mb-12 leading-relaxed font-light",children:"Share your event with the world in just a few simple steps"}),g.jsx("div",{className:"w-24 h-1 bg-gradient-to-r from-brand-500 to-purple-500 mx-auto rounded-full mb-8"})]})}),g.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[g.jsxs("section",{className:"bg-white rounded-xl shadow-lg p-8 border border-gray-100",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[g.jsx("div",{className:"w-10 h-10 bg-brand-100 rounded-full flex items-center justify-center",children:g.jsx("svg",{className:"w-5 h-5 text-brand-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})}),g.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Event Title"})]}),g.jsx("p",{className:"text-gray-600 mb-6",children:"This will be your event's title. Be specific and engaging to attract attendees!"}),g.jsx("input",{className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none transition-colors text-lg",placeholder:"Enter your event title",value:n,onChange:je=>i(je.target.value)})]}),g.jsxs("section",{className:"bg-white rounded-xl shadow-lg p-8 border border-gray-100",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[g.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:g.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),g.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Description"})]}),g.jsx("p",{className:"text-gray-600 mb-6",children:"Grab people's attention with a short description about your event. (100 characters max)"}),g.jsx("textarea",{className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none transition-colors resize-none",rows:3,maxLength:me,placeholder:"Describe your event in a few words",value:l,onChange:je=>c(je.target.value)}),g.jsxs("div",{className:"text-sm text-gray-500 text-right mt-2",children:[le,"/",me]})]}),g.jsxs("section",{className:"bg-white rounded-xl shadow-lg p-8 border border-gray-100",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[g.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:g.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),g.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"When & Where"})]}),g.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-6",children:[g.jsxs("div",{children:[g.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Date"}),g.jsx("input",{type:"date",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none transition-colors",value:v,onChange:je=>y(je.target.value)})]}),g.jsxs("div",{children:[g.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Start time"}),g.jsx("input",{type:"time",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none transition-colors",value:S,onChange:je=>E(je.target.value)})]}),g.jsxs("div",{children:[g.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"End time"}),g.jsx("input",{type:"time",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none transition-colors",value:T,onChange:je=>U(je.target.value)})]})]})]}),g.jsxs("section",{className:"bg-white rounded-xl shadow-lg p-8 border border-gray-100",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[g.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center",children:g.jsxs("svg",{className:"w-5 h-5 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),g.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Location"})]}),g.jsx(Px,{onLocationChange:P,initialLocation:j})]}),g.jsxs("section",{className:"bg-white rounded-xl shadow-lg p-8 border border-gray-100",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[g.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:g.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})}),g.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Category"})]}),g.jsx("select",{className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none transition-colors text-lg",value:m,onChange:je=>_(je.target.value),children:oC.map(je=>g.jsx("option",{value:je,children:je},je))})]}),g.jsxs("section",{className:"bg-white rounded-xl shadow-lg p-8 border border-gray-100",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[g.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:g.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),g.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Event Capacity"})]}),g.jsx("p",{className:"text-gray-600 mb-6",children:"Set the maximum number of attendees for your event."}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Attendees"}),g.jsx("input",{type:"number",min:"1",value:z,onChange:je=>G(je.target.value),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none transition-colors",placeholder:"Enter maximum number of attendees",readOnly:!I&&Y.length>0}),!I&&Y.length>0?g.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Capacity is automatically calculated from ticket tiers below."}):g.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Set the maximum number of people who can attend your event."})]})]}),g.jsxs("section",{className:"bg-white rounded-xl shadow-lg p-8 border border-gray-100",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[g.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center",children:g.jsx("svg",{className:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})})}),g.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Ticket Pricing"})]}),g.jsx("p",{className:"text-gray-600 mb-6",children:"Create different ticket types with different prices and quantities. You can have free and paid tiers."}),g.jsxs("div",{className:"mb-6",children:[g.jsxs("label",{className:"inline-flex items-center gap-3 text-gray-700",children:[g.jsx("input",{type:"checkbox",className:"w-5 h-5 text-brand-600 rounded focus:ring-brand-500",checked:I,onChange:je=>{k(je.target.checked),je.target.checked&&Z([])}}),g.jsx("span",{className:"font-medium",children:"My tickets are free"})]}),g.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Check this if you want to offer all tickets for free. No tiering options will be available."})]}),!I&&g.jsxs("div",{className:"space-y-6",children:[g.jsx(Cx,{tiers:Y,onChange:Z}),Y.length>0&&g.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),g.jsxs("div",{children:[g.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"Total Event Capacity"}),g.jsxs("p",{className:"text-sm text-blue-700",children:[z," ",z==="1"?"attendee":"attendees"," (automatically calculated from ticket tiers)"]})]})]})})]}),I&&g.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-6 text-center",children:[g.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:g.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),g.jsx("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:"Free Event"}),g.jsx("p",{className:"text-green-700",children:"Your event will be completely free for all attendees. No ticket tiers or pricing needed!"})]})]}),g.jsxs("section",{className:"bg-white rounded-xl shadow-lg p-8 border border-gray-100",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[g.jsx("div",{className:"w-10 h-10 bg-pink-100 rounded-full flex items-center justify-center",children:g.jsx("svg",{className:"w-5 h-5 text-pink-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),g.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Cover Image"})]}),g.jsx("p",{className:"text-gray-600 mb-6",children:"Upload a cover image for your event. This will be displayed prominently."}),g.jsxs("div",{className:`border-2 border-dashed rounded-xl p-8 text-center transition-all duration-200 ${Te?"border-green-300 bg-green-50":"border-gray-300 hover:border-brand-400 hover:bg-brand-50"}`,onDrop:we,onDragOver:Qe,children:[Te?g.jsxs("div",{className:"space-y-4",children:[g.jsx("img",{src:Te,alt:"Cover preview",className:"mx-auto max-w-full max-h-64 object-cover rounded-xl border border-gray-200 shadow-lg"}),g.jsxs("div",{className:"flex justify-center gap-3",children:[g.jsx("button",{type:"button",onClick:()=>document.getElementById("coverImageInput").click(),className:"btn btn-outline",children:"Change Image"}),g.jsx("button",{type:"button",onClick:Fe,className:"btn btn-ghost text-red-600 hover:text-red-700",children:"Remove"})]})]}):g.jsxs("div",{className:"space-y-4",children:[g.jsx("div",{className:"mx-auto w-20 h-20 text-gray-400",children:g.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),g.jsxs("div",{children:[g.jsx("p",{className:"text-xl font-medium text-gray-700",children:"Drop your cover image here"}),g.jsx("p",{className:"text-gray-500",children:"or click to browse files"})]}),g.jsx("button",{type:"button",onClick:()=>document.getElementById("coverImageInput").click(),className:"btn btn-outline",children:"Browse Files"}),g.jsx("p",{className:"text-sm text-gray-400",children:"PNG, JPG, JPEG up to 5MB"})]}),g.jsx("input",{id:"coverImageInput",type:"file",accept:"image/*",onChange:je=>be(je.target.files[0]),className:"hidden"})]})]}),g.jsxs("div",{className:"flex items-center justify-end gap-4 pt-8",children:[g.jsx("button",{className:"btn btn-ghost text-lg px-8 py-3",onClick:()=>e(-1),children:"Cancel"}),g.jsx("button",{className:"btn btn-primary text-lg px-8 py-3 bg-gradient-to-r from-brand-600 to-purple-600 border-0 hover:from-brand-700 hover:to-purple-700 shadow-lg hover:shadow-xl",onClick:fe,disabled:pe,children:pe?"Publishing…":"Publish Event"})]})]})]})]})}function cC({event:e,defaultQty:t=1,chosenTierId:n=null,priceOverride:i=null}){const{user:l}=ur(),c=zi(),[m,_]=H.useState(!1),[v,y]=H.useState("");async function S(){var j;if(!l){alert("Please sign in first.");return}y("");const U=e.tiers&&e.tiers.length>1;if(e.min_price===0&&e.max_price,U&&!n){y("Please select a ticket tier");return}_(!0);try{const P=t,R=(i??(e==null?void 0:e.min_price)??0)*P,{data:I,error:k}=await Re.from("orders").insert({user_id:l.id,total_amount:R,status:"paid"}).select("id").single();if(k)throw k;const z=(((j=e.tiers)==null?void 0:j.length)??0)>0,G=z?e.tiers.find(Ee=>Ee.id===n):null;console.log("BuyButton Debug - Event:",{id:e.id,min_price:e.min_price,max_price:e.max_price,chosenTierId:n,hasTiers:z,selectedTier:G});let Y=n;if(!n&&e.min_price===0&&e.max_price===0){console.log("BuyButton Debug - Finding free tier for free event");const{data:Ee,error:ce}=await Re.from("ticket_tiers").select("id").eq("event_id",e.id).eq("price",0).limit(1);if(console.log("BuyButton Debug - Free tiers check:",{freeTiers:Ee,tiersError:ce}),ce)throw console.error("Error checking free tiers:",ce),ce;if(Ee&&Ee.length>0)Y=Ee[0].id,console.log("BuyButton Debug - Using free tier:",Y);else throw new Error("No free tier found for free event. Database trigger may not be working.")}console.log("BuyButton Debug - Final tierIdToUse:",Y);const Z={order_id:I.id,event_id:e.id,qr_token:crypto.randomUUID()};Y&&(Z.tier_id=Y);const J=Array.from({length:P},()=>({...Z,qr_token:crypto.randomUUID()}));console.log("BuyButton Debug - Ticket rows to insert:",J);const{error:ie}=await Re.from("tickets").insert(J);if(ie)throw console.error("Error inserting tickets:",ie),ie;console.log("Purchase successful! Order:",I.id,"Tickets created:",J.length),window.dispatchEvent(new CustomEvent("suki:events_updated")),c("/tickets")}catch(P){console.error(P),alert("Could not complete purchase: "+((P==null?void 0:P.message)||"Unknown error"))}finally{_(!1)}}const E=e.tiers&&e.tiers.length>1,T=m||E&&!n;return g.jsxs("div",{className:"space-y-2",children:[v&&g.jsx("p",{className:"text-red-600 text-sm font-medium text-center",children:v}),g.jsx("button",{className:"btn btn-primary w-full",onClick:S,disabled:T,children:m?"Processing…":"Get Ticket"})]})}function dc(e){return e.toLocaleString("vi-VN",{style:"currency",currency:"VND"})}function uC({event:e,remaining:t,onClose:n}){var U,j,P;const[i,l]=H.useState(1),[c,m]=H.useState(!1),[_,v]=H.useState(null);console.log("EventDetail - Received event:",e),console.log("EventDetail - Event tiers:",e==null?void 0:e.tiers),console.log("EventDetail - Event has tiers array:",Array.isArray(e==null?void 0:e.tiers)),console.log("EventDetail - Event capacity:",e==null?void 0:e.capacity),console.log("EventDetail - Event min_price:",e==null?void 0:e.min_price),console.log("EventDetail - Event max_price:",e==null?void 0:e.max_price),console.log("EventDetail - Remaining prop:",t);const y=new Date(e.start_at),S=new Date(e.end_at),E=(U=e.venue)!=null&&U.lat&&((j=e.venue)!=null&&j.lng)?`https://www.google.com/maps/search/?api=1&query=${e.venue.lat},${e.venue.lng}`:null,T=typeof e.remaining=="number"?`${Math.max(0,e.remaining)} left`:null;return g.jsx("div",{className:"fixed inset-0 z-50 bg-black/30 backdrop-blur-sm grid place-items-center p-4",children:g.jsxs("div",{className:"w-full max-w-3xl card overflow-hidden",children:[g.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-neutral-200 bg-white",children:[g.jsx("h2",{className:"text-xl font-semibold",children:e.title}),g.jsx("button",{className:"btn btn-ghost",onClick:n,children:g.jsx(zf,{className:"size-5"})})]}),g.jsxs("div",{className:"p-4 grid md:grid-cols-2 gap-4",children:[g.jsxs("div",{className:"space-y-3",children:[g.jsx("div",{className:"aspect-video bg-neutral-100 rounded-xl overflow-hidden",children:e.cover_url?g.jsx("img",{src:e.cover_url,alt:e.title,className:"w-full h-full object-cover"}):g.jsx("div",{className:"w-full h-full grid place-items-center text-neutral-500",children:"No image"})}),g.jsx("div",{className:"text-sm text-neutral-700 leading-relaxed",children:e.description})]}),g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"space-y-2 text-sm",children:[g.jsxs("div",{className:"flex items-center gap-2 text-neutral-700",children:[g.jsx(Qc,{className:"size-4"})," ",y.toLocaleString()," – ",S.toLocaleTimeString()]}),g.jsxs("div",{className:"flex items-center gap-2 text-neutral-700",children:[g.jsx(na,{className:"size-4"})," ",(P=e.venue)==null?void 0:P.name," ",E&&g.jsxs("a",{className:"inline-flex items-center gap-1 text-brand-600 hover:text-brand-700",href:E,target:"_blank",rel:"noreferrer",children:["Open in Maps ",g.jsx(i3,{className:"size-3"})]})]}),g.jsxs("div",{className:"flex items-center gap-2 text-neutral-700",children:[g.jsx(Mh,{className:"size-4"})," Capacity: ",(()=>{if(e.tiers&&e.tiers.length>0){const D=e.tiers.reduce((R,I)=>R+(I.quota||0),0);return D>0?D:e.capacity}return e.capacity})()," ",T&&g.jsx("span",{className:"badge ml-2",children:T})]}),g.jsxs("div",{className:"flex items-center gap-2 text-neutral-700",children:[g.jsx(n3,{className:"size-4"}),e.min_price===0&&e.max_price===0?g.jsx("span",{className:"text-green-600 font-medium",children:"Free"}):`${dc(e.min_price)} – ${dc(e.max_price)}`]})]}),c?g.jsxs("div",{className:"card p-4 text-center",children:[g.jsxs("p",{className:"mb-2 font-medium text-neutral-800",children:["Ticket saved to ",g.jsx("span",{className:"underline",children:"My Tickets"}),"."]}),g.jsx("div",{className:"inline-block bg-white p-2 rounded",children:g.jsx(wx,{value:"suki://"+e.id,size:120})}),g.jsx("p",{className:"text-sm text-neutral-500 mt-2",children:"Go to My Tickets to view your QR offline."})]}):g.jsxs("div",{className:"space-y-3",children:[Array.isArray(e.tiers)&&e.tiers.length>0?g.jsxs("div",{className:"space-y-3",children:[g.jsx("div",{className:"text-sm text-neutral-500 font-medium",children:"Select your ticket tier:"}),g.jsx("div",{className:"space-y-2",children:e.tiers.map(D=>g.jsxs("label",{className:"flex items-center p-3 rounded-lg border border-neutral-200 hover:border-blue-300 cursor-pointer",children:[g.jsx("input",{type:"radio",name:"tier",value:D.id,className:"mr-3",onChange:()=>v(D),checked:(_==null?void 0:_.id)===D.id}),g.jsxs("div",{className:"flex-1",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("span",{className:"font-medium text-neutral-900",children:D.name}),g.jsx("span",{className:"font-semibold text-blue-600",children:dc(D.price)})]}),g.jsxs("div",{className:"text-xs text-neutral-500 mt-1",children:[D.remaining||D.quota," available"]})]})]},D.id))})]}):g.jsxs("div",{className:"space-y-3",children:[g.jsx("div",{className:"text-sm text-neutral-500 font-medium",children:"Free Tickets Available:"}),g.jsxs("div",{className:"p-3 rounded-lg border border-green-200 bg-green-50",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("span",{className:"font-medium text-green-900",children:"Free Ticket"}),g.jsx("span",{className:"font-semibold text-green-600",children:"Free"})]}),g.jsxs("div",{className:"text-xs text-green-700 mt-1",children:[t!==void 0?t:(()=>{if(e.tiers&&e.tiers.length>0){const D=e.tiers.find(R=>R.price===0)||e.tiers[0];return D.remaining||D.quota||e.capacity}return e.capacity||0})()," available"]})]})]}),_&&g.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[g.jsxs("div",{children:[g.jsx("div",{className:"font-medium text-blue-900",children:_.name}),g.jsxs("div",{className:"text-sm text-blue-700",children:[dc(_.price)," per ticket"]})]}),g.jsxs("div",{className:"text-right",children:[g.jsx("div",{className:"text-sm text-neutral-700",children:"Quantity"}),g.jsx("input",{type:"number",className:"input w-20 text-center",min:1,max:Math.min(10,_.remaining||_.quota),value:i,onChange:D=>l(Number(D.target.value||1))})]})]}),g.jsx(cC,{event:e,defaultQty:i,chosenTierId:_==null?void 0:_.id,priceOverride:_==null?void 0:_.price})]})]})]})]})})}delete Tu.Icon.Default.prototype._getIconUrl;Tu.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});async function dC(e){try{const{data:t,error:n}=await Re.rpc("get_venue_coordinates",{venue_id:e});if(n)return console.error("RPC get_venue_coordinates error:",n),{lat:null,lng:null};const i=t==null?void 0:t[0],l=typeof(i==null?void 0:i.latitude)=="number"?i.latitude:null,c=typeof(i==null?void 0:i.longitude)=="number"?i.longitude:null;return{lat:l,lng:c}}catch(t){return console.error("RPC get_venue_coordinates threw:",t),{lat:null,lng:null}}}const Rx="suki_saved_events";function hC(){try{return JSON.parse(localStorage.getItem(Rx)||"[]")}catch{return[]}}function fC(){var ie,Ee,ce,ue,Ie,Te;const{id:e}=nw(),t=zi(),{user:n}=ur(),[i,l]=H.useState(!1),[c,m]=H.useState(null),[_,v]=H.useState(!0),[y,S]=H.useState(0),[E,T]=H.useState(!1),[U,j]=H.useState(()=>hC()),P=H.useMemo(()=>c&&U.includes(c.id),[U,c]),D=()=>{if(!c)return;const Q=P?U.filter(pe=>pe!==c.id):[c.id,...U];j(Q),localStorage.setItem(Rx,JSON.stringify(Q))},R=async()=>{v(!0);try{const{data:Q,error:pe}=await Re.from("events").select(`
          *,
          venue:venues(
            id,
            name,
            address,
            location
          )
        `).eq("id",e).eq("status","published").single();if(pe){console.error("Error loading event:",pe),m(null);return}let ne=Q.venue||{name:"TBD"};if(ne!=null&&ne.id){const{lat:me,lng:le}=await dC(ne.id);ne={...ne,latitude:me,longitude:le},console.log("Fetched venue coordinates:",{lat:me,lng:le})}const K={...Q,venue:ne};if(K){console.log("Calling tier_inventory RPC for event:",e);const{data:me,error:le}=await Re.rpc("tier_inventory",{p_event:e});le?console.error("tier_inventory RPC error:",le):console.log("tier_inventory RPC result:",me);const be=me||[];console.log("Venue data from database:",K.venue);const we={id:K.id,title:K.title,description:K.description,category:K.category,start_at:K.start_at,end_at:K.end_at,venue:ne,capacity:K.capacity||0,min_price:K.min_price||0,max_price:K.max_price||0,cover_url:K.cover_url||"",status:K.status,creator_id:K.creator_id,organizer:{name:"Organizer"},tiers:be};if(console.log("Transformed event venue:",we.venue),m(we),be.length>0){const Qe=be.reduce((Fe,Ve)=>Fe+(Number(Ve.remaining)||0),0);S(Qe)}else S(K.capacity||0)}else m(null)}catch(Q){console.error("Error loading event:",Q),m(null)}finally{v(!1)}};if(H.useEffect(()=>{e&&R()},[e]),H.useEffect(()=>{const Q=()=>{console.log("Account switch detected in EventPage, reloading event..."),e&&R()};return window.addEventListener("suki:account_switched",Q),()=>{window.removeEventListener("suki:account_switched",Q)}},[e]),H.useEffect(()=>{const Q=()=>{e&&R()};return window.addEventListener("suki:events_updated",Q),()=>{window.removeEventListener("suki:events_updated",Q)}},[e]),H.useEffect(()=>{if(!e)return;const Q=Re.channel(`event-tickets-${e}`).on("postgres_changes",{event:"*",schema:"public",table:"tickets",filter:`event_id=eq.${e}`},pe=>{R()}).subscribe();return()=>{Q.unsubscribe()}},[e]),H.useEffect(()=>{const Q=()=>{!document.hidden&&e&&R()};return document.addEventListener("visibilitychange",Q),()=>{document.removeEventListener("visibilitychange",Q)}},[e]),_)return g.jsxs("div",{className:"min-h-screen bg-gray-50",children:[g.jsx(It,{}),g.jsx("div",{className:"container mx-auto px-4 py-8",children:g.jsx("div",{className:"flex justify-center items-center h-64",children:g.jsx("div",{className:"loading loading-spinner loading-lg"})})})]});if(!c)return g.jsxs("div",{className:"min-h-screen bg-gray-50",children:[g.jsx(It,{}),g.jsx("div",{className:"container mx-auto px-4 py-8",children:g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"text-6xl mb-4",children:"❌"}),g.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Event Not Found"}),g.jsx("p",{className:"text-gray-600 mb-6",children:"The event you're looking for doesn't exist or has been removed."}),g.jsx("button",{className:"btn btn-primary",onClick:()=>t(-1),children:"Go Back"})]})})]});const I=Q=>{if(!Q||typeof Q!="string")return new Date(NaN);const[pe,ne="00:00:00"]=Q.split("T"),[K,me,le]=pe.split("-").map(Fe=>parseInt(Fe,10)),[be,we,Qe]=ne.split(":").map(Fe=>parseInt(Fe,10)||0);return new Date(K,(me||1)-1,le||1,be||0,we||0,Qe||0)},k=I(c.start_at),z=I(c.end_at||c.start_at),G=k.toLocaleString([],{weekday:"long",day:"2-digit",month:"long",hour:"2-digit",minute:"2-digit"}),Y=Math.max(1,Math.round((z-k)/(1e3*60*60))),Z=(((ie=c.venue)==null?void 0:ie.name)||"").toLowerCase().includes("online"),J=async()=>{const Q=`${window.location.origin}/events/${c.id}`;try{navigator.share?await navigator.share({title:c.title,text:"Check out this event on Suki",url:Q}):(await navigator.clipboard.writeText(Q),alert("Link copied to clipboard"))}catch{}};return g.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-white",children:[g.jsx(It,{}),g.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[g.jsxs("div",{className:"mb-8",children:[g.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-4",children:[g.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium",children:c.category}),g.jsx("span",{children:"•"}),g.jsx("span",{children:c.status})]}),g.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-gray-900 mb-4 leading-tight",children:c.title}),g.jsxs("p",{className:"text-lg text-gray-600 mb-6",children:["Hosted by ",((Ee=c.organizer)==null?void 0:Ee.name)||"Organizer"]}),g.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-6",children:[g.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[g.jsx(Jc,{className:"w-5 h-5"}),g.jsx("span",{children:G})]}),g.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[g.jsx(V1,{className:"w-5 h-5"}),g.jsxs("span",{children:[Y," hour",Y!==1?"s":""]})]}),g.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[g.jsx(Mh,{className:"w-5 h-5"}),g.jsxs("span",{children:[y," tickets remaining"]})]})]}),g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsx("button",{className:"px-6 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors",onClick:()=>l(!0),children:"Buy Ticket"}),g.jsxs("button",{className:`px-6 py-3 border rounded-lg font-medium transition-colors flex items-center gap-2 ${P?"border-red-300 text-red-600 bg-red-50 hover:bg-red-100":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,onClick:D,children:[g.jsx(Ff,{className:`w-4 h-4 ${P?"fill-current":""}`}),P?"Saved":"Save Event"]}),g.jsxs("button",{className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors flex items-center gap-2",onClick:J,children:[g.jsx(fx,{className:"w-4 h-4"}),"Share Event"]})]})]}),g.jsx("div",{className:"mb-8",children:g.jsx("div",{className:"aspect-[16/9] bg-gray-100 rounded-2xl overflow-hidden",children:c.cover_url?g.jsx("img",{src:c.cover_url,alt:c.title,className:"w-full h-full object-cover"}):g.jsx("div",{className:"w-full h-full grid place-items-center text-gray-400",children:g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:g.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),g.jsx("div",{className:"text-lg",children:"No image available"})]})})})}),g.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[g.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[g.jsxs("section",{children:[g.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"About this event"}),g.jsx("div",{className:"prose prose-gray max-w-none",children:g.jsx("p",{className:"text-gray-700 leading-relaxed text-lg",children:c.description||"No description provided for this event."})})]}),g.jsxs("section",{children:[g.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Event Details"}),g.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 space-y-4",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx(Jc,{className:"w-5 h-5 text-blue-600"}),g.jsxs("div",{children:[g.jsx("div",{className:"font-medium text-gray-900",children:"Date & Time"}),g.jsx("div",{className:"text-gray-600",children:G})]})]}),g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx(V1,{className:"w-5 h-5 text-blue-600"}),g.jsxs("div",{children:[g.jsx("div",{className:"font-medium text-gray-900",children:"Duration"}),g.jsxs("div",{className:"text-gray-600",children:[Y," hour",Y!==1?"s":""]})]})]}),g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx(Mh,{className:"w-5 h-5 text-blue-600"}),g.jsxs("div",{children:[g.jsx("div",{className:"font-medium text-gray-900",children:"Capacity"}),g.jsx("div",{className:"text-gray-600",children:c.capacity||"Unlimited"})]})]})]})]}),g.jsxs("section",{children:[g.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Location"}),g.jsx("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:g.jsxs("div",{className:"p-6",children:[g.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[g.jsx(na,{className:"w-6 h-6 text-blue-600 mt-1"}),g.jsxs("div",{className:"flex-1",children:[g.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-1",children:((ce=c.venue)==null?void 0:ce.name)||(Z?"Online Event":"TBA")}),((ue=c.venue)==null?void 0:ue.address)&&g.jsx("p",{className:"text-gray-600 mb-3",children:c.venue.address}),!Z&&((Ie=c.venue)==null?void 0:Ie.name)&&g.jsxs("button",{className:"text-blue-600 hover:text-blue-700 font-medium flex items-center gap-2 transition-colors",onClick:()=>T(!E),children:[E?"Hide directions":"Get directions",E?g.jsx(Qb,{className:"w-4 h-4"}):g.jsx(Bf,{className:"w-4 h-4"})]})]})]}),E&&!Z&&((Te=c.venue)==null?void 0:Te.name)&&g.jsx("div",{className:"mt-4",children:g.jsx("div",{className:"aspect-video bg-gray-100 rounded-lg overflow-hidden",children:(()=>{var Q,pe,ne,K;return console.log("Map check - venue:",c.venue),console.log("Map check - latitude:",(Q=c.venue)==null?void 0:Q.latitude),console.log("Map check - longitude:",(pe=c.venue)==null?void 0:pe.longitude),((ne=c.venue)==null?void 0:ne.latitude)&&((K=c.venue)==null?void 0:K.longitude)})()?g.jsxs(kx,{center:[c.venue.latitude,c.venue.longitude],zoom:15,style:{height:"100%",width:"100%"},className:"rounded-lg",children:[g.jsx(Lx,{url:"https://api.maptiler.com/maps/streets-v2/256/{z}/{x}/{y}.png?key=9e3tpg0oNZKgdnlQMV7x",attribution:'© <a href="https://www.openstreetmap.org/copyright">OSM</a> | © <a href="https://www.maptiler.com/">MapTiler</a>'}),g.jsx(Mx,{position:[c.venue.latitude,c.venue.longitude],children:g.jsx(Ox,{children:g.jsxs("div",{className:"p-2",children:[g.jsx("h3",{className:"font-semibold text-gray-900",children:c.venue.name}),c.venue.address&&g.jsx("p",{className:"text-sm text-gray-600 mt-1",children:c.venue.address})]})})})]}):g.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-500",children:g.jsxs("div",{className:"text-center",children:[g.jsx(na,{className:"w-12 h-12 mx-auto mb-2 text-gray-400"}),g.jsx("p",{children:"Map coordinates not available"})]})})})})]})})]})]}),g.jsxs("div",{className:"space-y-6",children:[g.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[g.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Pricing"}),g.jsx("div",{className:"text-center",children:c.min_price===0&&c.max_price===0?g.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:"FREE"}):c.min_price===c.max_price?g.jsxs("div",{className:"text-3xl font-bold text-gray-900 mb-2",children:[(c.min_price/1e3).toFixed(0),"k VND"]}):g.jsxs("div",{className:"text-3xl font-bold text-gray-900 mb-2",children:[(c.min_price/1e3).toFixed(0),"k - ",(c.max_price/1e3).toFixed(0),"k VND"]})})]}),g.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[g.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Quick Info"}),g.jsxs("div",{className:"space-y-3",children:[g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{className:"text-gray-600",children:"Category"}),g.jsx("span",{className:"font-medium text-gray-900",children:c.category})]}),g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{className:"text-gray-600",children:"Status"}),g.jsx("span",{className:"font-medium text-gray-900 capitalize",children:c.status})]}),g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{className:"text-gray-600",children:"Available"}),g.jsxs("span",{className:"font-medium text-gray-900",children:[y," tickets"]})]})]})]})]})]})]}),i&&c&&g.jsx(uC,{event:c,remaining:y,onClose:()=>l(!1)})]})}function gC({query:e,setQuery:t}){return g.jsx("div",{className:"flex items-center gap-2 w-full md:max-w-md",children:g.jsx("div",{className:"flex-1",children:g.jsx("input",{type:"text",className:"input w-full",placeholder:"Search events, artists, venues…",value:e,onChange:n=>t(n.target.value)})})})}function mC(){const{user:e}=ur(),[t,n]=H.useState([]),[i,l]=H.useState(!0),[c,m]=H.useState(""),[_,v]=H.useState("all"),[y,S]=H.useState("all"),[E,T]=H.useState("");H.useEffect(()=>{const j=async()=>{l(!0);try{const{data:D,error:R}=await Re.from("events").select(`
            *,
            venue:venues(*),
            ticket_tiers(
              id,
              name,
              price,
              quota
            )
          `).eq("status","published").order("start_at",{ascending:!0});if(R)console.error("Error loading events:",R),n([]);else{const I=(D||[]).map(k=>({id:k.id,title:k.title,description:k.description,category:k.category,start_at:k.start_at,end_at:k.end_at,venue:k.venue||{name:"TBD"},capacity:k.capacity||0,min_price:k.min_price||0,max_price:k.max_price||0,cover_url:k.cover_url||"",status:k.status,creator_id:k.creator_id,tiers:k.ticket_tiers||[]}));n(I)}}catch(D){console.error("Error loading events:",D),n([])}finally{l(!1)}};j();const P=()=>{console.log("Events update event received, reloading events..."),j()};return window.addEventListener("suki:events_updated",P),()=>{window.removeEventListener("suki:events_updated",P)}},[]),H.useEffect(()=>{var j;(j=e==null?void 0:e.user_metadata)!=null&&j.city&&T(e.user_metadata.city)},[e]);const U=H.useMemo(()=>t.filter(j=>{var I,k,z,G,Y;const P=j.title.toLowerCase().includes(c.toLowerCase())||j.description.toLowerCase().includes(c.toLowerCase()),D=_==="all"||j.category===_,R=y==="all"||y==="nearby"&&E&&((k=(I=j.venue)==null?void 0:I.name)==null?void 0:k.toLowerCase().includes(E.toLowerCase()))||y==="online"&&((z=j.venue)==null?void 0:z.name)==="Online"||y==="venue"&&((G=j.venue)==null?void 0:G.name)!=="Online"&&((Y=j.venue)==null?void 0:Y.name)!=="To be announced";return P&&D&&R}),[t,c,_,y,E]);return e?i?g.jsxs("div",{className:"min-h-screen bg-gray-50",children:[g.jsx(It,{}),g.jsx("div",{className:"container mx-auto px-4 py-8",children:g.jsx("div",{className:"flex justify-center items-center h-64",children:g.jsx("div",{className:"loading loading-spinner loading-lg"})})})]}):g.jsxs("div",{className:"min-h-screen bg-gray-50",children:[g.jsx(It,{}),g.jsxs("div",{className:"container mx-auto px-4 py-8",children:[g.jsxs("div",{className:"mb-8",children:[g.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Browse Events"}),g.jsx("p",{className:"text-lg text-gray-600",children:"Discover and explore events from around the world"})]}),g.jsx(gC,{value:c,onChange:m}),g.jsx(mx,{selectedCategory:_,onCategoryChange:v,selectedLocation:y,onLocationChange:S}),g.jsxs("div",{className:"mt-8",children:[g.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:[U.length," Event",U.length!==1?"s":""," Found"]}),g.jsx(px,{events:U})]})]})]}):g.jsxs("div",{className:"min-h-screen bg-gray-50",children:[g.jsx(It,{}),g.jsx("div",{className:"container mx-auto px-4 py-8",children:g.jsxs("div",{className:"text-center",children:[g.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Please Sign In"}),g.jsx("p",{className:"text-gray-600",children:"You need to be signed in to browse events."})]})})]})}function pC(){const{user:e}=ur(),t=zi(),[n,i]=H.useState({city:"HCMC",lat:10.7769,lng:106.7009}),[l,c]=H.useState([]),[m,_]=H.useState(!1),[v,y]=H.useState(null),[S,E]=H.useState({}),[T,U]=H.useState("list"),[j,P]=H.useState(null),[D,R]=H.useState({top:0,left:0}),I=()=>{try{const ne=JSON.parse(localStorage.getItem("suki_tickets")||"[]"),K={};return ne.forEach(me=>{me.event_id&&(K[me.event_id]=(K[me.event_id]||0)+(Number(me.qty)||1))}),E(K),K}catch(ne){return console.warn("Could not load ticket sales:",ne),{}}};H.useEffect(()=>{e!=null&&e.city&&i((K=>{switch((K||"").toLowerCase()){case"hcmc":case"ho chi minh city":case"saigon":return{city:"HCMC",lat:10.7769,lng:106.7009};case"hanoi":return{city:"Hanoi",lat:21.0278,lng:105.8342};case"danang":case"da nang":return{city:"Danang",lat:16.0544,lng:108.2208};default:return{city:"HCMC",lat:10.7769,lng:106.7009}}})(e.city)),k(),I()},[e]),H.useEffect(()=>{const ne=()=>{e&&k()};return window.addEventListener("focus",ne),()=>window.removeEventListener("focus",ne)},[e]),H.useEffect(()=>{if(!e)return;const ne=Re.channel(`user-events-${e.id}`).on("postgres_changes",{event:"*",schema:"public",table:"tickets"},K=>{k()}).subscribe();return()=>{ne.unsubscribe()}},[e]),H.useEffect(()=>{const ne=()=>{!document.hidden&&e&&k()};return document.addEventListener("visibilitychange",ne),()=>{document.removeEventListener("visibilitychange",ne)}},[e]),H.useEffect(()=>{const ne=()=>{console.log("Events update event received in ManageEvents, reloading..."),e&&k()},K=()=>{console.log("Account switch detected in ManageEvents, reloading..."),e&&k()};return window.addEventListener("suki:events_updated",ne),window.addEventListener("suki:account_switched",K),()=>{window.removeEventListener("suki:events_updated",ne),window.removeEventListener("suki:account_switched",K)}},[e]);const k=H.useCallback(async()=>{if(e){_(!0);try{const{data:ne,error:K}=await Re.from("events").select(`
          *,
          venue:venues(*),
          ticket_tiers(
            id,
            name,
            price,
            quota
          )
        `).eq("creator_id",e.id).order("start_at",{ascending:!1});if(K)console.error("Error loading Supabase events:",K),c([]);else{if(ne&&!K)for(const me of ne){const{data:le,error:be}=await Re.rpc("tier_inventory",{p_event:me.id});!be&&le&&(me.ticket_tiers=le.map(we=>({id:we.id,name:we.name,price:we.price,quota:we.quota,sold:Number(we.sold)||0,remaining:we.remaining})))}c(ne||[])}}catch(ne){console.error("Error loading events:",ne),c([])}finally{_(!1)}}},[e]);H.useEffect(()=>{const ne=()=>{e&&k()};return window.addEventListener("focus",ne),()=>window.removeEventListener("focus",ne)},[e,k]);const z=ne=>{t("/edit-event",{state:{event:ne}})},G=ne=>{t("/copy-event",{state:{event:ne}})},Y=ne=>{t(`/events/${ne}`)},Z=async ne=>{if(window.confirm("Delete this event? This cannot be undone."))try{const{error:K}=await Re.from("events").delete().eq("id",ne).eq("creator_id",e.id);K?(console.error("Error deleting event:",K),alert("Could not delete: "+K.message)):(c(me=>me.filter(le=>le.id!==ne)),P(null))}catch(K){console.error("Delete error:",K),alert("Could not delete: "+K.message)}},J=ne=>{const K=`${window.location.origin}/events/${ne}`;navigator.clipboard.writeText(K),alert("Event link copied to clipboard!"),P(null)},ie=ne=>{G(ne),P(null)},Ee=ne=>{const K=new Date,me=new Date(ne.start_at);return ne.status==="cancelled"?"Cancelled":me<K?"Past":ne.status==="published"?"On Sale":"Draft"},ce=ne=>{switch(ne){case"On Sale":return"text-green-600 bg-green-100";case"Past":return"text-gray-600 bg-gray-100";case"Cancelled":return"text-red-600 bg-red-100";default:return"text-yellow-600 bg-yellow-100"}},ue=ne=>((ne.ticket_tiers||[]).reduce((me,le)=>me+(Number(le.sold)||0),0),(ne.ticket_tiers||[]).reduce((me,le)=>me+Number(le.sold||0)*Number(le.price||0),0)),Ie=ne=>{if(!ne||typeof ne!="string")return new Date(NaN);const[K,me="00:00:00"]=ne.split("T"),[le,be,we]=K.split("-").map(fe=>parseInt(fe,10)),[Qe,Fe,Ve]=me.split(":").map(fe=>parseInt(fe,10)||0);return new Date(le,(be||1)-1,we||1,Qe||0,Fe||0,Ve||0)},Te=ne=>Ie(ne).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),Q=(ne,K)=>{if(j===ne)P(null);else{const me=K.getBoundingClientRect();R({top:me.top-200,left:me.right-200}),P(ne)}},pe=()=>{P(null)};return H.useEffect(()=>{const ne=K=>{K.target.closest(".actions-menu")||pe()};return document.addEventListener("mousedown",ne),()=>document.removeEventListener("mousedown",ne)},[]),g.jsxs("div",{className:"min-h-screen bg-gray-50",children:[g.jsx(It,{}),g.jsxs("div",{className:"container mx-auto px-4 py-8",children:[g.jsxs("div",{className:"mb-8",children:[g.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Manage My Events"}),g.jsx("p",{className:"text-lg text-gray-600",children:"Monitor and manage your events, track sales, and make updates"})]}),g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsxs("div",{className:"flex bg-white rounded-lg p-1 shadow-sm",children:[g.jsxs("button",{onClick:()=>U("list"),className:`px-4 py-2 rounded-md flex items-center gap-2 transition-colors ${T==="list"?"bg-blue-500 text-white":"text-gray-600 hover:text-gray-900"}`,children:[g.jsx(a3,{className:"w-4 h-4"}),"List"]}),g.jsxs("button",{onClick:()=>U("calendar"),className:`px-4 py-2 rounded-md flex items-center gap-2 transition-colors ${T==="calendar"?"bg-blue-500 text-white":"text-gray-600 hover:text-gray-900"}`,children:[g.jsx(Qc,{className:"w-4 h-4"}),"Calendar"]})]}),g.jsx("a",{href:"/create",className:"btn btn-primary",children:"Create New Event"})]}),m?g.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[g.jsx("div",{className:"loading loading-spinner loading-lg"}),g.jsx("p",{className:"mt-4 text-gray-600",children:"Loading your events..."})]}):l.length===0?g.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[g.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:g.jsx(Jc,{className:"w-8 h-8 text-gray-400"})}),g.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No events yet"}),g.jsx("p",{className:"text-gray-600 mb-4",children:"You haven't created any events yet. Start by creating your first event!"}),g.jsx("a",{href:"/create",className:"btn btn-primary",children:"Create Your First Event"})]}):T==="list"?g.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:g.jsx("div",{className:"overflow-x-auto",children:g.jsxs("table",{className:"w-full",children:[g.jsx("thead",{className:"bg-gray-50",children:g.jsxs("tr",{children:[g.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Event"}),g.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tiers"}),g.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sold"}),g.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gross"}),g.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),g.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map(ne=>{var le;const K=Ee(ne),me=ue(ne);return g.jsxs("tr",{className:"hover:bg-gray-50",children:[g.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"w-16 h-16 rounded-lg overflow-hidden bg-gray-100 flex-shrink-0",children:ne.cover_url?g.jsx("img",{src:ne.cover_url,alt:ne.title,className:"w-full h-full object-cover"}):g.jsx("div",{className:"w-full h-full flex items-center justify-center",children:g.jsx(Jc,{className:"w-8 h-8 text-gray-400"})})}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium text-gray-900",children:ne.title}),g.jsxs("div",{className:"text-sm text-gray-500",children:[Te(ne.start_at)," • ",((le=ne.venue)==null?void 0:le.name)||"TBD"]})]})]})}),g.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ne.ticket_tiers&&ne.ticket_tiers.length>0?g.jsx("div",{className:"space-y-1",children:ne.ticket_tiers.map(be=>g.jsxs("div",{className:"text-xs",children:[g.jsxs("span",{className:"font-medium",children:[be.name,":"]})," ",be.price===0?"Free":`${be.price.toLocaleString()} VND`," (",be.sold||0,"/",be.quota," sold)"]},be.id))}):g.jsx("span",{className:"text-gray-400",children:"No tiers"})}),g.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[(ne.ticket_tiers||[]).reduce((be,we)=>be+(Number(we.sold)||0),0),"/",ne.capacity||"∞"," tickets"]}),g.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[me||0," VND"]}),g.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:g.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${ce(K)}`,children:K})}),g.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:g.jsxs("div",{className:"relative actions-menu",children:[g.jsx("button",{onClick:be=>Q(ne.id,be.currentTarget),className:"text-gray-400 hover:text-gray-600 p-1 rounded-full hover:bg-gray-100",children:g.jsx(r3,{className:"w-5 h-5"})}),j===ne.id&&g.jsxs("div",{className:"fixed w-48 bg-white rounded-md shadow-lg py-1 z-50 border",style:{top:`${D.top}px`,left:`${D.left}px`},children:[g.jsxs("button",{onClick:()=>Y(ne.id),className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left",children:[g.jsx(s3,{className:"w-4 h-4 mr-2"}),"View"]}),g.jsxs("button",{onClick:()=>z(ne),className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left",children:[g.jsx(u3,{className:"w-4 h-4 mr-2"}),"Edit"]}),g.jsxs("button",{onClick:()=>J(ne.id),className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left",children:[g.jsx(o3,{className:"w-4 h-4 mr-2"}),"Copy Link"]}),g.jsxs("a",{href:`/scan?event=${ne.id}`,className:"flex items-center px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 w-full text-left",children:[g.jsxs("svg",{className:"w-4 h-4 mr-2",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M4 7V5a1 1 0 0 1 1-1h2"}),g.jsx("path",{d:"M4 17v2a1 1 0 0 0 1 1h2"}),g.jsx("path",{d:"M20 7V5a1 1 0 0 0-1-1h-2"}),g.jsx("path",{d:"M20 17v2a1 1 0 0 1-1 1h-2"}),g.jsx("path",{d:"M7 12h10"})]}),"Scan Tickets"]}),g.jsxs("button",{onClick:()=>ie(ne),className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left",children:[g.jsx(t3,{className:"w-4 h-4 mr-2"}),"Copy Event"]}),g.jsxs("button",{onClick:()=>Z(ne.id),className:"flex items-center px-4 py-2 text-sm text-red-600 hover:bg-red-50 w-full text-left",children:[g.jsx(gx,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})})]},ne.id)})})]})})}):g.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[g.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:g.jsx(Qc,{className:"w-8 h-8 text-gray-400"})}),g.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Calendar View"}),g.jsx("p",{className:"text-gray-600",children:"Calendar view coming soon! Use list view for now."})]})]})]})}function xC({eventId:e,onDone:t}){const[n,i]=H.useState(null),[l,c]=H.useState(!1),[m,_]=H.useState(""),[v,y]=H.useState(!1);async function S(){var j;if(_(""),!!n){if(!n.type.startsWith("image/")){_("Please choose an image.");return}if(n.size>5*1024*1024){_("Max file size is 5 MB.");return}c(!0);try{const{data:{user:P}}=await Re.auth.getUser();if(!P){_("Not signed in"),c(!1);return}console.log("[EventCover] Authenticated user:",P.id),console.log("[EventCover] Event ID:",e);const D=(((j=n.name)==null?void 0:j.split(".").pop())||"jpg").toLowerCase(),R=`${e}/cover-${Date.now()}.${D}`;console.log("[EventCover] uploading to path:",R);const{error:I}=await Re.storage.from("event-covers").upload(R,n,{upsert:!0,contentType:n.type,cacheControl:"3600"});if(I){console.error("[EventCover] Storage upload error:",I),_(I.message),c(!1);return}console.log("[EventCover] Storage upload successful");const{data:k}=Re.storage.from("event-covers").getPublicUrl(R),z=k.publicUrl;console.log("[EventCover] Generated public URL:",z);const{error:G}=await Re.from("events").update({cover_url:z}).eq("id",e).eq("creator_id",P.id);if(G){console.error("[EventCover] Events update error:",G),_(G.message),c(!1);return}console.log("[EventCover] Event update successful"),t==null||t(z)}catch(P){console.error("[EventCover] Unexpected error:",P),_(P.message)}finally{c(!1)}}}const E=j=>{j.preventDefault(),j.stopPropagation(),j.type==="dragenter"||j.type==="dragover"?y(!0):j.type==="dragleave"&&y(!1)},T=j=>{if(j.preventDefault(),j.stopPropagation(),y(!1),j.dataTransfer.files&&j.dataTransfer.files[0]){const P=j.dataTransfer.files[0];P.type.startsWith("image/")?(i(P),_("")):_("Please drop an image file")}},U=j=>{j.target.files&&j.target.files[0]&&(i(j.target.files[0]),_(""))};return g.jsxs("div",{className:"space-y-3",children:[g.jsxs("div",{className:`relative border-2 border-dashed rounded-xl p-6 text-center transition-all duration-200 ${v?"border-blue-400 bg-blue-50":n?"border-green-300 bg-green-50":"border-gray-300 hover:border-blue-400 hover:bg-blue-50"}`,onDragEnter:E,onDragLeave:E,onDragOver:E,onDrop:T,children:[g.jsx("input",{type:"file",accept:"image/*",onChange:U,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),n?g.jsxs("div",{className:"space-y-3",children:[g.jsx("div",{className:"w-20 h-20 mx-auto rounded-lg overflow-hidden border-2 border-white shadow-lg",children:g.jsx("img",{src:URL.createObjectURL(n),alt:"Preview",className:"w-full h-full object-cover"})}),g.jsxs("div",{children:[g.jsx("p",{className:"text-sm font-medium text-green-700",children:n.name}),g.jsx("p",{className:"text-xs text-green-600",children:"Ready to upload"})]})]}):g.jsxs("div",{className:"space-y-3",children:[g.jsx("div",{className:"w-12 h-12 mx-auto bg-gray-100 rounded-full flex items-center justify-center",children:g.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),g.jsxs("div",{children:[g.jsx("p",{className:"text-sm font-medium text-gray-700",children:v?"Drop your cover image here":"Drag & drop your cover image here"}),g.jsx("p",{className:"text-xs text-gray-500",children:"or click to browse"})]})]})]}),n&&g.jsx("button",{className:"w-full px-4 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors font-medium",onClick:S,disabled:l,children:l?"Uploading…":"Upload Cover Image"}),m&&g.jsx("div",{className:"text-sm text-red-500 text-center bg-red-50 p-2 rounded-lg",children:m}),n&&g.jsx("div",{className:"text-xs text-gray-500 text-center",children:"Max file size: 5MB • Supported: JPG, PNG, GIF • Tip: Use ~1600×900 for best results"})]})}function yC(){var Nn;const{user:e}=ur(),t=Ms(),n=zi(),i=(Nn=t.state)==null?void 0:Nn.event,[l,c]=H.useState(""),[m,_]=H.useState(""),[v,y]=H.useState(""),[S,E]=H.useState(""),[T,U]=H.useState(""),[j,P]=H.useState(""),[D,R]=H.useState({mode:"venue",name:"",coordinates:null,address:null}),[I,k]=H.useState(""),[z,G]=H.useState(""),[Y,Z]=H.useState(""),[J,ie]=H.useState(""),[Ee,ce]=H.useState(null),[ue,Ie]=H.useState(""),[Te,Q]=H.useState([]),[pe,ne]=H.useState(!0),[K,me]=H.useState(!1),[le,be]=H.useState(!1),[we,Qe]=H.useState(!1),Fe=H.useCallback(Ue=>{Ue===null?ne(!1):(Q(Ue),ne(!0))},[]);if(H.useEffect(()=>{if(!K&&Te.length>0){const Ue=Te.reduce((tt,gt)=>tt+(parseInt(gt.quota,10)||0),0);k(Ue.toString())}},[Te,K]),H.useEffect(()=>{if(!i){n("/manage-events");return}(async()=>{var tt,gt,Le;try{const{data:yt,error:Ot}=await Re.from("events").select(`
            *,
            venue:venues(*),
            ticket_tiers(
              id,
              name,
              price,
              quota
            )
          `).eq("id",i.id).single();if(Ot){console.error("Error loading event with tiers:",Ot);return}const Ze=yt;c(Ze.title||""),_(Ze.description||""),y(Ze.category||"");const nt=Ze.start_at;if(nt){const[qe,Ge]=nt.split("T");E(qe),U((Ge||"").slice(0,5))}if(Ze.end_at){const qe=Ze.end_at,[,Ge]=qe.split("T");P((Ge||"").slice(0,5))}Ze.venue&&Ze.venue.name&&Ze.venue.name!=="TBD"?R({mode:"venue",name:Ze.venue.name,coordinates:Ze.venue.latitude&&Ze.venue.longitude?[Ze.venue.latitude,Ze.venue.longitude]:null,address:Ze.venue.address||null}):R({mode:"online",name:"Online",coordinates:null,address:null}),k(((tt=Ze.capacity)==null?void 0:tt.toString())||""),G(((gt=Ze.min_price)==null?void 0:gt.toString())||""),Z(((Le=Ze.max_price)==null?void 0:Le.toString())||""),ie(Ze.cover_url||""),Ie(Ze.cover_url||""),Ze.ticket_tiers&&Ze.ticket_tiers.length>0&&Q(Ze.ticket_tiers),Ze.min_price===0&&Ze.max_price===0&&me(!0)}catch(yt){console.error("Error in loadEventWithTiers:",yt)}})()},[i,n]),H.useEffect(()=>{i!=null&&i.id&&Ve().then(Qe)},[i==null?void 0:i.id]),!e)return g.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-white",children:[g.jsx(It,{}),g.jsx("div",{className:"container mx-auto px-6 py-12",children:g.jsxs("div",{className:"text-center py-16",children:[g.jsx("div",{className:"text-6xl mb-4",children:"🔒"}),g.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:"Please Sign In"}),g.jsx("p",{className:"text-gray-600 mb-6",children:"You need to be signed in to edit events."}),g.jsx("a",{href:"/auth",className:"btn btn-primary",children:"Sign In"})]})})]});if(!i)return g.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-white",children:[g.jsx(It,{}),g.jsx("div",{className:"container mx-auto px-6 py-12",children:g.jsxs("div",{className:"text-center py-16",children:[g.jsx("div",{className:"text-6xl mb-4",children:"❌"}),g.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:"Event Not Found"}),g.jsx("p",{className:"text-gray-600 mb-6",children:"The event you're trying to edit doesn't exist."}),g.jsx("a",{href:"/manage-events",className:"btn btn-primary",children:"Back to Events"})]})})]});const Ve=async()=>{try{const{data:Ue,error:tt}=await Re.from("ticket_tiers").select("id, name, price").eq("event_id",i.id).gt("price",0);if(tt)return console.error("Error checking paid tiers:",tt),!1;if(!Ue||Ue.length===0)return!1;for(const gt of Ue){const{data:Le,error:yt}=await Re.from("tickets").select("id").eq("tier_id",gt.id).limit(1);if(yt){console.error("Error checking sold tickets for tier:",gt.name,yt);continue}if(Le&&Le.length>0)return!0}return!1}catch(Ue){return console.error("Error in checkForSoldPaidTickets:",Ue),!1}},fe=async Ue=>{const{error:tt}=await Re.from("ticket_tiers").delete().eq("event_id",i.id).gt("price",0);if(tt)throw tt;const{data:gt,error:Le}=await Re.from("ticket_tiers").select("id").eq("event_id",i.id).eq("price",0).limit(1);if(Le)throw Le;if(gt&&gt.length>0){const{error:yt}=await Re.from("ticket_tiers").update({quota:Ue}).eq("id",gt[0].id);if(yt)throw yt}else{const{error:yt}=await Re.from("ticket_tiers").insert({event_id:i.id,name:"General Admission (Free)",price:0,quota:Ue});if(yt)throw yt}},je=async()=>{if(Te.length>0){const{error:Ue}=await Re.from("ticket_tiers").delete().eq("event_id",i.id);if(Ue)throw console.error("Error deleting existing ticket tiers:",Ue),Ue;const tt=Te.map(Le=>({event_id:i.id,name:Le.name,price:parseFloat(Le.price)||0,quota:parseInt(Le.quota)||0})),{error:gt}=await Re.from("ticket_tiers").insert(tt);if(gt)throw console.error("Error inserting new paid tiers:",gt),gt}},Je=async Ue=>{var tt,gt,Le,yt;Ue.preventDefault(),be(!0);try{const Ot=S&&T?`${S}T${T}:00`:null,Ze=j?`${S}T${j}:00`:Ot;let nt=null;if(D.mode==="venue"&&D.name)if(D.coordinates){const{data:rt,error:Tn}=await Re.rpc("upsert_custom_venue",{p_name:D.name.trim(),p_address:D.address||null,p_lat:D.coordinates[0],p_lng:D.coordinates[1]});if(Tn){console.error("Error creating/updating venue:",Tn),alert("Could not create/update venue: "+Tn.message),be(!1);return}nt=rt,console.log("Venue created/updated successfully with coordinates:",rt)}else{const{data:rt,error:Tn}=await Re.from("venues").select("id, name").eq("name",D.name);if(!Tn&&rt&&rt.length>0)nt=rt[0].id;else{const{data:In,error:en}=await Re.from("venues").insert([{name:D.name,address:D.address||null}]).select("id, name");!en&&In&&In.length>0?nt=In[0].id:nt=(tt=i.venue)==null?void 0:tt.id}}let qe=Te.length>0?Math.min(...Te.map(rt=>Number(rt.price)||0)):0,Ge=Te.length>0?Math.max(...Te.map(rt=>Number(rt.price)||0)):0;const xi=Te.reduce((rt,Tn)=>rt+(parseInt(Tn.quota,10)||0),0);K&&(qe=0,Ge=0);const ke=Te.reduce((rt,Tn)=>rt+(parseInt(Tn.quota,10)||0),0),dr=Te.length>0?K?parseInt(I,10)||0:ke:parseInt(I,10)||null;console.log("Capacity Debug:",{capacity:I,ticketTiers:Te.length,totalCapacity:xi,finalCapacity:dr,isFree:K});const{error:yi}=await Re.from("events").update({title:l,description:m,category:v,start_at:Ot,end_at:Ze,venue_id:nt,capacity:dr,min_price:qe,max_price:Ge,cover_url:ue||J||null}).eq("id",i.id).eq("creator_id",e.id);if(yi)throw console.error("Error updating event:",yi),yi;if(console.log("Event updated successfully with capacity:",dr),Te.length>0){const rt=[];for(const rn of Te){const tr=(gt=i.ticket_tiers)==null?void 0:gt.find(zn=>zn.name===rn.name);if(tr&&rn.quota<tr.quota){const{data:zn}=await Re.from("tickets").select("id").eq("tier_id",tr.id),_t=(zn==null?void 0:zn.length)||0;rn.quota<_t&&rt.push(`Cannot reduce "${rn.name}" quota to ${rn.quota} - ${_t} tickets already sold`)}}const Tn=((Le=i.ticket_tiers)==null?void 0:Le.map(rn=>rn.name))||[],In=Te.map(rn=>rn.name),en=Tn.filter(rn=>!In.includes(rn));for(const rn of en){const tr=(yt=i.ticket_tiers)==null?void 0:yt.find(zn=>zn.name===rn);if(tr){const{data:zn}=await Re.from("tickets").select("id").eq("tier_id",tr.id),_t=(zn==null?void 0:zn.length)||0;_t>0&&rt.push(`Cannot delete "${rn}" tier - ${_t} tickets already sold`)}}if(rt.length>0){alert("Cannot update event: "+rt.join(`
`));return}K?await fe(dr):await je()}else if(K)await fe(dr);else if(!K){const{error:rt}=await Re.from("ticket_tiers").delete().eq("event_id",i.id);if(rt)throw console.error("Error deleting all tiers for paid event with no tiers:",rt),rt}const{data:Sr,error:Hi}=await Re.from("events").select("*, venue:venues(*)").eq("id",i.id).single();Hi&&console.error("Error reloading event data:",Hi),alert("Event updated successfully!"),n("/manage-events")}catch(Ot){console.error("Error updating event:",Ot),alert("Failed to update event: "+Ot.message)}finally{be(!1)}};return g.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-white",children:[g.jsx(It,{}),g.jsxs("div",{className:"container mx-auto px-6 py-12",children:[g.jsx("div",{className:"mb-16",children:g.jsxs("div",{className:"text-center relative",children:[g.jsxs("div",{className:"absolute inset-0 -z-10",children:[g.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 w-96 h-96 bg-gradient-to-br from-brand-100/30 to-purple-100/30 rounded-full blur-3xl"}),g.jsx("div",{className:"absolute bottom-0 right-0 w-64 h-64 bg-gradient-to-tl from-blue-100/30 to-cyan-100/30 rounded-full blur-2xl"}),g.jsx("div",{className:"absolute top-1/2 left-0 w-48 h-48 bg-gradient-to-r from-pink-100/30 to-rose-100/30 rounded-full blur-xl"})]}),g.jsx("h1",{className:"text-6xl md:text-7xl font-black bg-gradient-to-r from-gray-900 via-brand-600 to-purple-700 bg-clip-text text-transparent mb-8",style:{lineHeight:"1.6"},children:"Edit Event"}),g.jsx("p",{className:"text-xl md:text-2xl text-gray-600 max-w-4xl mx-auto mb-12 leading-relaxed font-light",children:"Update your event details and settings"}),g.jsx("div",{className:"w-24 h-1 bg-gradient-to-r from-brand-500 to-purple-500 mx-auto rounded-full mb-8"})]})}),g.jsx("div",{className:"max-w-4xl mx-auto",children:g.jsxs("form",{onSubmit:Je,className:"space-y-8",children:[g.jsxs("section",{className:"bg-white rounded-xl shadow-lg p-8 border border-gray-100",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[g.jsx("div",{className:"w-10 h-10 bg-brand-100 rounded-full flex items-center justify-center",children:g.jsx("svg",{className:"w-5 h-5 text-brand-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})}),g.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Event Title"})]}),g.jsx("input",{type:"text",value:l,onChange:Ue=>c(Ue.target.value),required:!0,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none transition-colors text-lg",placeholder:"Enter event title"})]}),g.jsxs("section",{className:"bg-white rounded-xl shadow-lg p-8 border border-gray-100",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[g.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:g.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),g.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Description"})]}),g.jsx("textarea",{value:m,onChange:Ue=>_(Ue.target.value),rows:4,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none transition-colors resize-none",placeholder:"Describe your event"})]}),g.jsxs("section",{className:"bg-white rounded-xl shadow-lg p-8 border border-gray-100",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[g.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:g.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})}),g.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Category"})]}),g.jsxs("select",{value:v,onChange:Ue=>y(Ue.target.value),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none transition-colors text-lg",children:[g.jsx("option",{value:"",children:"Select a category"}),g.jsx("option",{value:"Music",children:"Music"}),g.jsx("option",{value:"Business & Professional",children:"Business & Professional"}),g.jsx("option",{value:"Food & Drink",children:"Food & Drink"}),g.jsx("option",{value:"Community & Culture",children:"Community & Culture"}),g.jsx("option",{value:"Performing & Visual Arts",children:"Performing & Visual Arts"}),g.jsx("option",{value:"Film, Media & Entertainment",children:"Film, Media & Entertainment"}),g.jsx("option",{value:"Sports & Fitness",children:"Sports & Fitness"}),g.jsx("option",{value:"Health & Wellness",children:"Health & Wellness"}),g.jsx("option",{value:"Science & Technology",children:"Science & Technology"}),g.jsx("option",{value:"Travel & Outdoor",children:"Travel & Outdoor"}),g.jsx("option",{value:"Charity & Causes",children:"Charity & Causes"}),g.jsx("option",{value:"Religion & Spirituality",children:"Religion & Spirituality"}),g.jsx("option",{value:"Family & Education",children:"Family & Education"}),g.jsx("option",{value:"Seasonal & Holiday",children:"Seasonal & Holiday"}),g.jsx("option",{value:"Government & Politics",children:"Government & Politics"}),g.jsx("option",{value:"Fashion & Beauty",children:"Fashion & Beauty"}),g.jsx("option",{value:"Home & Lifestyle",children:"Home & Lifestyle"}),g.jsx("option",{value:"Hobbies & Special Interests",children:"Hobbies & Special Interests"}),g.jsx("option",{value:"School Activities",children:"School Activities"}),g.jsx("option",{value:"Others",children:"Others"})]})]}),g.jsxs("section",{className:"bg-white rounded-xl shadow-lg p-8 border border-gray-100",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[g.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:g.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),g.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Date & Time"})]}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date *"}),g.jsx("input",{type:"date",value:S,onChange:Ue=>E(Ue.target.value),required:!0,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none transition-colors"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Time *"}),g.jsx("input",{type:"time",value:T,onChange:Ue=>U(Ue.target.value),required:!0,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none transition-colors"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Time"}),g.jsx("input",{type:"time",value:j,onChange:Ue=>P(Ue.target.value),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none transition-colors"})]})]})]}),g.jsxs("section",{className:"bg-white rounded-xl shadow-lg p-8 border border-gray-100",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[g.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center",children:g.jsxs("svg",{className:"w-5 h-5 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),g.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Location"})]}),g.jsx(Px,{onLocationChange:R,initialLocation:D})]}),g.jsxs("section",{className:"bg-white rounded-xl shadow-lg p-8 border border-gray-100",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[g.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center",children:g.jsx("svg",{className:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),g.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Capacity & Pricing"})]}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Capacity"}),g.jsx("input",{type:"number",value:I,onChange:Ue=>k(Ue.target.value),min:"1",disabled:!K&&Te.length>0,className:`w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none transition-colors ${!K&&Te.length>0?"bg-gray-100 cursor-not-allowed":""}`,placeholder:"Unlimited"}),!K&&Te.length>0?g.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"Capacity is the sum of tier quotas. Edit the tiers above to change capacity."}):g.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Set the maximum number of people who can attend your event."})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Min Price (VND)"}),g.jsx("input",{type:"number",value:z,onChange:Ue=>G(Ue.target.value),min:"0",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none transition-colors",placeholder:"0"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Price (VND)"}),g.jsx("input",{type:"number",value:Y,onChange:Ue=>Z(Ue.target.value),min:"0",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none transition-colors",placeholder:"0"})]})]})]}),g.jsxs("section",{className:"bg-white rounded-xl shadow-lg p-8 border border-gray-100",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[g.jsx("div",{className:"w-10 h-10 bg-pink-100 rounded-full flex items-center justify-center",children:g.jsx("svg",{className:"w-5 h-5 text-pink-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),g.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Cover Image"})]}),g.jsx("p",{className:"text-gray-600 mb-6",children:"Upload a cover image to make your event stand out. Recommended size: 1600×900 pixels."}),i!=null&&i.id?g.jsxs("div",{className:"space-y-6",children:[i.cover_url&&g.jsxs("div",{className:"relative",children:[g.jsx("img",{src:i.cover_url,alt:"Current cover",className:"w-full h-64 object-cover rounded-xl border border-gray-200 shadow-sm"}),g.jsx("div",{className:"absolute top-3 right-3 bg-black bg-opacity-50 text-white px-3 py-1 rounded-full text-sm",children:"Current Cover"})]}),g.jsx(xC,{eventId:i.id,onDone:Ue=>{ie(Ue),Ie(Ue)}})]}):g.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-xl border-2 border-dashed border-gray-300",children:[g.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-200 rounded-full flex items-center justify-center",children:g.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),g.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Cover Image Upload"}),g.jsx("p",{className:"text-gray-500",children:"Save the event first to upload a cover image"})]})]}),g.jsxs("section",{className:"bg-white rounded-xl shadow-lg p-8 border border-gray-100",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[g.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center",children:g.jsx("svg",{className:"w-5 h-5 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})})}),g.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Ticket Tiers"})]}),g.jsx("p",{className:"text-gray-600 mb-6",children:"Manage your ticket types, prices, and quantities. You can have free and paid tiers."}),g.jsxs("div",{className:"mb-6",children:[g.jsxs("label",{className:"inline-flex items-center gap-3 text-gray-700",children:[g.jsx("input",{type:"checkbox",className:`w-5 h-5 text-brand-600 rounded focus:ring-brand-500 ${we&&!K?"opacity-50 cursor-not-allowed":""}`,checked:K,disabled:we&&!K,onChange:async Ue=>{const tt=Ue.target.checked;if(tt&&!K&&await Ve()){alert("Cannot convert to free event: Some paid tickets have already been sold. Please contact support if you need to make changes.");return}me(tt),tt&&(Q([]),G("0"),Z("0"))}}),g.jsx("span",{className:`font-medium ${we&&!K?"text-gray-400":""}`,children:"My tickets are free"})]}),g.jsx("p",{className:"text-sm text-gray-500 mt-2",children:we&&!K?g.jsx("span",{className:"text-red-600 font-medium",children:"⚠️ Cannot convert to free: Some paid tickets have already been sold. Contact support for assistance."}):"Check this if you want to offer all tickets for free. No tiering options will be available."})]}),!K&&g.jsx(Cx,{tiers:Te,onChange:Fe,eventId:i.id,originalEvent:i,isEditing:!0}),K&&g.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-6 text-center",children:[g.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:g.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),g.jsx("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:"Free Event"}),g.jsx("p",{className:"text-green-700",children:"Your event will be completely free for all attendees. No ticket tiers or pricing needed!"})]})]}),g.jsxs("div",{className:"flex gap-4 pt-8",children:[g.jsx("button",{type:"button",onClick:()=>n("/manage-events"),className:"btn btn-ghost text-lg px-8 py-3 flex-1",children:"Cancel"}),g.jsx("button",{type:"submit",disabled:le||!pe,className:`btn text-lg px-8 py-3 flex-1 bg-gradient-to-r from-brand-600 to-purple-600 border-0 hover:from-brand-700 hover:to-purple-700 shadow-lg hover:shadow-xl ${pe?"":"opacity-50 cursor-not-allowed"}`,children:le?"Updating...":"Update Event"})]}),!pe&&g.jsx("div",{className:"text-center",children:g.jsx("p",{className:"text-sm text-red-600",children:"⚠️ Cannot save event - Please fix the validation errors above"})})]})})]})]})}function vC(){var Q;const{user:e}=ur(),t=Ms(),n=zi(),i=(Q=t.state)==null?void 0:Q.event,[l,c]=H.useState(""),[m,_]=H.useState(""),[v,y]=H.useState(""),[S,E]=H.useState(""),[T,U]=H.useState(""),[j,P]=H.useState(""),[D,R]=H.useState("venue"),[I,k]=H.useState(""),[z,G]=H.useState(""),[Y,Z]=H.useState(""),[J,ie]=H.useState(""),[Ee,ce]=H.useState(""),[ue,Ie]=H.useState(!1);if(H.useEffect(()=>{var K,me,le;if(!i){n("/manage-events");return}c(`${i.title} (Copy)`),_(i.description||""),y(i.category||"");const pe=new Date;pe.setDate(pe.getDate()+1),E(pe.toISOString().split("T")[0]);const ne=new Date(i.start_at);if(U(ne.toTimeString().slice(0,5)),i.end_at){const be=new Date(i.end_at);P(be.toTimeString().slice(0,5))}i.venue&&i.venue.name&&i.venue.name!=="TBD"?(R("venue"),k(i.venue.name)):R("online"),G(((K=i.capacity)==null?void 0:K.toString())||""),Z(((me=i.min_price)==null?void 0:me.toString())||""),ie(((le=i.max_price)==null?void 0:le.toString())||""),ce(i.cover_url||"")},[i,n]),!e)return g.jsxs("div",{className:"min-h-screen bg-gray-50",children:[g.jsx(It,{}),g.jsx("div",{className:"container mx-auto px-4 py-8",children:g.jsxs("div",{className:"text-center",children:[g.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Please Sign In"}),g.jsx("p",{className:"text-gray-600",children:"You need to be signed in to copy events."})]})})]});if(!i)return g.jsxs("div",{className:"min-h-screen bg-gray-50",children:[g.jsx(It,{}),g.jsx("div",{className:"container mx-auto px-4 py-8",children:g.jsxs("div",{className:"text-center",children:[g.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Event Not Found"}),g.jsx("p",{className:"text-gray-600",children:"The event you're trying to copy doesn't exist."})]})})]});const Te=async pe=>{pe.preventDefault(),Ie(!0);try{const ne=new Date(`${S}T${T}`).toISOString(),K=j?new Date(`${S}T${j}`).toISOString():ne;let me=null;if(D==="venue"&&I){const{data:be,error:we}=await Re.from("venues").insert([{name:I}]).select();if(we)throw we;me=be[0].id}const{error:le}=await Re.from("events").insert([{title:l,description:m,category:v,start_at:ne,end_at:K,venue_id:me,capacity:z?parseInt(z):null,min_price:Y?parseInt(Y):0,max_price:J?parseInt(J):0,cover_url:Ee||null,status:"published",creator_id:e.id}]);if(le)throw le;alert("Event copied successfully!"),n("/manage-events")}catch(ne){console.error("Error copying event:",ne),alert("Failed to copy event: "+ne.message)}finally{Ie(!1)}};return g.jsxs("div",{className:"min-h-screen bg-gray-50",children:[g.jsx(It,{}),g.jsx("div",{className:"container mx-auto px-4 py-8",children:g.jsxs("div",{className:"max-w-2xl mx-auto",children:[g.jsxs("div",{className:"mb-8",children:[g.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Copy Event"}),g.jsx("p",{className:"text-lg text-gray-600",children:"Your event copy will have the same event info and settings, without attendee information."})]}),g.jsxs("form",{onSubmit:Te,className:"bg-white rounded-lg shadow-lg p-6 space-y-6",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Event Title *"}),g.jsx("input",{type:"text",value:l,onChange:pe=>c(pe.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter event title"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),g.jsx("textarea",{value:m,onChange:pe=>_(pe.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Describe your event"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),g.jsxs("select",{value:v,onChange:pe=>y(pe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[g.jsx("option",{value:"",children:"Select a category"}),g.jsx("option",{value:"Music",children:"Music"}),g.jsx("option",{value:"Business & Professional",children:"Business & Professional"}),g.jsx("option",{value:"Food & Drink",children:"Food & Drink"}),g.jsx("option",{value:"Community & Culture",children:"Community & Culture"}),g.jsx("option",{value:"Performing & Visual Arts",children:"Performing & Visual Arts"}),g.jsx("option",{value:"Film, Media & Entertainment",children:"Film, Media & Entertainment"}),g.jsx("option",{value:"Sports & Fitness",children:"Sports & Fitness"}),g.jsx("option",{value:"Health & Wellness",children:"Health & Wellness"}),g.jsx("option",{value:"Science & Technology",children:"Science & Technology"}),g.jsx("option",{value:"Travel & Outdoor",children:"Travel & Outdoor"}),g.jsx("option",{value:"Charity & Causes",children:"Charity & Causes"}),g.jsx("option",{value:"Religion & Spirituality",children:"Religion & Spirituality"}),g.jsx("option",{value:"Family & Education",children:"Family & Education"}),g.jsx("option",{value:"Seasonal & Holiday",children:"Seasonal & Holiday"}),g.jsx("option",{value:"Government & Politics",children:"Government & Politics"}),g.jsx("option",{value:"Fashion & Beauty",children:"Fashion & Beauty"}),g.jsx("option",{value:"Home & Lifestyle",children:"Home & Lifestyle"}),g.jsx("option",{value:"Hobbies & Special Interests",children:"Hobbies & Special Interests"}),g.jsx("option",{value:"School Activities",children:"School Activities"}),g.jsx("option",{value:"Others",children:"Others"})]})]}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date *"}),g.jsx("input",{type:"date",value:S,onChange:pe=>E(pe.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Time *"}),g.jsx("input",{type:"time",value:T,onChange:pe=>U(pe.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Time"}),g.jsx("input",{type:"time",value:j,onChange:pe=>P(pe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location Type"}),g.jsxs("div",{className:"flex gap-4",children:[g.jsxs("label",{className:"flex items-center",children:[g.jsx("input",{type:"radio",value:"venue",checked:D==="venue",onChange:pe=>R(pe.target.value),className:"mr-2"}),"Venue"]}),g.jsxs("label",{className:"flex items-center",children:[g.jsx("input",{type:"radio",value:"online",checked:D==="online",onChange:pe=>R(pe.target.value),className:"mr-2"}),"Online"]})]})]}),D==="venue"&&g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Venue Name"}),g.jsx("input",{type:"text",value:I,onChange:pe=>k(pe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter venue name"})]}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Capacity"}),g.jsx("input",{type:"number",value:z,onChange:pe=>G(pe.target.value),min:"1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Unlimited"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Min Price (VND)"}),g.jsx("input",{type:"number",value:Y,onChange:pe=>Z(pe.target.value),min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Price (VND)"}),g.jsx("input",{type:"number",value:J,onChange:pe=>ie(pe.target.value),min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cover Image URL"}),g.jsx("input",{type:"url",value:Ee,onChange:pe=>ce(pe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://example.com/image.jpg"})]}),g.jsxs("div",{className:"flex gap-4 pt-4",children:[g.jsx("button",{type:"button",onClick:()=>n("/manage-events"),className:"btn btn-outline flex-1",children:"Cancel"}),g.jsx("button",{type:"submit",disabled:ue,className:"btn btn-primary flex-1",children:ue?"Creating...":"Create Event Copy"})]})]})]})})]})}var Me;(function(e){e[e.QR_CODE=0]="QR_CODE",e[e.AZTEC=1]="AZTEC",e[e.CODABAR=2]="CODABAR",e[e.CODE_39=3]="CODE_39",e[e.CODE_93=4]="CODE_93",e[e.CODE_128=5]="CODE_128",e[e.DATA_MATRIX=6]="DATA_MATRIX",e[e.MAXICODE=7]="MAXICODE",e[e.ITF=8]="ITF",e[e.EAN_13=9]="EAN_13",e[e.EAN_8=10]="EAN_8",e[e.PDF_417=11]="PDF_417",e[e.RSS_14=12]="RSS_14",e[e.RSS_EXPANDED=13]="RSS_EXPANDED",e[e.UPC_A=14]="UPC_A",e[e.UPC_E=15]="UPC_E",e[e.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Me||(Me={}));var K1=new Map([[Me.QR_CODE,"QR_CODE"],[Me.AZTEC,"AZTEC"],[Me.CODABAR,"CODABAR"],[Me.CODE_39,"CODE_39"],[Me.CODE_93,"CODE_93"],[Me.CODE_128,"CODE_128"],[Me.DATA_MATRIX,"DATA_MATRIX"],[Me.MAXICODE,"MAXICODE"],[Me.ITF,"ITF"],[Me.EAN_13,"EAN_13"],[Me.EAN_8,"EAN_8"],[Me.PDF_417,"PDF_417"],[Me.RSS_14,"RSS_14"],[Me.RSS_EXPANDED,"RSS_EXPANDED"],[Me.UPC_A,"UPC_A"],[Me.UPC_E,"UPC_E"],[Me.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),Q1;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.URL=1]="URL"})(Q1||(Q1={}));function wC(e){return Object.values(Me).includes(e)}var Ss;(function(e){e[e.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",e[e.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(Ss||(Ss={}));var Qr=function(){function e(){}return e.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",e.SCAN_DEFAULT_FPS=2,e.DEFAULT_DISABLE_FLIP=!1,e.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,e.DEFAULT_SUPPORTED_SCAN_TYPE=[Ss.SCAN_TYPE_CAMERA,Ss.SCAN_TYPE_FILE],e}(),jx=function(){function e(t,n){this.format=t,this.formatName=n}return e.prototype.toString=function(){return this.formatName},e.create=function(t){if(!K1.has(t))throw"".concat(t," not in html5QrcodeSupportedFormatsTextMap");return new e(t,K1.get(t))},e}(),J1=function(){function e(){}return e.createFromText=function(t){var n={text:t};return{decodedText:t,result:n}},e.createFromQrcodeResult=function(t){return{decodedText:t.text,result:t}},e}(),Rh;(function(e){e[e.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",e[e.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",e[e.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(Rh||(Rh={}));var Dx=function(){function e(){}return e.createFrom=function(t){return{errorMessage:t,type:Rh.UNKWOWN_ERROR}},e}(),Bx=function(){function e(t){this.verbose=t}return e.prototype.log=function(t){this.verbose&&console.log(t)},e.prototype.warn=function(t){this.verbose&&console.warn(t)},e.prototype.logError=function(t,n){(this.verbose||n===!0)&&console.error(t)},e.prototype.logErrors=function(t){if(t.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(t)},e}();function fi(e){return typeof e>"u"||e===null}function _C(e,t,n){return e>n?n:e<t?t:e}var Uo=function(){function e(){}return e.codeParseError=function(t){return"QR code parse error, error = ".concat(t)},e.errorGettingUserMedia=function(t){return"Error getting userMedia, error = ".concat(t)},e.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},e.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},e.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},e.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},e.scannerPaused=function(){return"Scanner paused"},e}(),Et=function(){function e(){}return e.scanningStatus=function(){return"Scanning"},e.idleStatus=function(){return"Idle"},e.errorStatus=function(){return"Error"},e.permissionStatus=function(){return"Permission"},e.noCameraFoundErrorStatus=function(){return"No Cameras"},e.lastMatch=function(t){return"Last Match: ".concat(t)},e.codeScannerTitle=function(){return"Code Scanner"},e.cameraPermissionTitle=function(){return"Request Camera Permissions"},e.cameraPermissionRequesting=function(){return"Requesting camera permissions..."},e.noCameraFound=function(){return"No camera found"},e.scanButtonStopScanningText=function(){return"Stop Scanning"},e.scanButtonStartScanningText=function(){return"Start Scanning"},e.torchOnButton=function(){return"Switch On Torch"},e.torchOffButton=function(){return"Switch Off Torch"},e.torchOnFailedMessage=function(){return"Failed to turn on torch"},e.torchOffFailedMessage=function(){return"Failed to turn off torch"},e.scanButtonScanningStarting=function(){return"Launching Camera..."},e.textIfCameraScanSelected=function(){return"Scan an Image File"},e.textIfFileScanSelected=function(){return"Scan using camera directly"},e.selectCamera=function(){return"Select Camera"},e.fileSelectionChooseImage=function(){return"Choose Image"},e.fileSelectionChooseAnother=function(){return"Choose Another"},e.fileSelectionNoImageSelected=function(){return"No image choosen"},e.anonymousCameraPrefix=function(){return"Anonymous Camera"},e.dragAndDropMessage=function(){return"Or drop an image to scan"},e.dragAndDropMessageOnlyImages=function(){return"Or drop an image to scan (other files not supported)"},e.zoom=function(){return"zoom"},e.loadingImage=function(){return"Loading image..."},e.cameraScanAltText=function(){return"Camera based scan"},e.fileScanAltText=function(){return"Fule based scan"},e}(),eg=function(){function e(){}return e.poweredBy=function(){return"Powered by "},e.reportIssues=function(){return"Report issues"},e}(),Fx=function(){function e(){}return e.isMediaStreamConstraintsValid=function(t,n){if(typeof t!="object"){var i=typeof t;return n.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(i,"."),!0),!1}for(var l=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],c=new Set(l),m=Object.keys(t),_=0,v=m;_<v.length;_++){var y=v[_];if(c.has(y))return n.logError("".concat(y," is not supported videoConstaints."),!0),!1}return!0},e}(),jh={exports:{}};(function(e,t){(function(n,i){i(t)})(Sn,function(n){function i(M){return M==null}var l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(M,r){M.__proto__=r}||function(M,r){for(var s in r)r.hasOwnProperty(s)&&(M[s]=r[s])};function c(M,r){l(M,r);function s(){this.constructor=M}M.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}function m(M,r){var s=Object.setPrototypeOf;s?s(M,r):M.__proto__=r}function _(M,r){r===void 0&&(r=M.constructor);var s=Error.captureStackTrace;s&&s(M,r)}var v=function(M){c(r,M);function r(s){var a=this.constructor,u=M.call(this,s)||this;return Object.defineProperty(u,"name",{value:a.name,enumerable:!1}),m(u,a.prototype),_(u),u}return r}(Error);class y extends v{constructor(r=void 0){super(r),this.message=r}getKind(){return this.constructor.kind}}y.kind="Exception";class S extends y{}S.kind="ArgumentException";class E extends y{}E.kind="IllegalArgumentException";class T{constructor(r){if(this.binarizer=r,r===null)throw new E("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(r,s){return this.binarizer.getBlackRow(r,s)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(r,s,a,u){const d=this.binarizer.getLuminanceSource().crop(r,s,a,u);return new T(this.binarizer.createBinarizer(d))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const r=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new T(this.binarizer.createBinarizer(r))}rotateCounterClockwise45(){const r=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new T(this.binarizer.createBinarizer(r))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class U extends y{static getChecksumInstance(){return new U}}U.kind="ChecksumException";class j{constructor(r){this.source=r}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class P{static arraycopy(r,s,a,u,d){for(;d--;)a[u++]=r[s++]}static currentTimeMillis(){return Date.now()}}class D extends y{}D.kind="IndexOutOfBoundsException";class R extends D{constructor(r=void 0,s=void 0){super(s),this.index=r,this.message=s}}R.kind="ArrayIndexOutOfBoundsException";class I{static fill(r,s){for(let a=0,u=r.length;a<u;a++)r[a]=s}static fillWithin(r,s,a,u){I.rangeCheck(r.length,s,a);for(let d=s;d<a;d++)r[d]=u}static rangeCheck(r,s,a){if(s>a)throw new E("fromIndex("+s+") > toIndex("+a+")");if(s<0)throw new R(s);if(a>r)throw new R(a)}static asList(...r){return r}static create(r,s,a){return Array.from({length:r}).map(d=>Array.from({length:s}).fill(a))}static createInt32Array(r,s,a){return Array.from({length:r}).map(d=>Int32Array.from({length:s}).fill(a))}static equals(r,s){if(!r||!s||!r.length||!s.length||r.length!==s.length)return!1;for(let a=0,u=r.length;a<u;a++)if(r[a]!==s[a])return!1;return!0}static hashCode(r){if(r===null)return 0;let s=1;for(const a of r)s=31*s+a;return s}static fillUint8Array(r,s){for(let a=0;a!==r.length;a++)r[a]=s}static copyOf(r,s){return r.slice(0,s)}static copyOfUint8Array(r,s){if(r.length<=s){const a=new Uint8Array(s);return a.set(r),a}return r.slice(0,s)}static copyOfRange(r,s,a){const u=a-s,d=new Int32Array(u);return P.arraycopy(r,s,d,0,u),d}static binarySearch(r,s,a){a===void 0&&(a=I.numberComparator);let u=0,d=r.length-1;for(;u<=d;){const f=d+u>>1,p=a(s,r[f]);if(p>0)u=f+1;else if(p<0)d=f-1;else return f}return-u-1}static numberComparator(r,s){return r-s}}class k{static numberOfTrailingZeros(r){let s;if(r===0)return 32;let a=31;return s=r<<16,s!==0&&(a-=16,r=s),s=r<<8,s!==0&&(a-=8,r=s),s=r<<4,s!==0&&(a-=4,r=s),s=r<<2,s!==0&&(a-=2,r=s),a-(r<<1>>>31)}static numberOfLeadingZeros(r){if(r===0)return 32;let s=1;return r>>>16||(s+=16,r<<=16),r>>>24||(s+=8,r<<=8),r>>>28||(s+=4,r<<=4),r>>>30||(s+=2,r<<=2),s-=r>>>31,s}static toHexString(r){return r.toString(16)}static toBinaryString(r){return String(parseInt(String(r),2))}static bitCount(r){return r=r-(r>>>1&1431655765),r=(r&858993459)+(r>>>2&858993459),r=r+(r>>>4)&252645135,r=r+(r>>>8),r=r+(r>>>16),r&63}static truncDivision(r,s){return Math.trunc(r/s)}static parseInt(r,s=void 0){return parseInt(r,s)}}k.MIN_VALUE_32_BITS=-2147483648,k.MAX_VALUE=Number.MAX_SAFE_INTEGER;class z{constructor(r,s){r===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=r,s==null?this.bits=z.makeArray(r):this.bits=s)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(r){if(r>this.bits.length*32){const s=z.makeArray(r);P.arraycopy(this.bits,0,s,0,this.bits.length),this.bits=s}}get(r){return(this.bits[Math.floor(r/32)]&1<<(r&31))!==0}set(r){this.bits[Math.floor(r/32)]|=1<<(r&31)}flip(r){this.bits[Math.floor(r/32)]^=1<<(r&31)}getNextSet(r){const s=this.size;if(r>=s)return s;const a=this.bits;let u=Math.floor(r/32),d=a[u];d&=~((1<<(r&31))-1);const f=a.length;for(;d===0;){if(++u===f)return s;d=a[u]}const p=u*32+k.numberOfTrailingZeros(d);return p>s?s:p}getNextUnset(r){const s=this.size;if(r>=s)return s;const a=this.bits;let u=Math.floor(r/32),d=~a[u];d&=~((1<<(r&31))-1);const f=a.length;for(;d===0;){if(++u===f)return s;d=~a[u]}const p=u*32+k.numberOfTrailingZeros(d);return p>s?s:p}setBulk(r,s){this.bits[Math.floor(r/32)]=s}setRange(r,s){if(s<r||r<0||s>this.size)throw new E;if(s===r)return;s--;const a=Math.floor(r/32),u=Math.floor(s/32),d=this.bits;for(let f=a;f<=u;f++){const p=f>a?0:r&31,b=(2<<(f<u?31:s&31))-(1<<p);d[f]|=b}}clear(){const r=this.bits.length,s=this.bits;for(let a=0;a<r;a++)s[a]=0}isRange(r,s,a){if(s<r||r<0||s>this.size)throw new E;if(s===r)return!0;s--;const u=Math.floor(r/32),d=Math.floor(s/32),f=this.bits;for(let p=u;p<=d;p++){const w=p>u?0:r&31,A=(2<<(p<d?31:s&31))-(1<<w)&4294967295;if((f[p]&A)!==(a?A:0))return!1}return!0}appendBit(r){this.ensureCapacity(this.size+1),r&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(r,s){if(s<0||s>32)throw new E("Num bits must be between 0 and 32");this.ensureCapacity(this.size+s);for(let a=s;a>0;a--)this.appendBit((r>>a-1&1)===1)}appendBitArray(r){const s=r.size;this.ensureCapacity(this.size+s);for(let a=0;a<s;a++)this.appendBit(r.get(a))}xor(r){if(this.size!==r.size)throw new E("Sizes don't match");const s=this.bits;for(let a=0,u=s.length;a<u;a++)s[a]^=r.bits[a]}toBytes(r,s,a,u){for(let d=0;d<u;d++){let f=0;for(let p=0;p<8;p++)this.get(r)&&(f|=1<<7-p),r++;s[a+d]=f}}getBitArray(){return this.bits}reverse(){const r=new Int32Array(this.bits.length),s=Math.floor((this.size-1)/32),a=s+1,u=this.bits;for(let d=0;d<a;d++){let f=u[d];f=f>>1&1431655765|(f&1431655765)<<1,f=f>>2&858993459|(f&858993459)<<2,f=f>>4&252645135|(f&252645135)<<4,f=f>>8&16711935|(f&16711935)<<8,f=f>>16&65535|(f&65535)<<16,r[s-d]=f}if(this.size!==a*32){const d=a*32-this.size;let f=r[0]>>>d;for(let p=1;p<a;p++){const w=r[p];f|=w<<32-d,r[p-1]=f,f=w>>>d}r[a-1]=f}this.bits=r}static makeArray(r){return new Int32Array(Math.floor((r+31)/32))}equals(r){if(!(r instanceof z))return!1;const s=r;return this.size===s.size&&I.equals(this.bits,s.bits)}hashCode(){return 31*this.size+I.hashCode(this.bits)}toString(){let r="";for(let s=0,a=this.size;s<a;s++)s&7||(r+=" "),r+=this.get(s)?"X":".";return r}clone(){return new z(this.size,this.bits.slice())}}var G;(function(M){M[M.OTHER=0]="OTHER",M[M.PURE_BARCODE=1]="PURE_BARCODE",M[M.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",M[M.TRY_HARDER=3]="TRY_HARDER",M[M.CHARACTER_SET=4]="CHARACTER_SET",M[M.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",M[M.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",M[M.ASSUME_GS1=7]="ASSUME_GS1",M[M.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",M[M.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",M[M.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(G||(G={}));var Y=G;class Z extends y{static getFormatInstance(){return new Z}}Z.kind="FormatException";var J;(function(M){M[M.Cp437=0]="Cp437",M[M.ISO8859_1=1]="ISO8859_1",M[M.ISO8859_2=2]="ISO8859_2",M[M.ISO8859_3=3]="ISO8859_3",M[M.ISO8859_4=4]="ISO8859_4",M[M.ISO8859_5=5]="ISO8859_5",M[M.ISO8859_6=6]="ISO8859_6",M[M.ISO8859_7=7]="ISO8859_7",M[M.ISO8859_8=8]="ISO8859_8",M[M.ISO8859_9=9]="ISO8859_9",M[M.ISO8859_10=10]="ISO8859_10",M[M.ISO8859_11=11]="ISO8859_11",M[M.ISO8859_13=12]="ISO8859_13",M[M.ISO8859_14=13]="ISO8859_14",M[M.ISO8859_15=14]="ISO8859_15",M[M.ISO8859_16=15]="ISO8859_16",M[M.SJIS=16]="SJIS",M[M.Cp1250=17]="Cp1250",M[M.Cp1251=18]="Cp1251",M[M.Cp1252=19]="Cp1252",M[M.Cp1256=20]="Cp1256",M[M.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",M[M.UTF8=22]="UTF8",M[M.ASCII=23]="ASCII",M[M.Big5=24]="Big5",M[M.GB18030=25]="GB18030",M[M.EUC_KR=26]="EUC_KR"})(J||(J={}));class ie{constructor(r,s,a,...u){this.valueIdentifier=r,this.name=a,typeof s=="number"?this.values=Int32Array.from([s]):this.values=s,this.otherEncodingNames=u,ie.VALUE_IDENTIFIER_TO_ECI.set(r,this),ie.NAME_TO_ECI.set(a,this);const d=this.values;for(let f=0,p=d.length;f!==p;f++){const w=d[f];ie.VALUES_TO_ECI.set(w,this)}for(const f of u)ie.NAME_TO_ECI.set(f,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(r){if(r<0||r>=900)throw new Z("incorect value");const s=ie.VALUES_TO_ECI.get(r);if(s===void 0)throw new Z("incorect value");return s}static getCharacterSetECIByName(r){const s=ie.NAME_TO_ECI.get(r);if(s===void 0)throw new Z("incorect value");return s}equals(r){if(!(r instanceof ie))return!1;const s=r;return this.getName()===s.getName()}}ie.VALUE_IDENTIFIER_TO_ECI=new Map,ie.VALUES_TO_ECI=new Map,ie.NAME_TO_ECI=new Map,ie.Cp437=new ie(J.Cp437,Int32Array.from([0,2]),"Cp437"),ie.ISO8859_1=new ie(J.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),ie.ISO8859_2=new ie(J.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),ie.ISO8859_3=new ie(J.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),ie.ISO8859_4=new ie(J.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),ie.ISO8859_5=new ie(J.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),ie.ISO8859_6=new ie(J.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),ie.ISO8859_7=new ie(J.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),ie.ISO8859_8=new ie(J.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),ie.ISO8859_9=new ie(J.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),ie.ISO8859_10=new ie(J.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),ie.ISO8859_11=new ie(J.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),ie.ISO8859_13=new ie(J.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),ie.ISO8859_14=new ie(J.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),ie.ISO8859_15=new ie(J.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),ie.ISO8859_16=new ie(J.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),ie.SJIS=new ie(J.SJIS,20,"SJIS","Shift_JIS"),ie.Cp1250=new ie(J.Cp1250,21,"Cp1250","windows-1250"),ie.Cp1251=new ie(J.Cp1251,22,"Cp1251","windows-1251"),ie.Cp1252=new ie(J.Cp1252,23,"Cp1252","windows-1252"),ie.Cp1256=new ie(J.Cp1256,24,"Cp1256","windows-1256"),ie.UnicodeBigUnmarked=new ie(J.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),ie.UTF8=new ie(J.UTF8,26,"UTF8","UTF-8"),ie.ASCII=new ie(J.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),ie.Big5=new ie(J.Big5,28,"Big5"),ie.GB18030=new ie(J.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),ie.EUC_KR=new ie(J.EUC_KR,30,"EUC_KR","EUC-KR");class Ee extends y{}Ee.kind="UnsupportedOperationException";class ce{static decode(r,s){const a=this.encodingName(s);return this.customDecoder?this.customDecoder(r,a):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(a)?this.decodeFallback(r,a):new TextDecoder(a).decode(r)}static shouldDecodeOnFallback(r){return!ce.isBrowser()&&r==="ISO-8859-1"}static encode(r,s){const a=this.encodingName(s);return this.customEncoder?this.customEncoder(r,a):typeof TextEncoder>"u"?this.encodeFallback(r):new TextEncoder().encode(r)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(r){return typeof r=="string"?r:r.getName()}static encodingCharacterSet(r){return r instanceof ie?r:ie.getCharacterSetECIByName(r)}static decodeFallback(r,s){const a=this.encodingCharacterSet(s);if(ce.isDecodeFallbackSupported(a)){let u="";for(let d=0,f=r.length;d<f;d++){let p=r[d].toString(16);p.length<2&&(p="0"+p),u+="%"+p}return decodeURIComponent(u)}if(a.equals(ie.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(r.buffer));throw new Ee(`Encoding ${this.encodingName(s)} not supported by fallback.`)}static isDecodeFallbackSupported(r){return r.equals(ie.UTF8)||r.equals(ie.ISO8859_1)||r.equals(ie.ASCII)}static encodeFallback(r){const a=btoa(unescape(encodeURIComponent(r))).split(""),u=[];for(let d=0;d<a.length;d++)u.push(a[d].charCodeAt(0));return new Uint8Array(u)}}class ue{static castAsNonUtf8Char(r,s=null){const a=s?s.getName():this.ISO88591;return ce.decode(new Uint8Array([r]),a)}static guessEncoding(r,s){if(s!=null&&s.get(Y.CHARACTER_SET)!==void 0)return s.get(Y.CHARACTER_SET).toString();const a=r.length;let u=!0,d=!0,f=!0,p=0,w=0,b=0,A=0,O=0,B=0,V=0,X=0,q=0,ee=0,se=0;const xe=r.length>3&&r[0]===239&&r[1]===187&&r[2]===191;for(let ye=0;ye<a&&(u||d||f);ye++){const ge=r[ye]&255;f&&(p>0?ge&128?p--:f=!1:ge&128&&(ge&64?(p++,ge&32?(p++,ge&16?(p++,ge&8?f=!1:A++):b++):w++):f=!1)),u&&(ge>127&&ge<160?u=!1:ge>159&&(ge<192||ge===215||ge===247)&&se++),d&&(O>0?ge<64||ge===127||ge>252?d=!1:O--:ge===128||ge===160||ge>239?d=!1:ge>160&&ge<224?(B++,X=0,V++,V>q&&(q=V)):ge>127?(O++,V=0,X++,X>ee&&(ee=X)):(V=0,X=0))}return f&&p>0&&(f=!1),d&&O>0&&(d=!1),f&&(xe||w+b+A>0)?ue.UTF8:d&&(ue.ASSUME_SHIFT_JIS||q>=3||ee>=3)?ue.SHIFT_JIS:u&&d?q===2&&B===2||se*10>=a?ue.SHIFT_JIS:ue.ISO88591:u?ue.ISO88591:d?ue.SHIFT_JIS:f?ue.UTF8:ue.PLATFORM_DEFAULT_ENCODING}static format(r,...s){let a=-1;function u(f,p,w,b,A,O){if(f==="%%")return"%";if(s[++a]===void 0)return;f=b?parseInt(b.substr(1)):void 0;let B=A?parseInt(A.substr(1)):void 0,V;switch(O){case"s":V=s[a];break;case"c":V=s[a][0];break;case"f":V=parseFloat(s[a]).toFixed(f);break;case"p":V=parseFloat(s[a]).toPrecision(f);break;case"e":V=parseFloat(s[a]).toExponential(f);break;case"x":V=parseInt(s[a]).toString(B||16);break;case"d":V=parseFloat(parseInt(s[a],B||10).toPrecision(f)).toFixed(0);break}V=typeof V=="object"?JSON.stringify(V):(+V).toString(B);let X=parseInt(w),q=w&&w[0]+""=="0"?"0":" ";for(;V.length<X;)V=p!==void 0?V+q:q+V;return V}let d=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return r.replace(d,u)}static getBytes(r,s){return ce.encode(r,s)}static getCharCode(r,s=0){return r.charCodeAt(s)}static getCharAt(r){return String.fromCharCode(r)}}ue.SHIFT_JIS=ie.SJIS.getName(),ue.GB2312="GB2312",ue.ISO88591=ie.ISO8859_1.getName(),ue.EUC_JP="EUC_JP",ue.UTF8=ie.UTF8.getName(),ue.PLATFORM_DEFAULT_ENCODING=ue.UTF8,ue.ASSUME_SHIFT_JIS=!1;class Ie{constructor(r=""){this.value=r}enableDecoding(r){return this.encoding=r,this}append(r){return typeof r=="string"?this.value+=r.toString():this.encoding?this.value+=ue.castAsNonUtf8Char(r,this.encoding):this.value+=String.fromCharCode(r),this}appendChars(r,s,a){for(let u=s;s<s+a;u++)this.append(r[u]);return this}length(){return this.value.length}charAt(r){return this.value.charAt(r)}deleteCharAt(r){this.value=this.value.substr(0,r)+this.value.substring(r+1)}setCharAt(r,s){this.value=this.value.substr(0,r)+s+this.value.substr(r+1)}substring(r,s){return this.value.substring(r,s)}setLengthToZero(){this.value=""}toString(){return this.value}insert(r,s){this.value=this.value.substr(0,r)+s+this.value.substr(r+s.length)}}class Te{constructor(r,s,a,u){if(this.width=r,this.height=s,this.rowSize=a,this.bits=u,s==null&&(s=r),this.height=s,r<1||s<1)throw new E("Both dimensions must be greater than 0");a==null&&(a=Math.floor((r+31)/32)),this.rowSize=a,u==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(r){const s=r.length,a=r[0].length,u=new Te(a,s);for(let d=0;d<s;d++){const f=r[d];for(let p=0;p<a;p++)f[p]&&u.set(p,d)}return u}static parseFromString(r,s,a){if(r===null)throw new E("stringRepresentation cannot be null");const u=new Array(r.length);let d=0,f=0,p=-1,w=0,b=0;for(;b<r.length;)if(r.charAt(b)===`
`||r.charAt(b)==="\r"){if(d>f){if(p===-1)p=d-f;else if(d-f!==p)throw new E("row lengths do not match");f=d,w++}b++}else if(r.substring(b,b+s.length)===s)b+=s.length,u[d]=!0,d++;else if(r.substring(b,b+a.length)===a)b+=a.length,u[d]=!1,d++;else throw new E("illegal character encountered: "+r.substring(b));if(d>f){if(p===-1)p=d-f;else if(d-f!==p)throw new E("row lengths do not match");w++}const A=new Te(p,w);for(let O=0;O<d;O++)u[O]&&A.set(Math.floor(O%p),Math.floor(O/p));return A}get(r,s){const a=s*this.rowSize+Math.floor(r/32);return(this.bits[a]>>>(r&31)&1)!==0}set(r,s){const a=s*this.rowSize+Math.floor(r/32);this.bits[a]|=1<<(r&31)&4294967295}unset(r,s){const a=s*this.rowSize+Math.floor(r/32);this.bits[a]&=~(1<<(r&31)&4294967295)}flip(r,s){const a=s*this.rowSize+Math.floor(r/32);this.bits[a]^=1<<(r&31)&4294967295}xor(r){if(this.width!==r.getWidth()||this.height!==r.getHeight()||this.rowSize!==r.getRowSize())throw new E("input matrix dimensions do not match");const s=new z(Math.floor(this.width/32)+1),a=this.rowSize,u=this.bits;for(let d=0,f=this.height;d<f;d++){const p=d*a,w=r.getRow(d,s).getBitArray();for(let b=0;b<a;b++)u[p+b]^=w[b]}}clear(){const r=this.bits,s=r.length;for(let a=0;a<s;a++)r[a]=0}setRegion(r,s,a,u){if(s<0||r<0)throw new E("Left and top must be nonnegative");if(u<1||a<1)throw new E("Height and width must be at least 1");const d=r+a,f=s+u;if(f>this.height||d>this.width)throw new E("The region must fit inside the matrix");const p=this.rowSize,w=this.bits;for(let b=s;b<f;b++){const A=b*p;for(let O=r;O<d;O++)w[A+Math.floor(O/32)]|=1<<(O&31)&4294967295}}getRow(r,s){s==null||s.getSize()<this.width?s=new z(this.width):s.clear();const a=this.rowSize,u=this.bits,d=r*a;for(let f=0;f<a;f++)s.setBulk(f*32,u[d+f]);return s}setRow(r,s){P.arraycopy(s.getBitArray(),0,this.bits,r*this.rowSize,this.rowSize)}rotate180(){const r=this.getWidth(),s=this.getHeight();let a=new z(r),u=new z(r);for(let d=0,f=Math.floor((s+1)/2);d<f;d++)a=this.getRow(d,a),u=this.getRow(s-1-d,u),a.reverse(),u.reverse(),this.setRow(d,u),this.setRow(s-1-d,a)}getEnclosingRectangle(){const r=this.width,s=this.height,a=this.rowSize,u=this.bits;let d=r,f=s,p=-1,w=-1;for(let b=0;b<s;b++)for(let A=0;A<a;A++){const O=u[b*a+A];if(O!==0){if(b<f&&(f=b),b>w&&(w=b),A*32<d){let B=0;for(;!(O<<31-B&4294967295);)B++;A*32+B<d&&(d=A*32+B)}if(A*32+31>p){let B=31;for(;!(O>>>B);)B--;A*32+B>p&&(p=A*32+B)}}}return p<d||w<f?null:Int32Array.from([d,f,p-d+1,w-f+1])}getTopLeftOnBit(){const r=this.rowSize,s=this.bits;let a=0;for(;a<s.length&&s[a]===0;)a++;if(a===s.length)return null;const u=a/r;let d=a%r*32;const f=s[a];let p=0;for(;!(f<<31-p&4294967295);)p++;return d+=p,Int32Array.from([d,u])}getBottomRightOnBit(){const r=this.rowSize,s=this.bits;let a=s.length-1;for(;a>=0&&s[a]===0;)a--;if(a<0)return null;const u=Math.floor(a/r);let d=Math.floor(a%r)*32;const f=s[a];let p=31;for(;!(f>>>p);)p--;return d+=p,Int32Array.from([d,u])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(r){if(!(r instanceof Te))return!1;const s=r;return this.width===s.width&&this.height===s.height&&this.rowSize===s.rowSize&&I.equals(this.bits,s.bits)}hashCode(){let r=this.width;return r=31*r+this.width,r=31*r+this.height,r=31*r+this.rowSize,r=31*r+I.hashCode(this.bits),r}toString(r="X ",s="  ",a=`
`){return this.buildToString(r,s,a)}buildToString(r,s,a){let u=new Ie;for(let d=0,f=this.height;d<f;d++){for(let p=0,w=this.width;p<w;p++)u.append(this.get(p,d)?r:s);u.append(a)}return u.toString()}clone(){return new Te(this.width,this.height,this.rowSize,this.bits.slice())}}class Q extends y{static getNotFoundInstance(){return new Q}}Q.kind="NotFoundException";class pe extends j{constructor(r){super(r),this.luminances=pe.EMPTY,this.buckets=new Int32Array(pe.LUMINANCE_BUCKETS)}getBlackRow(r,s){const a=this.getLuminanceSource(),u=a.getWidth();s==null||s.getSize()<u?s=new z(u):s.clear(),this.initArrays(u);const d=a.getRow(r,this.luminances),f=this.buckets;for(let w=0;w<u;w++)f[(d[w]&255)>>pe.LUMINANCE_SHIFT]++;const p=pe.estimateBlackPoint(f);if(u<3)for(let w=0;w<u;w++)(d[w]&255)<p&&s.set(w);else{let w=d[0]&255,b=d[1]&255;for(let A=1;A<u-1;A++){const O=d[A+1]&255;(b*4-w-O)/2<p&&s.set(A),w=b,b=O}}return s}getBlackMatrix(){const r=this.getLuminanceSource(),s=r.getWidth(),a=r.getHeight(),u=new Te(s,a);this.initArrays(s);const d=this.buckets;for(let w=1;w<5;w++){const b=Math.floor(a*w/5),A=r.getRow(b,this.luminances),O=Math.floor(s*4/5);for(let B=Math.floor(s/5);B<O;B++){const V=A[B]&255;d[V>>pe.LUMINANCE_SHIFT]++}}const f=pe.estimateBlackPoint(d),p=r.getMatrix();for(let w=0;w<a;w++){const b=w*s;for(let A=0;A<s;A++)(p[b+A]&255)<f&&u.set(A,w)}return u}createBinarizer(r){return new pe(r)}initArrays(r){this.luminances.length<r&&(this.luminances=new Uint8ClampedArray(r));const s=this.buckets;for(let a=0;a<pe.LUMINANCE_BUCKETS;a++)s[a]=0}static estimateBlackPoint(r){const s=r.length;let a=0,u=0,d=0;for(let A=0;A<s;A++)r[A]>d&&(u=A,d=r[A]),r[A]>a&&(a=r[A]);let f=0,p=0;for(let A=0;A<s;A++){const O=A-u,B=r[A]*O*O;B>p&&(f=A,p=B)}if(u>f){const A=u;u=f,f=A}if(f-u<=s/16)throw new Q;let w=f-1,b=-1;for(let A=f-1;A>u;A--){const O=A-u,B=O*O*(f-A)*(a-r[A]);B>b&&(w=A,b=B)}return w<<pe.LUMINANCE_SHIFT}}pe.LUMINANCE_BITS=5,pe.LUMINANCE_SHIFT=8-pe.LUMINANCE_BITS,pe.LUMINANCE_BUCKETS=1<<pe.LUMINANCE_BITS,pe.EMPTY=Uint8ClampedArray.from([0]);class ne extends pe{constructor(r){super(r),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const r=this.getLuminanceSource(),s=r.getWidth(),a=r.getHeight();if(s>=ne.MINIMUM_DIMENSION&&a>=ne.MINIMUM_DIMENSION){const u=r.getMatrix();let d=s>>ne.BLOCK_SIZE_POWER;s&ne.BLOCK_SIZE_MASK&&d++;let f=a>>ne.BLOCK_SIZE_POWER;a&ne.BLOCK_SIZE_MASK&&f++;const p=ne.calculateBlackPoints(u,d,f,s,a),w=new Te(s,a);ne.calculateThresholdForBlock(u,d,f,s,a,p,w),this.matrix=w}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(r){return new ne(r)}static calculateThresholdForBlock(r,s,a,u,d,f,p){const w=d-ne.BLOCK_SIZE,b=u-ne.BLOCK_SIZE;for(let A=0;A<a;A++){let O=A<<ne.BLOCK_SIZE_POWER;O>w&&(O=w);const B=ne.cap(A,2,a-3);for(let V=0;V<s;V++){let X=V<<ne.BLOCK_SIZE_POWER;X>b&&(X=b);const q=ne.cap(V,2,s-3);let ee=0;for(let xe=-2;xe<=2;xe++){const ye=f[B+xe];ee+=ye[q-2]+ye[q-1]+ye[q]+ye[q+1]+ye[q+2]}const se=ee/25;ne.thresholdBlock(r,X,O,se,u,p)}}}static cap(r,s,a){return r<s?s:r>a?a:r}static thresholdBlock(r,s,a,u,d,f){for(let p=0,w=a*d+s;p<ne.BLOCK_SIZE;p++,w+=d)for(let b=0;b<ne.BLOCK_SIZE;b++)(r[w+b]&255)<=u&&f.set(s+b,a+p)}static calculateBlackPoints(r,s,a,u,d){const f=d-ne.BLOCK_SIZE,p=u-ne.BLOCK_SIZE,w=new Array(a);for(let b=0;b<a;b++){w[b]=new Int32Array(s);let A=b<<ne.BLOCK_SIZE_POWER;A>f&&(A=f);for(let O=0;O<s;O++){let B=O<<ne.BLOCK_SIZE_POWER;B>p&&(B=p);let V=0,X=255,q=0;for(let se=0,xe=A*u+B;se<ne.BLOCK_SIZE;se++,xe+=u){for(let ye=0;ye<ne.BLOCK_SIZE;ye++){const ge=r[xe+ye]&255;V+=ge,ge<X&&(X=ge),ge>q&&(q=ge)}if(q-X>ne.MIN_DYNAMIC_RANGE)for(se++,xe+=u;se<ne.BLOCK_SIZE;se++,xe+=u)for(let ye=0;ye<ne.BLOCK_SIZE;ye++)V+=r[xe+ye]&255}let ee=V>>ne.BLOCK_SIZE_POWER*2;if(q-X<=ne.MIN_DYNAMIC_RANGE&&(ee=X/2,b>0&&O>0)){const se=(w[b-1][O]+2*w[b][O-1]+w[b-1][O-1])/4;X<se&&(ee=se)}w[b][O]=ee}}return w}}ne.BLOCK_SIZE_POWER=3,ne.BLOCK_SIZE=1<<ne.BLOCK_SIZE_POWER,ne.BLOCK_SIZE_MASK=ne.BLOCK_SIZE-1,ne.MINIMUM_DIMENSION=ne.BLOCK_SIZE*5,ne.MIN_DYNAMIC_RANGE=24;class K{constructor(r,s){this.width=r,this.height=s}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(r,s,a,u){throw new Ee("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new Ee("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new Ee("This luminance source does not support rotation by 45 degrees.")}toString(){const r=new Uint8ClampedArray(this.width);let s=new Ie;for(let a=0;a<this.height;a++){const u=this.getRow(a,r);for(let d=0;d<this.width;d++){const f=u[d]&255;let p;f<64?p="#":f<128?p="+":f<192?p=".":p=" ",s.append(p)}s.append(`
`)}return s.toString()}}class me extends K{constructor(r){super(r.getWidth(),r.getHeight()),this.delegate=r}getRow(r,s){const a=this.delegate.getRow(r,s),u=this.getWidth();for(let d=0;d<u;d++)a[d]=255-(a[d]&255);return a}getMatrix(){const r=this.delegate.getMatrix(),s=this.getWidth()*this.getHeight(),a=new Uint8ClampedArray(s);for(let u=0;u<s;u++)a[u]=255-(r[u]&255);return a}isCropSupported(){return this.delegate.isCropSupported()}crop(r,s,a,u){return new me(this.delegate.crop(r,s,a,u))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new me(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new me(this.delegate.rotateCounterClockwise45())}}class le extends K{constructor(r){super(r.width,r.height),this.canvas=r,this.tempCanvasElement=null,this.buffer=le.makeBufferFromCanvasImageData(r)}static makeBufferFromCanvasImageData(r){const s=r.getContext("2d").getImageData(0,0,r.width,r.height);return le.toGrayscaleBuffer(s.data,r.width,r.height)}static toGrayscaleBuffer(r,s,a){const u=new Uint8ClampedArray(s*a);for(let d=0,f=0,p=r.length;d<p;d+=4,f++){let w;if(r[d+3]===0)w=255;else{const A=r[d],O=r[d+1],B=r[d+2];w=306*A+601*O+117*B+512>>10}u[f]=w}return u}getRow(r,s){if(r<0||r>=this.getHeight())throw new E("Requested row is outside the image: "+r);const a=this.getWidth(),u=r*a;return s===null?s=this.buffer.slice(u,u+a):(s.length<a&&(s=new Uint8ClampedArray(a)),s.set(this.buffer.slice(u,u+a))),s}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(r,s,a,u){return super.crop(r,s,a,u),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const r=this.canvas.ownerDocument.createElement("canvas");r.width=this.canvas.width,r.height=this.canvas.height,this.tempCanvasElement=r}return this.tempCanvasElement}rotate(r){const s=this.getTempCanvasElement(),a=s.getContext("2d"),u=r*le.DEGREE_TO_RADIANS,d=this.canvas.width,f=this.canvas.height,p=Math.ceil(Math.abs(Math.cos(u))*d+Math.abs(Math.sin(u))*f),w=Math.ceil(Math.abs(Math.sin(u))*d+Math.abs(Math.cos(u))*f);return s.width=p,s.height=w,a.translate(p/2,w/2),a.rotate(u),a.drawImage(this.canvas,d/-2,f/-2),this.buffer=le.makeBufferFromCanvasImageData(s),this}invert(){return new me(this)}}le.DEGREE_TO_RADIANS=Math.PI/180;class be{constructor(r,s,a){this.deviceId=r,this.label=s,this.kind="videoinput",this.groupId=a||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var we=(globalThis||Sn||self||window||void 0)&&(globalThis||Sn||self||window||void 0).__awaiter||function(M,r,s,a){function u(d){return d instanceof s?d:new s(function(f){f(d)})}return new(s||(s=Promise))(function(d,f){function p(A){try{b(a.next(A))}catch(O){f(O)}}function w(A){try{b(a.throw(A))}catch(O){f(O)}}function b(A){A.done?d(A.value):u(A.value).then(p,w)}b((a=a.apply(M,r||[])).next())})};class Qe{constructor(r,s=500,a){this.reader=r,this.timeBetweenScansMillis=s,this._hints=a,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(r){this._timeBetweenDecodingAttempts=r<0?0:r}set hints(r){this._hints=r||null}get hints(){return this._hints}listVideoInputDevices(){return we(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const r=yield navigator.mediaDevices.enumerateDevices(),s=[];for(const a of r){const u=a.kind==="video"?"videoinput":a.kind;if(u!=="videoinput")continue;const d=a.deviceId||a.id,f=a.label||`Video device ${s.length+1}`,p=a.groupId,w={deviceId:d,label:f,kind:u,groupId:p};s.push(w)}return s})}getVideoInputDevices(){return we(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(s=>new be(s.deviceId,s.label))})}findDeviceById(r){return we(this,void 0,void 0,function*(){const s=yield this.listVideoInputDevices();return s?s.find(a=>a.deviceId===r):null})}decodeFromInputVideoDevice(r,s){return we(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(r,s)})}decodeOnceFromVideoDevice(r,s){return we(this,void 0,void 0,function*(){this.reset();let a;r?a={deviceId:{exact:r}}:a={facingMode:"environment"};const u={video:a};return yield this.decodeOnceFromConstraints(u,s)})}decodeOnceFromConstraints(r,s){return we(this,void 0,void 0,function*(){const a=yield navigator.mediaDevices.getUserMedia(r);return yield this.decodeOnceFromStream(a,s)})}decodeOnceFromStream(r,s){return we(this,void 0,void 0,function*(){this.reset();const a=yield this.attachStreamToVideo(r,s);return yield this.decodeOnce(a)})}decodeFromInputVideoDeviceContinuously(r,s,a){return we(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(r,s,a)})}decodeFromVideoDevice(r,s,a){return we(this,void 0,void 0,function*(){let u;r?u={deviceId:{exact:r}}:u={facingMode:"environment"};const d={video:u};return yield this.decodeFromConstraints(d,s,a)})}decodeFromConstraints(r,s,a){return we(this,void 0,void 0,function*(){const u=yield navigator.mediaDevices.getUserMedia(r);return yield this.decodeFromStream(u,s,a)})}decodeFromStream(r,s,a){return we(this,void 0,void 0,function*(){this.reset();const u=yield this.attachStreamToVideo(r,s);return yield this.decodeContinuously(u,a)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(r,s){return we(this,void 0,void 0,function*(){const a=this.prepareVideoElement(s);return this.addVideoSource(a,r),this.videoElement=a,this.stream=r,yield this.playVideoOnLoadAsync(a),a})}playVideoOnLoadAsync(r){return new Promise((s,a)=>this.playVideoOnLoad(r,()=>s()))}playVideoOnLoad(r,s){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(r),r.addEventListener("ended",this.videoEndedListener),r.addEventListener("canplay",this.videoCanPlayListener),r.addEventListener("playing",s),this.tryPlayVideo(r)}isVideoPlaying(r){return r.currentTime>0&&!r.paused&&!r.ended&&r.readyState>2}tryPlayVideo(r){return we(this,void 0,void 0,function*(){if(this.isVideoPlaying(r)){console.warn("Trying to play video that is already playing.");return}try{yield r.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(r,s){const a=document.getElementById(r);if(!a)throw new S(`element with id '${r}' not found`);if(a.nodeName.toLowerCase()!==s.toLowerCase())throw new S(`element with id '${r}' must be an ${s} element`);return a}decodeFromImage(r,s){if(!r&&!s)throw new S("either imageElement with a src set or an url must be provided");return s&&!r?this.decodeFromImageUrl(s):this.decodeFromImageElement(r)}decodeFromVideo(r,s){if(!r&&!s)throw new S("Either an element with a src set or an URL must be provided");return s&&!r?this.decodeFromVideoUrl(s):this.decodeFromVideoElement(r)}decodeFromVideoContinuously(r,s,a){if(r===void 0&&s===void 0)throw new S("Either an element with a src set or an URL must be provided");return s&&!r?this.decodeFromVideoUrlContinuously(s,a):this.decodeFromVideoElementContinuously(r,a)}decodeFromImageElement(r){if(!r)throw new S("An image element must be provided.");this.reset();const s=this.prepareImageElement(r);this.imageElement=s;let a;return this.isImageLoaded(s)?a=this.decodeOnce(s,!1,!0):a=this._decodeOnLoadImage(s),a}decodeFromVideoElement(r){const s=this._decodeFromVideoElementSetup(r);return this._decodeOnLoadVideo(s)}decodeFromVideoElementContinuously(r,s){const a=this._decodeFromVideoElementSetup(r);return this._decodeOnLoadVideoContinuously(a,s)}_decodeFromVideoElementSetup(r){if(!r)throw new S("A video element must be provided.");this.reset();const s=this.prepareVideoElement(r);return this.videoElement=s,s}decodeFromImageUrl(r){if(!r)throw new S("An URL must be provided.");this.reset();const s=this.prepareImageElement();this.imageElement=s;const a=this._decodeOnLoadImage(s);return s.src=r,a}decodeFromVideoUrl(r){if(!r)throw new S("An URL must be provided.");this.reset();const s=this.prepareVideoElement(),a=this.decodeFromVideoElement(s);return s.src=r,a}decodeFromVideoUrlContinuously(r,s){if(!r)throw new S("An URL must be provided.");this.reset();const a=this.prepareVideoElement(),u=this.decodeFromVideoElementContinuously(a,s);return a.src=r,u}_decodeOnLoadImage(r){return new Promise((s,a)=>{this.imageLoadedListener=()=>this.decodeOnce(r,!1,!0).then(s,a),r.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(r){return we(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(r),yield this.decodeOnce(r)})}_decodeOnLoadVideoContinuously(r,s){return we(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(r),this.decodeContinuously(r,s)})}isImageLoaded(r){return!(!r.complete||r.naturalWidth===0)}prepareImageElement(r){let s;return typeof r>"u"&&(s=document.createElement("img"),s.width=200,s.height=200),typeof r=="string"&&(s=this.getMediaElement(r,"img")),r instanceof HTMLImageElement&&(s=r),s}prepareVideoElement(r){let s;return!r&&typeof document<"u"&&(s=document.createElement("video"),s.width=200,s.height=200),typeof r=="string"&&(s=this.getMediaElement(r,"video")),r instanceof HTMLVideoElement&&(s=r),s.setAttribute("autoplay","true"),s.setAttribute("muted","true"),s.setAttribute("playsinline","true"),s}decodeOnce(r,s=!0,a=!0){this._stopAsyncDecode=!1;const u=(d,f)=>{if(this._stopAsyncDecode){f(new Q("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const p=this.decode(r);d(p)}catch(p){const w=s&&p instanceof Q,A=(p instanceof U||p instanceof Z)&&a;if(w||A)return setTimeout(u,this._timeBetweenDecodingAttempts,d,f);f(p)}};return new Promise((d,f)=>u(d,f))}decodeContinuously(r,s){this._stopContinuousDecode=!1;const a=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const u=this.decode(r);s(u,null),setTimeout(a,this.timeBetweenScansMillis)}catch(u){s(null,u);const d=u instanceof U||u instanceof Z,f=u instanceof Q;(d||f)&&setTimeout(a,this._timeBetweenDecodingAttempts)}};a()}decode(r){const s=this.createBinaryBitmap(r);return this.decodeBitmap(s)}_isHTMLVideoElement(r){return r.videoWidth!==0}drawFrameOnCanvas(r,s,a){s||(s={sx:0,sy:0,sWidth:r.videoWidth,sHeight:r.videoHeight,dx:0,dy:0,dWidth:r.videoWidth,dHeight:r.videoHeight}),a||(a=this.captureCanvasContext),a.drawImage(r,s.sx,s.sy,s.sWidth,s.sHeight,s.dx,s.dy,s.dWidth,s.dHeight)}drawImageOnCanvas(r,s,a=this.captureCanvasContext){s||(s={sx:0,sy:0,sWidth:r.naturalWidth,sHeight:r.naturalHeight,dx:0,dy:0,dWidth:r.naturalWidth,dHeight:r.naturalHeight}),a||(a=this.captureCanvasContext),a.drawImage(r,s.sx,s.sy,s.sWidth,s.sHeight,s.dx,s.dy,s.dWidth,s.dHeight)}createBinaryBitmap(r){this.getCaptureCanvasContext(r),this._isHTMLVideoElement(r)?this.drawFrameOnCanvas(r):this.drawImageOnCanvas(r);const s=this.getCaptureCanvas(r),a=new le(s),u=new ne(a);return new T(u)}getCaptureCanvasContext(r){if(!this.captureCanvasContext){const a=this.getCaptureCanvas(r).getContext("2d");this.captureCanvasContext=a}return this.captureCanvasContext}getCaptureCanvas(r){if(!this.captureCanvas){const s=this.createCaptureCanvas(r);this.captureCanvas=s}return this.captureCanvas}decodeBitmap(r){return this.reader.decode(r,this._hints)}createCaptureCanvas(r){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const s=document.createElement("canvas");let a,u;return typeof r<"u"&&(r instanceof HTMLVideoElement?(a=r.videoWidth,u=r.videoHeight):r instanceof HTMLImageElement&&(a=r.naturalWidth||r.width,u=r.naturalHeight||r.height)),s.style.width=a+"px",s.style.height=u+"px",s.width=a,s.height=u,s}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(r=>r.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(r,s){try{r.srcObject=s}catch{r.src=URL.createObjectURL(s)}}cleanVideoSource(r){try{r.srcObject=null}catch{r.src=""}this.videoElement.removeAttribute("src")}}class Fe{constructor(r,s,a=s==null?0:8*s.length,u,d,f=P.currentTimeMillis()){this.text=r,this.rawBytes=s,this.numBits=a,this.resultPoints=u,this.format=d,this.timestamp=f,this.text=r,this.rawBytes=s,a==null?this.numBits=s==null?0:8*s.length:this.numBits=a,this.resultPoints=u,this.format=d,this.resultMetadata=null,f==null?this.timestamp=P.currentTimeMillis():this.timestamp=f}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(r,s){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(r,s)}putAllMetadata(r){r!==null&&(this.resultMetadata===null?this.resultMetadata=r:this.resultMetadata=new Map(r))}addResultPoints(r){const s=this.resultPoints;if(s===null)this.resultPoints=r;else if(r!==null&&r.length>0){const a=new Array(s.length+r.length);P.arraycopy(s,0,a,0,s.length),P.arraycopy(r,0,a,s.length,r.length),this.resultPoints=a}}getTimestamp(){return this.timestamp}toString(){return this.text}}var Ve;(function(M){M[M.AZTEC=0]="AZTEC",M[M.CODABAR=1]="CODABAR",M[M.CODE_39=2]="CODE_39",M[M.CODE_93=3]="CODE_93",M[M.CODE_128=4]="CODE_128",M[M.DATA_MATRIX=5]="DATA_MATRIX",M[M.EAN_8=6]="EAN_8",M[M.EAN_13=7]="EAN_13",M[M.ITF=8]="ITF",M[M.MAXICODE=9]="MAXICODE",M[M.PDF_417=10]="PDF_417",M[M.QR_CODE=11]="QR_CODE",M[M.RSS_14=12]="RSS_14",M[M.RSS_EXPANDED=13]="RSS_EXPANDED",M[M.UPC_A=14]="UPC_A",M[M.UPC_E=15]="UPC_E",M[M.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Ve||(Ve={}));var fe=Ve,je;(function(M){M[M.OTHER=0]="OTHER",M[M.ORIENTATION=1]="ORIENTATION",M[M.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",M[M.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",M[M.ISSUE_NUMBER=4]="ISSUE_NUMBER",M[M.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",M[M.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",M[M.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",M[M.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",M[M.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",M[M.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(je||(je={}));var Je=je;class Nn{constructor(r,s,a,u,d=-1,f=-1){this.rawBytes=r,this.text=s,this.byteSegments=a,this.ecLevel=u,this.structuredAppendSequenceNumber=d,this.structuredAppendParity=f,this.numBits=r==null?0:8*r.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(r){this.numBits=r}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(r){this.errorsCorrected=r}getErasures(){return this.erasures}setErasures(r){this.erasures=r}getOther(){return this.other}setOther(r){this.other=r}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class Ue{exp(r){return this.expTable[r]}log(r){if(r===0)throw new E;return this.logTable[r]}static addOrSubtract(r,s){return r^s}}class tt{constructor(r,s){if(s.length===0)throw new E;this.field=r;const a=s.length;if(a>1&&s[0]===0){let u=1;for(;u<a&&s[u]===0;)u++;u===a?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(a-u),P.arraycopy(s,u,this.coefficients,0,this.coefficients.length))}else this.coefficients=s}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(r){return this.coefficients[this.coefficients.length-1-r]}evaluateAt(r){if(r===0)return this.getCoefficient(0);const s=this.coefficients;let a;if(r===1){a=0;for(let f=0,p=s.length;f!==p;f++){const w=s[f];a=Ue.addOrSubtract(a,w)}return a}a=s[0];const u=s.length,d=this.field;for(let f=1;f<u;f++)a=Ue.addOrSubtract(d.multiply(r,a),s[f]);return a}addOrSubtract(r){if(!this.field.equals(r.field))throw new E("GenericGFPolys do not have same GenericGF field");if(this.isZero())return r;if(r.isZero())return this;let s=this.coefficients,a=r.coefficients;if(s.length>a.length){const f=s;s=a,a=f}let u=new Int32Array(a.length);const d=a.length-s.length;P.arraycopy(a,0,u,0,d);for(let f=d;f<a.length;f++)u[f]=Ue.addOrSubtract(s[f-d],a[f]);return new tt(this.field,u)}multiply(r){if(!this.field.equals(r.field))throw new E("GenericGFPolys do not have same GenericGF field");if(this.isZero()||r.isZero())return this.field.getZero();const s=this.coefficients,a=s.length,u=r.coefficients,d=u.length,f=new Int32Array(a+d-1),p=this.field;for(let w=0;w<a;w++){const b=s[w];for(let A=0;A<d;A++)f[w+A]=Ue.addOrSubtract(f[w+A],p.multiply(b,u[A]))}return new tt(p,f)}multiplyScalar(r){if(r===0)return this.field.getZero();if(r===1)return this;const s=this.coefficients.length,a=this.field,u=new Int32Array(s),d=this.coefficients;for(let f=0;f<s;f++)u[f]=a.multiply(d[f],r);return new tt(a,u)}multiplyByMonomial(r,s){if(r<0)throw new E;if(s===0)return this.field.getZero();const a=this.coefficients,u=a.length,d=new Int32Array(u+r),f=this.field;for(let p=0;p<u;p++)d[p]=f.multiply(a[p],s);return new tt(f,d)}divide(r){if(!this.field.equals(r.field))throw new E("GenericGFPolys do not have same GenericGF field");if(r.isZero())throw new E("Divide by 0");const s=this.field;let a=s.getZero(),u=this;const d=r.getCoefficient(r.getDegree()),f=s.inverse(d);for(;u.getDegree()>=r.getDegree()&&!u.isZero();){const p=u.getDegree()-r.getDegree(),w=s.multiply(u.getCoefficient(u.getDegree()),f),b=r.multiplyByMonomial(p,w),A=s.buildMonomial(p,w);a=a.addOrSubtract(A),u=u.addOrSubtract(b)}return[a,u]}toString(){let r="";for(let s=this.getDegree();s>=0;s--){let a=this.getCoefficient(s);if(a!==0){if(a<0?(r+=" - ",a=-a):r.length>0&&(r+=" + "),s===0||a!==1){const u=this.field.log(a);u===0?r+="1":u===1?r+="a":(r+="a^",r+=u)}s!==0&&(s===1?r+="x":(r+="x^",r+=s))}}return r}}class gt extends y{}gt.kind="ArithmeticException";class Le extends Ue{constructor(r,s,a){super(),this.primitive=r,this.size=s,this.generatorBase=a;const u=new Int32Array(s);let d=1;for(let p=0;p<s;p++)u[p]=d,d*=2,d>=s&&(d^=r,d&=s-1);this.expTable=u;const f=new Int32Array(s);for(let p=0;p<s-1;p++)f[u[p]]=p;this.logTable=f,this.zero=new tt(this,Int32Array.from([0])),this.one=new tt(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(r,s){if(r<0)throw new E;if(s===0)return this.zero;const a=new Int32Array(r+1);return a[0]=s,new tt(this,a)}inverse(r){if(r===0)throw new gt;return this.expTable[this.size-this.logTable[r]-1]}multiply(r,s){return r===0||s===0?0:this.expTable[(this.logTable[r]+this.logTable[s])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+k.toHexString(this.primitive)+","+this.size+")"}equals(r){return r===this}}Le.AZTEC_DATA_12=new Le(4201,4096,1),Le.AZTEC_DATA_10=new Le(1033,1024,1),Le.AZTEC_DATA_6=new Le(67,64,1),Le.AZTEC_PARAM=new Le(19,16,1),Le.QR_CODE_FIELD_256=new Le(285,256,0),Le.DATA_MATRIX_FIELD_256=new Le(301,256,1),Le.AZTEC_DATA_8=Le.DATA_MATRIX_FIELD_256,Le.MAXICODE_FIELD_64=Le.AZTEC_DATA_6;class yt extends y{}yt.kind="ReedSolomonException";class Ot extends y{}Ot.kind="IllegalStateException";class Ze{constructor(r){this.field=r}decode(r,s){const a=this.field,u=new tt(a,r),d=new Int32Array(s);let f=!0;for(let V=0;V<s;V++){const X=u.evaluateAt(a.exp(V+a.getGeneratorBase()));d[d.length-1-V]=X,X!==0&&(f=!1)}if(f)return;const p=new tt(a,d),w=this.runEuclideanAlgorithm(a.buildMonomial(s,1),p,s),b=w[0],A=w[1],O=this.findErrorLocations(b),B=this.findErrorMagnitudes(A,O);for(let V=0;V<O.length;V++){const X=r.length-1-a.log(O[V]);if(X<0)throw new yt("Bad error location");r[X]=Le.addOrSubtract(r[X],B[V])}}runEuclideanAlgorithm(r,s,a){if(r.getDegree()<s.getDegree()){const V=r;r=s,s=V}const u=this.field;let d=r,f=s,p=u.getZero(),w=u.getOne();for(;f.getDegree()>=(a/2|0);){let V=d,X=p;if(d=f,p=w,d.isZero())throw new yt("r_{i-1} was zero");f=V;let q=u.getZero();const ee=d.getCoefficient(d.getDegree()),se=u.inverse(ee);for(;f.getDegree()>=d.getDegree()&&!f.isZero();){const xe=f.getDegree()-d.getDegree(),ye=u.multiply(f.getCoefficient(f.getDegree()),se);q=q.addOrSubtract(u.buildMonomial(xe,ye)),f=f.addOrSubtract(d.multiplyByMonomial(xe,ye))}if(w=q.multiply(p).addOrSubtract(X),f.getDegree()>=d.getDegree())throw new Ot("Division algorithm failed to reduce polynomial?")}const b=w.getCoefficient(0);if(b===0)throw new yt("sigmaTilde(0) was zero");const A=u.inverse(b),O=w.multiplyScalar(A),B=f.multiplyScalar(A);return[O,B]}findErrorLocations(r){const s=r.getDegree();if(s===1)return Int32Array.from([r.getCoefficient(1)]);const a=new Int32Array(s);let u=0;const d=this.field;for(let f=1;f<d.getSize()&&u<s;f++)r.evaluateAt(f)===0&&(a[u]=d.inverse(f),u++);if(u!==s)throw new yt("Error locator degree does not match number of roots");return a}findErrorMagnitudes(r,s){const a=s.length,u=new Int32Array(a),d=this.field;for(let f=0;f<a;f++){const p=d.inverse(s[f]);let w=1;for(let b=0;b<a;b++)if(f!==b){const A=d.multiply(s[b],p),O=A&1?A&-2:A|1;w=d.multiply(w,O)}u[f]=d.multiply(r.evaluateAt(p),d.inverse(w)),d.getGeneratorBase()!==0&&(u[f]=d.multiply(u[f],p))}return u}}var nt;(function(M){M[M.UPPER=0]="UPPER",M[M.LOWER=1]="LOWER",M[M.MIXED=2]="MIXED",M[M.DIGIT=3]="DIGIT",M[M.PUNCT=4]="PUNCT",M[M.BINARY=5]="BINARY"})(nt||(nt={}));class qe{decode(r){this.ddata=r;let s=r.getBits(),a=this.extractBits(s),u=this.correctBits(a),d=qe.convertBoolArrayToByteArray(u),f=qe.getEncodedData(u),p=new Nn(d,f,null,null);return p.setNumBits(u.length),p}static highLevelDecode(r){return this.getEncodedData(r)}static getEncodedData(r){let s=r.length,a=nt.UPPER,u=nt.UPPER,d="",f=0;for(;f<s;)if(u===nt.BINARY){if(s-f<5)break;let p=qe.readCode(r,f,5);if(f+=5,p===0){if(s-f<11)break;p=qe.readCode(r,f,11)+31,f+=11}for(let w=0;w<p;w++){if(s-f<8){f=s;break}const b=qe.readCode(r,f,8);d+=ue.castAsNonUtf8Char(b),f+=8}u=a}else{let p=u===nt.DIGIT?4:5;if(s-f<p)break;let w=qe.readCode(r,f,p);f+=p;let b=qe.getCharacter(u,w);b.startsWith("CTRL_")?(a=u,u=qe.getTable(b.charAt(5)),b.charAt(6)==="L"&&(a=u)):(d+=b,u=a)}return d}static getTable(r){switch(r){case"L":return nt.LOWER;case"P":return nt.PUNCT;case"M":return nt.MIXED;case"D":return nt.DIGIT;case"B":return nt.BINARY;case"U":default:return nt.UPPER}}static getCharacter(r,s){switch(r){case nt.UPPER:return qe.UPPER_TABLE[s];case nt.LOWER:return qe.LOWER_TABLE[s];case nt.MIXED:return qe.MIXED_TABLE[s];case nt.PUNCT:return qe.PUNCT_TABLE[s];case nt.DIGIT:return qe.DIGIT_TABLE[s];default:throw new Ot("Bad table")}}correctBits(r){let s,a;this.ddata.getNbLayers()<=2?(a=6,s=Le.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(a=8,s=Le.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(a=10,s=Le.AZTEC_DATA_10):(a=12,s=Le.AZTEC_DATA_12);let u=this.ddata.getNbDatablocks(),d=r.length/a;if(d<u)throw new Z;let f=r.length%a,p=new Int32Array(d);for(let B=0;B<d;B++,f+=a)p[B]=qe.readCode(r,f,a);try{new Ze(s).decode(p,d-u)}catch(B){throw new Z(B)}let w=(1<<a)-1,b=0;for(let B=0;B<u;B++){let V=p[B];if(V===0||V===w)throw new Z;(V===1||V===w-1)&&b++}let A=new Array(u*a-b),O=0;for(let B=0;B<u;B++){let V=p[B];if(V===1||V===w-1)A.fill(V>1,O,O+a-1),O+=a-1;else for(let X=a-1;X>=0;--X)A[O++]=(V&1<<X)!==0}return A}extractBits(r){let s=this.ddata.isCompact(),a=this.ddata.getNbLayers(),u=(s?11:14)+a*4,d=new Int32Array(u),f=new Array(this.totalBitsInLayer(a,s));if(s)for(let p=0;p<d.length;p++)d[p]=p;else{let p=u+1+2*k.truncDivision(k.truncDivision(u,2)-1,15),w=u/2,b=k.truncDivision(p,2);for(let A=0;A<w;A++){let O=A+k.truncDivision(A,15);d[w-A-1]=b-O-1,d[w+A]=b+O+1}}for(let p=0,w=0;p<a;p++){let b=(a-p)*4+(s?9:12),A=p*2,O=u-1-A;for(let B=0;B<b;B++){let V=B*2;for(let X=0;X<2;X++)f[w+V+X]=r.get(d[A+X],d[A+B]),f[w+2*b+V+X]=r.get(d[A+B],d[O-X]),f[w+4*b+V+X]=r.get(d[O-X],d[O-B]),f[w+6*b+V+X]=r.get(d[O-B],d[A+X])}w+=b*8}return f}static readCode(r,s,a){let u=0;for(let d=s;d<s+a;d++)u<<=1,r[d]&&(u|=1);return u}static readByte(r,s){let a=r.length-s;return a>=8?qe.readCode(r,s,8):qe.readCode(r,s,a)<<8-a}static convertBoolArrayToByteArray(r){let s=new Uint8Array((r.length+7)/8);for(let a=0;a<s.length;a++)s[a]=qe.readByte(r,8*a);return s}totalBitsInLayer(r,s){return((s?88:112)+16*r)*r}}qe.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],qe.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],qe.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],qe.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],qe.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class Ge{constructor(){}static round(r){return r===NaN?0:r<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:r>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:r+(r<0?-.5:.5)|0}static distance(r,s,a,u){const d=r-a,f=s-u;return Math.sqrt(d*d+f*f)}static sum(r){let s=0;for(let a=0,u=r.length;a!==u;a++){const d=r[a];s+=d}return s}}class xi{static floatToIntBits(r){return r}}xi.MAX_VALUE=Number.MAX_SAFE_INTEGER;class ke{constructor(r,s){this.x=r,this.y=s}getX(){return this.x}getY(){return this.y}equals(r){if(r instanceof ke){const s=r;return this.x===s.x&&this.y===s.y}return!1}hashCode(){return 31*xi.floatToIntBits(this.x)+xi.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(r){const s=this.distance(r[0],r[1]),a=this.distance(r[1],r[2]),u=this.distance(r[0],r[2]);let d,f,p;if(a>=s&&a>=u?(f=r[0],d=r[1],p=r[2]):u>=a&&u>=s?(f=r[1],d=r[0],p=r[2]):(f=r[2],d=r[0],p=r[1]),this.crossProductZ(d,f,p)<0){const w=d;d=p,p=w}r[0]=d,r[1]=f,r[2]=p}static distance(r,s){return Ge.distance(r.x,r.y,s.x,s.y)}static crossProductZ(r,s,a){const u=s.x,d=s.y;return(a.x-u)*(r.y-d)-(a.y-d)*(r.x-u)}}class dr{constructor(r,s){this.bits=r,this.points=s}getBits(){return this.bits}getPoints(){return this.points}}class yi extends dr{constructor(r,s,a,u,d){super(r,s),this.compact=a,this.nbDatablocks=u,this.nbLayers=d}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class Sr{constructor(r,s,a,u){this.image=r,this.height=r.getHeight(),this.width=r.getWidth(),s==null&&(s=Sr.INIT_SIZE),a==null&&(a=r.getWidth()/2|0),u==null&&(u=r.getHeight()/2|0);const d=s/2|0;if(this.leftInit=a-d,this.rightInit=a+d,this.upInit=u-d,this.downInit=u+d,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new Q}detect(){let r=this.leftInit,s=this.rightInit,a=this.upInit,u=this.downInit,d=!1,f=!0,p=!1,w=!1,b=!1,A=!1,O=!1;const B=this.width,V=this.height;for(;f;){f=!1;let X=!0;for(;(X||!w)&&s<B;)X=this.containsBlackPoint(a,u,s,!1),X?(s++,f=!0,w=!0):w||s++;if(s>=B){d=!0;break}let q=!0;for(;(q||!b)&&u<V;)q=this.containsBlackPoint(r,s,u,!0),q?(u++,f=!0,b=!0):b||u++;if(u>=V){d=!0;break}let ee=!0;for(;(ee||!A)&&r>=0;)ee=this.containsBlackPoint(a,u,r,!1),ee?(r--,f=!0,A=!0):A||r--;if(r<0){d=!0;break}let se=!0;for(;(se||!O)&&a>=0;)se=this.containsBlackPoint(r,s,a,!0),se?(a--,f=!0,O=!0):O||a--;if(a<0){d=!0;break}f&&(p=!0)}if(!d&&p){const X=s-r;let q=null;for(let ye=1;q===null&&ye<X;ye++)q=this.getBlackPointOnSegment(r,u-ye,r+ye,u);if(q==null)throw new Q;let ee=null;for(let ye=1;ee===null&&ye<X;ye++)ee=this.getBlackPointOnSegment(r,a+ye,r+ye,a);if(ee==null)throw new Q;let se=null;for(let ye=1;se===null&&ye<X;ye++)se=this.getBlackPointOnSegment(s,a+ye,s-ye,a);if(se==null)throw new Q;let xe=null;for(let ye=1;xe===null&&ye<X;ye++)xe=this.getBlackPointOnSegment(s,u-ye,s-ye,u);if(xe==null)throw new Q;return this.centerEdges(xe,q,se,ee)}else throw new Q}getBlackPointOnSegment(r,s,a,u){const d=Ge.round(Ge.distance(r,s,a,u)),f=(a-r)/d,p=(u-s)/d,w=this.image;for(let b=0;b<d;b++){const A=Ge.round(r+b*f),O=Ge.round(s+b*p);if(w.get(A,O))return new ke(A,O)}return null}centerEdges(r,s,a,u){const d=r.getX(),f=r.getY(),p=s.getX(),w=s.getY(),b=a.getX(),A=a.getY(),O=u.getX(),B=u.getY(),V=Sr.CORR;return d<this.width/2?[new ke(O-V,B+V),new ke(p+V,w+V),new ke(b-V,A-V),new ke(d+V,f-V)]:[new ke(O+V,B+V),new ke(p+V,w-V),new ke(b-V,A+V),new ke(d-V,f-V)]}containsBlackPoint(r,s,a,u){const d=this.image;if(u){for(let f=r;f<=s;f++)if(d.get(f,a))return!0}else for(let f=r;f<=s;f++)if(d.get(a,f))return!0;return!1}}Sr.INIT_SIZE=10,Sr.CORR=1;class Hi{static checkAndNudgePoints(r,s){const a=r.getWidth(),u=r.getHeight();let d=!0;for(let f=0;f<s.length&&d;f+=2){const p=Math.floor(s[f]),w=Math.floor(s[f+1]);if(p<-1||p>a||w<-1||w>u)throw new Q;d=!1,p===-1?(s[f]=0,d=!0):p===a&&(s[f]=a-1,d=!0),w===-1?(s[f+1]=0,d=!0):w===u&&(s[f+1]=u-1,d=!0)}d=!0;for(let f=s.length-2;f>=0&&d;f-=2){const p=Math.floor(s[f]),w=Math.floor(s[f+1]);if(p<-1||p>a||w<-1||w>u)throw new Q;d=!1,p===-1?(s[f]=0,d=!0):p===a&&(s[f]=a-1,d=!0),w===-1?(s[f+1]=0,d=!0):w===u&&(s[f+1]=u-1,d=!0)}}}class rt{constructor(r,s,a,u,d,f,p,w,b){this.a11=r,this.a21=s,this.a31=a,this.a12=u,this.a22=d,this.a32=f,this.a13=p,this.a23=w,this.a33=b}static quadrilateralToQuadrilateral(r,s,a,u,d,f,p,w,b,A,O,B,V,X,q,ee){const se=rt.quadrilateralToSquare(r,s,a,u,d,f,p,w);return rt.squareToQuadrilateral(b,A,O,B,V,X,q,ee).times(se)}transformPoints(r){const s=r.length,a=this.a11,u=this.a12,d=this.a13,f=this.a21,p=this.a22,w=this.a23,b=this.a31,A=this.a32,O=this.a33;for(let B=0;B<s;B+=2){const V=r[B],X=r[B+1],q=d*V+w*X+O;r[B]=(a*V+f*X+b)/q,r[B+1]=(u*V+p*X+A)/q}}transformPointsWithValues(r,s){const a=this.a11,u=this.a12,d=this.a13,f=this.a21,p=this.a22,w=this.a23,b=this.a31,A=this.a32,O=this.a33,B=r.length;for(let V=0;V<B;V++){const X=r[V],q=s[V],ee=d*X+w*q+O;r[V]=(a*X+f*q+b)/ee,s[V]=(u*X+p*q+A)/ee}}static squareToQuadrilateral(r,s,a,u,d,f,p,w){const b=r-a+d-p,A=s-u+f-w;if(b===0&&A===0)return new rt(a-r,d-a,r,u-s,f-u,s,0,0,1);{const O=a-d,B=p-d,V=u-f,X=w-f,q=O*X-B*V,ee=(b*X-B*A)/q,se=(O*A-b*V)/q;return new rt(a-r+ee*a,p-r+se*p,r,u-s+ee*u,w-s+se*w,s,ee,se,1)}}static quadrilateralToSquare(r,s,a,u,d,f,p,w){return rt.squareToQuadrilateral(r,s,a,u,d,f,p,w).buildAdjoint()}buildAdjoint(){return new rt(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(r){return new rt(this.a11*r.a11+this.a21*r.a12+this.a31*r.a13,this.a11*r.a21+this.a21*r.a22+this.a31*r.a23,this.a11*r.a31+this.a21*r.a32+this.a31*r.a33,this.a12*r.a11+this.a22*r.a12+this.a32*r.a13,this.a12*r.a21+this.a22*r.a22+this.a32*r.a23,this.a12*r.a31+this.a22*r.a32+this.a32*r.a33,this.a13*r.a11+this.a23*r.a12+this.a33*r.a13,this.a13*r.a21+this.a23*r.a22+this.a33*r.a23,this.a13*r.a31+this.a23*r.a32+this.a33*r.a33)}}class Tn extends Hi{sampleGrid(r,s,a,u,d,f,p,w,b,A,O,B,V,X,q,ee,se,xe,ye){const ge=rt.quadrilateralToQuadrilateral(u,d,f,p,w,b,A,O,B,V,X,q,ee,se,xe,ye);return this.sampleGridWithTransform(r,s,a,ge)}sampleGridWithTransform(r,s,a,u){if(s<=0||a<=0)throw new Q;const d=new Te(s,a),f=new Float32Array(2*s);for(let p=0;p<a;p++){const w=f.length,b=p+.5;for(let A=0;A<w;A+=2)f[A]=A/2+.5,f[A+1]=b;u.transformPoints(f),Hi.checkAndNudgePoints(r,f);try{for(let A=0;A<w;A+=2)r.get(Math.floor(f[A]),Math.floor(f[A+1]))&&d.set(A/2,p)}catch{throw new Q}}return d}}class In{static setGridSampler(r){In.gridSampler=r}static getInstance(){return In.gridSampler}}In.gridSampler=new Tn;class en{constructor(r,s){this.x=r,this.y=s}toResultPoint(){return new ke(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class rn{constructor(r){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=r}detect(){return this.detectMirror(!1)}detectMirror(r){let s=this.getMatrixCenter(),a=this.getBullsEyeCorners(s);if(r){let f=a[0];a[0]=a[2],a[2]=f}this.extractParameters(a);let u=this.sampleGrid(this.image,a[this.shift%4],a[(this.shift+1)%4],a[(this.shift+2)%4],a[(this.shift+3)%4]),d=this.getMatrixCornerPoints(a);return new yi(u,d,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(r){if(!this.isValidPoint(r[0])||!this.isValidPoint(r[1])||!this.isValidPoint(r[2])||!this.isValidPoint(r[3]))throw new Q;let s=2*this.nbCenterLayers,a=new Int32Array([this.sampleLine(r[0],r[1],s),this.sampleLine(r[1],r[2],s),this.sampleLine(r[2],r[3],s),this.sampleLine(r[3],r[0],s)]);this.shift=this.getRotation(a,s);let u=0;for(let f=0;f<4;f++){let p=a[(this.shift+f)%4];this.compact?(u<<=7,u+=p>>1&127):(u<<=10,u+=(p>>2&992)+(p>>1&31))}let d=this.getCorrectedParameterData(u,this.compact);this.compact?(this.nbLayers=(d>>6)+1,this.nbDataBlocks=(d&63)+1):(this.nbLayers=(d>>11)+1,this.nbDataBlocks=(d&2047)+1)}getRotation(r,s){let a=0;r.forEach((u,d,f)=>{let p=(u>>s-2<<1)+(u&1);a=(a<<3)+p}),a=((a&1)<<11)+(a>>1);for(let u=0;u<4;u++)if(k.bitCount(a^this.EXPECTED_CORNER_BITS[u])<=2)return u;throw new Q}getCorrectedParameterData(r,s){let a,u;s?(a=7,u=2):(a=10,u=4);let d=a-u,f=new Int32Array(a);for(let w=a-1;w>=0;--w)f[w]=r&15,r>>=4;try{new Ze(Le.AZTEC_PARAM).decode(f,d)}catch{throw new Q}let p=0;for(let w=0;w<u;w++)p=(p<<4)+f[w];return p}getBullsEyeCorners(r){let s=r,a=r,u=r,d=r,f=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let O=this.getFirstDifferent(s,f,1,-1),B=this.getFirstDifferent(a,f,1,1),V=this.getFirstDifferent(u,f,-1,1),X=this.getFirstDifferent(d,f,-1,-1);if(this.nbCenterLayers>2){let q=this.distancePoint(X,O)*this.nbCenterLayers/(this.distancePoint(d,s)*(this.nbCenterLayers+2));if(q<.75||q>1.25||!this.isWhiteOrBlackRectangle(O,B,V,X))break}s=O,a=B,u=V,d=X,f=!f}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new Q;this.compact=this.nbCenterLayers===5;let p=new ke(s.getX()+.5,s.getY()-.5),w=new ke(a.getX()+.5,a.getY()+.5),b=new ke(u.getX()-.5,u.getY()+.5),A=new ke(d.getX()-.5,d.getY()-.5);return this.expandSquare([p,w,b,A],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let r,s,a,u;try{let p=new Sr(this.image).detect();r=p[0],s=p[1],a=p[2],u=p[3]}catch{let w=this.image.getWidth()/2,b=this.image.getHeight()/2;r=this.getFirstDifferent(new en(w+7,b-7),!1,1,-1).toResultPoint(),s=this.getFirstDifferent(new en(w+7,b+7),!1,1,1).toResultPoint(),a=this.getFirstDifferent(new en(w-7,b+7),!1,-1,1).toResultPoint(),u=this.getFirstDifferent(new en(w-7,b-7),!1,-1,-1).toResultPoint()}let d=Ge.round((r.getX()+u.getX()+s.getX()+a.getX())/4),f=Ge.round((r.getY()+u.getY()+s.getY()+a.getY())/4);try{let p=new Sr(this.image,15,d,f).detect();r=p[0],s=p[1],a=p[2],u=p[3]}catch{r=this.getFirstDifferent(new en(d+7,f-7),!1,1,-1).toResultPoint(),s=this.getFirstDifferent(new en(d+7,f+7),!1,1,1).toResultPoint(),a=this.getFirstDifferent(new en(d-7,f+7),!1,-1,1).toResultPoint(),u=this.getFirstDifferent(new en(d-7,f-7),!1,-1,-1).toResultPoint()}return d=Ge.round((r.getX()+u.getX()+s.getX()+a.getX())/4),f=Ge.round((r.getY()+u.getY()+s.getY()+a.getY())/4),new en(d,f)}getMatrixCornerPoints(r){return this.expandSquare(r,2*this.nbCenterLayers,this.getDimension())}sampleGrid(r,s,a,u,d){let f=In.getInstance(),p=this.getDimension(),w=p/2-this.nbCenterLayers,b=p/2+this.nbCenterLayers;return f.sampleGrid(r,p,p,w,w,b,w,b,b,w,b,s.getX(),s.getY(),a.getX(),a.getY(),u.getX(),u.getY(),d.getX(),d.getY())}sampleLine(r,s,a){let u=0,d=this.distanceResultPoint(r,s),f=d/a,p=r.getX(),w=r.getY(),b=f*(s.getX()-r.getX())/d,A=f*(s.getY()-r.getY())/d;for(let O=0;O<a;O++)this.image.get(Ge.round(p+O*b),Ge.round(w+O*A))&&(u|=1<<a-O-1);return u}isWhiteOrBlackRectangle(r,s,a,u){let d=3;r=new en(r.getX()-d,r.getY()+d),s=new en(s.getX()-d,s.getY()-d),a=new en(a.getX()+d,a.getY()-d),u=new en(u.getX()+d,u.getY()+d);let f=this.getColor(u,r);if(f===0)return!1;let p=this.getColor(r,s);return p!==f||(p=this.getColor(s,a),p!==f)?!1:(p=this.getColor(a,u),p===f)}getColor(r,s){let a=this.distancePoint(r,s),u=(s.getX()-r.getX())/a,d=(s.getY()-r.getY())/a,f=0,p=r.getX(),w=r.getY(),b=this.image.get(r.getX(),r.getY()),A=Math.ceil(a);for(let B=0;B<A;B++)p+=u,w+=d,this.image.get(Ge.round(p),Ge.round(w))!==b&&f++;let O=f/a;return O>.1&&O<.9?0:O<=.1===b?1:-1}getFirstDifferent(r,s,a,u){let d=r.getX()+a,f=r.getY()+u;for(;this.isValid(d,f)&&this.image.get(d,f)===s;)d+=a,f+=u;for(d-=a,f-=u;this.isValid(d,f)&&this.image.get(d,f)===s;)d+=a;for(d-=a;this.isValid(d,f)&&this.image.get(d,f)===s;)f+=u;return f-=u,new en(d,f)}expandSquare(r,s,a){let u=a/(2*s),d=r[0].getX()-r[2].getX(),f=r[0].getY()-r[2].getY(),p=(r[0].getX()+r[2].getX())/2,w=(r[0].getY()+r[2].getY())/2,b=new ke(p+u*d,w+u*f),A=new ke(p-u*d,w-u*f);d=r[1].getX()-r[3].getX(),f=r[1].getY()-r[3].getY(),p=(r[1].getX()+r[3].getX())/2,w=(r[1].getY()+r[3].getY())/2;let O=new ke(p+u*d,w+u*f),B=new ke(p-u*d,w-u*f);return[b,O,A,B]}isValid(r,s){return r>=0&&r<this.image.getWidth()&&s>0&&s<this.image.getHeight()}isValidPoint(r){let s=Ge.round(r.getX()),a=Ge.round(r.getY());return this.isValid(s,a)}distancePoint(r,s){return Ge.distance(r.getX(),r.getY(),s.getX(),s.getY())}distanceResultPoint(r,s){return Ge.distance(r.getX(),r.getY(),s.getX(),s.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(k.truncDivision(this.nbLayers-4,8)+1)+15}}class tr{decode(r,s=null){let a=null,u=new rn(r.getBlackMatrix()),d=null,f=null;try{let A=u.detectMirror(!1);d=A.getPoints(),this.reportFoundResultPoints(s,d),f=new qe().decode(A)}catch(A){a=A}if(f==null)try{let A=u.detectMirror(!0);d=A.getPoints(),this.reportFoundResultPoints(s,d),f=new qe().decode(A)}catch(A){throw a??A}let p=new Fe(f.getText(),f.getRawBytes(),f.getNumBits(),d,fe.AZTEC,P.currentTimeMillis()),w=f.getByteSegments();w!=null&&p.putMetadata(Je.BYTE_SEGMENTS,w);let b=f.getECLevel();return b!=null&&p.putMetadata(Je.ERROR_CORRECTION_LEVEL,b),p}reportFoundResultPoints(r,s){if(r!=null){let a=r.get(Y.NEED_RESULT_POINT_CALLBACK);a!=null&&s.forEach((u,d,f)=>{a.foundPossibleResultPoint(u)})}}reset(){}}class zn extends Qe{constructor(r=500){super(new tr,r)}}class _t{decode(r,s){try{return this.doDecode(r,s)}catch{if(s&&s.get(Y.TRY_HARDER)===!0&&r.isRotateSupported()){const d=r.rotateCounterClockwise(),f=this.doDecode(d,s),p=f.getResultMetadata();let w=270;p!==null&&p.get(Je.ORIENTATION)===!0&&(w=w+p.get(Je.ORIENTATION)%360),f.putMetadata(Je.ORIENTATION,w);const b=f.getResultPoints();if(b!==null){const A=d.getHeight();for(let O=0;O<b.length;O++)b[O]=new ke(A-b[O].getY()-1,b[O].getX())}return f}else throw new Q}}reset(){}doDecode(r,s){const a=r.getWidth(),u=r.getHeight();let d=new z(a);const f=s&&s.get(Y.TRY_HARDER)===!0,p=Math.max(1,u>>(f?8:5));let w;f?w=u:w=15;const b=Math.trunc(u/2);for(let A=0;A<w;A++){const O=Math.trunc((A+1)/2),B=(A&1)===0,V=b+p*(B?O:-O);if(V<0||V>=u)break;try{d=r.getBlackRow(V,d)}catch{continue}for(let X=0;X<2;X++){if(X===1&&(d.reverse(),s&&s.get(Y.NEED_RESULT_POINT_CALLBACK)===!0)){const q=new Map;s.forEach((ee,se)=>q.set(se,ee)),q.delete(Y.NEED_RESULT_POINT_CALLBACK),s=q}try{const q=this.decodeRow(V,d,s);if(X===1){q.putMetadata(Je.ORIENTATION,180);const ee=q.getResultPoints();ee!==null&&(ee[0]=new ke(a-ee[0].getX()-1,ee[0].getY()),ee[1]=new ke(a-ee[1].getX()-1,ee[1].getY()))}return q}catch{}}}throw new Q}static recordPattern(r,s,a){const u=a.length;for(let b=0;b<u;b++)a[b]=0;const d=r.getSize();if(s>=d)throw new Q;let f=!r.get(s),p=0,w=s;for(;w<d;){if(r.get(w)!==f)a[p]++;else{if(++p===u)break;a[p]=1,f=!f}w++}if(!(p===u||p===u-1&&w===d))throw new Q}static recordPatternInReverse(r,s,a){let u=a.length,d=r.get(s);for(;s>0&&u>=0;)r.get(--s)!==d&&(u--,d=!d);if(u>=0)throw new Q;_t.recordPattern(r,s+1,a)}static patternMatchVariance(r,s,a){const u=r.length;let d=0,f=0;for(let b=0;b<u;b++)d+=r[b],f+=s[b];if(d<f)return Number.POSITIVE_INFINITY;const p=d/f;a*=p;let w=0;for(let b=0;b<u;b++){const A=r[b],O=s[b]*p,B=A>O?A-O:O-A;if(B>a)return Number.POSITIVE_INFINITY;w+=B}return w/d}}class _e extends _t{static findStartPattern(r){const s=r.getSize(),a=r.getNextSet(0);let u=0,d=Int32Array.from([0,0,0,0,0,0]),f=a,p=!1;const w=6;for(let b=a;b<s;b++)if(r.get(b)!==p)d[u]++;else{if(u===w-1){let A=_e.MAX_AVG_VARIANCE,O=-1;for(let B=_e.CODE_START_A;B<=_e.CODE_START_C;B++){const V=_t.patternMatchVariance(d,_e.CODE_PATTERNS[B],_e.MAX_INDIVIDUAL_VARIANCE);V<A&&(A=V,O=B)}if(O>=0&&r.isRange(Math.max(0,f-(b-f)/2),f,!1))return Int32Array.from([f,b,O]);f+=d[0]+d[1],d=d.slice(2,d.length-1),d[u-1]=0,d[u]=0,u--}else u++;d[u]=1,p=!p}throw new Q}static decodeCode(r,s,a){_t.recordPattern(r,a,s);let u=_e.MAX_AVG_VARIANCE,d=-1;for(let f=0;f<_e.CODE_PATTERNS.length;f++){const p=_e.CODE_PATTERNS[f],w=this.patternMatchVariance(s,p,_e.MAX_INDIVIDUAL_VARIANCE);w<u&&(u=w,d=f)}if(d>=0)return d;throw new Q}decodeRow(r,s,a){const u=a&&a.get(Y.ASSUME_GS1)===!0,d=_e.findStartPattern(s),f=d[2];let p=0;const w=new Uint8Array(20);w[p++]=f;let b;switch(f){case _e.CODE_START_A:b=_e.CODE_CODE_A;break;case _e.CODE_START_B:b=_e.CODE_CODE_B;break;case _e.CODE_START_C:b=_e.CODE_CODE_C;break;default:throw new Z}let A=!1,O=!1,B="",V=d[0],X=d[1];const q=Int32Array.from([0,0,0,0,0,0]);let ee=0,se=0,xe=f,ye=0,ge=!0,st=!1,$e=!1;for(;!A;){const Lr=O;switch(O=!1,ee=se,se=_e.decodeCode(s,q,X),w[p++]=se,se!==_e.CODE_STOP&&(ge=!0),se!==_e.CODE_STOP&&(ye++,xe+=ye*se),V=X,X+=q.reduce((Bu,Ji)=>Bu+Ji,0),se){case _e.CODE_START_A:case _e.CODE_START_B:case _e.CODE_START_C:throw new Z}switch(b){case _e.CODE_CODE_A:if(se<64)$e===st?B+=String.fromCharCode(32+se):B+=String.fromCharCode(32+se+128),$e=!1;else if(se<96)$e===st?B+=String.fromCharCode(se-64):B+=String.fromCharCode(se+64),$e=!1;else switch(se!==_e.CODE_STOP&&(ge=!1),se){case _e.CODE_FNC_1:u&&(B.length===0?B+="]C1":B+="");break;case _e.CODE_FNC_2:case _e.CODE_FNC_3:break;case _e.CODE_FNC_4_A:!st&&$e?(st=!0,$e=!1):st&&$e?(st=!1,$e=!1):$e=!0;break;case _e.CODE_SHIFT:O=!0,b=_e.CODE_CODE_B;break;case _e.CODE_CODE_B:b=_e.CODE_CODE_B;break;case _e.CODE_CODE_C:b=_e.CODE_CODE_C;break;case _e.CODE_STOP:A=!0;break}break;case _e.CODE_CODE_B:if(se<96)$e===st?B+=String.fromCharCode(32+se):B+=String.fromCharCode(32+se+128),$e=!1;else switch(se!==_e.CODE_STOP&&(ge=!1),se){case _e.CODE_FNC_1:u&&(B.length===0?B+="]C1":B+="");break;case _e.CODE_FNC_2:case _e.CODE_FNC_3:break;case _e.CODE_FNC_4_B:!st&&$e?(st=!0,$e=!1):st&&$e?(st=!1,$e=!1):$e=!0;break;case _e.CODE_SHIFT:O=!0,b=_e.CODE_CODE_A;break;case _e.CODE_CODE_A:b=_e.CODE_CODE_A;break;case _e.CODE_CODE_C:b=_e.CODE_CODE_C;break;case _e.CODE_STOP:A=!0;break}break;case _e.CODE_CODE_C:if(se<100)se<10&&(B+="0"),B+=se;else switch(se!==_e.CODE_STOP&&(ge=!1),se){case _e.CODE_FNC_1:u&&(B.length===0?B+="]C1":B+="");break;case _e.CODE_CODE_A:b=_e.CODE_CODE_A;break;case _e.CODE_CODE_B:b=_e.CODE_CODE_B;break;case _e.CODE_STOP:A=!0;break}break}Lr&&(b=b===_e.CODE_CODE_A?_e.CODE_CODE_B:_e.CODE_CODE_A)}const Ut=X-V;if(X=s.getNextUnset(X),!s.isRange(X,Math.min(s.getSize(),X+(X-V)/2),!1))throw new Q;if(xe-=ye*ee,xe%103!==ee)throw new U;const Pn=B.length;if(Pn===0)throw new Q;Pn>0&&ge&&(b===_e.CODE_CODE_C?B=B.substring(0,Pn-2):B=B.substring(0,Pn-1));const Rn=(d[1]+d[0])/2,xt=V+Ut/2,hn=w.length,jn=new Uint8Array(hn);for(let Lr=0;Lr<hn;Lr++)jn[Lr]=w[Lr];const Qi=[new ke(Rn,r),new ke(xt,r)];return new Fe(B,jn,0,Qi,fe.CODE_128,new Date().getTime())}}_e.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],_e.MAX_AVG_VARIANCE=.25,_e.MAX_INDIVIDUAL_VARIANCE=.7,_e.CODE_SHIFT=98,_e.CODE_CODE_C=99,_e.CODE_CODE_B=100,_e.CODE_CODE_A=101,_e.CODE_FNC_1=102,_e.CODE_FNC_2=97,_e.CODE_FNC_3=96,_e.CODE_FNC_4_A=101,_e.CODE_FNC_4_B=100,_e.CODE_START_A=103,_e.CODE_START_B=104,_e.CODE_START_C=105,_e.CODE_STOP=106;class qt extends _t{constructor(r=!1,s=!1){super(),this.usingCheckDigit=r,this.extendedMode=s,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(r,s,a){let u=this.counters;u.fill(0),this.decodeRowResult="";let d=qt.findAsteriskPattern(s,u),f=s.getNextSet(d[1]),p=s.getSize(),w,b;do{qt.recordPattern(s,f,u);let q=qt.toNarrowWidePattern(u);if(q<0)throw new Q;w=qt.patternToChar(q),this.decodeRowResult+=w,b=f;for(let ee of u)f+=ee;f=s.getNextSet(f)}while(w!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let A=0;for(let q of u)A+=q;let O=f-b-A;if(f!==p&&O*2<A)throw new Q;if(this.usingCheckDigit){let q=this.decodeRowResult.length-1,ee=0;for(let se=0;se<q;se++)ee+=qt.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(se));if(this.decodeRowResult.charAt(q)!==qt.ALPHABET_STRING.charAt(ee%43))throw new U;this.decodeRowResult=this.decodeRowResult.substring(0,q)}if(this.decodeRowResult.length===0)throw new Q;let B;this.extendedMode?B=qt.decodeExtended(this.decodeRowResult):B=this.decodeRowResult;let V=(d[1]+d[0])/2,X=b+A/2;return new Fe(B,null,0,[new ke(V,r),new ke(X,r)],fe.CODE_39,new Date().getTime())}static findAsteriskPattern(r,s){let a=r.getSize(),u=r.getNextSet(0),d=0,f=u,p=!1,w=s.length;for(let b=u;b<a;b++)if(r.get(b)!==p)s[d]++;else{if(d===w-1){if(this.toNarrowWidePattern(s)===qt.ASTERISK_ENCODING&&r.isRange(Math.max(0,f-Math.floor((b-f)/2)),f,!1))return[f,b];f+=s[0]+s[1],s.copyWithin(0,2,2+d-1),s[d-1]=0,s[d]=0,d--}else d++;s[d]=1,p=!p}throw new Q}static toNarrowWidePattern(r){let s=r.length,a=0,u;do{let d=2147483647;for(let w of r)w<d&&w>a&&(d=w);a=d,u=0;let f=0,p=0;for(let w=0;w<s;w++){let b=r[w];b>a&&(p|=1<<s-1-w,u++,f+=b)}if(u===3){for(let w=0;w<s&&u>0;w++){let b=r[w];if(b>a&&(u--,b*2>=f))return-1}return p}}while(u>3);return-1}static patternToChar(r){for(let s=0;s<qt.CHARACTER_ENCODINGS.length;s++)if(qt.CHARACTER_ENCODINGS[s]===r)return qt.ALPHABET_STRING.charAt(s);if(r===qt.ASTERISK_ENCODING)return"*";throw new Q}static decodeExtended(r){let s=r.length,a="";for(let u=0;u<s;u++){let d=r.charAt(u);if(d==="+"||d==="$"||d==="%"||d==="/"){let f=r.charAt(u+1),p="\0";switch(d){case"+":if(f>="A"&&f<="Z")p=String.fromCharCode(f.charCodeAt(0)+32);else throw new Z;break;case"$":if(f>="A"&&f<="Z")p=String.fromCharCode(f.charCodeAt(0)-64);else throw new Z;break;case"%":if(f>="A"&&f<="E")p=String.fromCharCode(f.charCodeAt(0)-38);else if(f>="F"&&f<="J")p=String.fromCharCode(f.charCodeAt(0)-11);else if(f>="K"&&f<="O")p=String.fromCharCode(f.charCodeAt(0)+16);else if(f>="P"&&f<="T")p=String.fromCharCode(f.charCodeAt(0)+43);else if(f==="U")p="\0";else if(f==="V")p="@";else if(f==="W")p="`";else if(f==="X"||f==="Y"||f==="Z")p="";else throw new Z;break;case"/":if(f>="A"&&f<="O")p=String.fromCharCode(f.charCodeAt(0)-32);else if(f==="Z")p=":";else throw new Z;break}a+=p,u++}else a+=d}return a}}qt.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",qt.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],qt.ASTERISK_ENCODING=148;class bt extends _t{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(r,s,a){let u=this.decodeStart(s),d=this.decodeEnd(s),f=new Ie;bt.decodeMiddle(s,u[1],d[0],f);let p=f.toString(),w=null;a!=null&&(w=a.get(Y.ALLOWED_LENGTHS)),w==null&&(w=bt.DEFAULT_ALLOWED_LENGTHS);let b=p.length,A=!1,O=0;for(let X of w){if(b===X){A=!0;break}X>O&&(O=X)}if(!A&&b>O&&(A=!0),!A)throw new Z;const B=[new ke(u[1],r),new ke(d[0],r)];return new Fe(p,null,0,B,fe.ITF,new Date().getTime())}static decodeMiddle(r,s,a,u){let d=new Int32Array(10),f=new Int32Array(5),p=new Int32Array(5);for(d.fill(0),f.fill(0),p.fill(0);s<a;){_t.recordPattern(r,s,d);for(let b=0;b<5;b++){let A=2*b;f[b]=d[A],p[b]=d[A+1]}let w=bt.decodeDigit(f);u.append(w.toString()),w=this.decodeDigit(p),u.append(w.toString()),d.forEach(function(b){s+=b})}}decodeStart(r){let s=bt.skipWhiteSpace(r),a=bt.findGuardPattern(r,s,bt.START_PATTERN);return this.narrowLineWidth=(a[1]-a[0])/4,this.validateQuietZone(r,a[0]),a}validateQuietZone(r,s){let a=this.narrowLineWidth*10;a=a<s?a:s;for(let u=s-1;a>0&&u>=0&&!r.get(u);u--)a--;if(a!==0)throw new Q}static skipWhiteSpace(r){const s=r.getSize(),a=r.getNextSet(0);if(a===s)throw new Q;return a}decodeEnd(r){r.reverse();try{let s=bt.skipWhiteSpace(r),a;try{a=bt.findGuardPattern(r,s,bt.END_PATTERN_REVERSED[0])}catch(d){d instanceof Q&&(a=bt.findGuardPattern(r,s,bt.END_PATTERN_REVERSED[1]))}this.validateQuietZone(r,a[0]);let u=a[0];return a[0]=r.getSize()-a[1],a[1]=r.getSize()-u,a}finally{r.reverse()}}static findGuardPattern(r,s,a){let u=a.length,d=new Int32Array(u),f=r.getSize(),p=!1,w=0,b=s;d.fill(0);for(let A=s;A<f;A++)if(r.get(A)!==p)d[w]++;else{if(w===u-1){if(_t.patternMatchVariance(d,a,bt.MAX_INDIVIDUAL_VARIANCE)<bt.MAX_AVG_VARIANCE)return[b,A];b+=d[0]+d[1],P.arraycopy(d,2,d,0,w-1),d[w-1]=0,d[w]=0,w--}else w++;d[w]=1,p=!p}throw new Q}static decodeDigit(r){let s=bt.MAX_AVG_VARIANCE,a=-1,u=bt.PATTERNS.length;for(let d=0;d<u;d++){let f=bt.PATTERNS[d],p=_t.patternMatchVariance(r,f,bt.MAX_INDIVIDUAL_VARIANCE);p<s?(s=p,a=d):p===s&&(a=-1)}if(a>=0)return a%10;throw new Q}}bt.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],bt.MAX_AVG_VARIANCE=.38,bt.MAX_INDIVIDUAL_VARIANCE=.5,bt.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],bt.START_PATTERN=Int32Array.from([1,1,1,1]),bt.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Nt extends _t{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(r){let s=!1,a,u=0,d=Int32Array.from([0,0,0]);for(;!s;){d=Int32Array.from([0,0,0]),a=Nt.findGuardPattern(r,u,!1,this.START_END_PATTERN,d);let f=a[0];u=a[1];let p=f-(u-f);p>=0&&(s=r.isRange(p,f,!1))}return a}static checkChecksum(r){return Nt.checkStandardUPCEANChecksum(r)}static checkStandardUPCEANChecksum(r){let s=r.length;if(s===0)return!1;let a=parseInt(r.charAt(s-1),10);return Nt.getStandardUPCEANChecksum(r.substring(0,s-1))===a}static getStandardUPCEANChecksum(r){let s=r.length,a=0;for(let u=s-1;u>=0;u-=2){let d=r.charAt(u).charCodeAt(0)-48;if(d<0||d>9)throw new Z;a+=d}a*=3;for(let u=s-2;u>=0;u-=2){let d=r.charAt(u).charCodeAt(0)-48;if(d<0||d>9)throw new Z;a+=d}return(1e3-a)%10}static decodeEnd(r,s){return Nt.findGuardPattern(r,s,!1,Nt.START_END_PATTERN,new Int32Array(Nt.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(r,s,a,u){return this.findGuardPattern(r,s,a,u,new Int32Array(u.length))}static findGuardPattern(r,s,a,u,d){let f=r.getSize();s=a?r.getNextUnset(s):r.getNextSet(s);let p=0,w=s,b=u.length,A=a;for(let O=s;O<f;O++)if(r.get(O)!==A)d[p]++;else{if(p===b-1){if(_t.patternMatchVariance(d,u,Nt.MAX_INDIVIDUAL_VARIANCE)<Nt.MAX_AVG_VARIANCE)return Int32Array.from([w,O]);w+=d[0]+d[1];let B=d.slice(2,d.length-1);for(let V=0;V<p-1;V++)d[V]=B[V];d[p-1]=0,d[p]=0,p--}else p++;d[p]=1,A=!A}throw new Q}static decodeDigit(r,s,a,u){this.recordPattern(r,a,s);let d=this.MAX_AVG_VARIANCE,f=-1,p=u.length;for(let w=0;w<p;w++){let b=u[w],A=_t.patternMatchVariance(s,b,Nt.MAX_INDIVIDUAL_VARIANCE);A<d&&(d=A,f=w)}if(f>=0)return f;throw new Q}}Nt.MAX_AVG_VARIANCE=.48,Nt.MAX_INDIVIDUAL_VARIANCE=.7,Nt.START_END_PATTERN=Int32Array.from([1,1,1]),Nt.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Nt.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Nt.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class Ls{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(r,s,a){let u=this.decodeRowStringBuffer,d=this.decodeMiddle(s,a,u),f=u.toString(),p=Ls.parseExtensionString(f),w=[new ke((a[0]+a[1])/2,r),new ke(d,r)],b=new Fe(f,null,0,w,fe.UPC_EAN_EXTENSION,new Date().getTime());return p!=null&&b.putAllMetadata(p),b}decodeMiddle(r,s,a){let u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=r.getSize(),f=s[1],p=0;for(let b=0;b<5&&f<d;b++){let A=Nt.decodeDigit(r,u,f,Nt.L_AND_G_PATTERNS);a+=String.fromCharCode(48+A%10);for(let O of u)f+=O;A>=10&&(p|=1<<4-b),b!==4&&(f=r.getNextSet(f),f=r.getNextUnset(f))}if(a.length!==5)throw new Q;let w=this.determineCheckDigit(p);if(Ls.extensionChecksum(a.toString())!==w)throw new Q;return f}static extensionChecksum(r){let s=r.length,a=0;for(let u=s-2;u>=0;u-=2)a+=r.charAt(u).charCodeAt(0)-48;a*=3;for(let u=s-1;u>=0;u-=2)a+=r.charAt(u).charCodeAt(0)-48;return a*=3,a%10}determineCheckDigit(r){for(let s=0;s<10;s++)if(r===this.CHECK_DIGIT_ENCODINGS[s])return s;throw new Q}static parseExtensionString(r){if(r.length!==5)return null;let s=Ls.parseExtension5String(r);return s==null?null:new Map([[Je.SUGGESTED_PRICE,s]])}static parseExtension5String(r){let s;switch(r.charAt(0)){case"0":s="£";break;case"5":s="$";break;case"9":switch(r){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}s="";break;default:s="";break}let a=parseInt(r.substring(1)),u=(a/100).toString(),d=a%100,f=d<10?"0"+d:d.toString();return s+u+"."+f}}class ca{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(r,s,a){let u=this.decodeRowStringBuffer,d=this.decodeMiddle(s,a,u),f=u.toString(),p=ca.parseExtensionString(f),w=[new ke((a[0]+a[1])/2,r),new ke(d,r)],b=new Fe(f,null,0,w,fe.UPC_EAN_EXTENSION,new Date().getTime());return p!=null&&b.putAllMetadata(p),b}decodeMiddle(r,s,a){let u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=r.getSize(),f=s[1],p=0;for(let w=0;w<2&&f<d;w++){let b=Nt.decodeDigit(r,u,f,Nt.L_AND_G_PATTERNS);a+=String.fromCharCode(48+b%10);for(let A of u)f+=A;b>=10&&(p|=1<<1-w),w!==1&&(f=r.getNextSet(f),f=r.getNextUnset(f))}if(a.length!==2)throw new Q;if(parseInt(a.toString())%4!==p)throw new Q;return f}static parseExtensionString(r){return r.length!==2?null:new Map([[Je.ISSUE_NUMBER,parseInt(r)]])}}class ua{static decodeRow(r,s,a){let u=Nt.findGuardPattern(s,a,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new Ls().decodeRow(r,s,u)}catch{return new ca().decodeRow(r,s,u)}}}ua.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class ht extends Nt{constructor(){super(),this.decodeRowStringBuffer="",ht.L_AND_G_PATTERNS=ht.L_PATTERNS.map(r=>Int32Array.from(r));for(let r=10;r<20;r++){let s=ht.L_PATTERNS[r-10],a=new Int32Array(s.length);for(let u=0;u<s.length;u++)a[u]=s[s.length-u-1];ht.L_AND_G_PATTERNS[r]=a}}decodeRow(r,s,a){let u=ht.findStartGuardPattern(s),d=a==null?null:a.get(Y.NEED_RESULT_POINT_CALLBACK);if(d!=null){const ge=new ke((u[0]+u[1])/2,r);d.foundPossibleResultPoint(ge)}let f=this.decodeMiddle(s,u,this.decodeRowStringBuffer),p=f.rowOffset,w=f.resultString;if(d!=null){const ge=new ke(p,r);d.foundPossibleResultPoint(ge)}let b=this.decodeEnd(s,p);if(d!=null){const ge=new ke((b[0]+b[1])/2,r);d.foundPossibleResultPoint(ge)}let A=b[1],O=A+(A-b[0]);if(O>=s.getSize()||!s.isRange(A,O,!1))throw new Q;let B=w.toString();if(B.length<8)throw new Z;if(!ht.checkChecksum(B))throw new U;let V=(u[1]+u[0])/2,X=(b[1]+b[0])/2,q=this.getBarcodeFormat(),ee=[new ke(V,r),new ke(X,r)],se=new Fe(B,null,0,ee,q,new Date().getTime()),xe=0;try{let ge=ua.decodeRow(r,s,b[1]);se.putMetadata(Je.UPC_EAN_EXTENSION,ge.getText()),se.putAllMetadata(ge.getResultMetadata()),se.addResultPoints(ge.getResultPoints()),xe=ge.getText().length}catch{}let ye=a==null?null:a.get(Y.ALLOWED_EAN_EXTENSIONS);if(ye!=null){let ge=!1;for(let st in ye)if(xe.toString()===st){ge=!0;break}if(!ge)throw new Q}return se}decodeEnd(r,s){return ht.findGuardPattern(r,s,!1,ht.START_END_PATTERN,new Int32Array(ht.START_END_PATTERN.length).fill(0))}static checkChecksum(r){return ht.checkStandardUPCEANChecksum(r)}static checkStandardUPCEANChecksum(r){let s=r.length;if(s===0)return!1;let a=parseInt(r.charAt(s-1),10);return ht.getStandardUPCEANChecksum(r.substring(0,s-1))===a}static getStandardUPCEANChecksum(r){let s=r.length,a=0;for(let u=s-1;u>=0;u-=2){let d=r.charAt(u).charCodeAt(0)-48;if(d<0||d>9)throw new Z;a+=d}a*=3;for(let u=s-2;u>=0;u-=2){let d=r.charAt(u).charCodeAt(0)-48;if(d<0||d>9)throw new Z;a+=d}return(1e3-a)%10}}class ri extends ht{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(r,s,a){let u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=r.getSize(),f=s[1],p=0;for(let b=0;b<6&&f<d;b++){let A=ht.decodeDigit(r,u,f,ht.L_AND_G_PATTERNS);a+=String.fromCharCode(48+A%10);for(let O of u)f+=O;A>=10&&(p|=1<<5-b)}a=ri.determineFirstDigit(a,p),f=ht.findGuardPattern(r,f,!0,ht.MIDDLE_PATTERN,new Int32Array(ht.MIDDLE_PATTERN.length).fill(0))[1];for(let b=0;b<6&&f<d;b++){let A=ht.decodeDigit(r,u,f,ht.L_PATTERNS);a+=String.fromCharCode(48+A);for(let O of u)f+=O}return{rowOffset:f,resultString:a}}getBarcodeFormat(){return fe.EAN_13}static determineFirstDigit(r,s){for(let a=0;a<10;a++)if(s===this.FIRST_DIGIT_ENCODINGS[a])return r=String.fromCharCode(48+a)+r,r;throw new Q}}ri.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class Ml extends ht{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(r,s,a){const u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=r.getSize(),f=s[1];for(let w=0;w<4&&f<d;w++){let b=ht.decodeDigit(r,u,f,ht.L_PATTERNS);a+=String.fromCharCode(48+b);for(let A of u)f+=A}f=ht.findGuardPattern(r,f,!0,ht.MIDDLE_PATTERN,new Int32Array(ht.MIDDLE_PATTERN.length).fill(0))[1];for(let w=0;w<4&&f<d;w++){let b=ht.decodeDigit(r,u,f,ht.L_PATTERNS);a+=String.fromCharCode(48+b);for(let A of u)f+=A}return{rowOffset:f,resultString:a}}getBarcodeFormat(){return fe.EAN_8}}class Ol extends ht{constructor(){super(...arguments),this.ean13Reader=new ri}getBarcodeFormat(){return fe.UPC_A}decode(r,s){return this.maybeReturnResult(this.ean13Reader.decode(r))}decodeRow(r,s,a){return this.maybeReturnResult(this.ean13Reader.decodeRow(r,s,a))}decodeMiddle(r,s,a){return this.ean13Reader.decodeMiddle(r,s,a)}maybeReturnResult(r){let s=r.getText();if(s.charAt(0)==="0"){let a=new Fe(s.substring(1),null,null,r.getResultPoints(),fe.UPC_A);return r.getResultMetadata()!=null&&a.putAllMetadata(r.getResultMetadata()),a}else throw new Q}reset(){this.ean13Reader.reset()}}class hr extends ht{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(r,s,a){const u=this.decodeMiddleCounters.map(b=>b);u[0]=0,u[1]=0,u[2]=0,u[3]=0;const d=r.getSize();let f=s[1],p=0;for(let b=0;b<6&&f<d;b++){const A=hr.decodeDigit(r,u,f,hr.L_AND_G_PATTERNS);a+=String.fromCharCode(48+A%10);for(let O of u)f+=O;A>=10&&(p|=1<<5-b)}let w=hr.determineNumSysAndCheckDigit(a,p);return{rowOffset:f,resultString:w}}decodeEnd(r,s){return hr.findGuardPatternWithoutCounters(r,s,!0,hr.MIDDLE_END_PATTERN)}checkChecksum(r){return ht.checkChecksum(hr.convertUPCEtoUPCA(r))}static determineNumSysAndCheckDigit(r,s){for(let a=0;a<=1;a++)for(let u=0;u<10;u++)if(s===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[a][u]){let d=String.fromCharCode(48+a),f=String.fromCharCode(48+u);return d+r+f}throw Q.getNotFoundInstance()}getBarcodeFormat(){return fe.UPC_E}static convertUPCEtoUPCA(r){const s=r.slice(1,7).split("").map(d=>d.charCodeAt(0)),a=new Ie;a.append(r.charAt(0));let u=s[5];switch(u){case 0:case 1:case 2:a.appendChars(s,0,2),a.append(u),a.append("0000"),a.appendChars(s,2,3);break;case 3:a.appendChars(s,0,3),a.append("00000"),a.appendChars(s,3,2);break;case 4:a.appendChars(s,0,4),a.append("00000"),a.append(s[4]);break;default:a.appendChars(s,0,5),a.append("0000"),a.append(u);break}return r.length>=8&&a.append(r.charAt(7)),a.toString()}}hr.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),hr.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class da extends _t{constructor(r){super();let s=r==null?null:r.get(Y.POSSIBLE_FORMATS),a=[];i(s)?(a.push(new ri),a.push(new Ol),a.push(new Ml),a.push(new hr)):(s.indexOf(fe.EAN_13)>-1&&a.push(new ri),s.indexOf(fe.UPC_A)>-1&&a.push(new Ol),s.indexOf(fe.EAN_8)>-1&&a.push(new Ml),s.indexOf(fe.UPC_E)>-1&&a.push(new hr)),this.readers=a}decodeRow(r,s,a){for(let u of this.readers)try{const d=u.decodeRow(r,s,a),f=d.getBarcodeFormat()===fe.EAN_13&&d.getText().charAt(0)==="0",p=a==null?null:a.get(Y.POSSIBLE_FORMATS),w=p==null||p.includes(fe.UPC_A);if(f&&w){const b=d.getRawBytes(),A=new Fe(d.getText().substring(1),b,b?b.length:null,d.getResultPoints(),fe.UPC_A);return A.putAllMetadata(d.getResultMetadata()),A}return d}catch{}throw new Q}reset(){for(let r of this.readers)r.reset()}}class xn extends _t{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(r,s){for(let a=0;a<s.length;a++)if(_t.patternMatchVariance(r,s[a],xn.MAX_INDIVIDUAL_VARIANCE)<xn.MAX_AVG_VARIANCE)return a;throw new Q}static count(r){return Ge.sum(new Int32Array(r))}static increment(r,s){let a=0,u=s[0];for(let d=1;d<r.length;d++)s[d]>u&&(u=s[d],a=d);r[a]++}static decrement(r,s){let a=0,u=s[0];for(let d=1;d<r.length;d++)s[d]<u&&(u=s[d],a=d);r[a]--}static isFinderPattern(r){let s=r[0]+r[1],a=s+r[2]+r[3],u=s/a;if(u>=xn.MIN_FINDER_PATTERN_RATIO&&u<=xn.MAX_FINDER_PATTERN_RATIO){let d=Number.MAX_SAFE_INTEGER,f=Number.MIN_SAFE_INTEGER;for(let p of r)p>f&&(f=p),p<d&&(d=p);return f<10*d}return!1}}xn.MAX_AVG_VARIANCE=.2,xn.MAX_INDIVIDUAL_VARIANCE=.45,xn.MIN_FINDER_PATTERN_RATIO=9.5/12,xn.MAX_FINDER_PATTERN_RATIO=12.5/14;class Wi{constructor(r,s){this.value=r,this.checksumPortion=s}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(r){if(!(r instanceof Wi))return!1;const s=r;return this.value===s.value&&this.checksumPortion===s.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class Vi{constructor(r,s,a,u,d){this.value=r,this.startEnd=s,this.value=r,this.startEnd=s,this.resultPoints=new Array,this.resultPoints.push(new ke(a,d)),this.resultPoints.push(new ke(u,d))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(r){if(!(r instanceof Vi))return!1;const s=r;return this.value===s.value}hashCode(){return this.value}}class Ar{constructor(){}static getRSSvalue(r,s,a){let u=0;for(let w of r)u+=w;let d=0,f=0,p=r.length;for(let w=0;w<p-1;w++){let b;for(b=1,f|=1<<w;b<r[w];b++,f&=~(1<<w)){let A=Ar.combins(u-b-1,p-w-2);if(a&&f===0&&u-b-(p-w-1)>=p-w-1&&(A-=Ar.combins(u-b-(p-w),p-w-2)),p-w-1>1){let O=0;for(let B=u-b-(p-w-2);B>s;B--)O+=Ar.combins(u-b-B-1,p-w-3);A-=O*(p-1-w)}else u-b>s&&A--;d+=A}u-=b}return d}static combins(r,s){let a,u;r-s>s?(u=s,a=r-s):(u=r-s,a=s);let d=1,f=1;for(let p=r;p>a;p--)d*=p,f<=u&&(d/=f,f++);for(;f<=u;)d/=f,f++;return d}}class Iu{static buildBitArray(r){let s=r.length*2-1;r[r.length-1].getRightChar()==null&&(s-=1);let a=12*s,u=new z(a),d=0,p=r[0].getRightChar().getValue();for(let w=11;w>=0;--w)p&1<<w&&u.set(d),d++;for(let w=1;w<r.length;++w){let b=r[w],A=b.getLeftChar().getValue();for(let O=11;O>=0;--O)A&1<<O&&u.set(d),d++;if(b.getRightChar()!=null){let O=b.getRightChar().getValue();for(let B=11;B>=0;--B)O&1<<B&&u.set(d),d++}}return u}}class vi{constructor(r,s){s?this.decodedInformation=null:(this.finished=r,this.decodedInformation=s)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class ha{constructor(r){this.newPosition=r}getNewPosition(){return this.newPosition}}class Bt extends ha{constructor(r,s){super(r),this.value=s}getValue(){return this.value}isFNC1(){return this.value===Bt.FNC1}}Bt.FNC1="$";class Pe extends ha{constructor(r,s,a){super(r),a?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=s}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class Hn extends ha{constructor(r,s,a){if(super(r),s<0||s>10||a<0||a>10)throw new Z;this.firstDigit=s,this.secondDigit=a}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===Hn.FNC1}isSecondDigitFNC1(){return this.secondDigit===Hn.FNC1}isAnyFNC1(){return this.firstDigit===Hn.FNC1||this.secondDigit===Hn.FNC1}}Hn.FNC1=10;class Ae{constructor(){}static parseFieldsInGeneralPurpose(r){if(!r)return null;if(r.length<2)throw new Q;let s=r.substring(0,2);for(let d of Ae.TWO_DIGIT_DATA_LENGTH)if(d[0]===s)return d[1]===Ae.VARIABLE_LENGTH?Ae.processVariableAI(2,d[2],r):Ae.processFixedAI(2,d[1],r);if(r.length<3)throw new Q;let a=r.substring(0,3);for(let d of Ae.THREE_DIGIT_DATA_LENGTH)if(d[0]===a)return d[1]===Ae.VARIABLE_LENGTH?Ae.processVariableAI(3,d[2],r):Ae.processFixedAI(3,d[1],r);for(let d of Ae.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(d[0]===a)return d[1]===Ae.VARIABLE_LENGTH?Ae.processVariableAI(4,d[2],r):Ae.processFixedAI(4,d[1],r);if(r.length<4)throw new Q;let u=r.substring(0,4);for(let d of Ae.FOUR_DIGIT_DATA_LENGTH)if(d[0]===u)return d[1]===Ae.VARIABLE_LENGTH?Ae.processVariableAI(4,d[2],r):Ae.processFixedAI(4,d[1],r);throw new Q}static processFixedAI(r,s,a){if(a.length<r)throw new Q;let u=a.substring(0,r);if(a.length<r+s)throw new Q;let d=a.substring(r,r+s),f=a.substring(r+s),p="("+u+")"+d,w=Ae.parseFieldsInGeneralPurpose(f);return w==null?p:p+w}static processVariableAI(r,s,a){let u=a.substring(0,r),d;a.length<r+s?d=a.length:d=r+s;let f=a.substring(r,d),p=a.substring(d),w="("+u+")"+f,b=Ae.parseFieldsInGeneralPurpose(p);return b==null?w:w+b}}Ae.VARIABLE_LENGTH=[],Ae.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",Ae.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",Ae.VARIABLE_LENGTH,20],["22",Ae.VARIABLE_LENGTH,29],["30",Ae.VARIABLE_LENGTH,8],["37",Ae.VARIABLE_LENGTH,8],["90",Ae.VARIABLE_LENGTH,30],["91",Ae.VARIABLE_LENGTH,30],["92",Ae.VARIABLE_LENGTH,30],["93",Ae.VARIABLE_LENGTH,30],["94",Ae.VARIABLE_LENGTH,30],["95",Ae.VARIABLE_LENGTH,30],["96",Ae.VARIABLE_LENGTH,30],["97",Ae.VARIABLE_LENGTH,3],["98",Ae.VARIABLE_LENGTH,30],["99",Ae.VARIABLE_LENGTH,30]],Ae.THREE_DIGIT_DATA_LENGTH=[["240",Ae.VARIABLE_LENGTH,30],["241",Ae.VARIABLE_LENGTH,30],["242",Ae.VARIABLE_LENGTH,6],["250",Ae.VARIABLE_LENGTH,30],["251",Ae.VARIABLE_LENGTH,30],["253",Ae.VARIABLE_LENGTH,17],["254",Ae.VARIABLE_LENGTH,20],["400",Ae.VARIABLE_LENGTH,30],["401",Ae.VARIABLE_LENGTH,30],["402",17],["403",Ae.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",Ae.VARIABLE_LENGTH,20],["421",Ae.VARIABLE_LENGTH,15],["422",3],["423",Ae.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],Ae.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",Ae.VARIABLE_LENGTH,15],["391",Ae.VARIABLE_LENGTH,18],["392",Ae.VARIABLE_LENGTH,15],["393",Ae.VARIABLE_LENGTH,18],["703",Ae.VARIABLE_LENGTH,30]],Ae.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",Ae.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",Ae.VARIABLE_LENGTH,20],["8003",Ae.VARIABLE_LENGTH,30],["8004",Ae.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",Ae.VARIABLE_LENGTH,30],["8008",Ae.VARIABLE_LENGTH,12],["8018",18],["8020",Ae.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",Ae.VARIABLE_LENGTH,70],["8200",Ae.VARIABLE_LENGTH,70]];class wi{constructor(r){this.buffer=new Ie,this.information=r}decodeAllCodes(r,s){let a=s,u=null;do{let d=this.decodeGeneralPurposeField(a,u),f=Ae.parseFieldsInGeneralPurpose(d.getNewString());if(f!=null&&r.append(f),d.isRemaining()?u=""+d.getRemainingValue():u=null,a===d.getNewPosition())break;a=d.getNewPosition()}while(!0);return r.toString()}isStillNumeric(r){if(r+7>this.information.getSize())return r+4<=this.information.getSize();for(let s=r;s<r+3;++s)if(this.information.get(s))return!0;return this.information.get(r+3)}decodeNumeric(r){if(r+7>this.information.getSize()){let d=this.extractNumericValueFromBitArray(r,4);return d===0?new Hn(this.information.getSize(),Hn.FNC1,Hn.FNC1):new Hn(this.information.getSize(),d-1,Hn.FNC1)}let s=this.extractNumericValueFromBitArray(r,7),a=(s-8)/11,u=(s-8)%11;return new Hn(r+7,a,u)}extractNumericValueFromBitArray(r,s){return wi.extractNumericValueFromBitArray(this.information,r,s)}static extractNumericValueFromBitArray(r,s,a){let u=0;for(let d=0;d<a;++d)r.get(s+d)&&(u|=1<<a-d-1);return u}decodeGeneralPurposeField(r,s){this.buffer.setLengthToZero(),s!=null&&this.buffer.append(s),this.current.setPosition(r);let a=this.parseBlocks();return a!=null&&a.isRemaining()?new Pe(this.current.getPosition(),this.buffer.toString(),a.getRemainingValue()):new Pe(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let r,s;do{let a=this.current.getPosition();if(this.current.isAlpha()?(s=this.parseAlphaBlock(),r=s.isFinished()):this.current.isIsoIec646()?(s=this.parseIsoIec646Block(),r=s.isFinished()):(s=this.parseNumericBlock(),r=s.isFinished()),!(a!==this.current.getPosition())&&!r)break}while(!r);return s.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let r=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFirstDigitFNC1()){let s;return r.isSecondDigitFNC1()?s=new Pe(this.current.getPosition(),this.buffer.toString()):s=new Pe(this.current.getPosition(),this.buffer.toString(),r.getSecondDigit()),new vi(!0,s)}if(this.buffer.append(r.getFirstDigit()),r.isSecondDigitFNC1()){let s=new Pe(this.current.getPosition(),this.buffer.toString());return new vi(!0,s)}this.buffer.append(r.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new vi(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let r=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFNC1()){let s=new Pe(this.current.getPosition(),this.buffer.toString());return new vi(!0,s)}this.buffer.append(r.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new vi(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let r=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFNC1()){let s=new Pe(this.current.getPosition(),this.buffer.toString());return new vi(!0,s)}this.buffer.append(r.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new vi(!1)}isStillIsoIec646(r){if(r+5>this.information.getSize())return!1;let s=this.extractNumericValueFromBitArray(r,5);if(s>=5&&s<16)return!0;if(r+7>this.information.getSize())return!1;let a=this.extractNumericValueFromBitArray(r,7);if(a>=64&&a<116)return!0;if(r+8>this.information.getSize())return!1;let u=this.extractNumericValueFromBitArray(r,8);return u>=232&&u<253}decodeIsoIec646(r){let s=this.extractNumericValueFromBitArray(r,5);if(s===15)return new Bt(r+5,Bt.FNC1);if(s>=5&&s<15)return new Bt(r+5,"0"+(s-5));let a=this.extractNumericValueFromBitArray(r,7);if(a>=64&&a<90)return new Bt(r+7,""+(a+1));if(a>=90&&a<116)return new Bt(r+7,""+(a+7));let u=this.extractNumericValueFromBitArray(r,8),d;switch(u){case 232:d="!";break;case 233:d='"';break;case 234:d="%";break;case 235:d="&";break;case 236:d="'";break;case 237:d="(";break;case 238:d=")";break;case 239:d="*";break;case 240:d="+";break;case 241:d=",";break;case 242:d="-";break;case 243:d=".";break;case 244:d="/";break;case 245:d=":";break;case 246:d=";";break;case 247:d="<";break;case 248:d="=";break;case 249:d=">";break;case 250:d="?";break;case 251:d="_";break;case 252:d=" ";break;default:throw new Z}return new Bt(r+8,d)}isStillAlpha(r){if(r+5>this.information.getSize())return!1;let s=this.extractNumericValueFromBitArray(r,5);if(s>=5&&s<16)return!0;if(r+6>this.information.getSize())return!1;let a=this.extractNumericValueFromBitArray(r,6);return a>=16&&a<63}decodeAlphanumeric(r){let s=this.extractNumericValueFromBitArray(r,5);if(s===15)return new Bt(r+5,Bt.FNC1);if(s>=5&&s<15)return new Bt(r+5,"0"+(s-5));let a=this.extractNumericValueFromBitArray(r,6);if(a>=32&&a<58)return new Bt(r+6,""+(a+33));let u;switch(a){case 58:u="*";break;case 59:u=",";break;case 60:u="-";break;case 61:u=".";break;case 62:u="/";break;default:throw new Ot("Decoding invalid alphanumeric value: "+a)}return new Bt(r+6,u)}isAlphaTo646ToAlphaLatch(r){if(r+1>this.information.getSize())return!1;for(let s=0;s<5&&s+r<this.information.getSize();++s)if(s===2){if(!this.information.get(r+2))return!1}else if(this.information.get(r+s))return!1;return!0}isAlphaOr646ToNumericLatch(r){if(r+3>this.information.getSize())return!1;for(let s=r;s<r+3;++s)if(this.information.get(s))return!1;return!0}isNumericToAlphaNumericLatch(r){if(r+1>this.information.getSize())return!1;for(let s=0;s<4&&s+r<this.information.getSize();++s)if(this.information.get(r+s))return!1;return!0}}class ho{constructor(r){this.information=r,this.generalDecoder=new wi(r)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class yn extends ho{constructor(r){super(r)}encodeCompressedGtin(r,s){r.append("(01)");let a=r.length();r.append("9"),this.encodeCompressedGtinWithoutAI(r,s,a)}encodeCompressedGtinWithoutAI(r,s,a){for(let u=0;u<4;++u){let d=this.getGeneralDecoder().extractNumericValueFromBitArray(s+10*u,10);d/100===0&&r.append("0"),d/10===0&&r.append("0"),r.append(d)}yn.appendCheckDigit(r,a)}static appendCheckDigit(r,s){let a=0;for(let u=0;u<13;u++){let d=r.charAt(u+s).charCodeAt(0)-48;a+=u&1?d:3*d}a=10-a%10,a===10&&(a=0),r.append(a)}}yn.GTIN_SIZE=40;class _i extends yn{constructor(r){super(r)}parseInformation(){let r=new Ie;r.append("(01)");let s=r.length(),a=this.getGeneralDecoder().extractNumericValueFromBitArray(_i.HEADER_SIZE,4);return r.append(a),this.encodeCompressedGtinWithoutAI(r,_i.HEADER_SIZE+4,s),this.getGeneralDecoder().decodeAllCodes(r,_i.HEADER_SIZE+44)}}_i.HEADER_SIZE=4;class zr extends ho{constructor(r){super(r)}parseInformation(){let r=new Ie;return this.getGeneralDecoder().decodeAllCodes(r,zr.HEADER_SIZE)}}zr.HEADER_SIZE=5;class Ps extends yn{constructor(r){super(r)}encodeCompressedWeight(r,s,a){let u=this.getGeneralDecoder().extractNumericValueFromBitArray(s,a);this.addWeightCode(r,u);let d=this.checkWeight(u),f=1e5;for(let p=0;p<5;++p)d/f===0&&r.append("0"),f/=10;r.append(d)}}class Nr extends Ps{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()!=Nr.HEADER_SIZE+Ps.GTIN_SIZE+Nr.WEIGHT_SIZE)throw new Q;let r=new Ie;return this.encodeCompressedGtin(r,Nr.HEADER_SIZE),this.encodeCompressedWeight(r,Nr.HEADER_SIZE+Ps.GTIN_SIZE,Nr.WEIGHT_SIZE),r.toString()}}Nr.HEADER_SIZE=5,Nr.WEIGHT_SIZE=15;class ku extends Nr{constructor(r){super(r)}addWeightCode(r,s){r.append("(3103)")}checkWeight(r){return r}}class Mu extends Nr{constructor(r){super(r)}addWeightCode(r,s){s<1e4?r.append("(3202)"):r.append("(3203)")}checkWeight(r){return r<1e4?r:r-1e4}}class Tr extends yn{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()<Tr.HEADER_SIZE+yn.GTIN_SIZE)throw new Q;let r=new Ie;this.encodeCompressedGtin(r,Tr.HEADER_SIZE);let s=this.getGeneralDecoder().extractNumericValueFromBitArray(Tr.HEADER_SIZE+yn.GTIN_SIZE,Tr.LAST_DIGIT_SIZE);r.append("(392"),r.append(s),r.append(")");let a=this.getGeneralDecoder().decodeGeneralPurposeField(Tr.HEADER_SIZE+yn.GTIN_SIZE+Tr.LAST_DIGIT_SIZE,null);return r.append(a.getNewString()),r.toString()}}Tr.HEADER_SIZE=8,Tr.LAST_DIGIT_SIZE=2;class vn extends yn{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()<vn.HEADER_SIZE+yn.GTIN_SIZE)throw new Q;let r=new Ie;this.encodeCompressedGtin(r,vn.HEADER_SIZE);let s=this.getGeneralDecoder().extractNumericValueFromBitArray(vn.HEADER_SIZE+yn.GTIN_SIZE,vn.LAST_DIGIT_SIZE);r.append("(393"),r.append(s),r.append(")");let a=this.getGeneralDecoder().extractNumericValueFromBitArray(vn.HEADER_SIZE+yn.GTIN_SIZE+vn.LAST_DIGIT_SIZE,vn.FIRST_THREE_DIGITS_SIZE);a/100==0&&r.append("0"),a/10==0&&r.append("0"),r.append(a);let u=this.getGeneralDecoder().decodeGeneralPurposeField(vn.HEADER_SIZE+yn.GTIN_SIZE+vn.LAST_DIGIT_SIZE+vn.FIRST_THREE_DIGITS_SIZE,null);return r.append(u.getNewString()),r.toString()}}vn.HEADER_SIZE=8,vn.LAST_DIGIT_SIZE=2,vn.FIRST_THREE_DIGITS_SIZE=10;class Lt extends Ps{constructor(r,s,a){super(r),this.dateCode=a,this.firstAIdigits=s}parseInformation(){if(this.getInformation().getSize()!=Lt.HEADER_SIZE+Lt.GTIN_SIZE+Lt.WEIGHT_SIZE+Lt.DATE_SIZE)throw new Q;let r=new Ie;return this.encodeCompressedGtin(r,Lt.HEADER_SIZE),this.encodeCompressedWeight(r,Lt.HEADER_SIZE+Lt.GTIN_SIZE,Lt.WEIGHT_SIZE),this.encodeCompressedDate(r,Lt.HEADER_SIZE+Lt.GTIN_SIZE+Lt.WEIGHT_SIZE),r.toString()}encodeCompressedDate(r,s){let a=this.getGeneralDecoder().extractNumericValueFromBitArray(s,Lt.DATE_SIZE);if(a==38400)return;r.append("("),r.append(this.dateCode),r.append(")");let u=a%32;a/=32;let d=a%12+1;a/=12;let f=a;f/10==0&&r.append("0"),r.append(f),d/10==0&&r.append("0"),r.append(d),u/10==0&&r.append("0"),r.append(u)}addWeightCode(r,s){r.append("("),r.append(this.firstAIdigits),r.append(s/1e5),r.append(")")}checkWeight(r){return r%1e5}}Lt.HEADER_SIZE=8,Lt.WEIGHT_SIZE=20,Lt.DATE_SIZE=16;function Rs(M){try{if(M.get(1))return new _i(M);if(!M.get(2))return new zr(M);switch(wi.extractNumericValueFromBitArray(M,1,4)){case 4:return new ku(M);case 5:return new Mu(M)}switch(wi.extractNumericValueFromBitArray(M,1,5)){case 12:return new Tr(M);case 13:return new vn(M)}switch(wi.extractNumericValueFromBitArray(M,1,7)){case 56:return new Lt(M,"310","11");case 57:return new Lt(M,"320","11");case 58:return new Lt(M,"310","13");case 59:return new Lt(M,"320","13");case 60:return new Lt(M,"310","15");case 61:return new Lt(M,"320","15");case 62:return new Lt(M,"310","17");case 63:return new Lt(M,"320","17")}}catch(r){throw console.log(r),new Ot("unknown decoder: "+M)}}class ii{constructor(r,s,a,u){this.leftchar=r,this.rightchar=s,this.finderpattern=a,this.maybeLast=u}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(r,s){return r instanceof ii?ii.equalsOrNull(r.leftchar,s.leftchar)&&ii.equalsOrNull(r.rightchar,s.rightchar)&&ii.equalsOrNull(r.finderpattern,s.finderpattern):!1}static equalsOrNull(r,s){return r===null?s===null:ii.equals(r,s)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class fa{constructor(r,s,a){this.pairs=r,this.rowNumber=s,this.wasReversed=a}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(r){return this.checkEqualitity(this,r)}toString(){return"{ "+this.pairs+" }"}equals(r,s){return r instanceof fa?this.checkEqualitity(r,s)&&r.wasReversed===s.wasReversed:!1}checkEqualitity(r,s){if(!r||!s)return;let a;return r.forEach((u,d)=>{s.forEach(f=>{u.getLeftChar().getValue()===f.getLeftChar().getValue()&&u.getRightChar().getValue()===f.getRightChar().getValue()&&u.getFinderPatter().getValue()===f.getFinderPatter().getValue()&&(a=!0)})}),a}}class de extends xn{constructor(r){super(...arguments),this.pairs=new Array(de.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=r===!0}decodeRow(r,s,a){this.pairs.length=0,this.startFromEven=!1;try{return de.constructResult(this.decodeRow2pairs(r,s))}catch(u){this.verbose&&console.log(u)}return this.pairs.length=0,this.startFromEven=!0,de.constructResult(this.decodeRow2pairs(r,s))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(r,s){let a=!1;for(;!a;)try{this.pairs.push(this.retrieveNextPair(s,this.pairs,r))}catch(d){if(d instanceof Q){if(!this.pairs.length)throw new Q;a=!0}}if(this.checkChecksum())return this.pairs;let u;if(this.rows.length?u=!0:u=!1,this.storeRow(r,!1),u){let d=this.checkRowsBoolean(!1);if(d!=null||(d=this.checkRowsBoolean(!0),d!=null))return d}throw new Q}checkRowsBoolean(r){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,r&&(this.rows=this.rows.reverse());let s=null;try{s=this.checkRows(new Array,0)}catch(a){this.verbose&&console.log(a)}return r&&(this.rows=this.rows.reverse()),s}checkRows(r,s){for(let a=s;a<this.rows.length;a++){let u=this.rows[a];this.pairs.length=0;for(let f of r)this.pairs.push(f.getPairs());if(this.pairs.push(u.getPairs()),!de.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let d=new Array(r);d.push(u);try{return this.checkRows(d,a+1)}catch(f){this.verbose&&console.log(f)}}throw new Q}static isValidSequence(r){for(let s of de.FINDER_PATTERN_SEQUENCES){if(r.length>s.length)continue;let a=!0;for(let u=0;u<r.length;u++)if(r[u].getFinderPattern().getValue()!=s[u]){a=!1;break}if(a)return!0}return!1}storeRow(r,s){let a=0,u=!1,d=!1;for(;a<this.rows.length;){let f=this.rows[a];if(f.getRowNumber()>r){d=f.isEquivalent(this.pairs);break}u=f.isEquivalent(this.pairs),a++}d||u||de.isPartialRow(this.pairs,this.rows)||(this.rows.push(a,new fa(this.pairs,r,s)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(r,s){for(let a of s)if(a.getPairs().length!==r.length){for(let u of a.getPairs())for(let d of r)if(ii.equals(u,d))break}}static isPartialRow(r,s){for(let a of s){let u=!0;for(let d of r){let f=!1;for(let p of a.getPairs())if(d.equals(p)){f=!0;break}if(!f){u=!1;break}}if(u)return!0}return!1}getRows(){return this.rows}static constructResult(r){let s=Iu.buildBitArray(r),u=Rs(s).parseInformation(),d=r[0].getFinderPattern().getResultPoints(),f=r[r.length-1].getFinderPattern().getResultPoints(),p=[d[0],d[1],f[0],f[1]];return new Fe(u,null,null,p,fe.RSS_EXPANDED,null)}checkChecksum(){let r=this.pairs.get(0),s=r.getLeftChar(),a=r.getRightChar();if(a==null)return!1;let u=a.getChecksumPortion(),d=2;for(let p=1;p<this.pairs.size();++p){let w=this.pairs.get(p);u+=w.getLeftChar().getChecksumPortion(),d++;let b=w.getRightChar();b!=null&&(u+=b.getChecksumPortion(),d++)}return u%=211,211*(d-4)+u==s.getValue()}static getNextSecondBar(r,s){let a;return r.get(s)?(a=r.getNextUnset(s),a=r.getNextSet(a)):(a=r.getNextSet(s),a=r.getNextUnset(a)),a}retrieveNextPair(r,s,a){let u=s.length%2==0;this.startFromEven&&(u=!u);let d,f=!0,p=-1;do this.findNextPair(r,s,p),d=this.parseFoundFinderPattern(r,a,u),d==null?p=de.getNextSecondBar(r,this.startEnd[0]):f=!1;while(f);let w=this.decodeDataCharacter(r,d,u,!0);if(!this.isEmptyPair(s)&&s[s.length-1].mustBeLast())throw new Q;let b;try{b=this.decodeDataCharacter(r,d,u,!1)}catch(A){b=null,this.verbose&&console.log(A)}return new ii(w,b,d,!0)}isEmptyPair(r){return r.length===0}findNextPair(r,s,a){let u=this.getDecodeFinderCounters();u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=r.getSize(),f;a>=0?f=a:this.isEmptyPair(s)?f=0:f=s[s.length-1].getFinderPattern().getStartEnd()[1];let p=s.length%2!=0;this.startFromEven&&(p=!p);let w=!1;for(;f<d&&(w=!r.get(f),!!w);)f++;let b=0,A=f;for(let O=f;O<d;O++)if(r.get(O)!=w)u[b]++;else{if(b==3){if(p&&de.reverseCounters(u),de.isFinderPattern(u)){this.startEnd[0]=A,this.startEnd[1]=O;return}p&&de.reverseCounters(u),A+=u[0]+u[1],u[0]=u[2],u[1]=u[3],u[2]=0,u[3]=0,b--}else b++;u[b]=1,w=!w}throw new Q}static reverseCounters(r){let s=r.length;for(let a=0;a<s/2;++a){let u=r[a];r[a]=r[s-a-1],r[s-a-1]=u}}parseFoundFinderPattern(r,s,a){let u,d,f;if(a){let b=this.startEnd[0]-1;for(;b>=0&&!r.get(b);)b--;b++,u=this.startEnd[0]-b,d=b,f=this.startEnd[1]}else d=this.startEnd[0],f=r.getNextUnset(this.startEnd[1]+1),u=f-this.startEnd[1];let p=this.getDecodeFinderCounters();P.arraycopy(p,0,p,1,p.length-1),p[0]=u;let w;try{w=this.parseFinderValue(p,de.FINDER_PATTERNS)}catch{return null}return new Vi(w,[d,f],d,f,s)}decodeDataCharacter(r,s,a,u){let d=this.getDataCharacterCounters();for(let xt=0;xt<d.length;xt++)d[xt]=0;if(u)de.recordPatternInReverse(r,s.getStartEnd()[0],d);else{de.recordPattern(r,s.getStartEnd()[1],d);for(let xt=0,hn=d.length-1;xt<hn;xt++,hn--){let jn=d[xt];d[xt]=d[hn],d[hn]=jn}}let f=17,p=Ge.sum(new Int32Array(d))/f,w=(s.getStartEnd()[1]-s.getStartEnd()[0])/15;if(Math.abs(p-w)/w>.3)throw new Q;let b=this.getOddCounts(),A=this.getEvenCounts(),O=this.getOddRoundingErrors(),B=this.getEvenRoundingErrors();for(let xt=0;xt<d.length;xt++){let hn=1*d[xt]/p,jn=hn+.5;if(jn<1){if(hn<.3)throw new Q;jn=1}else if(jn>8){if(hn>8.7)throw new Q;jn=8}let Qi=xt/2;xt&1?(A[Qi]=jn,B[Qi]=hn-jn):(b[Qi]=jn,O[Qi]=hn-jn)}this.adjustOddEvenCounts(f);let V=4*s.getValue()+(a?0:2)+(u?0:1)-1,X=0,q=0;for(let xt=b.length-1;xt>=0;xt--){if(de.isNotA1left(s,a,u)){let hn=de.WEIGHTS[V][2*xt];q+=b[xt]*hn}X+=b[xt]}let ee=0;for(let xt=A.length-1;xt>=0;xt--)if(de.isNotA1left(s,a,u)){let hn=de.WEIGHTS[V][2*xt+1];ee+=A[xt]*hn}let se=q+ee;if(X&1||X>13||X<4)throw new Q;let xe=(13-X)/2,ye=de.SYMBOL_WIDEST[xe],ge=9-ye,st=Ar.getRSSvalue(b,ye,!0),$e=Ar.getRSSvalue(A,ge,!1),Ut=de.EVEN_TOTAL_SUBSET[xe],Pn=de.GSUM[xe],Rn=st*Ut+$e+Pn;return new Wi(Rn,se)}static isNotA1left(r,s,a){return!(r.getValue()==0&&s&&a)}adjustOddEvenCounts(r){let s=Ge.sum(new Int32Array(this.getOddCounts())),a=Ge.sum(new Int32Array(this.getEvenCounts())),u=!1,d=!1;s>13?d=!0:s<4&&(u=!0);let f=!1,p=!1;a>13?p=!0:a<4&&(f=!0);let w=s+a-r,b=(s&1)==1,A=(a&1)==0;if(w==1)if(b){if(A)throw new Q;d=!0}else{if(!A)throw new Q;p=!0}else if(w==-1)if(b){if(A)throw new Q;u=!0}else{if(!A)throw new Q;f=!0}else if(w==0){if(b){if(!A)throw new Q;s<a?(u=!0,p=!0):(d=!0,f=!0)}else if(A)throw new Q}else throw new Q;if(u){if(d)throw new Q;de.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(d&&de.decrement(this.getOddCounts(),this.getOddRoundingErrors()),f){if(p)throw new Q;de.increment(this.getEvenCounts(),this.getOddRoundingErrors())}p&&de.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}de.SYMBOL_WIDEST=[7,5,4,3,1],de.EVEN_TOTAL_SUBSET=[4,20,52,104,204],de.GSUM=[0,348,1388,2948,3988],de.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],de.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],de.FINDER_PAT_A=0,de.FINDER_PAT_B=1,de.FINDER_PAT_C=2,de.FINDER_PAT_D=3,de.FINDER_PAT_E=4,de.FINDER_PAT_F=5,de.FINDER_PATTERN_SEQUENCES=[[de.FINDER_PAT_A,de.FINDER_PAT_A],[de.FINDER_PAT_A,de.FINDER_PAT_B,de.FINDER_PAT_B],[de.FINDER_PAT_A,de.FINDER_PAT_C,de.FINDER_PAT_B,de.FINDER_PAT_D],[de.FINDER_PAT_A,de.FINDER_PAT_E,de.FINDER_PAT_B,de.FINDER_PAT_D,de.FINDER_PAT_C],[de.FINDER_PAT_A,de.FINDER_PAT_E,de.FINDER_PAT_B,de.FINDER_PAT_D,de.FINDER_PAT_D,de.FINDER_PAT_F],[de.FINDER_PAT_A,de.FINDER_PAT_E,de.FINDER_PAT_B,de.FINDER_PAT_D,de.FINDER_PAT_E,de.FINDER_PAT_F,de.FINDER_PAT_F],[de.FINDER_PAT_A,de.FINDER_PAT_A,de.FINDER_PAT_B,de.FINDER_PAT_B,de.FINDER_PAT_C,de.FINDER_PAT_C,de.FINDER_PAT_D,de.FINDER_PAT_D],[de.FINDER_PAT_A,de.FINDER_PAT_A,de.FINDER_PAT_B,de.FINDER_PAT_B,de.FINDER_PAT_C,de.FINDER_PAT_C,de.FINDER_PAT_D,de.FINDER_PAT_E,de.FINDER_PAT_E],[de.FINDER_PAT_A,de.FINDER_PAT_A,de.FINDER_PAT_B,de.FINDER_PAT_B,de.FINDER_PAT_C,de.FINDER_PAT_C,de.FINDER_PAT_D,de.FINDER_PAT_E,de.FINDER_PAT_F,de.FINDER_PAT_F],[de.FINDER_PAT_A,de.FINDER_PAT_A,de.FINDER_PAT_B,de.FINDER_PAT_B,de.FINDER_PAT_C,de.FINDER_PAT_D,de.FINDER_PAT_D,de.FINDER_PAT_E,de.FINDER_PAT_E,de.FINDER_PAT_F,de.FINDER_PAT_F]],de.MAX_PAIRS=11;class Ou extends Wi{constructor(r,s,a){super(r,s),this.count=0,this.finderPattern=a}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Vt extends xn{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(r,s,a){const u=this.decodePair(s,!1,r,a);Vt.addOrTally(this.possibleLeftPairs,u),s.reverse();let d=this.decodePair(s,!0,r,a);Vt.addOrTally(this.possibleRightPairs,d),s.reverse();for(let f of this.possibleLeftPairs)if(f.getCount()>1){for(let p of this.possibleRightPairs)if(p.getCount()>1&&Vt.checkChecksum(f,p))return Vt.constructResult(f,p)}throw new Q}static addOrTally(r,s){if(s==null)return;let a=!1;for(let u of r)if(u.getValue()===s.getValue()){u.incrementCount(),a=!0;break}a||r.push(s)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(r,s){let a=4537077*r.getValue()+s.getValue(),u=new String(a).toString(),d=new Ie;for(let b=13-u.length;b>0;b--)d.append("0");d.append(u);let f=0;for(let b=0;b<13;b++){let A=d.charAt(b).charCodeAt(0)-48;f+=b&1?A:3*A}f=10-f%10,f===10&&(f=0),d.append(f.toString());let p=r.getFinderPattern().getResultPoints(),w=s.getFinderPattern().getResultPoints();return new Fe(d.toString(),null,0,[p[0],p[1],w[0],w[1]],fe.RSS_14,new Date().getTime())}static checkChecksum(r,s){let a=(r.getChecksumPortion()+16*s.getChecksumPortion())%79,u=9*r.getFinderPattern().getValue()+s.getFinderPattern().getValue();return u>72&&u--,u>8&&u--,a===u}decodePair(r,s,a,u){try{let d=this.findFinderPattern(r,s),f=this.parseFoundFinderPattern(r,a,s,d),p=u==null?null:u.get(Y.NEED_RESULT_POINT_CALLBACK);if(p!=null){let A=(d[0]+d[1])/2;s&&(A=r.getSize()-1-A),p.foundPossibleResultPoint(new ke(A,a))}let w=this.decodeDataCharacter(r,f,!0),b=this.decodeDataCharacter(r,f,!1);return new Ou(1597*w.getValue()+b.getValue(),w.getChecksumPortion()+4*b.getChecksumPortion(),f)}catch{return null}}decodeDataCharacter(r,s,a){let u=this.getDataCharacterCounters();for(let ee=0;ee<u.length;ee++)u[ee]=0;if(a)_t.recordPatternInReverse(r,s.getStartEnd()[0],u);else{_t.recordPattern(r,s.getStartEnd()[1]+1,u);for(let ee=0,se=u.length-1;ee<se;ee++,se--){let xe=u[ee];u[ee]=u[se],u[se]=xe}}let d=a?16:15,f=Ge.sum(new Int32Array(u))/d,p=this.getOddCounts(),w=this.getEvenCounts(),b=this.getOddRoundingErrors(),A=this.getEvenRoundingErrors();for(let ee=0;ee<u.length;ee++){let se=u[ee]/f,xe=Math.floor(se+.5);xe<1?xe=1:xe>8&&(xe=8);let ye=Math.floor(ee/2);ee&1?(w[ye]=xe,A[ye]=se-xe):(p[ye]=xe,b[ye]=se-xe)}this.adjustOddEvenCounts(a,d);let O=0,B=0;for(let ee=p.length-1;ee>=0;ee--)B*=9,B+=p[ee],O+=p[ee];let V=0,X=0;for(let ee=w.length-1;ee>=0;ee--)V*=9,V+=w[ee],X+=w[ee];let q=B+3*V;if(a){if(O&1||O>12||O<4)throw new Q;let ee=(12-O)/2,se=Vt.OUTSIDE_ODD_WIDEST[ee],xe=9-se,ye=Ar.getRSSvalue(p,se,!1),ge=Ar.getRSSvalue(w,xe,!0),st=Vt.OUTSIDE_EVEN_TOTAL_SUBSET[ee],$e=Vt.OUTSIDE_GSUM[ee];return new Wi(ye*st+ge+$e,q)}else{if(X&1||X>10||X<4)throw new Q;let ee=(10-X)/2,se=Vt.INSIDE_ODD_WIDEST[ee],xe=9-se,ye=Ar.getRSSvalue(p,se,!0),ge=Ar.getRSSvalue(w,xe,!1),st=Vt.INSIDE_ODD_TOTAL_SUBSET[ee],$e=Vt.INSIDE_GSUM[ee];return new Wi(ge*st+ye+$e,q)}}findFinderPattern(r,s){let a=this.getDecodeFinderCounters();a[0]=0,a[1]=0,a[2]=0,a[3]=0;let u=r.getSize(),d=!1,f=0;for(;f<u&&(d=!r.get(f),s!==d);)f++;let p=0,w=f;for(let b=f;b<u;b++)if(r.get(b)!==d)a[p]++;else{if(p===3){if(xn.isFinderPattern(a))return[w,b];w+=a[0]+a[1],a[0]=a[2],a[1]=a[3],a[2]=0,a[3]=0,p--}else p++;a[p]=1,d=!d}throw new Q}parseFoundFinderPattern(r,s,a,u){let d=r.get(u[0]),f=u[0]-1;for(;f>=0&&d!==r.get(f);)f--;f++;const p=u[0]-f,w=this.getDecodeFinderCounters(),b=new Int32Array(w.length);P.arraycopy(w,0,b,1,w.length-1),b[0]=p;const A=this.parseFinderValue(b,Vt.FINDER_PATTERNS);let O=f,B=u[1];return a&&(O=r.getSize()-1-O,B=r.getSize()-1-B),new Vi(A,[f,u[1]],O,B,s)}adjustOddEvenCounts(r,s){let a=Ge.sum(new Int32Array(this.getOddCounts())),u=Ge.sum(new Int32Array(this.getEvenCounts())),d=!1,f=!1,p=!1,w=!1;r?(a>12?f=!0:a<4&&(d=!0),u>12?w=!0:u<4&&(p=!0)):(a>11?f=!0:a<5&&(d=!0),u>10?w=!0:u<4&&(p=!0));let b=a+u-s,A=(a&1)===(r?1:0),O=(u&1)===1;if(b===1)if(A){if(O)throw new Q;f=!0}else{if(!O)throw new Q;w=!0}else if(b===-1)if(A){if(O)throw new Q;d=!0}else{if(!O)throw new Q;p=!0}else if(b===0){if(A){if(!O)throw new Q;a<u?(d=!0,w=!0):(f=!0,p=!0)}else if(O)throw new Q}else throw new Q;if(d){if(f)throw new Q;xn.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(f&&xn.decrement(this.getOddCounts(),this.getOddRoundingErrors()),p){if(w)throw new Q;xn.increment(this.getEvenCounts(),this.getOddRoundingErrors())}w&&xn.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Vt.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Vt.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Vt.OUTSIDE_GSUM=[0,161,961,2015,2715],Vt.INSIDE_GSUM=[0,336,1036,1516],Vt.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Vt.INSIDE_ODD_WIDEST=[2,4,6,8],Vt.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class si extends _t{constructor(r,s){super(),this.readers=[],this.verbose=s===!0;const a=r?r.get(Y.POSSIBLE_FORMATS):null,u=r&&r.get(Y.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;a?((a.includes(fe.EAN_13)||a.includes(fe.UPC_A)||a.includes(fe.EAN_8)||a.includes(fe.UPC_E))&&this.readers.push(new da(r)),a.includes(fe.CODE_39)&&this.readers.push(new qt(u)),a.includes(fe.CODE_128)&&this.readers.push(new _e),a.includes(fe.ITF)&&this.readers.push(new bt),a.includes(fe.RSS_14)&&this.readers.push(new Vt),a.includes(fe.RSS_EXPANDED)&&this.readers.push(new de(this.verbose))):(this.readers.push(new da(r)),this.readers.push(new qt),this.readers.push(new da(r)),this.readers.push(new _e),this.readers.push(new bt),this.readers.push(new Vt),this.readers.push(new de(this.verbose)))}decodeRow(r,s,a){for(let u=0;u<this.readers.length;u++)try{return this.readers[u].decodeRow(r,s,a)}catch{}throw new Q}reset(){this.readers.forEach(r=>r.reset())}}class js extends Qe{constructor(r=500,s){super(new si(s),r,s)}}class mt{constructor(r,s,a){this.ecCodewords=r,this.ecBlocks=[s],a&&this.ecBlocks.push(a)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class ft{constructor(r,s){this.count=r,this.dataCodewords=s}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class et{constructor(r,s,a,u,d,f){this.versionNumber=r,this.symbolSizeRows=s,this.symbolSizeColumns=a,this.dataRegionSizeRows=u,this.dataRegionSizeColumns=d,this.ecBlocks=f;let p=0;const w=f.getECCodewords(),b=f.getECBlocks();for(let A of b)p+=A.getCount()*(A.getDataCodewords()+w);this.totalCodewords=p}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(r,s){if(r&1||s&1)throw new Z;for(let a of et.VERSIONS)if(a.symbolSizeRows===r&&a.symbolSizeColumns===s)return a;throw new Z}toString(){return""+this.versionNumber}static buildVersions(){return[new et(1,10,10,8,8,new mt(5,new ft(1,3))),new et(2,12,12,10,10,new mt(7,new ft(1,5))),new et(3,14,14,12,12,new mt(10,new ft(1,8))),new et(4,16,16,14,14,new mt(12,new ft(1,12))),new et(5,18,18,16,16,new mt(14,new ft(1,18))),new et(6,20,20,18,18,new mt(18,new ft(1,22))),new et(7,22,22,20,20,new mt(20,new ft(1,30))),new et(8,24,24,22,22,new mt(24,new ft(1,36))),new et(9,26,26,24,24,new mt(28,new ft(1,44))),new et(10,32,32,14,14,new mt(36,new ft(1,62))),new et(11,36,36,16,16,new mt(42,new ft(1,86))),new et(12,40,40,18,18,new mt(48,new ft(1,114))),new et(13,44,44,20,20,new mt(56,new ft(1,144))),new et(14,48,48,22,22,new mt(68,new ft(1,174))),new et(15,52,52,24,24,new mt(42,new ft(2,102))),new et(16,64,64,14,14,new mt(56,new ft(2,140))),new et(17,72,72,16,16,new mt(36,new ft(4,92))),new et(18,80,80,18,18,new mt(48,new ft(4,114))),new et(19,88,88,20,20,new mt(56,new ft(4,144))),new et(20,96,96,22,22,new mt(68,new ft(4,174))),new et(21,104,104,24,24,new mt(56,new ft(6,136))),new et(22,120,120,18,18,new mt(68,new ft(6,175))),new et(23,132,132,20,20,new mt(62,new ft(8,163))),new et(24,144,144,22,22,new mt(62,new ft(8,156),new ft(2,155))),new et(25,8,18,6,16,new mt(7,new ft(1,5))),new et(26,8,32,6,14,new mt(11,new ft(1,10))),new et(27,12,26,10,24,new mt(14,new ft(1,16))),new et(28,12,36,10,16,new mt(18,new ft(1,22))),new et(29,16,36,14,16,new mt(24,new ft(1,32))),new et(30,16,48,14,22,new mt(28,new ft(1,49)))]}}et.VERSIONS=et.buildVersions();class ut{constructor(r){const s=r.getHeight();if(s<8||s>144||s&1)throw new Z;this.version=ut.readVersion(r),this.mappingBitMatrix=this.extractDataRegion(r),this.readMappingMatrix=new Te(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(r){const s=r.getHeight(),a=r.getWidth();return et.getVersionForDimensions(s,a)}readCodewords(){const r=new Int8Array(this.version.getTotalCodewords());let s=0,a=4,u=0;const d=this.mappingBitMatrix.getHeight(),f=this.mappingBitMatrix.getWidth();let p=!1,w=!1,b=!1,A=!1;do if(a===d&&u===0&&!p)r[s++]=this.readCorner1(d,f)&255,a-=2,u+=2,p=!0;else if(a===d-2&&u===0&&f&3&&!w)r[s++]=this.readCorner2(d,f)&255,a-=2,u+=2,w=!0;else if(a===d+4&&u===2&&!(f&7)&&!b)r[s++]=this.readCorner3(d,f)&255,a-=2,u+=2,b=!0;else if(a===d-2&&u===0&&(f&7)===4&&!A)r[s++]=this.readCorner4(d,f)&255,a-=2,u+=2,A=!0;else{do a<d&&u>=0&&!this.readMappingMatrix.get(u,a)&&(r[s++]=this.readUtah(a,u,d,f)&255),a-=2,u+=2;while(a>=0&&u<f);a+=1,u+=3;do a>=0&&u<f&&!this.readMappingMatrix.get(u,a)&&(r[s++]=this.readUtah(a,u,d,f)&255),a+=2,u-=2;while(a<d&&u>=0);a+=3,u+=1}while(a<d||u<f);if(s!==this.version.getTotalCodewords())throw new Z;return r}readModule(r,s,a,u){return r<0&&(r+=a,s+=4-(a+4&7)),s<0&&(s+=u,r+=4-(u+4&7)),this.readMappingMatrix.set(s,r),this.mappingBitMatrix.get(s,r)}readUtah(r,s,a,u){let d=0;return this.readModule(r-2,s-2,a,u)&&(d|=1),d<<=1,this.readModule(r-2,s-1,a,u)&&(d|=1),d<<=1,this.readModule(r-1,s-2,a,u)&&(d|=1),d<<=1,this.readModule(r-1,s-1,a,u)&&(d|=1),d<<=1,this.readModule(r-1,s,a,u)&&(d|=1),d<<=1,this.readModule(r,s-2,a,u)&&(d|=1),d<<=1,this.readModule(r,s-1,a,u)&&(d|=1),d<<=1,this.readModule(r,s,a,u)&&(d|=1),d}readCorner1(r,s){let a=0;return this.readModule(r-1,0,r,s)&&(a|=1),a<<=1,this.readModule(r-1,1,r,s)&&(a|=1),a<<=1,this.readModule(r-1,2,r,s)&&(a|=1),a<<=1,this.readModule(0,s-2,r,s)&&(a|=1),a<<=1,this.readModule(0,s-1,r,s)&&(a|=1),a<<=1,this.readModule(1,s-1,r,s)&&(a|=1),a<<=1,this.readModule(2,s-1,r,s)&&(a|=1),a<<=1,this.readModule(3,s-1,r,s)&&(a|=1),a}readCorner2(r,s){let a=0;return this.readModule(r-3,0,r,s)&&(a|=1),a<<=1,this.readModule(r-2,0,r,s)&&(a|=1),a<<=1,this.readModule(r-1,0,r,s)&&(a|=1),a<<=1,this.readModule(0,s-4,r,s)&&(a|=1),a<<=1,this.readModule(0,s-3,r,s)&&(a|=1),a<<=1,this.readModule(0,s-2,r,s)&&(a|=1),a<<=1,this.readModule(0,s-1,r,s)&&(a|=1),a<<=1,this.readModule(1,s-1,r,s)&&(a|=1),a}readCorner3(r,s){let a=0;return this.readModule(r-1,0,r,s)&&(a|=1),a<<=1,this.readModule(r-1,s-1,r,s)&&(a|=1),a<<=1,this.readModule(0,s-3,r,s)&&(a|=1),a<<=1,this.readModule(0,s-2,r,s)&&(a|=1),a<<=1,this.readModule(0,s-1,r,s)&&(a|=1),a<<=1,this.readModule(1,s-3,r,s)&&(a|=1),a<<=1,this.readModule(1,s-2,r,s)&&(a|=1),a<<=1,this.readModule(1,s-1,r,s)&&(a|=1),a}readCorner4(r,s){let a=0;return this.readModule(r-3,0,r,s)&&(a|=1),a<<=1,this.readModule(r-2,0,r,s)&&(a|=1),a<<=1,this.readModule(r-1,0,r,s)&&(a|=1),a<<=1,this.readModule(0,s-2,r,s)&&(a|=1),a<<=1,this.readModule(0,s-1,r,s)&&(a|=1),a<<=1,this.readModule(1,s-1,r,s)&&(a|=1),a<<=1,this.readModule(2,s-1,r,s)&&(a|=1),a<<=1,this.readModule(3,s-1,r,s)&&(a|=1),a}extractDataRegion(r){const s=this.version.getSymbolSizeRows(),a=this.version.getSymbolSizeColumns();if(r.getHeight()!==s)throw new E("Dimension of bitMatrix must match the version size");const u=this.version.getDataRegionSizeRows(),d=this.version.getDataRegionSizeColumns(),f=s/u|0,p=a/d|0,w=f*u,b=p*d,A=new Te(b,w);for(let O=0;O<f;++O){const B=O*u;for(let V=0;V<p;++V){const X=V*d;for(let q=0;q<u;++q){const ee=O*(u+2)+1+q,se=B+q;for(let xe=0;xe<d;++xe){const ye=V*(d+2)+1+xe;if(r.get(ye,ee)){const ge=X+xe;A.set(ge,se)}}}}}return A}}class kt{constructor(r,s){this.numDataCodewords=r,this.codewords=s}static getDataBlocks(r,s){const a=s.getECBlocks();let u=0;const d=a.getECBlocks();for(let q of d)u+=q.getCount();const f=new Array(u);let p=0;for(let q of d)for(let ee=0;ee<q.getCount();ee++){const se=q.getDataCodewords(),xe=a.getECCodewords()+se;f[p++]=new kt(se,new Uint8Array(xe))}const b=f[0].codewords.length-a.getECCodewords(),A=b-1;let O=0;for(let q=0;q<A;q++)for(let ee=0;ee<p;ee++)f[ee].codewords[q]=r[O++];const B=s.getVersionNumber()===24,V=B?8:p;for(let q=0;q<V;q++)f[q].codewords[b-1]=r[O++];const X=f[0].codewords.length;for(let q=b;q<X;q++)for(let ee=0;ee<p;ee++){const se=B?(ee+8)%p:ee,xe=B&&se>7?q-1:q;f[se].codewords[xe]=r[O++]}if(O!==r.length)throw new E;return f}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class Gi{constructor(r){this.bytes=r,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(r){if(r<1||r>32||r>this.available())throw new E(""+r);let s=0,a=this.bitOffset,u=this.byteOffset;const d=this.bytes;if(a>0){const f=8-a,p=r<f?r:f,w=f-p,b=255>>8-p<<w;s=(d[u]&b)>>w,r-=p,a+=p,a===8&&(a=0,u++)}if(r>0){for(;r>=8;)s=s<<8|d[u]&255,u++,r-=8;if(r>0){const f=8-r,p=255>>f<<f;s=s<<r|(d[u]&p)>>f,a+=r}}return this.bitOffset=a,this.byteOffset=u,s}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var Pt;(function(M){M[M.PAD_ENCODE=0]="PAD_ENCODE",M[M.ASCII_ENCODE=1]="ASCII_ENCODE",M[M.C40_ENCODE=2]="C40_ENCODE",M[M.TEXT_ENCODE=3]="TEXT_ENCODE",M[M.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",M[M.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",M[M.BASE256_ENCODE=6]="BASE256_ENCODE"})(Pt||(Pt={}));class Wn{static decode(r){const s=new Gi(r),a=new Ie,u=new Ie,d=new Array;let f=Pt.ASCII_ENCODE;do if(f===Pt.ASCII_ENCODE)f=this.decodeAsciiSegment(s,a,u);else{switch(f){case Pt.C40_ENCODE:this.decodeC40Segment(s,a);break;case Pt.TEXT_ENCODE:this.decodeTextSegment(s,a);break;case Pt.ANSIX12_ENCODE:this.decodeAnsiX12Segment(s,a);break;case Pt.EDIFACT_ENCODE:this.decodeEdifactSegment(s,a);break;case Pt.BASE256_ENCODE:this.decodeBase256Segment(s,a,d);break;default:throw new Z}f=Pt.ASCII_ENCODE}while(f!==Pt.PAD_ENCODE&&s.available()>0);return u.length()>0&&a.append(u.toString()),new Nn(r,a.toString(),d.length===0?null:d,null)}static decodeAsciiSegment(r,s,a){let u=!1;do{let d=r.readBits(8);if(d===0)throw new Z;if(d<=128)return u&&(d+=128),s.append(String.fromCharCode(d-1)),Pt.ASCII_ENCODE;if(d===129)return Pt.PAD_ENCODE;if(d<=229){const f=d-130;f<10&&s.append("0"),s.append(""+f)}else switch(d){case 230:return Pt.C40_ENCODE;case 231:return Pt.BASE256_ENCODE;case 232:s.append("");break;case 233:case 234:break;case 235:u=!0;break;case 236:s.append("[)>05"),a.insert(0,"");break;case 237:s.append("[)>06"),a.insert(0,"");break;case 238:return Pt.ANSIX12_ENCODE;case 239:return Pt.TEXT_ENCODE;case 240:return Pt.EDIFACT_ENCODE;case 241:break;default:if(d!==254||r.available()!==0)throw new Z;break}}while(r.available()>0);return Pt.ASCII_ENCODE}static decodeC40Segment(r,s){let a=!1;const u=[];let d=0;do{if(r.available()===8)return;const f=r.readBits(8);if(f===254)return;this.parseTwoBytes(f,r.readBits(8),u);for(let p=0;p<3;p++){const w=u[p];switch(d){case 0:if(w<3)d=w+1;else if(w<this.C40_BASIC_SET_CHARS.length){const b=this.C40_BASIC_SET_CHARS[w];a?(s.append(String.fromCharCode(b.charCodeAt(0)+128)),a=!1):s.append(b)}else throw new Z;break;case 1:a?(s.append(String.fromCharCode(w+128)),a=!1):s.append(String.fromCharCode(w)),d=0;break;case 2:if(w<this.C40_SHIFT2_SET_CHARS.length){const b=this.C40_SHIFT2_SET_CHARS[w];a?(s.append(String.fromCharCode(b.charCodeAt(0)+128)),a=!1):s.append(b)}else switch(w){case 27:s.append("");break;case 30:a=!0;break;default:throw new Z}d=0;break;case 3:a?(s.append(String.fromCharCode(w+224)),a=!1):s.append(String.fromCharCode(w+96)),d=0;break;default:throw new Z}}}while(r.available()>0)}static decodeTextSegment(r,s){let a=!1,u=[],d=0;do{if(r.available()===8)return;const f=r.readBits(8);if(f===254)return;this.parseTwoBytes(f,r.readBits(8),u);for(let p=0;p<3;p++){const w=u[p];switch(d){case 0:if(w<3)d=w+1;else if(w<this.TEXT_BASIC_SET_CHARS.length){const b=this.TEXT_BASIC_SET_CHARS[w];a?(s.append(String.fromCharCode(b.charCodeAt(0)+128)),a=!1):s.append(b)}else throw new Z;break;case 1:a?(s.append(String.fromCharCode(w+128)),a=!1):s.append(String.fromCharCode(w)),d=0;break;case 2:if(w<this.TEXT_SHIFT2_SET_CHARS.length){const b=this.TEXT_SHIFT2_SET_CHARS[w];a?(s.append(String.fromCharCode(b.charCodeAt(0)+128)),a=!1):s.append(b)}else switch(w){case 27:s.append("");break;case 30:a=!0;break;default:throw new Z}d=0;break;case 3:if(w<this.TEXT_SHIFT3_SET_CHARS.length){const b=this.TEXT_SHIFT3_SET_CHARS[w];a?(s.append(String.fromCharCode(b.charCodeAt(0)+128)),a=!1):s.append(b),d=0}else throw new Z;break;default:throw new Z}}}while(r.available()>0)}static decodeAnsiX12Segment(r,s){const a=[];do{if(r.available()===8)return;const u=r.readBits(8);if(u===254)return;this.parseTwoBytes(u,r.readBits(8),a);for(let d=0;d<3;d++){const f=a[d];switch(f){case 0:s.append("\r");break;case 1:s.append("*");break;case 2:s.append(">");break;case 3:s.append(" ");break;default:if(f<14)s.append(String.fromCharCode(f+44));else if(f<40)s.append(String.fromCharCode(f+51));else throw new Z;break}}}while(r.available()>0)}static parseTwoBytes(r,s,a){let u=(r<<8)+s-1,d=Math.floor(u/1600);a[0]=d,u-=d*1600,d=Math.floor(u/40),a[1]=d,a[2]=u-d*40}static decodeEdifactSegment(r,s){do{if(r.available()<=16)return;for(let a=0;a<4;a++){let u=r.readBits(6);if(u===31){const d=8-r.getBitOffset();d!==8&&r.readBits(d);return}u&32||(u|=64),s.append(String.fromCharCode(u))}}while(r.available()>0)}static decodeBase256Segment(r,s,a){let u=1+r.getByteOffset();const d=this.unrandomize255State(r.readBits(8),u++);let f;if(d===0?f=r.available()/8|0:d<250?f=d:f=250*(d-249)+this.unrandomize255State(r.readBits(8),u++),f<0)throw new Z;const p=new Uint8Array(f);for(let w=0;w<f;w++){if(r.available()<8)throw new Z;p[w]=this.unrandomize255State(r.readBits(8),u++)}a.push(p);try{s.append(ce.decode(p,ue.ISO88591))}catch(w){throw new Ot("Platform does not support required encoding: "+w.message)}}static unrandomize255State(r,s){const a=149*s%255+1,u=r-a;return u>=0?u:u+256}}Wn.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Wn.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Wn.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Wn.TEXT_SHIFT2_SET_CHARS=Wn.C40_SHIFT2_SET_CHARS,Wn.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class ga{constructor(){this.rsDecoder=new Ze(Le.DATA_MATRIX_FIELD_256)}decode(r){const s=new ut(r),a=s.getVersion(),u=s.readCodewords(),d=kt.getDataBlocks(u,a);let f=0;for(let b of d)f+=b.getNumDataCodewords();const p=new Uint8Array(f),w=d.length;for(let b=0;b<w;b++){const A=d[b],O=A.getCodewords(),B=A.getNumDataCodewords();this.correctErrors(O,B);for(let V=0;V<B;V++)p[V*w+b]=O[V]}return Wn.decode(p)}correctErrors(r,s){const a=new Int32Array(r);try{this.rsDecoder.decode(a,r.length-s)}catch{throw new U}for(let u=0;u<s;u++)r[u]=a[u]}}class De{constructor(r){this.image=r,this.rectangleDetector=new Sr(this.image)}detect(){const r=this.rectangleDetector.detect();let s=this.detectSolid1(r);if(s=this.detectSolid2(s),s[3]=this.correctTopRight(s),!s[3])throw new Q;s=this.shiftToModuleCenter(s);const a=s[0],u=s[1],d=s[2],f=s[3];let p=this.transitionsBetween(a,f)+1,w=this.transitionsBetween(d,f)+1;(p&1)===1&&(p+=1),(w&1)===1&&(w+=1),4*p<7*w&&4*w<7*p&&(p=w=Math.max(p,w));let b=De.sampleGrid(this.image,a,u,d,f,p,w);return new dr(b,[a,u,d,f])}static shiftPoint(r,s,a){let u=(s.getX()-r.getX())/(a+1),d=(s.getY()-r.getY())/(a+1);return new ke(r.getX()+u,r.getY()+d)}static moveAway(r,s,a){let u=r.getX(),d=r.getY();return u<s?u-=1:u+=1,d<a?d-=1:d+=1,new ke(u,d)}detectSolid1(r){let s=r[0],a=r[1],u=r[3],d=r[2],f=this.transitionsBetween(s,a),p=this.transitionsBetween(a,u),w=this.transitionsBetween(u,d),b=this.transitionsBetween(d,s),A=f,O=[d,s,a,u];return A>p&&(A=p,O[0]=s,O[1]=a,O[2]=u,O[3]=d),A>w&&(A=w,O[0]=a,O[1]=u,O[2]=d,O[3]=s),A>b&&(O[0]=u,O[1]=d,O[2]=s,O[3]=a),O}detectSolid2(r){let s=r[0],a=r[1],u=r[2],d=r[3],f=this.transitionsBetween(s,d),p=De.shiftPoint(a,u,(f+1)*4),w=De.shiftPoint(u,a,(f+1)*4),b=this.transitionsBetween(p,s),A=this.transitionsBetween(w,d);return b<A?(r[0]=s,r[1]=a,r[2]=u,r[3]=d):(r[0]=a,r[1]=u,r[2]=d,r[3]=s),r}correctTopRight(r){let s=r[0],a=r[1],u=r[2],d=r[3],f=this.transitionsBetween(s,d),p=this.transitionsBetween(a,d),w=De.shiftPoint(s,a,(p+1)*4),b=De.shiftPoint(u,a,(f+1)*4);f=this.transitionsBetween(w,d),p=this.transitionsBetween(b,d);let A=new ke(d.getX()+(u.getX()-a.getX())/(f+1),d.getY()+(u.getY()-a.getY())/(f+1)),O=new ke(d.getX()+(s.getX()-a.getX())/(p+1),d.getY()+(s.getY()-a.getY())/(p+1));if(!this.isValid(A))return this.isValid(O)?O:null;if(!this.isValid(O))return A;let B=this.transitionsBetween(w,A)+this.transitionsBetween(b,A),V=this.transitionsBetween(w,O)+this.transitionsBetween(b,O);return B>V?A:O}shiftToModuleCenter(r){let s=r[0],a=r[1],u=r[2],d=r[3],f=this.transitionsBetween(s,d)+1,p=this.transitionsBetween(u,d)+1,w=De.shiftPoint(s,a,p*4),b=De.shiftPoint(u,a,f*4);f=this.transitionsBetween(w,d)+1,p=this.transitionsBetween(b,d)+1,(f&1)===1&&(f+=1),(p&1)===1&&(p+=1);let A=(s.getX()+a.getX()+u.getX()+d.getX())/4,O=(s.getY()+a.getY()+u.getY()+d.getY())/4;s=De.moveAway(s,A,O),a=De.moveAway(a,A,O),u=De.moveAway(u,A,O),d=De.moveAway(d,A,O);let B,V;return w=De.shiftPoint(s,a,p*4),w=De.shiftPoint(w,d,f*4),B=De.shiftPoint(a,s,p*4),B=De.shiftPoint(B,u,f*4),b=De.shiftPoint(u,d,p*4),b=De.shiftPoint(b,a,f*4),V=De.shiftPoint(d,u,p*4),V=De.shiftPoint(V,s,f*4),[w,B,b,V]}isValid(r){return r.getX()>=0&&r.getX()<this.image.getWidth()&&r.getY()>0&&r.getY()<this.image.getHeight()}static sampleGrid(r,s,a,u,d,f,p){return In.getInstance().sampleGrid(r,f,p,.5,.5,f-.5,.5,f-.5,p-.5,.5,p-.5,s.getX(),s.getY(),d.getX(),d.getY(),u.getX(),u.getY(),a.getX(),a.getY())}transitionsBetween(r,s){let a=Math.trunc(r.getX()),u=Math.trunc(r.getY()),d=Math.trunc(s.getX()),f=Math.trunc(s.getY()),p=Math.abs(f-u)>Math.abs(d-a);if(p){let q=a;a=u,u=q,q=d,d=f,f=q}let w=Math.abs(d-a),b=Math.abs(f-u),A=-w/2,O=u<f?1:-1,B=a<d?1:-1,V=0,X=this.image.get(p?u:a,p?a:u);for(let q=a,ee=u;q!==d;q+=B){let se=this.image.get(p?ee:q,p?q:ee);if(se!==X&&(V++,X=se),A+=b,A>0){if(ee===f)break;ee+=O,A-=w}}return V}}class vt{constructor(){this.decoder=new ga}decode(r,s=null){let a,u;if(s!=null&&s.has(Y.PURE_BARCODE)){const b=vt.extractPureBits(r.getBlackMatrix());a=this.decoder.decode(b),u=vt.NO_POINTS}else{const b=new De(r.getBlackMatrix()).detect();a=this.decoder.decode(b.getBits()),u=b.getPoints()}const d=a.getRawBytes(),f=new Fe(a.getText(),d,8*d.length,u,fe.DATA_MATRIX,P.currentTimeMillis()),p=a.getByteSegments();p!=null&&f.putMetadata(Je.BYTE_SEGMENTS,p);const w=a.getECLevel();return w!=null&&f.putMetadata(Je.ERROR_CORRECTION_LEVEL,w),f}reset(){}static extractPureBits(r){const s=r.getTopLeftOnBit(),a=r.getBottomRightOnBit();if(s==null||a==null)throw new Q;const u=this.moduleSize(s,r);let d=s[1];const f=a[1];let p=s[0];const b=(a[0]-p+1)/u,A=(f-d+1)/u;if(b<=0||A<=0)throw new Q;const O=u/2;d+=O,p+=O;const B=new Te(b,A);for(let V=0;V<A;V++){const X=d+V*u;for(let q=0;q<b;q++)r.get(p+q*u,X)&&B.set(q,V)}return B}static moduleSize(r,s){const a=s.getWidth();let u=r[0];const d=r[1];for(;u<a&&s.get(u,d);)u++;if(u===a)throw new Q;const f=u-r[0];if(f===0)throw new Q;return f}}vt.NO_POINTS=[];class ma extends Qe{constructor(r=500){super(new vt,r)}}var Hr;(function(M){M[M.L=0]="L",M[M.M=1]="M",M[M.Q=2]="Q",M[M.H=3]="H"})(Hr||(Hr={}));class it{constructor(r,s,a){this.value=r,this.stringValue=s,this.bits=a,it.FOR_BITS.set(a,this),it.FOR_VALUE.set(r,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(r){switch(r){case"L":return it.L;case"M":return it.M;case"Q":return it.Q;case"H":return it.H;default:throw new S(r+"not available")}}toString(){return this.stringValue}equals(r){if(!(r instanceof it))return!1;const s=r;return this.value===s.value}static forBits(r){if(r<0||r>=it.FOR_BITS.size)throw new E;return it.FOR_BITS.get(r)}}it.FOR_BITS=new Map,it.FOR_VALUE=new Map,it.L=new it(Hr.L,"L",1),it.M=new it(Hr.M,"M",0),it.Q=new it(Hr.Q,"Q",3),it.H=new it(Hr.H,"H",2);class wn{constructor(r){this.errorCorrectionLevel=it.forBits(r>>3&3),this.dataMask=r&7}static numBitsDiffering(r,s){return k.bitCount(r^s)}static decodeFormatInformation(r,s){const a=wn.doDecodeFormatInformation(r,s);return a!==null?a:wn.doDecodeFormatInformation(r^wn.FORMAT_INFO_MASK_QR,s^wn.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(r,s){let a=Number.MAX_SAFE_INTEGER,u=0;for(const d of wn.FORMAT_INFO_DECODE_LOOKUP){const f=d[0];if(f===r||f===s)return new wn(d[1]);let p=wn.numBitsDiffering(r,f);p<a&&(u=d[1],a=p),r!==s&&(p=wn.numBitsDiffering(s,f),p<a&&(u=d[1],a=p))}return a<=3?new wn(u):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(r){if(!(r instanceof wn))return!1;const s=r;return this.errorCorrectionLevel===s.errorCorrectionLevel&&this.dataMask===s.dataMask}}wn.FORMAT_INFO_MASK_QR=21522,wn.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class te{constructor(r,...s){this.ecCodewordsPerBlock=r,this.ecBlocks=s}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let r=0;const s=this.ecBlocks;for(const a of s)r+=a.getCount();return r}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class W{constructor(r,s){this.count=r,this.dataCodewords=s}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Ce{constructor(r,s,...a){this.versionNumber=r,this.alignmentPatternCenters=s,this.ecBlocks=a;let u=0;const d=a[0].getECCodewordsPerBlock(),f=a[0].getECBlocks();for(const p of f)u+=p.getCount()*(p.getDataCodewords()+d);this.totalCodewords=u}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(r){return this.ecBlocks[r.getValue()]}static getProvisionalVersionForDimension(r){if(r%4!==1)throw new Z;try{return this.getVersionForNumber((r-17)/4)}catch{throw new Z}}static getVersionForNumber(r){if(r<1||r>40)throw new E;return Ce.VERSIONS[r-1]}static decodeVersionInformation(r){let s=Number.MAX_SAFE_INTEGER,a=0;for(let u=0;u<Ce.VERSION_DECODE_INFO.length;u++){const d=Ce.VERSION_DECODE_INFO[u];if(d===r)return Ce.getVersionForNumber(u+7);const f=wn.numBitsDiffering(r,d);f<s&&(a=u+7,s=f)}return s<=3?Ce.getVersionForNumber(a):null}buildFunctionPattern(){const r=this.getDimensionForVersion(),s=new Te(r);s.setRegion(0,0,9,9),s.setRegion(r-8,0,8,9),s.setRegion(0,r-8,9,8);const a=this.alignmentPatternCenters.length;for(let u=0;u<a;u++){const d=this.alignmentPatternCenters[u]-2;for(let f=0;f<a;f++)u===0&&(f===0||f===a-1)||u===a-1&&f===0||s.setRegion(this.alignmentPatternCenters[f]-2,d,5,5)}return s.setRegion(6,9,1,r-17),s.setRegion(9,6,r-17,1),this.versionNumber>6&&(s.setRegion(r-11,0,3,6),s.setRegion(0,r-11,6,3)),s}toString(){return""+this.versionNumber}}Ce.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),Ce.VERSIONS=[new Ce(1,new Int32Array(0),new te(7,new W(1,19)),new te(10,new W(1,16)),new te(13,new W(1,13)),new te(17,new W(1,9))),new Ce(2,Int32Array.from([6,18]),new te(10,new W(1,34)),new te(16,new W(1,28)),new te(22,new W(1,22)),new te(28,new W(1,16))),new Ce(3,Int32Array.from([6,22]),new te(15,new W(1,55)),new te(26,new W(1,44)),new te(18,new W(2,17)),new te(22,new W(2,13))),new Ce(4,Int32Array.from([6,26]),new te(20,new W(1,80)),new te(18,new W(2,32)),new te(26,new W(2,24)),new te(16,new W(4,9))),new Ce(5,Int32Array.from([6,30]),new te(26,new W(1,108)),new te(24,new W(2,43)),new te(18,new W(2,15),new W(2,16)),new te(22,new W(2,11),new W(2,12))),new Ce(6,Int32Array.from([6,34]),new te(18,new W(2,68)),new te(16,new W(4,27)),new te(24,new W(4,19)),new te(28,new W(4,15))),new Ce(7,Int32Array.from([6,22,38]),new te(20,new W(2,78)),new te(18,new W(4,31)),new te(18,new W(2,14),new W(4,15)),new te(26,new W(4,13),new W(1,14))),new Ce(8,Int32Array.from([6,24,42]),new te(24,new W(2,97)),new te(22,new W(2,38),new W(2,39)),new te(22,new W(4,18),new W(2,19)),new te(26,new W(4,14),new W(2,15))),new Ce(9,Int32Array.from([6,26,46]),new te(30,new W(2,116)),new te(22,new W(3,36),new W(2,37)),new te(20,new W(4,16),new W(4,17)),new te(24,new W(4,12),new W(4,13))),new Ce(10,Int32Array.from([6,28,50]),new te(18,new W(2,68),new W(2,69)),new te(26,new W(4,43),new W(1,44)),new te(24,new W(6,19),new W(2,20)),new te(28,new W(6,15),new W(2,16))),new Ce(11,Int32Array.from([6,30,54]),new te(20,new W(4,81)),new te(30,new W(1,50),new W(4,51)),new te(28,new W(4,22),new W(4,23)),new te(24,new W(3,12),new W(8,13))),new Ce(12,Int32Array.from([6,32,58]),new te(24,new W(2,92),new W(2,93)),new te(22,new W(6,36),new W(2,37)),new te(26,new W(4,20),new W(6,21)),new te(28,new W(7,14),new W(4,15))),new Ce(13,Int32Array.from([6,34,62]),new te(26,new W(4,107)),new te(22,new W(8,37),new W(1,38)),new te(24,new W(8,20),new W(4,21)),new te(22,new W(12,11),new W(4,12))),new Ce(14,Int32Array.from([6,26,46,66]),new te(30,new W(3,115),new W(1,116)),new te(24,new W(4,40),new W(5,41)),new te(20,new W(11,16),new W(5,17)),new te(24,new W(11,12),new W(5,13))),new Ce(15,Int32Array.from([6,26,48,70]),new te(22,new W(5,87),new W(1,88)),new te(24,new W(5,41),new W(5,42)),new te(30,new W(5,24),new W(7,25)),new te(24,new W(11,12),new W(7,13))),new Ce(16,Int32Array.from([6,26,50,74]),new te(24,new W(5,98),new W(1,99)),new te(28,new W(7,45),new W(3,46)),new te(24,new W(15,19),new W(2,20)),new te(30,new W(3,15),new W(13,16))),new Ce(17,Int32Array.from([6,30,54,78]),new te(28,new W(1,107),new W(5,108)),new te(28,new W(10,46),new W(1,47)),new te(28,new W(1,22),new W(15,23)),new te(28,new W(2,14),new W(17,15))),new Ce(18,Int32Array.from([6,30,56,82]),new te(30,new W(5,120),new W(1,121)),new te(26,new W(9,43),new W(4,44)),new te(28,new W(17,22),new W(1,23)),new te(28,new W(2,14),new W(19,15))),new Ce(19,Int32Array.from([6,30,58,86]),new te(28,new W(3,113),new W(4,114)),new te(26,new W(3,44),new W(11,45)),new te(26,new W(17,21),new W(4,22)),new te(26,new W(9,13),new W(16,14))),new Ce(20,Int32Array.from([6,34,62,90]),new te(28,new W(3,107),new W(5,108)),new te(26,new W(3,41),new W(13,42)),new te(30,new W(15,24),new W(5,25)),new te(28,new W(15,15),new W(10,16))),new Ce(21,Int32Array.from([6,28,50,72,94]),new te(28,new W(4,116),new W(4,117)),new te(26,new W(17,42)),new te(28,new W(17,22),new W(6,23)),new te(30,new W(19,16),new W(6,17))),new Ce(22,Int32Array.from([6,26,50,74,98]),new te(28,new W(2,111),new W(7,112)),new te(28,new W(17,46)),new te(30,new W(7,24),new W(16,25)),new te(24,new W(34,13))),new Ce(23,Int32Array.from([6,30,54,78,102]),new te(30,new W(4,121),new W(5,122)),new te(28,new W(4,47),new W(14,48)),new te(30,new W(11,24),new W(14,25)),new te(30,new W(16,15),new W(14,16))),new Ce(24,Int32Array.from([6,28,54,80,106]),new te(30,new W(6,117),new W(4,118)),new te(28,new W(6,45),new W(14,46)),new te(30,new W(11,24),new W(16,25)),new te(30,new W(30,16),new W(2,17))),new Ce(25,Int32Array.from([6,32,58,84,110]),new te(26,new W(8,106),new W(4,107)),new te(28,new W(8,47),new W(13,48)),new te(30,new W(7,24),new W(22,25)),new te(30,new W(22,15),new W(13,16))),new Ce(26,Int32Array.from([6,30,58,86,114]),new te(28,new W(10,114),new W(2,115)),new te(28,new W(19,46),new W(4,47)),new te(28,new W(28,22),new W(6,23)),new te(30,new W(33,16),new W(4,17))),new Ce(27,Int32Array.from([6,34,62,90,118]),new te(30,new W(8,122),new W(4,123)),new te(28,new W(22,45),new W(3,46)),new te(30,new W(8,23),new W(26,24)),new te(30,new W(12,15),new W(28,16))),new Ce(28,Int32Array.from([6,26,50,74,98,122]),new te(30,new W(3,117),new W(10,118)),new te(28,new W(3,45),new W(23,46)),new te(30,new W(4,24),new W(31,25)),new te(30,new W(11,15),new W(31,16))),new Ce(29,Int32Array.from([6,30,54,78,102,126]),new te(30,new W(7,116),new W(7,117)),new te(28,new W(21,45),new W(7,46)),new te(30,new W(1,23),new W(37,24)),new te(30,new W(19,15),new W(26,16))),new Ce(30,Int32Array.from([6,26,52,78,104,130]),new te(30,new W(5,115),new W(10,116)),new te(28,new W(19,47),new W(10,48)),new te(30,new W(15,24),new W(25,25)),new te(30,new W(23,15),new W(25,16))),new Ce(31,Int32Array.from([6,30,56,82,108,134]),new te(30,new W(13,115),new W(3,116)),new te(28,new W(2,46),new W(29,47)),new te(30,new W(42,24),new W(1,25)),new te(30,new W(23,15),new W(28,16))),new Ce(32,Int32Array.from([6,34,60,86,112,138]),new te(30,new W(17,115)),new te(28,new W(10,46),new W(23,47)),new te(30,new W(10,24),new W(35,25)),new te(30,new W(19,15),new W(35,16))),new Ce(33,Int32Array.from([6,30,58,86,114,142]),new te(30,new W(17,115),new W(1,116)),new te(28,new W(14,46),new W(21,47)),new te(30,new W(29,24),new W(19,25)),new te(30,new W(11,15),new W(46,16))),new Ce(34,Int32Array.from([6,34,62,90,118,146]),new te(30,new W(13,115),new W(6,116)),new te(28,new W(14,46),new W(23,47)),new te(30,new W(44,24),new W(7,25)),new te(30,new W(59,16),new W(1,17))),new Ce(35,Int32Array.from([6,30,54,78,102,126,150]),new te(30,new W(12,121),new W(7,122)),new te(28,new W(12,47),new W(26,48)),new te(30,new W(39,24),new W(14,25)),new te(30,new W(22,15),new W(41,16))),new Ce(36,Int32Array.from([6,24,50,76,102,128,154]),new te(30,new W(6,121),new W(14,122)),new te(28,new W(6,47),new W(34,48)),new te(30,new W(46,24),new W(10,25)),new te(30,new W(2,15),new W(64,16))),new Ce(37,Int32Array.from([6,28,54,80,106,132,158]),new te(30,new W(17,122),new W(4,123)),new te(28,new W(29,46),new W(14,47)),new te(30,new W(49,24),new W(10,25)),new te(30,new W(24,15),new W(46,16))),new Ce(38,Int32Array.from([6,32,58,84,110,136,162]),new te(30,new W(4,122),new W(18,123)),new te(28,new W(13,46),new W(32,47)),new te(30,new W(48,24),new W(14,25)),new te(30,new W(42,15),new W(32,16))),new Ce(39,Int32Array.from([6,26,54,82,110,138,166]),new te(30,new W(20,117),new W(4,118)),new te(28,new W(40,47),new W(7,48)),new te(30,new W(43,24),new W(22,25)),new te(30,new W(10,15),new W(67,16))),new Ce(40,Int32Array.from([6,30,58,86,114,142,170]),new te(30,new W(19,118),new W(6,119)),new te(28,new W(18,47),new W(31,48)),new te(30,new W(34,24),new W(34,25)),new te(30,new W(20,15),new W(61,16)))];var Rt;(function(M){M[M.DATA_MASK_000=0]="DATA_MASK_000",M[M.DATA_MASK_001=1]="DATA_MASK_001",M[M.DATA_MASK_010=2]="DATA_MASK_010",M[M.DATA_MASK_011=3]="DATA_MASK_011",M[M.DATA_MASK_100=4]="DATA_MASK_100",M[M.DATA_MASK_101=5]="DATA_MASK_101",M[M.DATA_MASK_110=6]="DATA_MASK_110",M[M.DATA_MASK_111=7]="DATA_MASK_111"})(Rt||(Rt={}));class _n{constructor(r,s){this.value=r,this.isMasked=s}unmaskBitMatrix(r,s){for(let a=0;a<s;a++)for(let u=0;u<s;u++)this.isMasked(a,u)&&r.flip(u,a)}}_n.values=new Map([[Rt.DATA_MASK_000,new _n(Rt.DATA_MASK_000,(M,r)=>(M+r&1)===0)],[Rt.DATA_MASK_001,new _n(Rt.DATA_MASK_001,(M,r)=>(M&1)===0)],[Rt.DATA_MASK_010,new _n(Rt.DATA_MASK_010,(M,r)=>r%3===0)],[Rt.DATA_MASK_011,new _n(Rt.DATA_MASK_011,(M,r)=>(M+r)%3===0)],[Rt.DATA_MASK_100,new _n(Rt.DATA_MASK_100,(M,r)=>(Math.floor(M/2)+Math.floor(r/3)&1)===0)],[Rt.DATA_MASK_101,new _n(Rt.DATA_MASK_101,(M,r)=>M*r%6===0)],[Rt.DATA_MASK_110,new _n(Rt.DATA_MASK_110,(M,r)=>M*r%6<3)],[Rt.DATA_MASK_111,new _n(Rt.DATA_MASK_111,(M,r)=>(M+r+M*r%3&1)===0)]]);class Ds{constructor(r){const s=r.getHeight();if(s<21||(s&3)!==1)throw new Z;this.bitMatrix=r}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let r=0;for(let d=0;d<6;d++)r=this.copyBit(d,8,r);r=this.copyBit(7,8,r),r=this.copyBit(8,8,r),r=this.copyBit(8,7,r);for(let d=5;d>=0;d--)r=this.copyBit(8,d,r);const s=this.bitMatrix.getHeight();let a=0;const u=s-7;for(let d=s-1;d>=u;d--)a=this.copyBit(8,d,a);for(let d=s-8;d<s;d++)a=this.copyBit(d,8,a);if(this.parsedFormatInfo=wn.decodeFormatInformation(r,a),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new Z}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const r=this.bitMatrix.getHeight(),s=Math.floor((r-17)/4);if(s<=6)return Ce.getVersionForNumber(s);let a=0;const u=r-11;for(let f=5;f>=0;f--)for(let p=r-9;p>=u;p--)a=this.copyBit(p,f,a);let d=Ce.decodeVersionInformation(a);if(d!==null&&d.getDimensionForVersion()===r)return this.parsedVersion=d,d;a=0;for(let f=5;f>=0;f--)for(let p=r-9;p>=u;p--)a=this.copyBit(f,p,a);if(d=Ce.decodeVersionInformation(a),d!==null&&d.getDimensionForVersion()===r)return this.parsedVersion=d,d;throw new Z}copyBit(r,s,a){return(this.isMirror?this.bitMatrix.get(s,r):this.bitMatrix.get(r,s))?a<<1|1:a<<1}readCodewords(){const r=this.readFormatInformation(),s=this.readVersion(),a=_n.values.get(r.getDataMask()),u=this.bitMatrix.getHeight();a.unmaskBitMatrix(this.bitMatrix,u);const d=s.buildFunctionPattern();let f=!0;const p=new Uint8Array(s.getTotalCodewords());let w=0,b=0,A=0;for(let O=u-1;O>0;O-=2){O===6&&O--;for(let B=0;B<u;B++){const V=f?u-1-B:B;for(let X=0;X<2;X++)d.get(O-X,V)||(A++,b<<=1,this.bitMatrix.get(O-X,V)&&(b|=1),A===8&&(p[w++]=b,A=0,b=0))}f=!f}if(w!==s.getTotalCodewords())throw new Z;return p}remask(){if(this.parsedFormatInfo===null)return;const r=_n.values[this.parsedFormatInfo.getDataMask()],s=this.bitMatrix.getHeight();r.unmaskBitMatrix(this.bitMatrix,s)}setMirror(r){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=r}mirror(){const r=this.bitMatrix;for(let s=0,a=r.getWidth();s<a;s++)for(let u=s+1,d=r.getHeight();u<d;u++)r.get(s,u)!==r.get(u,s)&&(r.flip(u,s),r.flip(s,u))}}class Bs{constructor(r,s){this.numDataCodewords=r,this.codewords=s}static getDataBlocks(r,s,a){if(r.length!==s.getTotalCodewords())throw new E;const u=s.getECBlocksForLevel(a);let d=0;const f=u.getECBlocks();for(const X of f)d+=X.getCount();const p=new Array(d);let w=0;for(const X of f)for(let q=0;q<X.getCount();q++){const ee=X.getDataCodewords(),se=u.getECCodewordsPerBlock()+ee;p[w++]=new Bs(ee,new Uint8Array(se))}const b=p[0].codewords.length;let A=p.length-1;for(;A>=0&&p[A].codewords.length!==b;)A--;A++;const O=b-u.getECCodewordsPerBlock();let B=0;for(let X=0;X<O;X++)for(let q=0;q<w;q++)p[q].codewords[X]=r[B++];for(let X=A;X<w;X++)p[X].codewords[O]=r[B++];const V=p[0].codewords.length;for(let X=O;X<V;X++)for(let q=0;q<w;q++){const ee=q<A?X:X+1;p[q].codewords[ee]=r[B++]}return p}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var bn;(function(M){M[M.TERMINATOR=0]="TERMINATOR",M[M.NUMERIC=1]="NUMERIC",M[M.ALPHANUMERIC=2]="ALPHANUMERIC",M[M.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",M[M.BYTE=4]="BYTE",M[M.ECI=5]="ECI",M[M.KANJI=6]="KANJI",M[M.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",M[M.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",M[M.HANZI=9]="HANZI"})(bn||(bn={}));class Be{constructor(r,s,a,u){this.value=r,this.stringValue=s,this.characterCountBitsForVersions=a,this.bits=u,Be.FOR_BITS.set(u,this),Be.FOR_VALUE.set(r,this)}static forBits(r){const s=Be.FOR_BITS.get(r);if(s===void 0)throw new E;return s}getCharacterCountBits(r){const s=r.getVersionNumber();let a;return s<=9?a=0:s<=26?a=1:a=2,this.characterCountBitsForVersions[a]}getValue(){return this.value}getBits(){return this.bits}equals(r){if(!(r instanceof Be))return!1;const s=r;return this.value===s.value}toString(){return this.stringValue}}Be.FOR_BITS=new Map,Be.FOR_VALUE=new Map,Be.TERMINATOR=new Be(bn.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),Be.NUMERIC=new Be(bn.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),Be.ALPHANUMERIC=new Be(bn.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),Be.STRUCTURED_APPEND=new Be(bn.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),Be.BYTE=new Be(bn.BYTE,"BYTE",Int32Array.from([8,16,16]),4),Be.ECI=new Be(bn.ECI,"ECI",Int32Array.from([0,0,0]),7),Be.KANJI=new Be(bn.KANJI,"KANJI",Int32Array.from([8,10,12]),8),Be.FNC1_FIRST_POSITION=new Be(bn.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),Be.FNC1_SECOND_POSITION=new Be(bn.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),Be.HANZI=new Be(bn.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class Mt{static decode(r,s,a,u){const d=new Gi(r);let f=new Ie;const p=new Array;let w=-1,b=-1;try{let A=null,O=!1,B;do{if(d.available()<4)B=Be.TERMINATOR;else{const V=d.readBits(4);B=Be.forBits(V)}switch(B){case Be.TERMINATOR:break;case Be.FNC1_FIRST_POSITION:case Be.FNC1_SECOND_POSITION:O=!0;break;case Be.STRUCTURED_APPEND:if(d.available()<16)throw new Z;w=d.readBits(8),b=d.readBits(8);break;case Be.ECI:const V=Mt.parseECIValue(d);if(A=ie.getCharacterSetECIByValue(V),A===null)throw new Z;break;case Be.HANZI:const X=d.readBits(4),q=d.readBits(B.getCharacterCountBits(s));X===Mt.GB2312_SUBSET&&Mt.decodeHanziSegment(d,f,q);break;default:const ee=d.readBits(B.getCharacterCountBits(s));switch(B){case Be.NUMERIC:Mt.decodeNumericSegment(d,f,ee);break;case Be.ALPHANUMERIC:Mt.decodeAlphanumericSegment(d,f,ee,O);break;case Be.BYTE:Mt.decodeByteSegment(d,f,ee,A,p,u);break;case Be.KANJI:Mt.decodeKanjiSegment(d,f,ee);break;default:throw new Z}break}}while(B!==Be.TERMINATOR)}catch{throw new Z}return new Nn(r,f.toString(),p.length===0?null:p,a===null?null:a.toString(),w,b)}static decodeHanziSegment(r,s,a){if(a*13>r.available())throw new Z;const u=new Uint8Array(2*a);let d=0;for(;a>0;){const f=r.readBits(13);let p=f/96<<8&4294967295|f%96;p<959?p+=41377:p+=42657,u[d]=p>>8&255,u[d+1]=p&255,d+=2,a--}try{s.append(ce.decode(u,ue.GB2312))}catch(f){throw new Z(f)}}static decodeKanjiSegment(r,s,a){if(a*13>r.available())throw new Z;const u=new Uint8Array(2*a);let d=0;for(;a>0;){const f=r.readBits(13);let p=f/192<<8&4294967295|f%192;p<7936?p+=33088:p+=49472,u[d]=p>>8,u[d+1]=p,d+=2,a--}try{s.append(ce.decode(u,ue.SHIFT_JIS))}catch(f){throw new Z(f)}}static decodeByteSegment(r,s,a,u,d,f){if(8*a>r.available())throw new Z;const p=new Uint8Array(a);for(let b=0;b<a;b++)p[b]=r.readBits(8);let w;u===null?w=ue.guessEncoding(p,f):w=u.getName();try{s.append(ce.decode(p,w))}catch(b){throw new Z(b)}d.push(p)}static toAlphaNumericChar(r){if(r>=Mt.ALPHANUMERIC_CHARS.length)throw new Z;return Mt.ALPHANUMERIC_CHARS[r]}static decodeAlphanumericSegment(r,s,a,u){const d=s.length();for(;a>1;){if(r.available()<11)throw new Z;const f=r.readBits(11);s.append(Mt.toAlphaNumericChar(Math.floor(f/45))),s.append(Mt.toAlphaNumericChar(f%45)),a-=2}if(a===1){if(r.available()<6)throw new Z;s.append(Mt.toAlphaNumericChar(r.readBits(6)))}if(u)for(let f=d;f<s.length();f++)s.charAt(f)==="%"&&(f<s.length()-1&&s.charAt(f+1)==="%"?s.deleteCharAt(f+1):s.setCharAt(f,""))}static decodeNumericSegment(r,s,a){for(;a>=3;){if(r.available()<10)throw new Z;const u=r.readBits(10);if(u>=1e3)throw new Z;s.append(Mt.toAlphaNumericChar(Math.floor(u/100))),s.append(Mt.toAlphaNumericChar(Math.floor(u/10)%10)),s.append(Mt.toAlphaNumericChar(u%10)),a-=3}if(a===2){if(r.available()<7)throw new Z;const u=r.readBits(7);if(u>=100)throw new Z;s.append(Mt.toAlphaNumericChar(Math.floor(u/10))),s.append(Mt.toAlphaNumericChar(u%10))}else if(a===1){if(r.available()<4)throw new Z;const u=r.readBits(4);if(u>=10)throw new Z;s.append(Mt.toAlphaNumericChar(u))}}static parseECIValue(r){const s=r.readBits(8);if(!(s&128))return s&127;if((s&192)===128){const a=r.readBits(8);return(s&63)<<8&4294967295|a}if((s&224)===192){const a=r.readBits(16);return(s&31)<<16&4294967295|a}throw new Z}}Mt.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",Mt.GB2312_SUBSET=1;class Fs{constructor(r){this.mirrored=r}isMirrored(){return this.mirrored}applyMirroredCorrection(r){if(!this.mirrored||r===null||r.length<3)return;const s=r[0];r[0]=r[2],r[2]=s}}class pa{constructor(){this.rsDecoder=new Ze(Le.QR_CODE_FIELD_256)}decodeBooleanArray(r,s){return this.decodeBitMatrix(Te.parseFromBooleanArray(r),s)}decodeBitMatrix(r,s){const a=new Ds(r);let u=null;try{return this.decodeBitMatrixParser(a,s)}catch(d){u=d}try{a.remask(),a.setMirror(!0),a.readVersion(),a.readFormatInformation(),a.mirror();const d=this.decodeBitMatrixParser(a,s);return d.setOther(new Fs(!0)),d}catch(d){throw u!==null?u:d}}decodeBitMatrixParser(r,s){const a=r.readVersion(),u=r.readFormatInformation().getErrorCorrectionLevel(),d=r.readCodewords(),f=Bs.getDataBlocks(d,a,u);let p=0;for(const A of f)p+=A.getNumDataCodewords();const w=new Uint8Array(p);let b=0;for(const A of f){const O=A.getCodewords(),B=A.getNumDataCodewords();this.correctErrors(O,B);for(let V=0;V<B;V++)w[b++]=O[V]}return Mt.decode(w,a,u,s)}correctErrors(r,s){const a=new Int32Array(r);try{this.rsDecoder.decode(a,r.length-s)}catch{throw new U}for(let u=0;u<s;u++)r[u]=a[u]}}class Us extends ke{constructor(r,s,a){super(r,s),this.estimatedModuleSize=a}aboutEquals(r,s,a){if(Math.abs(s-this.getY())<=r&&Math.abs(a-this.getX())<=r){const u=Math.abs(r-this.estimatedModuleSize);return u<=1||u<=this.estimatedModuleSize}return!1}combineEstimate(r,s,a){const u=(this.getX()+s)/2,d=(this.getY()+r)/2,f=(this.estimatedModuleSize+a)/2;return new Us(u,d,f)}}class bi{constructor(r,s,a,u,d,f,p){this.image=r,this.startX=s,this.startY=a,this.width=u,this.height=d,this.moduleSize=f,this.resultPointCallback=p,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const r=this.startX,s=this.height,a=this.width,u=r+a,d=this.startY+s/2,f=new Int32Array(3),p=this.image;for(let w=0;w<s;w++){const b=d+(w&1?-Math.floor((w+1)/2):Math.floor((w+1)/2));f[0]=0,f[1]=0,f[2]=0;let A=r;for(;A<u&&!p.get(A,b);)A++;let O=0;for(;A<u;){if(p.get(A,b))if(O===1)f[1]++;else if(O===2){if(this.foundPatternCross(f)){const B=this.handlePossibleCenter(f,b,A);if(B!==null)return B}f[0]=f[2],f[1]=1,f[2]=0,O=1}else f[++O]++;else O===1&&O++,f[O]++;A++}if(this.foundPatternCross(f)){const B=this.handlePossibleCenter(f,b,u);if(B!==null)return B}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new Q}static centerFromEnd(r,s){return s-r[2]-r[1]/2}foundPatternCross(r){const s=this.moduleSize,a=s/2;for(let u=0;u<3;u++)if(Math.abs(s-r[u])>=a)return!1;return!0}crossCheckVertical(r,s,a,u){const d=this.image,f=d.getHeight(),p=this.crossCheckStateCount;p[0]=0,p[1]=0,p[2]=0;let w=r;for(;w>=0&&d.get(s,w)&&p[1]<=a;)p[1]++,w--;if(w<0||p[1]>a)return NaN;for(;w>=0&&!d.get(s,w)&&p[0]<=a;)p[0]++,w--;if(p[0]>a)return NaN;for(w=r+1;w<f&&d.get(s,w)&&p[1]<=a;)p[1]++,w++;if(w===f||p[1]>a)return NaN;for(;w<f&&!d.get(s,w)&&p[2]<=a;)p[2]++,w++;if(p[2]>a)return NaN;const b=p[0]+p[1]+p[2];return 5*Math.abs(b-u)>=2*u?NaN:this.foundPatternCross(p)?bi.centerFromEnd(p,w):NaN}handlePossibleCenter(r,s,a){const u=r[0]+r[1]+r[2],d=bi.centerFromEnd(r,a),f=this.crossCheckVertical(s,d,2*r[1],u);if(!isNaN(f)){const p=(r[0]+r[1]+r[2])/3;for(const b of this.possibleCenters)if(b.aboutEquals(p,f,d))return b.combineEstimate(f,d,p);const w=new Us(d,f,p);this.possibleCenters.push(w),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(w)}return null}}class fo extends ke{constructor(r,s,a,u){super(r,s),this.estimatedModuleSize=a,this.count=u,u===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(r,s,a){if(Math.abs(s-this.getY())<=r&&Math.abs(a-this.getX())<=r){const u=Math.abs(r-this.estimatedModuleSize);return u<=1||u<=this.estimatedModuleSize}return!1}combineEstimate(r,s,a){const u=this.count+1,d=(this.count*this.getX()+s)/u,f=(this.count*this.getY()+r)/u,p=(this.count*this.estimatedModuleSize+a)/u;return new fo(d,f,p,u)}}class xa{constructor(r){this.bottomLeft=r[0],this.topLeft=r[1],this.topRight=r[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class sn{constructor(r,s){this.image=r,this.resultPointCallback=s,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=s}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(r){const s=r!=null&&r.get(Y.TRY_HARDER)!==void 0,a=r!=null&&r.get(Y.PURE_BARCODE)!==void 0,u=this.image,d=u.getHeight(),f=u.getWidth();let p=Math.floor(3*d/(4*sn.MAX_MODULES));(p<sn.MIN_SKIP||s)&&(p=sn.MIN_SKIP);let w=!1;const b=new Int32Array(5);for(let O=p-1;O<d&&!w;O+=p){b[0]=0,b[1]=0,b[2]=0,b[3]=0,b[4]=0;let B=0;for(let V=0;V<f;V++)if(u.get(V,O))(B&1)===1&&B++,b[B]++;else if(B&1)b[B]++;else if(B===4)if(sn.foundPatternCross(b)){if(this.handlePossibleCenter(b,O,V,a)===!0)if(p=2,this.hasSkipped===!0)w=this.haveMultiplyConfirmedCenters();else{const q=this.findRowSkip();q>b[2]&&(O+=q-b[2]-p,V=f-1)}else{b[0]=b[2],b[1]=b[3],b[2]=b[4],b[3]=1,b[4]=0,B=3;continue}B=0,b[0]=0,b[1]=0,b[2]=0,b[3]=0,b[4]=0}else b[0]=b[2],b[1]=b[3],b[2]=b[4],b[3]=1,b[4]=0,B=3;else b[++B]++;sn.foundPatternCross(b)&&this.handlePossibleCenter(b,O,f,a)===!0&&(p=b[0],this.hasSkipped&&(w=this.haveMultiplyConfirmedCenters()))}const A=this.selectBestPatterns();return ke.orderBestPatterns(A),new xa(A)}static centerFromEnd(r,s){return s-r[4]-r[3]-r[2]/2}static foundPatternCross(r){let s=0;for(let d=0;d<5;d++){const f=r[d];if(f===0)return!1;s+=f}if(s<7)return!1;const a=s/7,u=a/2;return Math.abs(a-r[0])<u&&Math.abs(a-r[1])<u&&Math.abs(3*a-r[2])<3*u&&Math.abs(a-r[3])<u&&Math.abs(a-r[4])<u}getCrossCheckStateCount(){const r=this.crossCheckStateCount;return r[0]=0,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r}crossCheckDiagonal(r,s,a,u){const d=this.getCrossCheckStateCount();let f=0;const p=this.image;for(;r>=f&&s>=f&&p.get(s-f,r-f);)d[2]++,f++;if(r<f||s<f)return!1;for(;r>=f&&s>=f&&!p.get(s-f,r-f)&&d[1]<=a;)d[1]++,f++;if(r<f||s<f||d[1]>a)return!1;for(;r>=f&&s>=f&&p.get(s-f,r-f)&&d[0]<=a;)d[0]++,f++;if(d[0]>a)return!1;const w=p.getHeight(),b=p.getWidth();for(f=1;r+f<w&&s+f<b&&p.get(s+f,r+f);)d[2]++,f++;if(r+f>=w||s+f>=b)return!1;for(;r+f<w&&s+f<b&&!p.get(s+f,r+f)&&d[3]<a;)d[3]++,f++;if(r+f>=w||s+f>=b||d[3]>=a)return!1;for(;r+f<w&&s+f<b&&p.get(s+f,r+f)&&d[4]<a;)d[4]++,f++;if(d[4]>=a)return!1;const A=d[0]+d[1]+d[2]+d[3]+d[4];return Math.abs(A-u)<2*u&&sn.foundPatternCross(d)}crossCheckVertical(r,s,a,u){const d=this.image,f=d.getHeight(),p=this.getCrossCheckStateCount();let w=r;for(;w>=0&&d.get(s,w);)p[2]++,w--;if(w<0)return NaN;for(;w>=0&&!d.get(s,w)&&p[1]<=a;)p[1]++,w--;if(w<0||p[1]>a)return NaN;for(;w>=0&&d.get(s,w)&&p[0]<=a;)p[0]++,w--;if(p[0]>a)return NaN;for(w=r+1;w<f&&d.get(s,w);)p[2]++,w++;if(w===f)return NaN;for(;w<f&&!d.get(s,w)&&p[3]<a;)p[3]++,w++;if(w===f||p[3]>=a)return NaN;for(;w<f&&d.get(s,w)&&p[4]<a;)p[4]++,w++;if(p[4]>=a)return NaN;const b=p[0]+p[1]+p[2]+p[3]+p[4];return 5*Math.abs(b-u)>=2*u?NaN:sn.foundPatternCross(p)?sn.centerFromEnd(p,w):NaN}crossCheckHorizontal(r,s,a,u){const d=this.image,f=d.getWidth(),p=this.getCrossCheckStateCount();let w=r;for(;w>=0&&d.get(w,s);)p[2]++,w--;if(w<0)return NaN;for(;w>=0&&!d.get(w,s)&&p[1]<=a;)p[1]++,w--;if(w<0||p[1]>a)return NaN;for(;w>=0&&d.get(w,s)&&p[0]<=a;)p[0]++,w--;if(p[0]>a)return NaN;for(w=r+1;w<f&&d.get(w,s);)p[2]++,w++;if(w===f)return NaN;for(;w<f&&!d.get(w,s)&&p[3]<a;)p[3]++,w++;if(w===f||p[3]>=a)return NaN;for(;w<f&&d.get(w,s)&&p[4]<a;)p[4]++,w++;if(p[4]>=a)return NaN;const b=p[0]+p[1]+p[2]+p[3]+p[4];return 5*Math.abs(b-u)>=u?NaN:sn.foundPatternCross(p)?sn.centerFromEnd(p,w):NaN}handlePossibleCenter(r,s,a,u){const d=r[0]+r[1]+r[2]+r[3]+r[4];let f=sn.centerFromEnd(r,a),p=this.crossCheckVertical(s,Math.floor(f),r[2],d);if(!isNaN(p)&&(f=this.crossCheckHorizontal(Math.floor(f),Math.floor(p),r[2],d),!isNaN(f)&&(!u||this.crossCheckDiagonal(Math.floor(p),Math.floor(f),r[2],d)))){const w=d/7;let b=!1;const A=this.possibleCenters;for(let O=0,B=A.length;O<B;O++){const V=A[O];if(V.aboutEquals(w,p,f)){A[O]=V.combineEstimate(p,f,w),b=!0;break}}if(!b){const O=new fo(f,p,w);A.push(O),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(O)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let s=null;for(const a of this.possibleCenters)if(a.getCount()>=sn.CENTER_QUORUM)if(s==null)s=a;else return this.hasSkipped=!0,Math.floor((Math.abs(s.getX()-a.getX())-Math.abs(s.getY()-a.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let r=0,s=0;const a=this.possibleCenters.length;for(const f of this.possibleCenters)f.getCount()>=sn.CENTER_QUORUM&&(r++,s+=f.getEstimatedModuleSize());if(r<3)return!1;const u=s/a;let d=0;for(const f of this.possibleCenters)d+=Math.abs(f.getEstimatedModuleSize()-u);return d<=.05*s}selectBestPatterns(){const r=this.possibleCenters.length;if(r<3)throw new Q;const s=this.possibleCenters;let a;if(r>3){let u=0,d=0;for(const w of this.possibleCenters){const b=w.getEstimatedModuleSize();u+=b,d+=b*b}a=u/r;let f=Math.sqrt(d/r-a*a);s.sort((w,b)=>{const A=Math.abs(b.getEstimatedModuleSize()-a),O=Math.abs(w.getEstimatedModuleSize()-a);return A<O?-1:A>O?1:0});const p=Math.max(.2*a,f);for(let w=0;w<s.length&&s.length>3;w++){const b=s[w];Math.abs(b.getEstimatedModuleSize()-a)>p&&(s.splice(w,1),w--)}}if(s.length>3){let u=0;for(const d of s)u+=d.getEstimatedModuleSize();a=u/s.length,s.sort((d,f)=>{if(f.getCount()===d.getCount()){const p=Math.abs(f.getEstimatedModuleSize()-a),w=Math.abs(d.getEstimatedModuleSize()-a);return p<w?1:p>w?-1:0}else return f.getCount()-d.getCount()}),s.splice(3)}return[s[0],s[1],s[2]]}}sn.CENTER_QUORUM=2,sn.MIN_SKIP=3,sn.MAX_MODULES=57;class We{constructor(r){this.image=r}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(r){this.resultPointCallback=r==null?null:r.get(Y.NEED_RESULT_POINT_CALLBACK);const a=new sn(this.image,this.resultPointCallback).find(r);return this.processFinderPatternInfo(a)}processFinderPatternInfo(r){const s=r.getTopLeft(),a=r.getTopRight(),u=r.getBottomLeft(),d=this.calculateModuleSize(s,a,u);if(d<1)throw new Q("No pattern found in proccess finder.");const f=We.computeDimension(s,a,u,d),p=Ce.getProvisionalVersionForDimension(f),w=p.getDimensionForVersion()-7;let b=null;if(p.getAlignmentPatternCenters().length>0){const V=a.getX()-s.getX()+u.getX(),X=a.getY()-s.getY()+u.getY(),q=1-3/w,ee=Math.floor(s.getX()+q*(V-s.getX())),se=Math.floor(s.getY()+q*(X-s.getY()));for(let xe=4;xe<=16;xe<<=1)try{b=this.findAlignmentInRegion(d,ee,se,xe);break}catch(ye){if(!(ye instanceof Q))throw ye}}const A=We.createTransform(s,a,u,b,f),O=We.sampleGrid(this.image,A,f);let B;return b===null?B=[u,s,a]:B=[u,s,a,b],new dr(O,B)}static createTransform(r,s,a,u,d){const f=d-3.5;let p,w,b,A;return u!==null?(p=u.getX(),w=u.getY(),b=f-3,A=b):(p=s.getX()-r.getX()+a.getX(),w=s.getY()-r.getY()+a.getY(),b=f,A=f),rt.quadrilateralToQuadrilateral(3.5,3.5,f,3.5,b,A,3.5,f,r.getX(),r.getY(),s.getX(),s.getY(),p,w,a.getX(),a.getY())}static sampleGrid(r,s,a){return In.getInstance().sampleGridWithTransform(r,a,a,s)}static computeDimension(r,s,a,u){const d=Ge.round(ke.distance(r,s)/u),f=Ge.round(ke.distance(r,a)/u);let p=Math.floor((d+f)/2)+7;switch(p&3){case 0:p++;break;case 2:p--;break;case 3:throw new Q("Dimensions could be not found.")}return p}calculateModuleSize(r,s,a){return(this.calculateModuleSizeOneWay(r,s)+this.calculateModuleSizeOneWay(r,a))/2}calculateModuleSizeOneWay(r,s){const a=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(r.getX()),Math.floor(r.getY()),Math.floor(s.getX()),Math.floor(s.getY())),u=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(s.getX()),Math.floor(s.getY()),Math.floor(r.getX()),Math.floor(r.getY()));return isNaN(a)?u/7:isNaN(u)?a/7:(a+u)/14}sizeOfBlackWhiteBlackRunBothWays(r,s,a,u){let d=this.sizeOfBlackWhiteBlackRun(r,s,a,u),f=1,p=r-(a-r);p<0?(f=r/(r-p),p=0):p>=this.image.getWidth()&&(f=(this.image.getWidth()-1-r)/(p-r),p=this.image.getWidth()-1);let w=Math.floor(s-(u-s)*f);return f=1,w<0?(f=s/(s-w),w=0):w>=this.image.getHeight()&&(f=(this.image.getHeight()-1-s)/(w-s),w=this.image.getHeight()-1),p=Math.floor(r+(p-r)*f),d+=this.sizeOfBlackWhiteBlackRun(r,s,p,w),d-1}sizeOfBlackWhiteBlackRun(r,s,a,u){const d=Math.abs(u-s)>Math.abs(a-r);if(d){let V=r;r=s,s=V,V=a,a=u,u=V}const f=Math.abs(a-r),p=Math.abs(u-s);let w=-f/2;const b=r<a?1:-1,A=s<u?1:-1;let O=0;const B=a+b;for(let V=r,X=s;V!==B;V+=b){const q=d?X:V,ee=d?V:X;if(O===1===this.image.get(q,ee)){if(O===2)return Ge.distance(V,X,r,s);O++}if(w+=p,w>0){if(X===u)break;X+=A,w-=f}}return O===2?Ge.distance(a+b,u,r,s):NaN}findAlignmentInRegion(r,s,a,u){const d=Math.floor(u*r),f=Math.max(0,s-d),p=Math.min(this.image.getWidth()-1,s+d);if(p-f<r*3)throw new Q("Alignment top exceeds estimated module size.");const w=Math.max(0,a-d),b=Math.min(this.image.getHeight()-1,a+d);if(b-w<r*3)throw new Q("Alignment bottom exceeds estimated module size.");return new bi(this.image,f,w,p-f,b-w,r,this.resultPointCallback).find()}}class cn{constructor(){this.decoder=new pa}getDecoder(){return this.decoder}decode(r,s){let a,u;if(s!=null&&s.get(Y.PURE_BARCODE)!==void 0){const w=cn.extractPureBits(r.getBlackMatrix());a=this.decoder.decodeBitMatrix(w,s),u=cn.NO_POINTS}else{const w=new We(r.getBlackMatrix()).detect(s);a=this.decoder.decodeBitMatrix(w.getBits(),s),u=w.getPoints()}a.getOther()instanceof Fs&&a.getOther().applyMirroredCorrection(u);const d=new Fe(a.getText(),a.getRawBytes(),void 0,u,fe.QR_CODE,void 0),f=a.getByteSegments();f!==null&&d.putMetadata(Je.BYTE_SEGMENTS,f);const p=a.getECLevel();return p!==null&&d.putMetadata(Je.ERROR_CORRECTION_LEVEL,p),a.hasStructuredAppend()&&(d.putMetadata(Je.STRUCTURED_APPEND_SEQUENCE,a.getStructuredAppendSequenceNumber()),d.putMetadata(Je.STRUCTURED_APPEND_PARITY,a.getStructuredAppendParity())),d}reset(){}static extractPureBits(r){const s=r.getTopLeftOnBit(),a=r.getBottomRightOnBit();if(s===null||a===null)throw new Q;const u=this.moduleSize(s,r);let d=s[1],f=a[1],p=s[0],w=a[0];if(p>=w||d>=f)throw new Q;if(f-d!==w-p&&(w=p+(f-d),w>=r.getWidth()))throw new Q;const b=Math.round((w-p+1)/u),A=Math.round((f-d+1)/u);if(b<=0||A<=0)throw new Q;if(A!==b)throw new Q;const O=Math.floor(u/2);d+=O,p+=O;const B=p+Math.floor((b-1)*u)-w;if(B>0){if(B>O)throw new Q;p-=B}const V=d+Math.floor((A-1)*u)-f;if(V>0){if(V>O)throw new Q;d-=V}const X=new Te(b,A);for(let q=0;q<A;q++){const ee=d+Math.floor(q*u);for(let se=0;se<b;se++)r.get(p+Math.floor(se*u),ee)&&X.set(se,q)}return X}static moduleSize(r,s){const a=s.getHeight(),u=s.getWidth();let d=r[0],f=r[1],p=!0,w=0;for(;d<u&&f<a;){if(p!==s.get(d,f)){if(++w===5)break;p=!p}d++,f++}if(d===u||f===a)throw new Q;return(d-r[0])/7}}cn.NO_POINTS=new Array;class Se{PDF417Common(){}static getBitCountSum(r){return Ge.sum(r)}static toIntArray(r){if(r==null||!r.length)return Se.EMPTY_INT_ARRAY;const s=new Int32Array(r.length);let a=0;for(const u of r)s[a++]=u;return s}static getCodeword(r){const s=I.binarySearch(Se.SYMBOL_TABLE,r&262143);return s<0?-1:(Se.CODEWORD_TABLE[s]-1)%Se.NUMBER_OF_CODEWORDS}}Se.NUMBER_OF_CODEWORDS=929,Se.MAX_CODEWORDS_IN_BARCODE=Se.NUMBER_OF_CODEWORDS-1,Se.MIN_ROWS_IN_BARCODE=3,Se.MAX_ROWS_IN_BARCODE=90,Se.MODULES_IN_CODEWORD=17,Se.MODULES_IN_STOP_PATTERN=18,Se.BARS_IN_MODULE=8,Se.EMPTY_INT_ARRAY=new Int32Array([]),Se.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),Se.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class Ll{constructor(r,s){this.bits=r,this.points=s}getBits(){return this.bits}getPoints(){return this.points}}class Ye{static detectMultiple(r,s,a){let u=r.getBlackMatrix(),d=Ye.detect(a,u);return d.length||(u=u.clone(),u.rotate180(),d=Ye.detect(a,u)),new Ll(u,d)}static detect(r,s){const a=new Array;let u=0,d=0,f=!1;for(;u<s.getHeight();){const p=Ye.findVertices(s,u,d);if(p[0]==null&&p[3]==null){if(!f)break;f=!1,d=0;for(const w of a)w[1]!=null&&(u=Math.trunc(Math.max(u,w[1].getY()))),w[3]!=null&&(u=Math.max(u,Math.trunc(w[3].getY())));u+=Ye.ROW_STEP;continue}if(f=!0,a.push(p),!r)break;p[2]!=null?(d=Math.trunc(p[2].getX()),u=Math.trunc(p[2].getY())):(d=Math.trunc(p[4].getX()),u=Math.trunc(p[4].getY()))}return a}static findVertices(r,s,a){const u=r.getHeight(),d=r.getWidth(),f=new Array(8);return Ye.copyToResult(f,Ye.findRowsWithPattern(r,u,d,s,a,Ye.START_PATTERN),Ye.INDEXES_START_PATTERN),f[4]!=null&&(a=Math.trunc(f[4].getX()),s=Math.trunc(f[4].getY())),Ye.copyToResult(f,Ye.findRowsWithPattern(r,u,d,s,a,Ye.STOP_PATTERN),Ye.INDEXES_STOP_PATTERN),f}static copyToResult(r,s,a){for(let u=0;u<a.length;u++)r[a[u]]=s[u]}static findRowsWithPattern(r,s,a,u,d,f){const p=new Array(4);let w=!1;const b=new Int32Array(f.length);for(;u<s;u+=Ye.ROW_STEP){let O=Ye.findGuardPattern(r,d,u,a,!1,f,b);if(O!=null){for(;u>0;){const B=Ye.findGuardPattern(r,d,--u,a,!1,f,b);if(B!=null)O=B;else{u++;break}}p[0]=new ke(O[0],u),p[1]=new ke(O[1],u),w=!0;break}}let A=u+1;if(w){let O=0,B=Int32Array.from([Math.trunc(p[0].getX()),Math.trunc(p[1].getX())]);for(;A<s;A++){const V=Ye.findGuardPattern(r,B[0],A,a,!1,f,b);if(V!=null&&Math.abs(B[0]-V[0])<Ye.MAX_PATTERN_DRIFT&&Math.abs(B[1]-V[1])<Ye.MAX_PATTERN_DRIFT)B=V,O=0;else{if(O>Ye.SKIPPED_ROW_COUNT_MAX)break;O++}}A-=O+1,p[2]=new ke(B[0],A),p[3]=new ke(B[1],A)}return A-u<Ye.BARCODE_MIN_HEIGHT&&I.fill(p,null),p}static findGuardPattern(r,s,a,u,d,f,p){I.fillWithin(p,0,p.length,0);let w=s,b=0;for(;r.get(w,a)&&w>0&&b++<Ye.MAX_PIXEL_DRIFT;)w--;let A=w,O=0,B=f.length;for(let V=d;A<u;A++)if(r.get(A,a)!==V)p[O]++;else{if(O===B-1){if(Ye.patternMatchVariance(p,f,Ye.MAX_INDIVIDUAL_VARIANCE)<Ye.MAX_AVG_VARIANCE)return new Int32Array([w,A]);w+=p[0]+p[1],P.arraycopy(p,2,p,0,O-1),p[O-1]=0,p[O]=0,O--}else O++;p[O]=1,V=!V}return O===B-1&&Ye.patternMatchVariance(p,f,Ye.MAX_INDIVIDUAL_VARIANCE)<Ye.MAX_AVG_VARIANCE?new Int32Array([w,A-1]):null}static patternMatchVariance(r,s,a){let u=r.length,d=0,f=0;for(let b=0;b<u;b++)d+=r[b],f+=s[b];if(d<f)return 1/0;let p=d/f;a*=p;let w=0;for(let b=0;b<u;b++){let A=r[b],O=s[b]*p,B=A>O?A-O:O-A;if(B>a)return 1/0;w+=B}return w/d}}Ye.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Ye.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Ye.MAX_AVG_VARIANCE=.42,Ye.MAX_INDIVIDUAL_VARIANCE=.8,Ye.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Ye.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Ye.MAX_PIXEL_DRIFT=3,Ye.MAX_PATTERN_DRIFT=5,Ye.SKIPPED_ROW_COUNT_MAX=25,Ye.ROW_STEP=5,Ye.BARCODE_MIN_HEIGHT=10;class tn{constructor(r,s){if(s.length===0)throw new E;this.field=r;let a=s.length;if(a>1&&s[0]===0){let u=1;for(;u<a&&s[u]===0;)u++;u===a?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(a-u),P.arraycopy(s,u,this.coefficients,0,this.coefficients.length))}else this.coefficients=s}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(r){return this.coefficients[this.coefficients.length-1-r]}evaluateAt(r){if(r===0)return this.getCoefficient(0);if(r===1){let u=0;for(let d of this.coefficients)u=this.field.add(u,d);return u}let s=this.coefficients[0],a=this.coefficients.length;for(let u=1;u<a;u++)s=this.field.add(this.field.multiply(r,s),this.coefficients[u]);return s}add(r){if(!this.field.equals(r.field))throw new E("ModulusPolys do not have same ModulusGF field");if(this.isZero())return r;if(r.isZero())return this;let s=this.coefficients,a=r.coefficients;if(s.length>a.length){let f=s;s=a,a=f}let u=new Int32Array(a.length),d=a.length-s.length;P.arraycopy(a,0,u,0,d);for(let f=d;f<a.length;f++)u[f]=this.field.add(s[f-d],a[f]);return new tn(this.field,u)}subtract(r){if(!this.field.equals(r.field))throw new E("ModulusPolys do not have same ModulusGF field");return r.isZero()?this:this.add(r.negative())}multiply(r){return r instanceof tn?this.multiplyOther(r):this.multiplyScalar(r)}multiplyOther(r){if(!this.field.equals(r.field))throw new E("ModulusPolys do not have same ModulusGF field");if(this.isZero()||r.isZero())return new tn(this.field,new Int32Array([0]));let s=this.coefficients,a=s.length,u=r.coefficients,d=u.length,f=new Int32Array(a+d-1);for(let p=0;p<a;p++){let w=s[p];for(let b=0;b<d;b++)f[p+b]=this.field.add(f[p+b],this.field.multiply(w,u[b]))}return new tn(this.field,f)}negative(){let r=this.coefficients.length,s=new Int32Array(r);for(let a=0;a<r;a++)s[a]=this.field.subtract(0,this.coefficients[a]);return new tn(this.field,s)}multiplyScalar(r){if(r===0)return new tn(this.field,new Int32Array([0]));if(r===1)return this;let s=this.coefficients.length,a=new Int32Array(s);for(let u=0;u<s;u++)a[u]=this.field.multiply(this.coefficients[u],r);return new tn(this.field,a)}multiplyByMonomial(r,s){if(r<0)throw new E;if(s===0)return new tn(this.field,new Int32Array([0]));let a=this.coefficients.length,u=new Int32Array(a+r);for(let d=0;d<a;d++)u[d]=this.field.multiply(this.coefficients[d],s);return new tn(this.field,u)}toString(){let r=new Ie;for(let s=this.getDegree();s>=0;s--){let a=this.getCoefficient(s);a!==0&&(a<0?(r.append(" - "),a=-a):r.length()>0&&r.append(" + "),(s===0||a!==1)&&r.append(a),s!==0&&(s===1?r.append("x"):(r.append("x^"),r.append(s))))}return r.toString()}}class ya{add(r,s){return(r+s)%this.modulus}subtract(r,s){return(this.modulus+r-s)%this.modulus}exp(r){return this.expTable[r]}log(r){if(r===0)throw new E;return this.logTable[r]}inverse(r){if(r===0)throw new gt;return this.expTable[this.modulus-this.logTable[r]-1]}multiply(r,s){return r===0||s===0?0:this.expTable[(this.logTable[r]+this.logTable[s])%(this.modulus-1)]}getSize(){return this.modulus}equals(r){return r===this}}class Wr extends ya{constructor(r,s){super(),this.modulus=r,this.expTable=new Int32Array(r),this.logTable=new Int32Array(r);let a=1;for(let u=0;u<r;u++)this.expTable[u]=a,a=a*s%r;for(let u=0;u<r-1;u++)this.logTable[this.expTable[u]]=u;this.zero=new tn(this,new Int32Array([0])),this.one=new tn(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(r,s){if(r<0)throw new E;if(s===0)return this.zero;let a=new Int32Array(r+1);return a[0]=s,new tn(this,a)}}Wr.PDF417_GF=new Wr(Se.NUMBER_OF_CODEWORDS,3);class go{constructor(){this.field=Wr.PDF417_GF}decode(r,s,a){let u=new tn(this.field,r),d=new Int32Array(s),f=!1;for(let X=s;X>0;X--){let q=u.evaluateAt(this.field.exp(X));d[s-X]=q,q!==0&&(f=!0)}if(!f)return 0;let p=this.field.getOne();if(a!=null)for(const X of a){let q=this.field.exp(r.length-1-X),ee=new tn(this.field,new Int32Array([this.field.subtract(0,q),1]));p=p.multiply(ee)}let w=new tn(this.field,d),b=this.runEuclideanAlgorithm(this.field.buildMonomial(s,1),w,s),A=b[0],O=b[1],B=this.findErrorLocations(A),V=this.findErrorMagnitudes(O,A,B);for(let X=0;X<B.length;X++){let q=r.length-1-this.field.log(B[X]);if(q<0)throw U.getChecksumInstance();r[q]=this.field.subtract(r[q],V[X])}return B.length}runEuclideanAlgorithm(r,s,a){if(r.getDegree()<s.getDegree()){let B=r;r=s,s=B}let u=r,d=s,f=this.field.getZero(),p=this.field.getOne();for(;d.getDegree()>=Math.round(a/2);){let B=u,V=f;if(u=d,f=p,u.isZero())throw U.getChecksumInstance();d=B;let X=this.field.getZero(),q=u.getCoefficient(u.getDegree()),ee=this.field.inverse(q);for(;d.getDegree()>=u.getDegree()&&!d.isZero();){let se=d.getDegree()-u.getDegree(),xe=this.field.multiply(d.getCoefficient(d.getDegree()),ee);X=X.add(this.field.buildMonomial(se,xe)),d=d.subtract(u.multiplyByMonomial(se,xe))}p=X.multiply(f).subtract(V).negative()}let w=p.getCoefficient(0);if(w===0)throw U.getChecksumInstance();let b=this.field.inverse(w),A=p.multiply(b),O=d.multiply(b);return[A,O]}findErrorLocations(r){let s=r.getDegree(),a=new Int32Array(s),u=0;for(let d=1;d<this.field.getSize()&&u<s;d++)r.evaluateAt(d)===0&&(a[u]=this.field.inverse(d),u++);if(u!==s)throw U.getChecksumInstance();return a}findErrorMagnitudes(r,s,a){let u=s.getDegree(),d=new Int32Array(u);for(let b=1;b<=u;b++)d[u-b]=this.field.multiply(b,s.getCoefficient(b));let f=new tn(this.field,d),p=a.length,w=new Int32Array(p);for(let b=0;b<p;b++){let A=this.field.inverse(a[b]),O=this.field.subtract(0,r.evaluateAt(A)),B=this.field.inverse(f.evaluateAt(A));w[b]=this.field.multiply(O,B)}return w}}class fr{constructor(r,s,a,u,d){r instanceof fr?this.constructor_2(r):this.constructor_1(r,s,a,u,d)}constructor_1(r,s,a,u,d){const f=s==null||a==null,p=u==null||d==null;if(f&&p)throw new Q;f?(s=new ke(0,u.getY()),a=new ke(0,d.getY())):p&&(u=new ke(r.getWidth()-1,s.getY()),d=new ke(r.getWidth()-1,a.getY())),this.image=r,this.topLeft=s,this.bottomLeft=a,this.topRight=u,this.bottomRight=d,this.minX=Math.trunc(Math.min(s.getX(),a.getX())),this.maxX=Math.trunc(Math.max(u.getX(),d.getX())),this.minY=Math.trunc(Math.min(s.getY(),u.getY())),this.maxY=Math.trunc(Math.max(a.getY(),d.getY()))}constructor_2(r){this.image=r.image,this.topLeft=r.getTopLeft(),this.bottomLeft=r.getBottomLeft(),this.topRight=r.getTopRight(),this.bottomRight=r.getBottomRight(),this.minX=r.getMinX(),this.maxX=r.getMaxX(),this.minY=r.getMinY(),this.maxY=r.getMaxY()}static merge(r,s){return r==null?s:s==null?r:new fr(r.image,r.topLeft,r.bottomLeft,s.topRight,s.bottomRight)}addMissingRows(r,s,a){let u=this.topLeft,d=this.bottomLeft,f=this.topRight,p=this.bottomRight;if(r>0){let w=a?this.topLeft:this.topRight,b=Math.trunc(w.getY()-r);b<0&&(b=0);let A=new ke(w.getX(),b);a?u=A:f=A}if(s>0){let w=a?this.bottomLeft:this.bottomRight,b=Math.trunc(w.getY()+s);b>=this.image.getHeight()&&(b=this.image.getHeight()-1);let A=new ke(w.getX(),b);a?d=A:p=A}return new fr(this.image,u,d,f,p)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class un{constructor(r,s,a,u){this.columnCount=r,this.errorCorrectionLevel=u,this.rowCountUpperPart=s,this.rowCountLowerPart=a,this.rowCount=s+a}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class gr{constructor(){this.buffer=""}static form(r,s){let a=-1;function u(f,p,w,b,A,O){if(f==="%%")return"%";if(s[++a]===void 0)return;f=b?parseInt(b.substr(1)):void 0;let B=A?parseInt(A.substr(1)):void 0,V;switch(O){case"s":V=s[a];break;case"c":V=s[a][0];break;case"f":V=parseFloat(s[a]).toFixed(f);break;case"p":V=parseFloat(s[a]).toPrecision(f);break;case"e":V=parseFloat(s[a]).toExponential(f);break;case"x":V=parseInt(s[a]).toString(B||16);break;case"d":V=parseFloat(parseInt(s[a],B||10).toPrecision(f)).toFixed(0);break}V=typeof V=="object"?JSON.stringify(V):(+V).toString(B);let X=parseInt(w),q=w&&w[0]+""=="0"?"0":" ";for(;V.length<X;)V=p!==void 0?V+q:q+V;return V}let d=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return r.replace(d,u)}format(r,...s){this.buffer+=gr.form(r,s)}toString(){return this.buffer}}class Zi{constructor(r){this.boundingBox=new fr(r),this.codewords=new Array(r.getMaxY()-r.getMinY()+1)}getCodewordNearby(r){let s=this.getCodeword(r);if(s!=null)return s;for(let a=1;a<Zi.MAX_NEARBY_DISTANCE;a++){let u=this.imageRowToCodewordIndex(r)-a;if(u>=0&&(s=this.codewords[u],s!=null)||(u=this.imageRowToCodewordIndex(r)+a,u<this.codewords.length&&(s=this.codewords[u],s!=null)))return s}return null}imageRowToCodewordIndex(r){return r-this.boundingBox.getMinY()}setCodeword(r,s){this.codewords[this.imageRowToCodewordIndex(r)]=s}getCodeword(r){return this.codewords[this.imageRowToCodewordIndex(r)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const r=new gr;let s=0;for(const a of this.codewords){if(a==null){r.format("%3d:    |   %n",s++);continue}r.format("%3d: %3d|%3d%n",s++,a.getRowNumber(),a.getValue())}return r.toString()}}Zi.MAX_NEARBY_DISTANCE=5;class Yi{constructor(){this.values=new Map}setValue(r){r=Math.trunc(r);let s=this.values.get(r);s==null&&(s=0),s++,this.values.set(r,s)}getValue(){let r=-1,s=new Array;for(const[a,u]of this.values.entries()){const d={getKey:()=>a,getValue:()=>u};d.getValue()>r?(r=d.getValue(),s=[],s.push(d.getKey())):d.getValue()===r&&s.push(d.getKey())}return Se.toIntArray(s)}getConfidence(r){return this.values.get(r)}}class Pl extends Zi{constructor(r,s){super(r),this._isLeft=s}setRowNumbers(){for(let r of this.getCodewords())r!=null&&r.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(r){let s=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(s,r);let a=this.getBoundingBox(),u=this._isLeft?a.getTopLeft():a.getTopRight(),d=this._isLeft?a.getBottomLeft():a.getBottomRight(),f=this.imageRowToCodewordIndex(Math.trunc(u.getY())),p=this.imageRowToCodewordIndex(Math.trunc(d.getY())),w=-1,b=1,A=0;for(let O=f;O<p;O++){if(s[O]==null)continue;let B=s[O],V=B.getRowNumber()-w;if(V===0)A++;else if(V===1)b=Math.max(b,A),A=1,w=B.getRowNumber();else if(V<0||B.getRowNumber()>=r.getRowCount()||V>O)s[O]=null;else{let X;b>2?X=(b-2)*V:X=V;let q=X>=O;for(let ee=1;ee<=X&&!q;ee++)q=s[O-ee]!=null;q?s[O]=null:(w=B.getRowNumber(),A=1)}}}getRowHeights(){let r=this.getBarcodeMetadata();if(r==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(r);let s=new Int32Array(r.getRowCount());for(let a of this.getCodewords())if(a!=null){let u=a.getRowNumber();if(u>=s.length)continue;s[u]++}return s}adjustIncompleteIndicatorColumnRowNumbers(r){let s=this.getBoundingBox(),a=this._isLeft?s.getTopLeft():s.getTopRight(),u=this._isLeft?s.getBottomLeft():s.getBottomRight(),d=this.imageRowToCodewordIndex(Math.trunc(a.getY())),f=this.imageRowToCodewordIndex(Math.trunc(u.getY())),p=this.getCodewords(),w=-1;for(let b=d;b<f;b++){if(p[b]==null)continue;let A=p[b];A.setRowNumberAsRowIndicatorColumn();let O=A.getRowNumber()-w;O===0||(O===1?w=A.getRowNumber():A.getRowNumber()>=r.getRowCount()?p[b]=null:w=A.getRowNumber())}}getBarcodeMetadata(){let r=this.getCodewords(),s=new Yi,a=new Yi,u=new Yi,d=new Yi;for(let p of r){if(p==null)continue;p.setRowNumberAsRowIndicatorColumn();let w=p.getValue()%30,b=p.getRowNumber();switch(this._isLeft||(b+=2),b%3){case 0:a.setValue(w*3+1);break;case 1:d.setValue(w/3),u.setValue(w%3);break;case 2:s.setValue(w+1);break}}if(s.getValue().length===0||a.getValue().length===0||u.getValue().length===0||d.getValue().length===0||s.getValue()[0]<1||a.getValue()[0]+u.getValue()[0]<Se.MIN_ROWS_IN_BARCODE||a.getValue()[0]+u.getValue()[0]>Se.MAX_ROWS_IN_BARCODE)return null;let f=new un(s.getValue()[0],a.getValue()[0],u.getValue()[0],d.getValue()[0]);return this.removeIncorrectCodewords(r,f),f}removeIncorrectCodewords(r,s){for(let a=0;a<r.length;a++){let u=r[a];if(r[a]==null)continue;let d=u.getValue()%30,f=u.getRowNumber();if(f>s.getRowCount()){r[a]=null;continue}switch(this._isLeft||(f+=2),f%3){case 0:d*3+1!==s.getRowCountUpperPart()&&(r[a]=null);break;case 1:(Math.trunc(d/3)!==s.getErrorCorrectionLevel()||d%3!==s.getRowCountLowerPart())&&(r[a]=null);break;case 2:d+1!==s.getColumnCount()&&(r[a]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class $i{constructor(r,s){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=r,this.barcodeColumnCount=r.getColumnCount(),this.boundingBox=s,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let r=Se.MAX_CODEWORDS_IN_BARCODE,s;do s=r,r=this.adjustRowNumbersAndGetCount();while(r>0&&r<s);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(r){r!=null&&r.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let r=this.adjustRowNumbersByRow();if(r===0)return 0;for(let s=1;s<this.barcodeColumnCount+1;s++){let a=this.detectionResultColumns[s].getCodewords();for(let u=0;u<a.length;u++)a[u]!=null&&(a[u].hasValidRowNumber()||this.adjustRowNumbers(s,u,a))}return r}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let r=this.detectionResultColumns[0].getCodewords(),s=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let a=0;a<r.length;a++)if(r[a]!=null&&s[a]!=null&&r[a].getRowNumber()===s[a].getRowNumber())for(let u=1;u<=this.barcodeColumnCount;u++){let d=this.detectionResultColumns[u].getCodewords()[a];d!=null&&(d.setRowNumber(r[a].getRowNumber()),d.hasValidRowNumber()||(this.detectionResultColumns[u].getCodewords()[a]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let r=0,s=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let a=0;a<s.length;a++){if(s[a]==null)continue;let u=s[a].getRowNumber(),d=0;for(let f=this.barcodeColumnCount+1;f>0&&d<this.ADJUST_ROW_NUMBER_SKIP;f--){let p=this.detectionResultColumns[f].getCodewords()[a];p!=null&&(d=$i.adjustRowNumberIfValid(u,d,p),p.hasValidRowNumber()||r++)}}return r}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let r=0,s=this.detectionResultColumns[0].getCodewords();for(let a=0;a<s.length;a++){if(s[a]==null)continue;let u=s[a].getRowNumber(),d=0;for(let f=1;f<this.barcodeColumnCount+1&&d<this.ADJUST_ROW_NUMBER_SKIP;f++){let p=this.detectionResultColumns[f].getCodewords()[a];p!=null&&(d=$i.adjustRowNumberIfValid(u,d,p),p.hasValidRowNumber()||r++)}}return r}static adjustRowNumberIfValid(r,s,a){return a==null||a.hasValidRowNumber()||(a.isValidRowNumber(r)?(a.setRowNumber(r),s=0):++s),s}adjustRowNumbers(r,s,a){if(!this.detectionResultColumns[r-1])return;let u=a[s],d=this.detectionResultColumns[r-1].getCodewords(),f=d;this.detectionResultColumns[r+1]!=null&&(f=this.detectionResultColumns[r+1].getCodewords());let p=new Array(14);p[2]=d[s],p[3]=f[s],s>0&&(p[0]=a[s-1],p[4]=d[s-1],p[5]=f[s-1]),s>1&&(p[8]=a[s-2],p[10]=d[s-2],p[11]=f[s-2]),s<a.length-1&&(p[1]=a[s+1],p[6]=d[s+1],p[7]=f[s+1]),s<a.length-2&&(p[9]=a[s+2],p[12]=d[s+2],p[13]=f[s+2]);for(let w of p)if($i.adjustRowNumber(u,w))return}static adjustRowNumber(r,s){return s==null?!1:s.hasValidRowNumber()&&s.getBucket()===r.getBucket()?(r.setRowNumber(s.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(r){this.boundingBox=r}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(r,s){this.detectionResultColumns[r]=s}getDetectionResultColumn(r){return this.detectionResultColumns[r]}toString(){let r=this.detectionResultColumns[0];r==null&&(r=this.detectionResultColumns[this.barcodeColumnCount+1]);let s=new gr;for(let a=0;a<r.getCodewords().length;a++){s.format("CW %3d:",a);for(let u=0;u<this.barcodeColumnCount+2;u++){if(this.detectionResultColumns[u]==null){s.format("    |   ");continue}let d=this.detectionResultColumns[u].getCodewords()[a];if(d==null){s.format("    |   ");continue}s.format(" %3d|%3d",d.getRowNumber(),d.getValue())}s.format("%n")}return s.toString()}}class Ci{constructor(r,s,a,u){this.rowNumber=Ci.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(r),this.endX=Math.trunc(s),this.bucket=Math.trunc(a),this.value=Math.trunc(u)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(r){return r!==Ci.BARCODE_ROW_UNKNOWN&&this.bucket===r%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(r){this.rowNumber=r}toString(){return this.rowNumber+"|"+this.value}}Ci.BARCODE_ROW_UNKNOWN=-1;class Ln{static initialize(){for(let r=0;r<Se.SYMBOL_TABLE.length;r++){let s=Se.SYMBOL_TABLE[r],a=s&1;for(let u=0;u<Se.BARS_IN_MODULE;u++){let d=0;for(;(s&1)===a;)d+=1,s>>=1;a=s&1,Ln.RATIOS_TABLE[r]||(Ln.RATIOS_TABLE[r]=new Array(Se.BARS_IN_MODULE)),Ln.RATIOS_TABLE[r][Se.BARS_IN_MODULE-u-1]=Math.fround(d/Se.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(r){let s=Ln.getDecodedCodewordValue(Ln.sampleBitCounts(r));return s!==-1?s:Ln.getClosestDecodedValue(r)}static sampleBitCounts(r){let s=Ge.sum(r),a=new Int32Array(Se.BARS_IN_MODULE),u=0,d=0;for(let f=0;f<Se.MODULES_IN_CODEWORD;f++){let p=s/(2*Se.MODULES_IN_CODEWORD)+f*s/Se.MODULES_IN_CODEWORD;d+r[u]<=p&&(d+=r[u],u++),a[u]++}return a}static getDecodedCodewordValue(r){let s=Ln.getBitValue(r);return Se.getCodeword(s)===-1?-1:s}static getBitValue(r){let s=0;for(let a=0;a<r.length;a++)for(let u=0;u<r[a];u++)s=s<<1|(a%2===0?1:0);return Math.trunc(s)}static getClosestDecodedValue(r){let s=Ge.sum(r),a=new Array(Se.BARS_IN_MODULE);if(s>1)for(let f=0;f<a.length;f++)a[f]=Math.fround(r[f]/s);let u=xi.MAX_VALUE,d=-1;this.bSymbolTableReady||Ln.initialize();for(let f=0;f<Ln.RATIOS_TABLE.length;f++){let p=0,w=Ln.RATIOS_TABLE[f];for(let b=0;b<Se.BARS_IN_MODULE;b++){let A=Math.fround(w[b]-a[b]);if(p+=Math.fround(A*A),p>=u)break}p<u&&(u=p,d=Se.SYMBOL_TABLE[f])}return d}}Ln.bSymbolTableReady=!1,Ln.RATIOS_TABLE=new Array(Se.SYMBOL_TABLE.length).map(M=>new Array(Se.BARS_IN_MODULE));class va{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(r){this.segmentIndex=r}getFileId(){return this.fileId}setFileId(r){this.fileId=r}getOptionalData(){return this.optionalData}setOptionalData(r){this.optionalData=r}isLastSegment(){return this.lastSegment}setLastSegment(r){this.lastSegment=r}getSegmentCount(){return this.segmentCount}setSegmentCount(r){this.segmentCount=r}getSender(){return this.sender||null}setSender(r){this.sender=r}getAddressee(){return this.addressee||null}setAddressee(r){this.addressee=r}getFileName(){return this.fileName}setFileName(r){this.fileName=r}getFileSize(){return this.fileSize}setFileSize(r){this.fileSize=r}getChecksum(){return this.checksum}setChecksum(r){this.checksum=r}getTimestamp(){return this.timestamp}setTimestamp(r){this.timestamp=r}}class at{static parseLong(r,s=void 0){return parseInt(r,s)}}class Rl extends y{}Rl.kind="NullPointerException";class mr{writeBytes(r){this.writeBytesOffset(r,0,r.length)}writeBytesOffset(r,s,a){if(r==null)throw new Rl;if(s<0||s>r.length||a<0||s+a>r.length||s+a<0)throw new D;if(a===0)return;for(let u=0;u<a;u++)this.write(r[s+u])}flush(){}close(){}}class zs extends y{}class jl extends mr{constructor(r=32){if(super(),this.count=0,r<0)throw new E("Negative initial size: "+r);this.buf=new Uint8Array(r)}ensureCapacity(r){r-this.buf.length>0&&this.grow(r)}grow(r){let a=this.buf.length<<1;if(a-r<0&&(a=r),a<0){if(r<0)throw new zs;a=k.MAX_VALUE}this.buf=I.copyOfUint8Array(this.buf,a)}write(r){this.ensureCapacity(this.count+1),this.buf[this.count]=r,this.count+=1}writeBytesOffset(r,s,a){if(s<0||s>r.length||a<0||s+a-r.length>0)throw new D;this.ensureCapacity(this.count+a),P.arraycopy(r,s,this.buf,this.count,a),this.count+=a}writeTo(r){r.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return I.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(r){return r?typeof r=="string"?this.toString_string(r):this.toString_number(r):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(r){return new String(this.buf).toString()}toString_number(r){return new String(this.buf).toString()}close(){}}var wt;(function(M){M[M.ALPHA=0]="ALPHA",M[M.LOWER=1]="LOWER",M[M.MIXED=2]="MIXED",M[M.PUNCT=3]="PUNCT",M[M.ALPHA_SHIFT=4]="ALPHA_SHIFT",M[M.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(wt||(wt={}));function mo(){if(typeof window<"u")return window.BigInt||null;if(typeof Sn<"u")return Sn.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let po;function Vr(M){if(typeof po>"u"&&(po=mo()),po===null)throw new Error("BigInt is not supported!");return po(M)}function Lu(){let M=[];M[0]=Vr(1);let r=Vr(900);M[1]=r;for(let s=2;s<16;s++)M[s]=M[s-1]*r;return M}class oe{static decode(r,s){let a=new Ie(""),u=ie.ISO8859_1;a.enableDecoding(u);let d=1,f=r[d++],p=new va;for(;d<r[0];){switch(f){case oe.TEXT_COMPACTION_MODE_LATCH:d=oe.textCompaction(r,d,a);break;case oe.BYTE_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH_6:d=oe.byteCompaction(f,r,u,d,a);break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[d++]);break;case oe.NUMERIC_COMPACTION_MODE_LATCH:d=oe.numericCompaction(r,d,a);break;case oe.ECI_CHARSET:ie.getCharacterSetECIByValue(r[d++]);break;case oe.ECI_GENERAL_PURPOSE:d+=2;break;case oe.ECI_USER_DEFINED:d++;break;case oe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:d=oe.decodeMacroBlock(r,d,p);break;case oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case oe.MACRO_PDF417_TERMINATOR:throw new Z;default:d--,d=oe.textCompaction(r,d,a);break}if(d<r.length)f=r[d++];else throw Z.getFormatInstance()}if(a.length()===0)throw Z.getFormatInstance();let w=new Nn(null,a.toString(),null,s);return w.setOther(p),w}static decodeMacroBlock(r,s,a){if(s+oe.NUMBER_OF_SEQUENCE_CODEWORDS>r[0])throw Z.getFormatInstance();let u=new Int32Array(oe.NUMBER_OF_SEQUENCE_CODEWORDS);for(let p=0;p<oe.NUMBER_OF_SEQUENCE_CODEWORDS;p++,s++)u[p]=r[s];a.setSegmentIndex(k.parseInt(oe.decodeBase900toBase10(u,oe.NUMBER_OF_SEQUENCE_CODEWORDS)));let d=new Ie;s=oe.textCompaction(r,s,d),a.setFileId(d.toString());let f=-1;for(r[s]===oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(f=s+1);s<r[0];)switch(r[s]){case oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(s++,r[s]){case oe.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let p=new Ie;s=oe.textCompaction(r,s+1,p),a.setFileName(p.toString());break;case oe.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let w=new Ie;s=oe.textCompaction(r,s+1,w),a.setSender(w.toString());break;case oe.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let b=new Ie;s=oe.textCompaction(r,s+1,b),a.setAddressee(b.toString());break;case oe.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let A=new Ie;s=oe.numericCompaction(r,s+1,A),a.setSegmentCount(k.parseInt(A.toString()));break;case oe.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let O=new Ie;s=oe.numericCompaction(r,s+1,O),a.setTimestamp(at.parseLong(O.toString()));break;case oe.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let B=new Ie;s=oe.numericCompaction(r,s+1,B),a.setChecksum(k.parseInt(B.toString()));break;case oe.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let V=new Ie;s=oe.numericCompaction(r,s+1,V),a.setFileSize(at.parseLong(V.toString()));break;default:throw Z.getFormatInstance()}break;case oe.MACRO_PDF417_TERMINATOR:s++,a.setLastSegment(!0);break;default:throw Z.getFormatInstance()}if(f!==-1){let p=s-f;a.isLastSegment()&&p--,a.setOptionalData(I.copyOfRange(r,f,f+p))}return s}static textCompaction(r,s,a){let u=new Int32Array((r[0]-s)*2),d=new Int32Array((r[0]-s)*2),f=0,p=!1;for(;s<r[0]&&!p;){let w=r[s++];if(w<oe.TEXT_COMPACTION_MODE_LATCH)u[f]=w/30,u[f+1]=w%30,f+=2;else switch(w){case oe.TEXT_COMPACTION_MODE_LATCH:u[f++]=oe.TEXT_COMPACTION_MODE_LATCH;break;case oe.BYTE_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH_6:case oe.NUMERIC_COMPACTION_MODE_LATCH:case oe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case oe.MACRO_PDF417_TERMINATOR:s--,p=!0;break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u[f]=oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,w=r[s++],d[f]=w,f++;break}}return oe.decodeTextCompaction(u,d,f,a),s}static decodeTextCompaction(r,s,a,u){let d=wt.ALPHA,f=wt.ALPHA,p=0;for(;p<a;){let w=r[p],b="";switch(d){case wt.ALPHA:if(w<26)b=String.fromCharCode(65+w);else switch(w){case 26:b=" ";break;case oe.LL:d=wt.LOWER;break;case oe.ML:d=wt.MIXED;break;case oe.PS:f=d,d=wt.PUNCT_SHIFT;break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(s[p]);break;case oe.TEXT_COMPACTION_MODE_LATCH:d=wt.ALPHA;break}break;case wt.LOWER:if(w<26)b=String.fromCharCode(97+w);else switch(w){case 26:b=" ";break;case oe.AS:f=d,d=wt.ALPHA_SHIFT;break;case oe.ML:d=wt.MIXED;break;case oe.PS:f=d,d=wt.PUNCT_SHIFT;break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(s[p]);break;case oe.TEXT_COMPACTION_MODE_LATCH:d=wt.ALPHA;break}break;case wt.MIXED:if(w<oe.PL)b=oe.MIXED_CHARS[w];else switch(w){case oe.PL:d=wt.PUNCT;break;case 26:b=" ";break;case oe.LL:d=wt.LOWER;break;case oe.AL:d=wt.ALPHA;break;case oe.PS:f=d,d=wt.PUNCT_SHIFT;break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(s[p]);break;case oe.TEXT_COMPACTION_MODE_LATCH:d=wt.ALPHA;break}break;case wt.PUNCT:if(w<oe.PAL)b=oe.PUNCT_CHARS[w];else switch(w){case oe.PAL:d=wt.ALPHA;break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(s[p]);break;case oe.TEXT_COMPACTION_MODE_LATCH:d=wt.ALPHA;break}break;case wt.ALPHA_SHIFT:if(d=f,w<26)b=String.fromCharCode(65+w);else switch(w){case 26:b=" ";break;case oe.TEXT_COMPACTION_MODE_LATCH:d=wt.ALPHA;break}break;case wt.PUNCT_SHIFT:if(d=f,w<oe.PAL)b=oe.PUNCT_CHARS[w];else switch(w){case oe.PAL:d=wt.ALPHA;break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(s[p]);break;case oe.TEXT_COMPACTION_MODE_LATCH:d=wt.ALPHA;break}break}b!==""&&u.append(b),p++}}static byteCompaction(r,s,a,u,d){let f=new jl,p=0,w=0,b=!1;switch(r){case oe.BYTE_COMPACTION_MODE_LATCH:let A=new Int32Array(6),O=s[u++];for(;u<s[0]&&!b;)switch(A[p++]=O,w=900*w+O,O=s[u++],O){case oe.TEXT_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH:case oe.NUMERIC_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH_6:case oe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case oe.MACRO_PDF417_TERMINATOR:u--,b=!0;break;default:if(p%5===0&&p>0){for(let B=0;B<6;++B)f.write(Number(Vr(w)>>Vr(8*(5-B))));w=0,p=0}break}u===s[0]&&O<oe.TEXT_COMPACTION_MODE_LATCH&&(A[p++]=O);for(let B=0;B<p;B++)f.write(A[B]);break;case oe.BYTE_COMPACTION_MODE_LATCH_6:for(;u<s[0]&&!b;){let B=s[u++];if(B<oe.TEXT_COMPACTION_MODE_LATCH)p++,w=900*w+B;else switch(B){case oe.TEXT_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH:case oe.NUMERIC_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH_6:case oe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case oe.MACRO_PDF417_TERMINATOR:u--,b=!0;break}if(p%5===0&&p>0){for(let V=0;V<6;++V)f.write(Number(Vr(w)>>Vr(8*(5-V))));w=0,p=0}}break}return d.append(ce.decode(f.toByteArray(),a)),u}static numericCompaction(r,s,a){let u=0,d=!1,f=new Int32Array(oe.MAX_NUMERIC_CODEWORDS);for(;s<r[0]&&!d;){let p=r[s++];if(s===r[0]&&(d=!0),p<oe.TEXT_COMPACTION_MODE_LATCH)f[u]=p,u++;else switch(p){case oe.TEXT_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH_6:case oe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case oe.MACRO_PDF417_TERMINATOR:s--,d=!0;break}(u%oe.MAX_NUMERIC_CODEWORDS===0||p===oe.NUMERIC_COMPACTION_MODE_LATCH||d)&&u>0&&(a.append(oe.decodeBase900toBase10(f,u)),u=0)}return s}static decodeBase900toBase10(r,s){let a=Vr(0);for(let d=0;d<s;d++)a+=oe.EXP900[s-d-1]*Vr(r[d]);let u=a.toString();if(u.charAt(0)!=="1")throw new Z;return u.substring(1)}}oe.TEXT_COMPACTION_MODE_LATCH=900,oe.BYTE_COMPACTION_MODE_LATCH=901,oe.NUMERIC_COMPACTION_MODE_LATCH=902,oe.BYTE_COMPACTION_MODE_LATCH_6=924,oe.ECI_USER_DEFINED=925,oe.ECI_GENERAL_PURPOSE=926,oe.ECI_CHARSET=927,oe.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,oe.MACRO_PDF417_TERMINATOR=922,oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,oe.MAX_NUMERIC_CODEWORDS=15,oe.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,oe.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,oe.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,oe.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,oe.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,oe.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,oe.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,oe.PL=25,oe.LL=27,oe.AS=27,oe.ML=28,oe.AL=28,oe.PS=29,oe.PAL=29,oe.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,oe.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",oe.EXP900=mo()?Lu():[],oe.NUMBER_OF_SEQUENCE_CODEWORDS=2;class Xe{constructor(){}static decode(r,s,a,u,d,f,p){let w=new fr(r,s,a,u,d),b=null,A=null,O;for(let X=!0;;X=!1){if(s!=null&&(b=Xe.getRowIndicatorColumn(r,w,s,!0,f,p)),u!=null&&(A=Xe.getRowIndicatorColumn(r,w,u,!1,f,p)),O=Xe.merge(b,A),O==null)throw Q.getNotFoundInstance();let q=O.getBoundingBox();if(X&&q!=null&&(q.getMinY()<w.getMinY()||q.getMaxY()>w.getMaxY()))w=q;else break}O.setBoundingBox(w);let B=O.getBarcodeColumnCount()+1;O.setDetectionResultColumn(0,b),O.setDetectionResultColumn(B,A);let V=b!=null;for(let X=1;X<=B;X++){let q=V?X:B-X;if(O.getDetectionResultColumn(q)!==void 0)continue;let ee;q===0||q===B?ee=new Pl(w,q===0):ee=new Zi(w),O.setDetectionResultColumn(q,ee);let se=-1,xe=se;for(let ye=w.getMinY();ye<=w.getMaxY();ye++){if(se=Xe.getStartColumn(O,q,ye,V),se<0||se>w.getMaxX()){if(xe===-1)continue;se=xe}let ge=Xe.detectCodeword(r,w.getMinX(),w.getMaxX(),V,se,ye,f,p);ge!=null&&(ee.setCodeword(ye,ge),xe=se,f=Math.min(f,ge.getWidth()),p=Math.max(p,ge.getWidth()))}}return Xe.createDecoderResult(O)}static merge(r,s){if(r==null&&s==null)return null;let a=Xe.getBarcodeMetadata(r,s);if(a==null)return null;let u=fr.merge(Xe.adjustBoundingBox(r),Xe.adjustBoundingBox(s));return new $i(a,u)}static adjustBoundingBox(r){if(r==null)return null;let s=r.getRowHeights();if(s==null)return null;let a=Xe.getMax(s),u=0;for(let p of s)if(u+=a-p,p>0)break;let d=r.getCodewords();for(let p=0;u>0&&d[p]==null;p++)u--;let f=0;for(let p=s.length-1;p>=0&&(f+=a-s[p],!(s[p]>0));p--);for(let p=d.length-1;f>0&&d[p]==null;p--)f--;return r.getBoundingBox().addMissingRows(u,f,r.isLeft())}static getMax(r){let s=-1;for(let a of r)s=Math.max(s,a);return s}static getBarcodeMetadata(r,s){let a;if(r==null||(a=r.getBarcodeMetadata())==null)return s==null?null:s.getBarcodeMetadata();let u;return s==null||(u=s.getBarcodeMetadata())==null?a:a.getColumnCount()!==u.getColumnCount()&&a.getErrorCorrectionLevel()!==u.getErrorCorrectionLevel()&&a.getRowCount()!==u.getRowCount()?null:a}static getRowIndicatorColumn(r,s,a,u,d,f){let p=new Pl(s,u);for(let w=0;w<2;w++){let b=w===0?1:-1,A=Math.trunc(Math.trunc(a.getX()));for(let O=Math.trunc(Math.trunc(a.getY()));O<=s.getMaxY()&&O>=s.getMinY();O+=b){let B=Xe.detectCodeword(r,0,r.getWidth(),u,A,O,d,f);B!=null&&(p.setCodeword(O,B),u?A=B.getStartX():A=B.getEndX())}}return p}static adjustCodewordCount(r,s){let a=s[0][1],u=a.getValue(),d=r.getBarcodeColumnCount()*r.getBarcodeRowCount()-Xe.getNumberOfECCodeWords(r.getBarcodeECLevel());if(u.length===0){if(d<1||d>Se.MAX_CODEWORDS_IN_BARCODE)throw Q.getNotFoundInstance();a.setValue(d)}else u[0]!==d&&a.setValue(d)}static createDecoderResult(r){let s=Xe.createBarcodeMatrix(r);Xe.adjustCodewordCount(r,s);let a=new Array,u=new Int32Array(r.getBarcodeRowCount()*r.getBarcodeColumnCount()),d=[],f=new Array;for(let w=0;w<r.getBarcodeRowCount();w++)for(let b=0;b<r.getBarcodeColumnCount();b++){let A=s[w][b+1].getValue(),O=w*r.getBarcodeColumnCount()+b;A.length===0?a.push(O):A.length===1?u[O]=A[0]:(f.push(O),d.push(A))}let p=new Array(d.length);for(let w=0;w<p.length;w++)p[w]=d[w];return Xe.createDecoderResultFromAmbiguousValues(r.getBarcodeECLevel(),u,Se.toIntArray(a),Se.toIntArray(f),p)}static createDecoderResultFromAmbiguousValues(r,s,a,u,d){let f=new Int32Array(u.length),p=100;for(;p-- >0;){for(let w=0;w<f.length;w++)s[u[w]]=d[w][f[w]];try{return Xe.decodeCodewords(s,r,a)}catch(w){if(!(w instanceof U))throw w}if(f.length===0)throw U.getChecksumInstance();for(let w=0;w<f.length;w++)if(f[w]<d[w].length-1){f[w]++;break}else if(f[w]=0,w===f.length-1)throw U.getChecksumInstance()}throw U.getChecksumInstance()}static createBarcodeMatrix(r){let s=Array.from({length:r.getBarcodeRowCount()},()=>new Array(r.getBarcodeColumnCount()+2));for(let u=0;u<s.length;u++)for(let d=0;d<s[u].length;d++)s[u][d]=new Yi;let a=0;for(let u of r.getDetectionResultColumns()){if(u!=null){for(let d of u.getCodewords())if(d!=null){let f=d.getRowNumber();if(f>=0){if(f>=s.length)continue;s[f][a].setValue(d.getValue())}}}a++}return s}static isValidBarcodeColumn(r,s){return s>=0&&s<=r.getBarcodeColumnCount()+1}static getStartColumn(r,s,a,u){let d=u?1:-1,f=null;if(Xe.isValidBarcodeColumn(r,s-d)&&(f=r.getDetectionResultColumn(s-d).getCodeword(a)),f!=null)return u?f.getEndX():f.getStartX();if(f=r.getDetectionResultColumn(s).getCodewordNearby(a),f!=null)return u?f.getStartX():f.getEndX();if(Xe.isValidBarcodeColumn(r,s-d)&&(f=r.getDetectionResultColumn(s-d).getCodewordNearby(a)),f!=null)return u?f.getEndX():f.getStartX();let p=0;for(;Xe.isValidBarcodeColumn(r,s-d);){s-=d;for(let w of r.getDetectionResultColumn(s).getCodewords())if(w!=null)return(u?w.getEndX():w.getStartX())+d*p*(w.getEndX()-w.getStartX());p++}return u?r.getBoundingBox().getMinX():r.getBoundingBox().getMaxX()}static detectCodeword(r,s,a,u,d,f,p,w){d=Xe.adjustCodewordStartColumn(r,s,a,u,d,f);let b=Xe.getModuleBitCount(r,s,a,u,d,f);if(b==null)return null;let A,O=Ge.sum(b);if(u)A=d+O;else{for(let X=0;X<b.length/2;X++){let q=b[X];b[X]=b[b.length-1-X],b[b.length-1-X]=q}A=d,d=A-O}if(!Xe.checkCodewordSkew(O,p,w))return null;let B=Ln.getDecodedValue(b),V=Se.getCodeword(B);return V===-1?null:new Ci(d,A,Xe.getCodewordBucketNumber(B),V)}static getModuleBitCount(r,s,a,u,d,f){let p=d,w=new Int32Array(8),b=0,A=u?1:-1,O=u;for(;(u?p<a:p>=s)&&b<w.length;)r.get(p,f)===O?(w[b]++,p+=A):(b++,O=!O);return b===w.length||p===(u?a:s)&&b===w.length-1?w:null}static getNumberOfECCodeWords(r){return 2<<r}static adjustCodewordStartColumn(r,s,a,u,d,f){let p=d,w=u?-1:1;for(let b=0;b<2;b++){for(;(u?p>=s:p<a)&&u===r.get(p,f);){if(Math.abs(d-p)>Xe.CODEWORD_SKEW_SIZE)return d;p+=w}w=-w,u=!u}return p}static checkCodewordSkew(r,s,a){return s-Xe.CODEWORD_SKEW_SIZE<=r&&r<=a+Xe.CODEWORD_SKEW_SIZE}static decodeCodewords(r,s,a){if(r.length===0)throw Z.getFormatInstance();let u=1<<s+1,d=Xe.correctErrors(r,a,u);Xe.verifyCodewordCount(r,u);let f=oe.decode(r,""+s);return f.setErrorsCorrected(d),f.setErasures(a.length),f}static correctErrors(r,s,a){if(s!=null&&s.length>a/2+Xe.MAX_ERRORS||a<0||a>Xe.MAX_EC_CODEWORDS)throw U.getChecksumInstance();return Xe.errorCorrection.decode(r,a,s)}static verifyCodewordCount(r,s){if(r.length<4)throw Z.getFormatInstance();let a=r[0];if(a>r.length)throw Z.getFormatInstance();if(a===0)if(s<r.length)r[0]=r.length-s;else throw Z.getFormatInstance()}static getBitCountForCodeword(r){let s=new Int32Array(8),a=0,u=s.length-1;for(;!((r&1)!==a&&(a=r&1,u--,u<0));)s[u]++,r>>=1;return s}static getCodewordBucketNumber(r){return r instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(r):this.getCodewordBucketNumber_number(r)}static getCodewordBucketNumber_number(r){return Xe.getCodewordBucketNumber(Xe.getBitCountForCodeword(r))}static getCodewordBucketNumber_Int32Array(r){return(r[0]-r[2]+r[4]-r[6]+9)%9}static toString(r){let s=new gr;for(let a=0;a<r.length;a++){s.format("Row %2d: ",a);for(let u=0;u<r[a].length;u++){let d=r[a][u];d.getValue().length===0?s.format("        ",null):s.format("%4d(%2d)",d.getValue()[0],d.getConfidence(d.getValue()[0]))}s.format("%n")}return s.toString()}}Xe.CODEWORD_SKEW_SIZE=2,Xe.MAX_ERRORS=3,Xe.MAX_EC_CODEWORDS=512,Xe.errorCorrection=new go;class dn{decode(r,s=null){let a=dn.decode(r,s,!1);if(a==null||a.length===0||a[0]==null)throw Q.getNotFoundInstance();return a[0]}decodeMultiple(r,s=null){try{return dn.decode(r,s,!0)}catch(a){throw a instanceof Z||a instanceof U?Q.getNotFoundInstance():a}}static decode(r,s,a){const u=new Array,d=Ye.detectMultiple(r,s,a);for(const f of d.getPoints()){const p=Xe.decode(d.getBits(),f[4],f[5],f[6],f[7],dn.getMinCodewordWidth(f),dn.getMaxCodewordWidth(f)),w=new Fe(p.getText(),p.getRawBytes(),void 0,f,fe.PDF_417);w.putMetadata(Je.ERROR_CORRECTION_LEVEL,p.getECLevel());const b=p.getOther();b!=null&&w.putMetadata(Je.PDF417_EXTRA_METADATA,b),u.push(w)}return u.map(f=>f)}static getMaxWidth(r,s){return r==null||s==null?0:Math.trunc(Math.abs(r.getX()-s.getX()))}static getMinWidth(r,s){return r==null||s==null?k.MAX_VALUE:Math.trunc(Math.abs(r.getX()-s.getX()))}static getMaxCodewordWidth(r){return Math.floor(Math.max(Math.max(dn.getMaxWidth(r[0],r[4]),dn.getMaxWidth(r[6],r[2])*Se.MODULES_IN_CODEWORD/Se.MODULES_IN_STOP_PATTERN),Math.max(dn.getMaxWidth(r[1],r[5]),dn.getMaxWidth(r[7],r[3])*Se.MODULES_IN_CODEWORD/Se.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(r){return Math.floor(Math.min(Math.min(dn.getMinWidth(r[0],r[4]),dn.getMinWidth(r[6],r[2])*Se.MODULES_IN_CODEWORD/Se.MODULES_IN_STOP_PATTERN),Math.min(dn.getMinWidth(r[1],r[5]),dn.getMinWidth(r[7],r[3])*Se.MODULES_IN_CODEWORD/Se.MODULES_IN_STOP_PATTERN)))}reset(){}}class Vn extends y{}Vn.kind="ReaderException";class Dl{constructor(r,s){this.verbose=r===!0,s&&this.setHints(s)}decode(r,s){return s&&this.setHints(s),this.decodeInternal(r)}decodeWithState(r){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(r)}setHints(r){this.hints=r;const s=!i(r)&&r.get(Y.TRY_HARDER)===!0,a=i(r)?null:r.get(Y.POSSIBLE_FORMATS),u=new Array;if(!i(a)){const d=a.some(f=>f===fe.UPC_A||f===fe.UPC_E||f===fe.EAN_13||f===fe.EAN_8||f===fe.CODABAR||f===fe.CODE_39||f===fe.CODE_93||f===fe.CODE_128||f===fe.ITF||f===fe.RSS_14||f===fe.RSS_EXPANDED);d&&!s&&u.push(new si(r,this.verbose)),a.includes(fe.QR_CODE)&&u.push(new cn),a.includes(fe.DATA_MATRIX)&&u.push(new vt),a.includes(fe.AZTEC)&&u.push(new tr),a.includes(fe.PDF_417)&&u.push(new dn),d&&s&&u.push(new si(r,this.verbose))}u.length===0&&(s||u.push(new si(r,this.verbose)),u.push(new cn),u.push(new vt),u.push(new tr),u.push(new dn),s&&u.push(new si(r,this.verbose))),this.readers=u}reset(){if(this.readers!==null)for(const r of this.readers)r.reset()}decodeInternal(r){if(this.readers===null)throw new Vn("No readers where selected, nothing can be read.");for(const s of this.readers)try{return s.decode(r,this.hints)}catch(a){if(a instanceof Vn)continue}throw new Q("No MultiFormat Readers were able to detect the code.")}}class Bl extends Qe{constructor(r=null,s=500){const a=new Dl;a.setHints(r),super(a,s)}decodeBitmap(r){return this.reader.decodeWithState(r)}}class oi extends Qe{constructor(r=500){super(new dn,r)}}class Fl extends Qe{constructor(r=500){super(new cn,r)}}var xo;(function(M){M[M.ERROR_CORRECTION=0]="ERROR_CORRECTION",M[M.CHARACTER_SET=1]="CHARACTER_SET",M[M.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",M[M.MIN_SIZE=3]="MIN_SIZE",M[M.MAX_SIZE=4]="MAX_SIZE",M[M.MARGIN=5]="MARGIN",M[M.PDF417_COMPACT=6]="PDF417_COMPACT",M[M.PDF417_COMPACTION=7]="PDF417_COMPACTION",M[M.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",M[M.AZTEC_LAYERS=9]="AZTEC_LAYERS",M[M.QR_VERSION=10]="QR_VERSION"})(xo||(xo={}));var Zt=xo;class wa{constructor(r){this.field=r,this.cachedGenerators=[],this.cachedGenerators.push(new tt(r,Int32Array.from([1])))}buildGenerator(r){const s=this.cachedGenerators;if(r>=s.length){let a=s[s.length-1];const u=this.field;for(let d=s.length;d<=r;d++){const f=a.multiply(new tt(u,Int32Array.from([1,u.exp(d-1+u.getGeneratorBase())])));s.push(f),a=f}}return s[r]}encode(r,s){if(s===0)throw new E("No error correction bytes");const a=r.length-s;if(a<=0)throw new E("No data bytes provided");const u=this.buildGenerator(s),d=new Int32Array(a);P.arraycopy(r,0,d,0,a);let f=new tt(this.field,d);f=f.multiplyByMonomial(s,1);const w=f.divide(u)[1].getCoefficients(),b=s-w.length;for(let A=0;A<b;A++)r[a+A]=0;P.arraycopy(w,0,r,a+b,w.length)}}class Ft{constructor(){}static applyMaskPenaltyRule1(r){return Ft.applyMaskPenaltyRule1Internal(r,!0)+Ft.applyMaskPenaltyRule1Internal(r,!1)}static applyMaskPenaltyRule2(r){let s=0;const a=r.getArray(),u=r.getWidth(),d=r.getHeight();for(let f=0;f<d-1;f++){const p=a[f];for(let w=0;w<u-1;w++){const b=p[w];b===p[w+1]&&b===a[f+1][w]&&b===a[f+1][w+1]&&s++}}return Ft.N2*s}static applyMaskPenaltyRule3(r){let s=0;const a=r.getArray(),u=r.getWidth(),d=r.getHeight();for(let f=0;f<d;f++)for(let p=0;p<u;p++){const w=a[f];p+6<u&&w[p]===1&&w[p+1]===0&&w[p+2]===1&&w[p+3]===1&&w[p+4]===1&&w[p+5]===0&&w[p+6]===1&&(Ft.isWhiteHorizontal(w,p-4,p)||Ft.isWhiteHorizontal(w,p+7,p+11))&&s++,f+6<d&&a[f][p]===1&&a[f+1][p]===0&&a[f+2][p]===1&&a[f+3][p]===1&&a[f+4][p]===1&&a[f+5][p]===0&&a[f+6][p]===1&&(Ft.isWhiteVertical(a,p,f-4,f)||Ft.isWhiteVertical(a,p,f+7,f+11))&&s++}return s*Ft.N3}static isWhiteHorizontal(r,s,a){s=Math.max(s,0),a=Math.min(a,r.length);for(let u=s;u<a;u++)if(r[u]===1)return!1;return!0}static isWhiteVertical(r,s,a,u){a=Math.max(a,0),u=Math.min(u,r.length);for(let d=a;d<u;d++)if(r[d][s]===1)return!1;return!0}static applyMaskPenaltyRule4(r){let s=0;const a=r.getArray(),u=r.getWidth(),d=r.getHeight();for(let w=0;w<d;w++){const b=a[w];for(let A=0;A<u;A++)b[A]===1&&s++}const f=r.getHeight()*r.getWidth();return Math.floor(Math.abs(s*2-f)*10/f)*Ft.N4}static getDataMaskBit(r,s,a){let u,d;switch(r){case 0:u=a+s&1;break;case 1:u=a&1;break;case 2:u=s%3;break;case 3:u=(a+s)%3;break;case 4:u=Math.floor(a/2)+Math.floor(s/3)&1;break;case 5:d=a*s,u=(d&1)+d%3;break;case 6:d=a*s,u=(d&1)+d%3&1;break;case 7:d=a*s,u=d%3+(a+s&1)&1;break;default:throw new E("Invalid mask pattern: "+r)}return u===0}static applyMaskPenaltyRule1Internal(r,s){let a=0;const u=s?r.getHeight():r.getWidth(),d=s?r.getWidth():r.getHeight(),f=r.getArray();for(let p=0;p<u;p++){let w=0,b=-1;for(let A=0;A<d;A++){const O=s?f[p][A]:f[A][p];O===b?w++:(w>=5&&(a+=Ft.N1+(w-5)),w=1,b=O)}w>=5&&(a+=Ft.N1+(w-5))}return a}}Ft.N1=3,Ft.N2=3,Ft.N3=40,Ft.N4=10;class Hs{constructor(r,s){this.width=r,this.height=s;const a=new Array(s);for(let u=0;u!==s;u++)a[u]=new Uint8Array(r);this.bytes=a}getHeight(){return this.height}getWidth(){return this.width}get(r,s){return this.bytes[s][r]}getArray(){return this.bytes}setNumber(r,s,a){this.bytes[s][r]=a}setBoolean(r,s,a){this.bytes[s][r]=a?1:0}clear(r){for(const s of this.bytes)I.fill(s,r)}equals(r){if(!(r instanceof Hs))return!1;const s=r;if(this.width!==s.width||this.height!==s.height)return!1;for(let a=0,u=this.height;a<u;++a){const d=this.bytes[a],f=s.bytes[a];for(let p=0,w=this.width;p<w;++p)if(d[p]!==f[p])return!1}return!0}toString(){const r=new Ie;for(let s=0,a=this.height;s<a;++s){const u=this.bytes[s];for(let d=0,f=this.width;d<f;++d)switch(u[d]){case 0:r.append(" 0");break;case 1:r.append(" 1");break;default:r.append("  ");break}r.append(`
`)}return r.toString()}}class Ei{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const r=new Ie;return r.append(`<<
`),r.append(" mode: "),r.append(this.mode?this.mode.toString():"null"),r.append(`
 ecLevel: `),r.append(this.ecLevel?this.ecLevel.toString():"null"),r.append(`
 version: `),r.append(this.version?this.version.toString():"null"),r.append(`
 maskPattern: `),r.append(this.maskPattern.toString()),this.matrix?(r.append(`
 matrix:
`),r.append(this.matrix.toString())):r.append(`
 matrix: null
`),r.append(`>>
`),r.toString()}setMode(r){this.mode=r}setECLevel(r){this.ecLevel=r}setVersion(r){this.version=r}setMaskPattern(r){this.maskPattern=r}setMatrix(r){this.matrix=r}static isValidMaskPattern(r){return r>=0&&r<Ei.NUM_MASK_PATTERNS}}Ei.NUM_MASK_PATTERNS=8;class Ct extends y{}Ct.kind="WriterException";class ze{constructor(){}static clearMatrix(r){r.clear(255)}static buildMatrix(r,s,a,u,d){ze.clearMatrix(d),ze.embedBasicPatterns(a,d),ze.embedTypeInfo(s,u,d),ze.maybeEmbedVersionInfo(a,d),ze.embedDataBits(r,u,d)}static embedBasicPatterns(r,s){ze.embedPositionDetectionPatternsAndSeparators(s),ze.embedDarkDotAtLeftBottomCorner(s),ze.maybeEmbedPositionAdjustmentPatterns(r,s),ze.embedTimingPatterns(s)}static embedTypeInfo(r,s,a){const u=new z;ze.makeTypeInfoBits(r,s,u);for(let d=0,f=u.getSize();d<f;++d){const p=u.get(u.getSize()-1-d),w=ze.TYPE_INFO_COORDINATES[d],b=w[0],A=w[1];if(a.setBoolean(b,A,p),d<8){const O=a.getWidth()-d-1;a.setBoolean(O,8,p)}else{const B=a.getHeight()-7+(d-8);a.setBoolean(8,B,p)}}}static maybeEmbedVersionInfo(r,s){if(r.getVersionNumber()<7)return;const a=new z;ze.makeVersionInfoBits(r,a);let u=6*3-1;for(let d=0;d<6;++d)for(let f=0;f<3;++f){const p=a.get(u);u--,s.setBoolean(d,s.getHeight()-11+f,p),s.setBoolean(s.getHeight()-11+f,d,p)}}static embedDataBits(r,s,a){let u=0,d=-1,f=a.getWidth()-1,p=a.getHeight()-1;for(;f>0;){for(f===6&&(f-=1);p>=0&&p<a.getHeight();){for(let w=0;w<2;++w){const b=f-w;if(!ze.isEmpty(a.get(b,p)))continue;let A;u<r.getSize()?(A=r.get(u),++u):A=!1,s!==255&&Ft.getDataMaskBit(s,b,p)&&(A=!A),a.setBoolean(b,p,A)}p+=d}d=-d,p+=d,f-=2}if(u!==r.getSize())throw new Ct("Not all bits consumed: "+u+"/"+r.getSize())}static findMSBSet(r){return 32-k.numberOfLeadingZeros(r)}static calculateBCHCode(r,s){if(s===0)throw new E("0 polynomial");const a=ze.findMSBSet(s);for(r<<=a-1;ze.findMSBSet(r)>=a;)r^=s<<ze.findMSBSet(r)-a;return r}static makeTypeInfoBits(r,s,a){if(!Ei.isValidMaskPattern(s))throw new Ct("Invalid mask pattern");const u=r.getBits()<<3|s;a.appendBits(u,5);const d=ze.calculateBCHCode(u,ze.TYPE_INFO_POLY);a.appendBits(d,10);const f=new z;if(f.appendBits(ze.TYPE_INFO_MASK_PATTERN,15),a.xor(f),a.getSize()!==15)throw new Ct("should not happen but we got: "+a.getSize())}static makeVersionInfoBits(r,s){s.appendBits(r.getVersionNumber(),6);const a=ze.calculateBCHCode(r.getVersionNumber(),ze.VERSION_INFO_POLY);if(s.appendBits(a,12),s.getSize()!==18)throw new Ct("should not happen but we got: "+s.getSize())}static isEmpty(r){return r===255}static embedTimingPatterns(r){for(let s=8;s<r.getWidth()-8;++s){const a=(s+1)%2;ze.isEmpty(r.get(s,6))&&r.setNumber(s,6,a),ze.isEmpty(r.get(6,s))&&r.setNumber(6,s,a)}}static embedDarkDotAtLeftBottomCorner(r){if(r.get(8,r.getHeight()-8)===0)throw new Ct;r.setNumber(8,r.getHeight()-8,1)}static embedHorizontalSeparationPattern(r,s,a){for(let u=0;u<8;++u){if(!ze.isEmpty(a.get(r+u,s)))throw new Ct;a.setNumber(r+u,s,0)}}static embedVerticalSeparationPattern(r,s,a){for(let u=0;u<7;++u){if(!ze.isEmpty(a.get(r,s+u)))throw new Ct;a.setNumber(r,s+u,0)}}static embedPositionAdjustmentPattern(r,s,a){for(let u=0;u<5;++u){const d=ze.POSITION_ADJUSTMENT_PATTERN[u];for(let f=0;f<5;++f)a.setNumber(r+f,s+u,d[f])}}static embedPositionDetectionPattern(r,s,a){for(let u=0;u<7;++u){const d=ze.POSITION_DETECTION_PATTERN[u];for(let f=0;f<7;++f)a.setNumber(r+f,s+u,d[f])}}static embedPositionDetectionPatternsAndSeparators(r){const s=ze.POSITION_DETECTION_PATTERN[0].length;ze.embedPositionDetectionPattern(0,0,r),ze.embedPositionDetectionPattern(r.getWidth()-s,0,r),ze.embedPositionDetectionPattern(0,r.getWidth()-s,r);const a=8;ze.embedHorizontalSeparationPattern(0,a-1,r),ze.embedHorizontalSeparationPattern(r.getWidth()-a,a-1,r),ze.embedHorizontalSeparationPattern(0,r.getWidth()-a,r);const u=7;ze.embedVerticalSeparationPattern(u,0,r),ze.embedVerticalSeparationPattern(r.getHeight()-u-1,0,r),ze.embedVerticalSeparationPattern(u,r.getHeight()-u,r)}static maybeEmbedPositionAdjustmentPatterns(r,s){if(r.getVersionNumber()<2)return;const a=r.getVersionNumber()-1,u=ze.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[a];for(let d=0,f=u.length;d!==f;d++){const p=u[d];if(p>=0)for(let w=0;w!==f;w++){const b=u[w];b>=0&&ze.isEmpty(s.get(b,p))&&ze.embedPositionAdjustmentPattern(b-2,p-2,s)}}}}ze.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),ze.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),ze.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),ze.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),ze.VERSION_INFO_POLY=7973,ze.TYPE_INFO_POLY=1335,ze.TYPE_INFO_MASK_PATTERN=21522;class Pu{constructor(r,s){this.dataBytes=r,this.errorCorrectionBytes=s}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class Tt{constructor(){}static calculateMaskPenalty(r){return Ft.applyMaskPenaltyRule1(r)+Ft.applyMaskPenaltyRule2(r)+Ft.applyMaskPenaltyRule3(r)+Ft.applyMaskPenaltyRule4(r)}static encode(r,s,a=null){let u=Tt.DEFAULT_BYTE_MODE_ENCODING;const d=a!==null&&a.get(Zt.CHARACTER_SET)!==void 0;d&&(u=a.get(Zt.CHARACTER_SET).toString());const f=this.chooseMode(r,u),p=new z;if(f===Be.BYTE&&(d||Tt.DEFAULT_BYTE_MODE_ENCODING!==u)){const ye=ie.getCharacterSetECIByName(u);ye!==void 0&&this.appendECI(ye,p)}this.appendModeInfo(f,p);const w=new z;this.appendBytes(r,f,w,u);let b;if(a!==null&&a.get(Zt.QR_VERSION)!==void 0){const ye=Number.parseInt(a.get(Zt.QR_VERSION).toString(),10);b=Ce.getVersionForNumber(ye);const ge=this.calculateBitsNeeded(f,p,w,b);if(!this.willFit(ge,b,s))throw new Ct("Data too big for requested version")}else b=this.recommendVersion(s,f,p,w);const A=new z;A.appendBitArray(p);const O=f===Be.BYTE?w.getSizeInBytes():r.length;this.appendLengthInfo(O,b,f,A),A.appendBitArray(w);const B=b.getECBlocksForLevel(s),V=b.getTotalCodewords()-B.getTotalECCodewords();this.terminateBits(V,A);const X=this.interleaveWithECBytes(A,b.getTotalCodewords(),V,B.getNumBlocks()),q=new Ei;q.setECLevel(s),q.setMode(f),q.setVersion(b);const ee=b.getDimensionForVersion(),se=new Hs(ee,ee),xe=this.chooseMaskPattern(X,s,b,se);return q.setMaskPattern(xe),ze.buildMatrix(X,s,b,xe,se),q.setMatrix(se),q}static recommendVersion(r,s,a,u){const d=this.calculateBitsNeeded(s,a,u,Ce.getVersionForNumber(1)),f=this.chooseVersion(d,r),p=this.calculateBitsNeeded(s,a,u,f);return this.chooseVersion(p,r)}static calculateBitsNeeded(r,s,a,u){return s.getSize()+r.getCharacterCountBits(u)+a.getSize()}static getAlphanumericCode(r){return r<Tt.ALPHANUMERIC_TABLE.length?Tt.ALPHANUMERIC_TABLE[r]:-1}static chooseMode(r,s=null){if(ie.SJIS.getName()===s&&this.isOnlyDoubleByteKanji(r))return Be.KANJI;let a=!1,u=!1;for(let d=0,f=r.length;d<f;++d){const p=r.charAt(d);if(Tt.isDigit(p))a=!0;else if(this.getAlphanumericCode(p.charCodeAt(0))!==-1)u=!0;else return Be.BYTE}return u?Be.ALPHANUMERIC:a?Be.NUMERIC:Be.BYTE}static isOnlyDoubleByteKanji(r){let s;try{s=ce.encode(r,ie.SJIS)}catch{return!1}const a=s.length;if(a%2!==0)return!1;for(let u=0;u<a;u+=2){const d=s[u]&255;if((d<129||d>159)&&(d<224||d>235))return!1}return!0}static chooseMaskPattern(r,s,a,u){let d=Number.MAX_SAFE_INTEGER,f=-1;for(let p=0;p<Ei.NUM_MASK_PATTERNS;p++){ze.buildMatrix(r,s,a,p,u);let w=this.calculateMaskPenalty(u);w<d&&(d=w,f=p)}return f}static chooseVersion(r,s){for(let a=1;a<=40;a++){const u=Ce.getVersionForNumber(a);if(Tt.willFit(r,u,s))return u}throw new Ct("Data too big")}static willFit(r,s,a){const u=s.getTotalCodewords(),f=s.getECBlocksForLevel(a).getTotalECCodewords(),p=u-f,w=(r+7)/8;return p>=w}static terminateBits(r,s){const a=r*8;if(s.getSize()>a)throw new Ct("data bits cannot fit in the QR Code"+s.getSize()+" > "+a);for(let f=0;f<4&&s.getSize()<a;++f)s.appendBit(!1);const u=s.getSize()&7;if(u>0)for(let f=u;f<8;f++)s.appendBit(!1);const d=r-s.getSizeInBytes();for(let f=0;f<d;++f)s.appendBits(f&1?17:236,8);if(s.getSize()!==a)throw new Ct("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(r,s,a,u,d,f){if(u>=a)throw new Ct("Block ID too large");const p=r%a,w=a-p,b=Math.floor(r/a),A=b+1,O=Math.floor(s/a),B=O+1,V=b-O,X=A-B;if(V!==X)throw new Ct("EC bytes mismatch");if(a!==w+p)throw new Ct("RS blocks mismatch");if(r!==(O+V)*w+(B+X)*p)throw new Ct("Total bytes mismatch");u<w?(d[0]=O,f[0]=V):(d[0]=B,f[0]=X)}static interleaveWithECBytes(r,s,a,u){if(r.getSizeInBytes()!==a)throw new Ct("Number of bits and data bytes does not match");let d=0,f=0,p=0;const w=new Array;for(let A=0;A<u;++A){const O=new Int32Array(1),B=new Int32Array(1);Tt.getNumDataBytesAndNumECBytesForBlockID(s,a,u,A,O,B);const V=O[0],X=new Uint8Array(V);r.toBytes(8*d,X,0,V);const q=Tt.generateECBytes(X,B[0]);w.push(new Pu(X,q)),f=Math.max(f,V),p=Math.max(p,q.length),d+=O[0]}if(a!==d)throw new Ct("Data bytes does not match offset");const b=new z;for(let A=0;A<f;++A)for(const O of w){const B=O.getDataBytes();A<B.length&&b.appendBits(B[A],8)}for(let A=0;A<p;++A)for(const O of w){const B=O.getErrorCorrectionBytes();A<B.length&&b.appendBits(B[A],8)}if(s!==b.getSizeInBytes())throw new Ct("Interleaving error: "+s+" and "+b.getSizeInBytes()+" differ.");return b}static generateECBytes(r,s){const a=r.length,u=new Int32Array(a+s);for(let f=0;f<a;f++)u[f]=r[f]&255;new wa(Le.QR_CODE_FIELD_256).encode(u,s);const d=new Uint8Array(s);for(let f=0;f<s;f++)d[f]=u[a+f];return d}static appendModeInfo(r,s){s.appendBits(r.getBits(),4)}static appendLengthInfo(r,s,a,u){const d=a.getCharacterCountBits(s);if(r>=1<<d)throw new Ct(r+" is bigger than "+((1<<d)-1));u.appendBits(r,d)}static appendBytes(r,s,a,u){switch(s){case Be.NUMERIC:Tt.appendNumericBytes(r,a);break;case Be.ALPHANUMERIC:Tt.appendAlphanumericBytes(r,a);break;case Be.BYTE:Tt.append8BitBytes(r,a,u);break;case Be.KANJI:Tt.appendKanjiBytes(r,a);break;default:throw new Ct("Invalid mode: "+s)}}static getDigit(r){return r.charCodeAt(0)-48}static isDigit(r){const s=Tt.getDigit(r);return s>=0&&s<=9}static appendNumericBytes(r,s){const a=r.length;let u=0;for(;u<a;){const d=Tt.getDigit(r.charAt(u));if(u+2<a){const f=Tt.getDigit(r.charAt(u+1)),p=Tt.getDigit(r.charAt(u+2));s.appendBits(d*100+f*10+p,10),u+=3}else if(u+1<a){const f=Tt.getDigit(r.charAt(u+1));s.appendBits(d*10+f,7),u+=2}else s.appendBits(d,4),u++}}static appendAlphanumericBytes(r,s){const a=r.length;let u=0;for(;u<a;){const d=Tt.getAlphanumericCode(r.charCodeAt(u));if(d===-1)throw new Ct;if(u+1<a){const f=Tt.getAlphanumericCode(r.charCodeAt(u+1));if(f===-1)throw new Ct;s.appendBits(d*45+f,11),u+=2}else s.appendBits(d,6),u++}}static append8BitBytes(r,s,a){let u;try{u=ce.encode(r,a)}catch(d){throw new Ct(d)}for(let d=0,f=u.length;d!==f;d++){const p=u[d];s.appendBits(p,8)}}static appendKanjiBytes(r,s){let a;try{a=ce.encode(r,ie.SJIS)}catch(d){throw new Ct(d)}const u=a.length;for(let d=0;d<u;d+=2){const f=a[d]&255,p=a[d+1]&255,w=f<<8&4294967295|p;let b=-1;if(w>=33088&&w<=40956?b=w-33088:w>=57408&&w<=60351&&(b=w-49472),b===-1)throw new Ct("Invalid byte sequence");const A=(b>>8)*192+(b&255);s.appendBits(A,13)}}static appendECI(r,s){s.appendBits(Be.ECI.getBits(),4),s.appendBits(r.getValue(),8)}}Tt.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),Tt.DEFAULT_BYTE_MODE_ENCODING=ie.UTF8.getName();class ai{write(r,s,a,u=null){if(r.length===0)throw new E("Found empty contents");if(s<0||a<0)throw new E("Requested dimensions are too small: "+s+"x"+a);let d=it.L,f=ai.QUIET_ZONE_SIZE;u!==null&&(u.get(Zt.ERROR_CORRECTION)!==void 0&&(d=it.fromString(u.get(Zt.ERROR_CORRECTION).toString())),u.get(Zt.MARGIN)!==void 0&&(f=Number.parseInt(u.get(Zt.MARGIN).toString(),10)));const p=Tt.encode(r,d,u);return this.renderResult(p,s,a,f)}writeToDom(r,s,a,u,d=null){typeof r=="string"&&(r=document.querySelector(r));const f=this.write(s,a,u,d);r&&r.appendChild(f)}renderResult(r,s,a,u){const d=r.getMatrix();if(d===null)throw new Ot;const f=d.getWidth(),p=d.getHeight(),w=f+u*2,b=p+u*2,A=Math.max(s,w),O=Math.max(a,b),B=Math.min(Math.floor(A/w),Math.floor(O/b)),V=Math.floor((A-f*B)/2),X=Math.floor((O-p*B)/2),q=this.createSVGElement(A,O);for(let ee=0,se=X;ee<p;ee++,se+=B)for(let xe=0,ye=V;xe<f;xe++,ye+=B)if(d.get(xe,ee)===1){const ge=this.createSvgRectElement(ye,se,B,B);q.appendChild(ge)}return q}createSVGElement(r,s){const a=document.createElementNS(ai.SVG_NS,"svg");return a.setAttributeNS(null,"height",r.toString()),a.setAttributeNS(null,"width",s.toString()),a}createSvgRectElement(r,s,a,u){const d=document.createElementNS(ai.SVG_NS,"rect");return d.setAttributeNS(null,"x",r.toString()),d.setAttributeNS(null,"y",s.toString()),d.setAttributeNS(null,"height",a.toString()),d.setAttributeNS(null,"width",u.toString()),d.setAttributeNS(null,"fill","#000000"),d}}ai.QUIET_ZONE_SIZE=4,ai.SVG_NS="http://www.w3.org/2000/svg";class Gr{encode(r,s,a,u,d){if(r.length===0)throw new E("Found empty contents");if(s!==fe.QR_CODE)throw new E("Can only encode QR_CODE, but got "+s);if(a<0||u<0)throw new E(`Requested dimensions are too small: ${a}x${u}`);let f=it.L,p=Gr.QUIET_ZONE_SIZE;d!==null&&(d.get(Zt.ERROR_CORRECTION)!==void 0&&(f=it.fromString(d.get(Zt.ERROR_CORRECTION).toString())),d.get(Zt.MARGIN)!==void 0&&(p=Number.parseInt(d.get(Zt.MARGIN).toString(),10)));const w=Tt.encode(r,f,d);return Gr.renderResult(w,a,u,p)}static renderResult(r,s,a,u){const d=r.getMatrix();if(d===null)throw new Ot;const f=d.getWidth(),p=d.getHeight(),w=f+u*2,b=p+u*2,A=Math.max(s,w),O=Math.max(a,b),B=Math.min(Math.floor(A/w),Math.floor(O/b)),V=Math.floor((A-f*B)/2),X=Math.floor((O-p*B)/2),q=new Te(A,O);for(let ee=0,se=X;ee<p;ee++,se+=B)for(let xe=0,ye=V;xe<f;xe++,ye+=B)d.get(xe,ee)===1&&q.setRegion(ye,se,B,B);return q}}Gr.QUIET_ZONE_SIZE=4;class Si{encode(r,s,a,u,d){let f;switch(s){case fe.QR_CODE:f=new Gr;break;default:throw new E("No encoder available for format "+s)}return f.encode(r,s,a,u,d)}}class Ir extends K{constructor(r,s,a,u,d,f,p,w){if(super(f,p),this.yuvData=r,this.dataWidth=s,this.dataHeight=a,this.left=u,this.top=d,u+f>s||d+p>a)throw new E("Crop rectangle does not fit within image data.");w&&this.reverseHorizontal(f,p)}getRow(r,s){if(r<0||r>=this.getHeight())throw new E("Requested row is outside the image: "+r);const a=this.getWidth();(s==null||s.length<a)&&(s=new Uint8ClampedArray(a));const u=(r+this.top)*this.dataWidth+this.left;return P.arraycopy(this.yuvData,u,s,0,a),s}getMatrix(){const r=this.getWidth(),s=this.getHeight();if(r===this.dataWidth&&s===this.dataHeight)return this.yuvData;const a=r*s,u=new Uint8ClampedArray(a);let d=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return P.arraycopy(this.yuvData,d,u,0,a),u;for(let f=0;f<s;f++){const p=f*r;P.arraycopy(this.yuvData,d,u,p,r),d+=this.dataWidth}return u}isCropSupported(){return!0}crop(r,s,a,u){return new Ir(this.yuvData,this.dataWidth,this.dataHeight,this.left+r,this.top+s,a,u,!1)}renderThumbnail(){const r=this.getWidth()/Ir.THUMBNAIL_SCALE_FACTOR,s=this.getHeight()/Ir.THUMBNAIL_SCALE_FACTOR,a=new Int32Array(r*s),u=this.yuvData;let d=this.top*this.dataWidth+this.left;for(let f=0;f<s;f++){const p=f*r;for(let w=0;w<r;w++){const b=u[d+w*Ir.THUMBNAIL_SCALE_FACTOR]&255;a[p+w]=4278190080|b*65793}d+=this.dataWidth*Ir.THUMBNAIL_SCALE_FACTOR}return a}getThumbnailWidth(){return this.getWidth()/Ir.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Ir.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(r,s){const a=this.yuvData;for(let u=0,d=this.top*this.dataWidth+this.left;u<s;u++,d+=this.dataWidth){const f=d+r/2;for(let p=d,w=d+r-1;p<f;p++,w--){const b=a[p];a[p]=a[w],a[w]=b}}}invert(){return new me(this)}}Ir.THUMBNAIL_SCALE_FACTOR=2;class Ai extends K{constructor(r,s,a,u,d,f,p){if(super(s,a),this.dataWidth=u,this.dataHeight=d,this.left=f,this.top=p,r.BYTES_PER_ELEMENT===4){const w=s*a,b=new Uint8ClampedArray(w);for(let A=0;A<w;A++){const O=r[A],B=O>>16&255,V=O>>7&510,X=O&255;b[A]=(B+V+X)/4&255}this.luminances=b}else this.luminances=r;if(u===void 0&&(this.dataWidth=s),d===void 0&&(this.dataHeight=a),f===void 0&&(this.left=0),p===void 0&&(this.top=0),this.left+s>this.dataWidth||this.top+a>this.dataHeight)throw new E("Crop rectangle does not fit within image data.")}getRow(r,s){if(r<0||r>=this.getHeight())throw new E("Requested row is outside the image: "+r);const a=this.getWidth();(s==null||s.length<a)&&(s=new Uint8ClampedArray(a));const u=(r+this.top)*this.dataWidth+this.left;return P.arraycopy(this.luminances,u,s,0,a),s}getMatrix(){const r=this.getWidth(),s=this.getHeight();if(r===this.dataWidth&&s===this.dataHeight)return this.luminances;const a=r*s,u=new Uint8ClampedArray(a);let d=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return P.arraycopy(this.luminances,d,u,0,a),u;for(let f=0;f<s;f++){const p=f*r;P.arraycopy(this.luminances,d,u,p,r),d+=this.dataWidth}return u}isCropSupported(){return!0}crop(r,s,a,u){return new Ai(this.luminances,a,u,this.dataWidth,this.dataHeight,this.left+r,this.top+s)}invert(){return new me(this)}}class Gn extends ie{static forName(r){return this.getCharacterSetECIByName(r)}}class yo{}yo.ISO_8859_1=ie.ISO8859_1;class _a{isCompact(){return this.compact}setCompact(r){this.compact=r}getSize(){return this.size}setSize(r){this.size=r}getLayers(){return this.layers}setLayers(r){this.layers=r}getCodeWords(){return this.codeWords}setCodeWords(r){this.codeWords=r}getMatrix(){return this.matrix}setMatrix(r){this.matrix=r}}class Ul{static singletonList(r){return[r]}static min(r,s){return r.sort(s)[0]}}class ba{constructor(r){this.previous=r}getPrevious(){return this.previous}}class li extends ba{constructor(r,s,a){super(r),this.value=s,this.bitCount=a}appendTo(r,s){r.appendBits(this.value,this.bitCount)}add(r,s){return new li(this,r,s)}addBinaryShift(r,s){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new li(this,r,s)}toString(){let r=this.value&(1<<this.bitCount)-1;return r|=1<<this.bitCount,"<"+k.toBinaryString(r|1<<this.bitCount).substring(1)+">"}}class Ca extends li{constructor(r,s,a){super(r,0,0),this.binaryShiftStart=s,this.binaryShiftByteCount=a}appendTo(r,s){for(let a=0;a<this.binaryShiftByteCount;a++)(a===0||a===31&&this.binaryShiftByteCount<=62)&&(r.appendBits(31,5),this.binaryShiftByteCount>62?r.appendBits(this.binaryShiftByteCount-31,16):a===0?r.appendBits(Math.min(this.binaryShiftByteCount,31),5):r.appendBits(this.binaryShiftByteCount-31,5)),r.appendBits(s[this.binaryShiftStart+a],8)}addBinaryShift(r,s){return new Ca(this,r,s)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function Ru(M,r,s){return new Ca(M,r,s)}function Xi(M,r,s){return new li(M,r,s)}const ju=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],on=0,Zr=1,nr=2,kr=3,Mr=4,qi=new li(null,0,0),Ea=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function Ws(M){for(let r of M)I.fill(r,-1);return M[on][Mr]=0,M[Zr][Mr]=0,M[Zr][on]=28,M[kr][Mr]=0,M[nr][Mr]=0,M[nr][on]=15,M}const Sa=Ws(I.createInt32Array(6,6));class Zn{constructor(r,s,a,u){this.token=r,this.mode=s,this.binaryShiftByteCount=a,this.bitCount=u}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(r,s){let a=this.bitCount,u=this.token;if(r!==this.mode){let f=Ea[this.mode][r];u=Xi(u,f&65535,f>>16),a+=f>>16}let d=r===nr?4:5;return u=Xi(u,s,d),new Zn(u,r,0,a+d)}shiftAndAppend(r,s){let a=this.token,u=this.mode===nr?4:5;return a=Xi(a,Sa[this.mode][r],u),a=Xi(a,s,5),new Zn(a,this.mode,0,this.bitCount+u+5)}addBinaryShiftChar(r){let s=this.token,a=this.mode,u=this.bitCount;if(this.mode===Mr||this.mode===nr){let p=Ea[a][on];s=Xi(s,p&65535,p>>16),u+=p>>16,a=on}let d=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,f=new Zn(s,a,this.binaryShiftByteCount+1,u+d);return f.binaryShiftByteCount===2078&&(f=f.endBinaryShift(r+1)),f}endBinaryShift(r){if(this.binaryShiftByteCount===0)return this;let s=this.token;return s=Ru(s,r-this.binaryShiftByteCount,this.binaryShiftByteCount),new Zn(s,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(r){let s=this.bitCount+(Ea[this.mode][r.mode]>>16);return this.binaryShiftByteCount<r.binaryShiftByteCount?s+=Zn.calculateBinaryShiftCost(r)-Zn.calculateBinaryShiftCost(this):this.binaryShiftByteCount>r.binaryShiftByteCount&&r.binaryShiftByteCount>0&&(s+=10),s<=r.bitCount}toBitArray(r){let s=[];for(let u=this.endBinaryShift(r.length).token;u!==null;u=u.getPrevious())s.unshift(u);let a=new z;for(const u of s)u.appendTo(a,r);return a}toString(){return ue.format("%s bits=%d bytes=%d",ju[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(r){return r.binaryShiftByteCount>62?21:r.binaryShiftByteCount>31?20:r.binaryShiftByteCount>0?10:0}}Zn.INITIAL_STATE=new Zn(qi,on,0,0);function Du(M){const r=ue.getCharCode(" "),s=ue.getCharCode("."),a=ue.getCharCode(",");M[on][r]=1;const u=ue.getCharCode("Z"),d=ue.getCharCode("A");for(let B=d;B<=u;B++)M[on][B]=B-d+2;M[Zr][r]=1;const f=ue.getCharCode("z"),p=ue.getCharCode("a");for(let B=p;B<=f;B++)M[Zr][B]=B-p+2;M[nr][r]=1;const w=ue.getCharCode("9"),b=ue.getCharCode("0");for(let B=b;B<=w;B++)M[nr][B]=B-b+2;M[nr][a]=12,M[nr][s]=13;const A=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let B=0;B<A.length;B++)M[kr][ue.getCharCode(A[B])]=B;const O=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let B=0;B<O.length;B++)ue.getCharCode(O[B])>0&&(M[Mr][ue.getCharCode(O[B])]=B);return M}const Or=Du(I.createInt32Array(5,256));class ci{constructor(r){this.text=r}encode(){const r=ue.getCharCode(" "),s=ue.getCharCode(`
`);let a=Ul.singletonList(Zn.INITIAL_STATE);for(let d=0;d<this.text.length;d++){let f,p=d+1<this.text.length?this.text[d+1]:0;switch(this.text[d]){case ue.getCharCode("\r"):f=p===s?2:0;break;case ue.getCharCode("."):f=p===r?3:0;break;case ue.getCharCode(","):f=p===r?4:0;break;case ue.getCharCode(":"):f=p===r?5:0;break;default:f=0}f>0?(a=ci.updateStateListForPair(a,d,f),d++):a=this.updateStateListForChar(a,d)}return Ul.min(a,(d,f)=>d.getBitCount()-f.getBitCount()).toBitArray(this.text)}updateStateListForChar(r,s){const a=[];for(let u of r)this.updateStateForChar(u,s,a);return ci.simplifyStates(a)}updateStateForChar(r,s,a){let u=this.text[s]&255,d=Or[r.getMode()][u]>0,f=null;for(let p=0;p<=Mr;p++){let w=Or[p][u];if(w>0){if(f==null&&(f=r.endBinaryShift(s)),!d||p===r.getMode()||p===nr){const b=f.latchAndAppend(p,w);a.push(b)}if(!d&&Sa[r.getMode()][p]>=0){const b=f.shiftAndAppend(p,w);a.push(b)}}}if(r.getBinaryShiftByteCount()>0||Or[r.getMode()][u]===0){let p=r.addBinaryShiftChar(s);a.push(p)}}static updateStateListForPair(r,s,a){const u=[];for(let d of r)this.updateStateForPair(d,s,a,u);return this.simplifyStates(u)}static updateStateForPair(r,s,a,u){let d=r.endBinaryShift(s);if(u.push(d.latchAndAppend(Mr,a)),r.getMode()!==Mr&&u.push(d.shiftAndAppend(Mr,a)),a===3||a===4){let f=d.latchAndAppend(nr,16-a).latchAndAppend(nr,1);u.push(f)}if(r.getBinaryShiftByteCount()>0){let f=r.addBinaryShiftChar(s).addBinaryShiftChar(s+1);u.push(f)}}static simplifyStates(r){let s=[];for(const a of r){let u=!0;for(const d of s){if(d.isBetterThanOrEqualTo(a)){u=!1;break}a.isBetterThanOrEqualTo(d)&&(s=s.filter(f=>f!==d))}u&&s.push(a)}return s}}class dt{constructor(){}static encodeBytes(r){return dt.encode(r,dt.DEFAULT_EC_PERCENT,dt.DEFAULT_AZTEC_LAYERS)}static encode(r,s,a){let u=new ci(r).encode(),d=k.truncDivision(u.getSize()*s,100)+11,f=u.getSize()+d,p,w,b,A,O;if(a!==dt.DEFAULT_AZTEC_LAYERS){if(p=a<0,w=Math.abs(a),w>(p?dt.MAX_NB_BITS_COMPACT:dt.MAX_NB_BITS))throw new E(ue.format("Illegal value %s for layers",a));b=dt.totalBitsInLayer(w,p),A=dt.WORD_SIZE[w];let ge=b-b%A;if(O=dt.stuffBits(u,A),O.getSize()+d>ge)throw new E("Data to large for user specified layer");if(p&&O.getSize()>A*64)throw new E("Data to large for user specified layer")}else{A=0,O=null;for(let ge=0;;ge++){if(ge>dt.MAX_NB_BITS)throw new E("Data too large for an Aztec code");if(p=ge<=3,w=p?ge+1:ge,b=dt.totalBitsInLayer(w,p),f>b)continue;(O==null||A!==dt.WORD_SIZE[w])&&(A=dt.WORD_SIZE[w],O=dt.stuffBits(u,A));let st=b-b%A;if(!(p&&O.getSize()>A*64)&&O.getSize()+d<=st)break}}let B=dt.generateCheckWords(O,b,A),V=O.getSize()/A,X=dt.generateModeMessage(p,w,V),q=(p?11:14)+w*4,ee=new Int32Array(q),se;if(p){se=q;for(let ge=0;ge<ee.length;ge++)ee[ge]=ge}else{se=q+1+2*k.truncDivision(k.truncDivision(q,2)-1,15);let ge=k.truncDivision(q,2),st=k.truncDivision(se,2);for(let $e=0;$e<ge;$e++){let Ut=$e+k.truncDivision($e,15);ee[ge-$e-1]=st-Ut-1,ee[ge+$e]=st+Ut+1}}let xe=new Te(se);for(let ge=0,st=0;ge<w;ge++){let $e=(w-ge)*4+(p?9:12);for(let Ut=0;Ut<$e;Ut++){let Pn=Ut*2;for(let Rn=0;Rn<2;Rn++)B.get(st+Pn+Rn)&&xe.set(ee[ge*2+Rn],ee[ge*2+Ut]),B.get(st+$e*2+Pn+Rn)&&xe.set(ee[ge*2+Ut],ee[q-1-ge*2-Rn]),B.get(st+$e*4+Pn+Rn)&&xe.set(ee[q-1-ge*2-Rn],ee[q-1-ge*2-Ut]),B.get(st+$e*6+Pn+Rn)&&xe.set(ee[q-1-ge*2-Ut],ee[ge*2+Rn])}st+=$e*8}if(dt.drawModeMessage(xe,p,se,X),p)dt.drawBullsEye(xe,k.truncDivision(se,2),5);else{dt.drawBullsEye(xe,k.truncDivision(se,2),7);for(let ge=0,st=0;ge<k.truncDivision(q,2)-1;ge+=15,st+=16)for(let $e=k.truncDivision(se,2)&1;$e<se;$e+=2)xe.set(k.truncDivision(se,2)-st,$e),xe.set(k.truncDivision(se,2)+st,$e),xe.set($e,k.truncDivision(se,2)-st),xe.set($e,k.truncDivision(se,2)+st)}let ye=new _a;return ye.setCompact(p),ye.setSize(se),ye.setLayers(w),ye.setCodeWords(V),ye.setMatrix(xe),ye}static drawBullsEye(r,s,a){for(let u=0;u<a;u+=2)for(let d=s-u;d<=s+u;d++)r.set(d,s-u),r.set(d,s+u),r.set(s-u,d),r.set(s+u,d);r.set(s-a,s-a),r.set(s-a+1,s-a),r.set(s-a,s-a+1),r.set(s+a,s-a),r.set(s+a,s-a+1),r.set(s+a,s+a-1)}static generateModeMessage(r,s,a){let u=new z;return r?(u.appendBits(s-1,2),u.appendBits(a-1,6),u=dt.generateCheckWords(u,28,4)):(u.appendBits(s-1,5),u.appendBits(a-1,11),u=dt.generateCheckWords(u,40,4)),u}static drawModeMessage(r,s,a,u){let d=k.truncDivision(a,2);if(s)for(let f=0;f<7;f++){let p=d-3+f;u.get(f)&&r.set(p,d-5),u.get(f+7)&&r.set(d+5,p),u.get(20-f)&&r.set(p,d+5),u.get(27-f)&&r.set(d-5,p)}else for(let f=0;f<10;f++){let p=d-5+f+k.truncDivision(f,5);u.get(f)&&r.set(p,d-7),u.get(f+10)&&r.set(d+7,p),u.get(29-f)&&r.set(p,d+7),u.get(39-f)&&r.set(d-7,p)}}static generateCheckWords(r,s,a){let u=r.getSize()/a,d=new wa(dt.getGF(a)),f=k.truncDivision(s,a),p=dt.bitsToWords(r,a,f);d.encode(p,f-u);let w=s%a,b=new z;b.appendBits(0,w);for(const A of Array.from(p))b.appendBits(A,a);return b}static bitsToWords(r,s,a){let u=new Int32Array(a),d,f;for(d=0,f=r.getSize()/s;d<f;d++){let p=0;for(let w=0;w<s;w++)p|=r.get(d*s+w)?1<<s-w-1:0;u[d]=p}return u}static getGF(r){switch(r){case 4:return Le.AZTEC_PARAM;case 6:return Le.AZTEC_DATA_6;case 8:return Le.AZTEC_DATA_8;case 10:return Le.AZTEC_DATA_10;case 12:return Le.AZTEC_DATA_12;default:throw new E("Unsupported word size "+r)}}static stuffBits(r,s){let a=new z,u=r.getSize(),d=(1<<s)-2;for(let f=0;f<u;f+=s){let p=0;for(let w=0;w<s;w++)(f+w>=u||r.get(f+w))&&(p|=1<<s-1-w);(p&d)===d?(a.appendBits(p&d,s),f--):p&d?a.appendBits(p,s):(a.appendBits(p|1,s),f--)}return a}static totalBitsInLayer(r,s){return((s?88:112)+16*r)*r}}dt.DEFAULT_EC_PERCENT=33,dt.DEFAULT_AZTEC_LAYERS=0,dt.MAX_NB_BITS=32,dt.MAX_NB_BITS_COMPACT=4,dt.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Ki{encode(r,s,a,u){return this.encodeWithHints(r,s,a,u,null)}encodeWithHints(r,s,a,u,d){let f=yo.ISO_8859_1,p=dt.DEFAULT_EC_PERCENT,w=dt.DEFAULT_AZTEC_LAYERS;return d!=null&&(d.has(Zt.CHARACTER_SET)&&(f=Gn.forName(d.get(Zt.CHARACTER_SET).toString())),d.has(Zt.ERROR_CORRECTION)&&(p=k.parseInt(d.get(Zt.ERROR_CORRECTION).toString())),d.has(Zt.AZTEC_LAYERS)&&(w=k.parseInt(d.get(Zt.AZTEC_LAYERS).toString()))),Ki.encodeLayers(r,s,a,u,f,p,w)}static encodeLayers(r,s,a,u,d,f,p){if(s!==fe.AZTEC)throw new E("Can only encode AZTEC, but got "+s);let w=dt.encode(ue.getBytes(r,d),f,p);return Ki.renderResult(w,a,u)}static renderResult(r,s,a){let u=r.getMatrix();if(u==null)throw new Ot;let d=u.getWidth(),f=u.getHeight(),p=Math.max(s,d),w=Math.max(a,f),b=Math.min(p/d,w/f),A=(p-d*b)/2,O=(w-f*b)/2,B=new Te(p,w);for(let V=0,X=O;V<f;V++,X+=b)for(let q=0,ee=A;q<d;q++,ee+=b)u.get(q,V)&&B.setRegion(ee,X,b,b);return B}}n.AbstractExpandedDecoder=ho,n.ArgumentException=S,n.ArithmeticException=gt,n.AztecCode=_a,n.AztecCodeReader=tr,n.AztecCodeWriter=Ki,n.AztecDecoder=qe,n.AztecDetector=rn,n.AztecDetectorResult=yi,n.AztecEncoder=dt,n.AztecHighLevelEncoder=ci,n.AztecPoint=en,n.BarcodeFormat=fe,n.Binarizer=j,n.BinaryBitmap=T,n.BitArray=z,n.BitMatrix=Te,n.BitSource=Gi,n.BrowserAztecCodeReader=zn,n.BrowserBarcodeReader=js,n.BrowserCodeReader=Qe,n.BrowserDatamatrixCodeReader=ma,n.BrowserMultiFormatReader=Bl,n.BrowserPDF417Reader=oi,n.BrowserQRCodeReader=Fl,n.BrowserQRCodeSvgWriter=ai,n.CharacterSetECI=ie,n.ChecksumException=U,n.Code128Reader=_e,n.Code39Reader=qt,n.DataMatrixDecodedBitStreamParser=Wn,n.DataMatrixReader=vt,n.DecodeHintType=Y,n.DecoderResult=Nn,n.DefaultGridSampler=Tn,n.DetectorResult=dr,n.EAN13Reader=ri,n.EncodeHintType=Zt,n.Exception=y,n.FormatException=Z,n.GenericGF=Le,n.GenericGFPoly=tt,n.GlobalHistogramBinarizer=pe,n.GridSampler=Hi,n.GridSamplerInstance=In,n.HTMLCanvasElementLuminanceSource=le,n.HybridBinarizer=ne,n.ITFReader=bt,n.IllegalArgumentException=E,n.IllegalStateException=Ot,n.InvertedLuminanceSource=me,n.LuminanceSource=K,n.MathUtils=Ge,n.MultiFormatOneDReader=si,n.MultiFormatReader=Dl,n.MultiFormatWriter=Si,n.NotFoundException=Q,n.OneDReader=_t,n.PDF417DecodedBitStreamParser=oe,n.PDF417DecoderErrorCorrection=go,n.PDF417Reader=dn,n.PDF417ResultMetadata=va,n.PerspectiveTransform=rt,n.PlanarYUVLuminanceSource=Ir,n.QRCodeByteMatrix=Hs,n.QRCodeDataMask=_n,n.QRCodeDecodedBitStreamParser=Mt,n.QRCodeDecoderErrorCorrectionLevel=it,n.QRCodeDecoderFormatInformation=wn,n.QRCodeEncoder=Tt,n.QRCodeEncoderQRCode=Ei,n.QRCodeMaskUtil=Ft,n.QRCodeMatrixUtil=ze,n.QRCodeMode=Be,n.QRCodeReader=cn,n.QRCodeVersion=Ce,n.QRCodeWriter=Gr,n.RGBLuminanceSource=Ai,n.RSS14Reader=Vt,n.RSSExpandedReader=de,n.ReaderException=Vn,n.ReedSolomonDecoder=Ze,n.ReedSolomonEncoder=wa,n.ReedSolomonException=yt,n.Result=Fe,n.ResultMetadataType=Je,n.ResultPoint=ke,n.StringUtils=ue,n.UnsupportedOperationException=Ee,n.VideoInputDevice=be,n.WhiteRectangleDetector=Sr,n.WriterException=Ct,n.ZXingArrays=I,n.ZXingCharset=Gn,n.ZXingInteger=k,n.ZXingStandardCharsets=yo,n.ZXingStringBuilder=Ie,n.ZXingStringEncoding=ce,n.ZXingSystem=P,n.createAbstractExpandedDecoder=Rs,Object.defineProperty(n,"__esModule",{value:!0})})})(jh,jh.exports);var Ht=jh.exports;const bC=Dh(Ht),CC=hg({__proto__:null,default:bC},[Ht]);var tg=function(){function e(t,n,i){if(this.formatMap=new Map([[Me.QR_CODE,Ht.BarcodeFormat.QR_CODE],[Me.AZTEC,Ht.BarcodeFormat.AZTEC],[Me.CODABAR,Ht.BarcodeFormat.CODABAR],[Me.CODE_39,Ht.BarcodeFormat.CODE_39],[Me.CODE_93,Ht.BarcodeFormat.CODE_93],[Me.CODE_128,Ht.BarcodeFormat.CODE_128],[Me.DATA_MATRIX,Ht.BarcodeFormat.DATA_MATRIX],[Me.MAXICODE,Ht.BarcodeFormat.MAXICODE],[Me.ITF,Ht.BarcodeFormat.ITF],[Me.EAN_13,Ht.BarcodeFormat.EAN_13],[Me.EAN_8,Ht.BarcodeFormat.EAN_8],[Me.PDF_417,Ht.BarcodeFormat.PDF_417],[Me.RSS_14,Ht.BarcodeFormat.RSS_14],[Me.RSS_EXPANDED,Ht.BarcodeFormat.RSS_EXPANDED],[Me.UPC_A,Ht.BarcodeFormat.UPC_A],[Me.UPC_E,Ht.BarcodeFormat.UPC_E],[Me.UPC_EAN_EXTENSION,Ht.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!CC)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=n,this.logger=i;var l=this.createZXingFormats(t),c=new Map;c.set(Ht.DecodeHintType.POSSIBLE_FORMATS,l),c.set(Ht.DecodeHintType.TRY_HARDER,!1),this.hints=c}return e.prototype.decodeAsync=function(t){var n=this;return new Promise(function(i,l){try{i(n.decode(t))}catch(c){l(c)}})},e.prototype.decode=function(t){var n=new Ht.MultiFormatReader(this.verbose,this.hints),i=new Ht.HTMLCanvasElementLuminanceSource(t),l=new Ht.BinaryBitmap(new Ht.HybridBinarizer(i)),c=n.decode(l);return{text:c.text,format:jx.create(this.toHtml5QrcodeSupportedFormats(c.format)),debugData:this.createDebugData()}},e.prototype.createReverseFormatMap=function(){var t=new Map;return this.formatMap.forEach(function(n,i,l){t.set(n,i)}),t},e.prototype.toHtml5QrcodeSupportedFormats=function(t){if(!this.reverseFormatMap.has(t))throw"reverseFormatMap doesn't have ".concat(t);return this.reverseFormatMap.get(t)},e.prototype.createZXingFormats=function(t){for(var n=[],i=0,l=t;i<l.length;i++){var c=l[i];this.formatMap.has(c)?n.push(this.formatMap.get(c)):this.logger.logError("".concat(c," is not supported by")+"ZXingHtml5QrcodeShim")}return n},e.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},e}(),EC=function(e,t,n,i){function l(c){return c instanceof n?c:new n(function(m){m(c)})}return new(n||(n=Promise))(function(c,m){function _(S){try{y(i.next(S))}catch(E){m(E)}}function v(S){try{y(i.throw(S))}catch(E){m(E)}}function y(S){S.done?c(S.value):l(S.value).then(_,v)}y((i=i.apply(e,t||[])).next())})},SC=function(e,t){var n={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,l,c,m;return m={next:_(0),throw:_(1),return:_(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function _(y){return function(S){return v([y,S])}}function v(y){if(i)throw new TypeError("Generator is already executing.");for(;m&&(m=0,y[0]&&(n=0)),n;)try{if(i=1,l&&(c=y[0]&2?l.return:y[0]?l.throw||((c=l.return)&&c.call(l),0):l.next)&&!(c=c.call(l,y[1])).done)return c;switch(l=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return n.label++,{value:y[1],done:!1};case 5:n.label++,l=y[1],y=[0];continue;case 7:y=n.ops.pop(),n.trys.pop();continue;default:if(c=n.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){n=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){n.label=y[1];break}if(y[0]===6&&n.label<c[1]){n.label=c[1],c=y;break}if(c&&n.label<c[2]){n.label=c[2],n.ops.push(y);break}c[2]&&n.ops.pop(),n.trys.pop();continue}y=t.call(e,n)}catch(S){y=[6,S],l=0}finally{i=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}},ng=function(){function e(t,n,i){if(this.formatMap=new Map([[Me.QR_CODE,"qr_code"],[Me.AZTEC,"aztec"],[Me.CODABAR,"codabar"],[Me.CODE_39,"code_39"],[Me.CODE_93,"code_93"],[Me.CODE_128,"code_128"],[Me.DATA_MATRIX,"data_matrix"],[Me.ITF,"itf"],[Me.EAN_13,"ean_13"],[Me.EAN_8,"ean_8"],[Me.PDF_417,"pdf417"],[Me.UPC_A,"upc_a"],[Me.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!e.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=n,this.logger=i;var l=this.createBarcodeDetectorFormats(t);if(this.detector=new BarcodeDetector(l),!this.detector)throw"BarcodeDetector detector not supported"}return e.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var t=new BarcodeDetector({formats:["qr_code"]});return typeof t<"u"},e.prototype.decodeAsync=function(t){return EC(this,void 0,void 0,function(){var n,i;return SC(this,function(l){switch(l.label){case 0:return[4,this.detector.detect(t)];case 1:if(n=l.sent(),!n||n.length===0)throw"No barcode or QR code detected.";return i=this.selectLargestBarcode(n),[2,{text:i.rawValue,format:jx.create(this.toHtml5QrcodeSupportedFormats(i.format)),debugData:this.createDebugData()}]}})})},e.prototype.selectLargestBarcode=function(t){for(var n=null,i=0,l=0,c=t;l<c.length;l++){var m=c[l],_=m.boundingBox.width*m.boundingBox.height;_>i&&(i=_,n=m)}if(!n)throw"No largest barcode found";return n},e.prototype.createBarcodeDetectorFormats=function(t){for(var n=[],i=0,l=t;i<l.length;i++){var c=l[i];this.formatMap.has(c)?n.push(this.formatMap.get(c)):this.logger.warn("".concat(c," is not supported by")+"BarcodeDetectorDelegate")}return{formats:n}},e.prototype.toHtml5QrcodeSupportedFormats=function(t){if(!this.reverseFormatMap.has(t))throw"reverseFormatMap doesn't have ".concat(t);return this.reverseFormatMap.get(t)},e.prototype.createReverseFormatMap=function(){var t=new Map;return this.formatMap.forEach(function(n,i,l){t.set(n,i)}),t},e.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},e}(),rg=function(e,t,n,i){function l(c){return c instanceof n?c:new n(function(m){m(c)})}return new(n||(n=Promise))(function(c,m){function _(S){try{y(i.next(S))}catch(E){m(E)}}function v(S){try{y(i.throw(S))}catch(E){m(E)}}function y(S){S.done?c(S.value):l(S.value).then(_,v)}y((i=i.apply(e,t||[])).next())})},ig=function(e,t){var n={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,l,c,m;return m={next:_(0),throw:_(1),return:_(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function _(y){return function(S){return v([y,S])}}function v(y){if(i)throw new TypeError("Generator is already executing.");for(;m&&(m=0,y[0]&&(n=0)),n;)try{if(i=1,l&&(c=y[0]&2?l.return:y[0]?l.throw||((c=l.return)&&c.call(l),0):l.next)&&!(c=c.call(l,y[1])).done)return c;switch(l=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return n.label++,{value:y[1],done:!1};case 5:n.label++,l=y[1],y=[0];continue;case 7:y=n.ops.pop(),n.trys.pop();continue;default:if(c=n.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){n=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){n.label=y[1];break}if(y[0]===6&&n.label<c[1]){n.label=c[1],c=y;break}if(c&&n.label<c[2]){n.label=c[2],n.ops.push(y);break}c[2]&&n.ops.pop(),n.trys.pop();continue}y=t.call(e,n)}catch(S){y=[6,S],l=0}finally{i=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}},AC=function(){function e(t,n,i,l){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=i,n&&ng.isSupported()?(this.primaryDecoder=new ng(t,i,l),this.secondaryDecoder=new tg(t,i,l)):this.primaryDecoder=new tg(t,i,l)}return e.prototype.decodeAsync=function(t){return rg(this,void 0,void 0,function(){var n;return ig(this,function(i){switch(i.label){case 0:n=performance.now(),i.label=1;case 1:return i.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(t)];case 2:return[2,i.sent()];case 3:return this.possiblyLogPerformance(n),[7];case 4:return[2]}})})},e.prototype.decodeRobustlyAsync=function(t){return rg(this,void 0,void 0,function(){var n,i;return ig(this,function(l){switch(l.label){case 0:n=performance.now(),l.label=1;case 1:return l.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(t)];case 2:return[2,l.sent()];case 3:if(i=l.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(t)];throw i;case 4:return this.possiblyLogPerformance(n),[7];case 5:return[2]}})})},e.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},e.prototype.possiblyLogPerformance=function(t){if(this.verbose){var n=performance.now()-t;this.executionResults.push(n),this.executions++,this.possiblyFlushPerformanceReport()}},e.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var t=0,n=0,i=this.executionResults;n<i.length;n++){var l=i[n];t+=l}var c=t/this.executionResults.length;console.log("".concat(c," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},e}(),Zf=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,l){i.__proto__=l}||function(i,l){for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(i[c]=l[c])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),tu=function(e,t,n,i){function l(c){return c instanceof n?c:new n(function(m){m(c)})}return new(n||(n=Promise))(function(c,m){function _(S){try{y(i.next(S))}catch(E){m(E)}}function v(S){try{y(i.throw(S))}catch(E){m(E)}}function y(S){S.done?c(S.value):l(S.value).then(_,v)}y((i=i.apply(e,t||[])).next())})},nu=function(e,t){var n={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,l,c,m;return m={next:_(0),throw:_(1),return:_(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function _(y){return function(S){return v([y,S])}}function v(y){if(i)throw new TypeError("Generator is already executing.");for(;m&&(m=0,y[0]&&(n=0)),n;)try{if(i=1,l&&(c=y[0]&2?l.return:y[0]?l.throw||((c=l.return)&&c.call(l),0):l.next)&&!(c=c.call(l,y[1])).done)return c;switch(l=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return n.label++,{value:y[1],done:!1};case 5:n.label++,l=y[1],y=[0];continue;case 7:y=n.ops.pop(),n.trys.pop();continue;default:if(c=n.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){n=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){n.label=y[1];break}if(y[0]===6&&n.label<c[1]){n.label=c[1],c=y;break}if(c&&n.label<c[2]){n.label=c[2],n.ops.push(y);break}c[2]&&n.ops.pop(),n.trys.pop();continue}y=t.call(e,n)}catch(S){y=[6,S],l=0}finally{i=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}},Ux=function(){function e(t,n){this.name=t,this.track=n}return e.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},e.prototype.apply=function(t){var n={};n[this.name]=t;var i={advanced:[n]};return this.track.applyConstraints(i)},e.prototype.value=function(){var t=this.track.getSettings();if(this.name in t){var n=t[this.name];return n}return null},e}(),NC=function(e){Zf(t,e);function t(n,i){return e.call(this,n,i)||this}return t.prototype.min=function(){return this.getCapabilities().min},t.prototype.max=function(){return this.getCapabilities().max},t.prototype.step=function(){return this.getCapabilities().step},t.prototype.apply=function(n){var i={};i[this.name]=n;var l={advanced:[i]};return this.track.applyConstraints(l)},t.prototype.getCapabilities=function(){this.failIfNotSupported();var n=this.track.getCapabilities(),i=n[this.name];return{min:i.min,max:i.max,step:i.step}},t.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},t}(Ux),TC=function(e){Zf(t,e);function t(n){return e.call(this,"zoom",n)||this}return t}(NC),IC=function(e){Zf(t,e);function t(n){return e.call(this,"torch",n)||this}return t}(Ux),kC=function(){function e(t){this.track=t}return e.prototype.zoomFeature=function(){return new TC(this.track)},e.prototype.torchFeature=function(){return new IC(this.track)},e}(),MC=function(){function e(t,n,i){this.isClosed=!1,this.parentElement=t,this.mediaStream=n,this.callbacks=i,this.surface=this.createVideoElement(this.parentElement.clientWidth),t.append(this.surface)}return e.prototype.createVideoElement=function(t){var n=document.createElement("video");return n.style.width="".concat(t,"px"),n.style.display="block",n.muted=!0,n.setAttribute("muted","true"),n.playsInline=!0,n},e.prototype.setupSurface=function(){var t=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var n=function(){var i=t.surface.clientWidth,l=t.surface.clientHeight;t.callbacks.onRenderSurfaceReady(i,l),t.surface.removeEventListener("playing",n)};this.surface.addEventListener("playing",n),this.surface.srcObject=this.mediaStream,this.surface.play()},e.create=function(t,n,i,l){return tu(this,void 0,void 0,function(){var c,m;return nu(this,function(_){switch(_.label){case 0:return c=new e(t,n,l),i.aspectRatio?(m={aspectRatio:i.aspectRatio},[4,c.getFirstTrackOrFail().applyConstraints(m)]):[3,2];case 1:_.sent(),_.label=2;case 2:return c.setupSurface(),[2,c]}})})},e.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},e.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},e.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},e.prototype.resume=function(t){this.failIfClosed();var n=this,i=function(){setTimeout(t,200),n.surface.removeEventListener("playing",i)};this.surface.addEventListener("playing",i),this.surface.play()},e.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},e.prototype.getSurface=function(){return this.failIfClosed(),this.surface},e.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},e.prototype.applyVideoConstraints=function(t){return tu(this,void 0,void 0,function(){return nu(this,function(n){if("aspectRatio"in t)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(t)]})})},e.prototype.close=function(){if(this.isClosed)return Promise.resolve();var t=this;return new Promise(function(n,i){var l=t.mediaStream.getVideoTracks(),c=l.length,m=0;t.mediaStream.getVideoTracks().forEach(function(_){t.mediaStream.removeTrack(_),_.stop(),++m,m>=c&&(t.isClosed=!0,t.parentElement.removeChild(t.surface),n())})})},e.prototype.getCapabilities=function(){return new kC(this.getFirstTrackOrFail())},e}(),OC=function(){function e(t){this.mediaStream=t}return e.prototype.render=function(t,n,i){return tu(this,void 0,void 0,function(){return nu(this,function(l){return[2,MC.create(t,this.mediaStream,n,i)]})})},e.create=function(t){return tu(this,void 0,void 0,function(){var n,i;return nu(this,function(l){switch(l.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return n={audio:!1,video:t},[4,navigator.mediaDevices.getUserMedia(n)];case 1:return i=l.sent(),[2,new e(i)]}})})},e}(),sg=function(e,t,n,i){function l(c){return c instanceof n?c:new n(function(m){m(c)})}return new(n||(n=Promise))(function(c,m){function _(S){try{y(i.next(S))}catch(E){m(E)}}function v(S){try{y(i.throw(S))}catch(E){m(E)}}function y(S){S.done?c(S.value):l(S.value).then(_,v)}y((i=i.apply(e,t||[])).next())})},og=function(e,t){var n={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,l,c,m;return m={next:_(0),throw:_(1),return:_(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function _(y){return function(S){return v([y,S])}}function v(y){if(i)throw new TypeError("Generator is already executing.");for(;m&&(m=0,y[0]&&(n=0)),n;)try{if(i=1,l&&(c=y[0]&2?l.return:y[0]?l.throw||((c=l.return)&&c.call(l),0):l.next)&&!(c=c.call(l,y[1])).done)return c;switch(l=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return n.label++,{value:y[1],done:!1};case 5:n.label++,l=y[1],y=[0];continue;case 7:y=n.ops.pop(),n.trys.pop();continue;default:if(c=n.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){n=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){n.label=y[1];break}if(y[0]===6&&n.label<c[1]){n.label=c[1],c=y;break}if(c&&n.label<c[2]){n.label=c[2],n.ops.push(y);break}c[2]&&n.ops.pop(),n.trys.pop();continue}y=t.call(e,n)}catch(S){y=[6,S],l=0}finally{i=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}},LC=function(){function e(){}return e.failIfNotSupported=function(){return sg(this,void 0,void 0,function(){return og(this,function(t){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new e]})})},e.prototype.create=function(t){return sg(this,void 0,void 0,function(){return og(this,function(n){return[2,OC.create(t)]})})},e}(),PC=function(e,t,n,i){function l(c){return c instanceof n?c:new n(function(m){m(c)})}return new(n||(n=Promise))(function(c,m){function _(S){try{y(i.next(S))}catch(E){m(E)}}function v(S){try{y(i.throw(S))}catch(E){m(E)}}function y(S){S.done?c(S.value):l(S.value).then(_,v)}y((i=i.apply(e,t||[])).next())})},RC=function(e,t){var n={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,l,c,m;return m={next:_(0),throw:_(1),return:_(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function _(y){return function(S){return v([y,S])}}function v(y){if(i)throw new TypeError("Generator is already executing.");for(;m&&(m=0,y[0]&&(n=0)),n;)try{if(i=1,l&&(c=y[0]&2?l.return:y[0]?l.throw||((c=l.return)&&c.call(l),0):l.next)&&!(c=c.call(l,y[1])).done)return c;switch(l=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return n.label++,{value:y[1],done:!1};case 5:n.label++,l=y[1],y=[0];continue;case 7:y=n.ops.pop(),n.trys.pop();continue;default:if(c=n.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){n=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){n.label=y[1];break}if(y[0]===6&&n.label<c[1]){n.label=c[1],c=y;break}if(c&&n.label<c[2]){n.label=c[2],n.ops.push(y);break}c[2]&&n.ops.pop(),n.trys.pop();continue}y=t.call(e,n)}catch(S){y=[6,S],l=0}finally{i=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}},jC=function(){function e(){}return e.retrieve=function(){if(navigator.mediaDevices)return e.getCamerasFromMediaDevices();var t=MediaStreamTrack;return MediaStreamTrack&&t.getSources?e.getCamerasFromMediaStreamTrack():e.rejectWithError()},e.rejectWithError=function(){var t=Uo.unableToQuerySupportedDevices();return e.isHttpsOrLocalhost()||(t=Uo.insecureContextCameraQueryError()),Promise.reject(t)},e.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var t=location.host.split(":")[0];return t==="127.0.0.1"||t==="localhost"},e.getCamerasFromMediaDevices=function(){return PC(this,void 0,void 0,function(){var t,n,i,l,c,m,_;return RC(this,function(v){switch(v.label){case 0:return t=function(y){for(var S=y.getVideoTracks(),E=0,T=S;E<T.length;E++){var U=T[E];U.enabled=!1,U.stop(),y.removeTrack(U)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return n=v.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(i=v.sent(),l=[],c=0,m=i;c<m.length;c++)_=m[c],_.kind==="videoinput"&&l.push({id:_.deviceId,label:_.label});return t(n),[2,l]}})})},e.getCamerasFromMediaStreamTrack=function(){return new Promise(function(t,n){var i=function(c){for(var m=[],_=0,v=c;_<v.length;_++){var y=v[_];y.kind==="video"&&m.push({id:y.id,label:y.label})}t(m)},l=MediaStreamTrack;l.getSources(i)})},e}(),Kt;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.NOT_STARTED=1]="NOT_STARTED",e[e.SCANNING=2]="SCANNING",e[e.PAUSED=3]="PAUSED"})(Kt||(Kt={}));var DC=function(){function e(){this.state=Kt.NOT_STARTED,this.onGoingTransactionNewState=Kt.UNKNOWN}return e.prototype.directTransition=function(t){this.failIfTransitionOngoing(),this.validateTransition(t),this.state=t},e.prototype.startTransition=function(t){return this.failIfTransitionOngoing(),this.validateTransition(t),this.onGoingTransactionNewState=t,this},e.prototype.execute=function(){if(this.onGoingTransactionNewState===Kt.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var t=this.onGoingTransactionNewState;this.onGoingTransactionNewState=Kt.UNKNOWN,this.directTransition(t)},e.prototype.cancel=function(){if(this.onGoingTransactionNewState===Kt.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=Kt.UNKNOWN},e.prototype.getState=function(){return this.state},e.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==Kt.UNKNOWN)throw"Cannot transition to a new state, already under transition"},e.prototype.validateTransition=function(t){switch(this.state){case Kt.UNKNOWN:throw"Transition from unknown is not allowed";case Kt.NOT_STARTED:this.failIfNewStateIs(t,[Kt.PAUSED]);break;case Kt.SCANNING:break;case Kt.PAUSED:break}},e.prototype.failIfNewStateIs=function(t,n){for(var i=0,l=n;i<l.length;i++){var c=l[i];if(t===c)throw"Cannot transition from ".concat(this.state," to ").concat(t)}},e}(),BC=function(){function e(t){this.stateManager=t}return e.prototype.startTransition=function(t){return this.stateManager.startTransition(t)},e.prototype.directTransition=function(t){this.stateManager.directTransition(t)},e.prototype.getState=function(){return this.stateManager.getState()},e.prototype.canScanFile=function(){return this.stateManager.getState()===Kt.NOT_STARTED},e.prototype.isScanning=function(){return this.stateManager.getState()!==Kt.NOT_STARTED},e.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===Kt.SCANNING},e.prototype.isPaused=function(){return this.stateManager.getState()===Kt.PAUSED},e}(),FC=function(){function e(){}return e.create=function(){return new BC(new DC)},e}(),UC=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,l){i.__proto__=l}||function(i,l){for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(i[c]=l[c])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),pr=function(e){UC(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.DEFAULT_WIDTH=300,t.DEFAULT_WIDTH_OFFSET=2,t.FILE_SCAN_MIN_HEIGHT=300,t.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,t.MIN_QR_BOX_SIZE=50,t.SHADED_LEFT=1,t.SHADED_RIGHT=2,t.SHADED_TOP=3,t.SHADED_BOTTOM=4,t.SHADED_REGION_ELEMENT_ID="qr-shaded-region",t.VERBOSE=!1,t.BORDER_SHADER_DEFAULT_COLOR="#ffffff",t.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",t}(Qr),zC=function(){function e(t,n){this.logger=n,this.fps=pr.SCAN_DEFAULT_FPS,t?(t.fps&&(this.fps=t.fps),this.disableFlip=t.disableFlip===!0,this.qrbox=t.qrbox,this.aspectRatio=t.aspectRatio,this.videoConstraints=t.videoConstraints):this.disableFlip=pr.DEFAULT_DISABLE_FLIP}return e.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?Fx.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},e.prototype.isShadedBoxEnabled=function(){return!fi(this.qrbox)},e.create=function(t,n){return new e(t,n)},e}(),ag=function(){function e(t,n){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(t))throw"HTML Element with id=".concat(t," not found");this.elementId=t,this.verbose=!1;var i;typeof n=="boolean"?this.verbose=n===!0:n&&(i=n,this.verbose=i.verbose===!0,i.experimentalFeatures),this.logger=new Bx(this.verbose),this.qrcode=new AC(this.getSupportedFormats(n),this.getUseBarCodeDetectorIfSupported(i),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=FC.create()}return e.prototype.start=function(t,n,i,l){var c=this;if(!t)throw"cameraIdOrConfig is required";if(!i||typeof i!="function")throw"qrCodeSuccessCallback is required and should be a function.";var m;l?m=l:m=this.verbose?this.logger.log:function(){};var _=zC.create(n,this.logger);this.clearElement();var v=!1;_.videoConstraints&&(_.isMediaStreamConstraintsValid()?v=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var y=v,S=document.getElementById(this.elementId);S.clientWidth?S.clientWidth:pr.DEFAULT_WIDTH,S.style.position="relative",this.shouldScan=!0,this.element=S;var E=this,T=this.stateManagerProxy.startTransition(Kt.SCANNING);return new Promise(function(U,j){var P=y?_.videoConstraints:E.createVideoConstraints(t);if(!P){T.cancel(),j("videoConstraints should be defined");return}var D={};(!y||_.aspectRatio)&&(D.aspectRatio=_.aspectRatio);var R={onRenderSurfaceReady:function(I,k){E.setupUi(I,k,_),E.isScanning=!0,E.foreverScan(_,i,m)}};LC.failIfNotSupported().then(function(I){I.create(P).then(function(k){return k.render(c.element,D,R).then(function(z){E.renderedCamera=z,T.execute(),U(null)}).catch(function(z){T.cancel(),j(z)})}).catch(function(k){T.cancel(),j(Uo.errorGettingUserMedia(k))})}).catch(function(I){T.cancel(),j(Uo.cameraStreamingNotSupported())})})},e.prototype.pause=function(t){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(Kt.PAUSED),this.showPausedState(),(fi(t)||t!==!0)&&(t=!1),t&&this.renderedCamera&&this.renderedCamera.pause()},e.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var t=this,n=function(){t.stateManagerProxy.directTransition(Kt.SCANNING),t.hidePausedState()};if(!this.renderedCamera.isPaused()){n();return}this.renderedCamera.resume(function(){n()})},e.prototype.getState=function(){return this.stateManagerProxy.getState()},e.prototype.stop=function(){var t=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var n=this.stateManagerProxy.startTransition(Kt.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var i=function(){if(t.element){var c=document.getElementById(pr.SHADED_REGION_ELEMENT_ID);c&&t.element.removeChild(c)}},l=this;return this.renderedCamera.close().then(function(){return l.renderedCamera=null,l.element&&(l.element.removeChild(l.canvasElement),l.canvasElement=null),i(),l.qrRegion&&(l.qrRegion=null),l.context&&(l.context=null),n.execute(),l.hidePausedState(),l.isScanning=!1,Promise.resolve()})},e.prototype.scanFile=function(t,n){return this.scanFileV2(t,n).then(function(i){return i.decodedText})},e.prototype.scanFileV2=function(t,n){var i=this;if(!t||!(t instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(fi(n)&&(n=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(l,c){i.possiblyCloseLastScanImageFile(),i.clearElement(),i.lastScanImageFile=URL.createObjectURL(t);var m=new Image;m.onload=function(){var _=m.width,v=m.height,y=document.getElementById(i.elementId),S=y.clientWidth?y.clientWidth:pr.DEFAULT_WIDTH,E=Math.max(y.clientHeight?y.clientHeight:v,pr.FILE_SCAN_MIN_HEIGHT),T=i.computeCanvasDrawConfig(_,v,S,E);if(n){var U=i.createCanvasElement(S,E,"qr-canvas-visible");U.style.display="inline-block",y.appendChild(U);var j=U.getContext("2d");if(!j)throw"Unable to get 2d context from canvas";j.canvas.width=S,j.canvas.height=E,j.drawImage(m,0,0,_,v,T.x,T.y,T.width,T.height)}var P=pr.FILE_SCAN_HIDDEN_CANVAS_PADDING,D=Math.max(m.width,T.width),R=Math.max(m.height,T.height),I=D+2*P,k=R+2*P,z=i.createCanvasElement(I,k);y.appendChild(z);var G=z.getContext("2d");if(!G)throw"Unable to get 2d context from canvas";G.canvas.width=I,G.canvas.height=k,G.drawImage(m,0,0,_,v,P,P,D,R);try{i.qrcode.decodeRobustlyAsync(z).then(function(Y){l(J1.createFromQrcodeResult(Y))}).catch(c)}catch(Y){c("QR code parse error, error = ".concat(Y))}},m.onerror=c,m.onabort=c,m.onstalled=c,m.onsuspend=c,m.src=URL.createObjectURL(t)})},e.prototype.clear=function(){this.clearElement()},e.getCameras=function(){return jC.retrieve()},e.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},e.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},e.prototype.applyVideoConstraints=function(t){if(t){if(!Fx.isMediaStreamConstraintsValid(t,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(t)},e.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},e.prototype.getSupportedFormats=function(t){var n=[Me.QR_CODE,Me.AZTEC,Me.CODABAR,Me.CODE_39,Me.CODE_93,Me.CODE_128,Me.DATA_MATRIX,Me.MAXICODE,Me.ITF,Me.EAN_13,Me.EAN_8,Me.PDF_417,Me.RSS_14,Me.RSS_EXPANDED,Me.UPC_A,Me.UPC_E,Me.UPC_EAN_EXTENSION];if(!t||typeof t=="boolean"||!t.formatsToSupport)return n;if(!Array.isArray(t.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(t.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var i=[],l=0,c=t.formatsToSupport;l<c.length;l++){var m=c[l];wC(m)?i.push(m):this.logger.warn("Invalid format: ".concat(m," passed in config, ignoring."))}if(i.length===0)throw"None of formatsToSupport match supported values.";return i},e.prototype.getUseBarCodeDetectorIfSupported=function(t){if(fi(t))return!0;if(!fi(t.useBarCodeDetectorIfSupported))return t.useBarCodeDetectorIfSupported!==!1;if(fi(t.experimentalFeatures))return!0;var n=t.experimentalFeatures;return fi(n.useBarCodeDetectorIfSupported)?!0:n.useBarCodeDetectorIfSupported!==!1},e.prototype.validateQrboxSize=function(t,n,i){var l=this,c=i.qrbox;this.validateQrboxConfig(c);var m=this.toQrdimensions(t,n,c),_=function(y){if(y<pr.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(pr.MIN_QR_BOX_SIZE,"px.")},v=function(y){return y>t&&(l.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),y=t),y};_(m.width),_(m.height),m.width=v(m.width)},e.prototype.validateQrboxConfig=function(t){if(typeof t!="number"&&typeof t!="function"&&(t.width===void 0||t.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},e.prototype.toQrdimensions=function(t,n,i){if(typeof i=="number")return{width:i,height:i};if(typeof i=="function")try{return i(t,n)}catch(l){throw new Error("qrbox config was passed as a function but it failed with unknown error"+l)}return i},e.prototype.setupUi=function(t,n,i){i.isShadedBoxEnabled()&&this.validateQrboxSize(t,n,i);var l=fi(i.qrbox)?{width:t,height:n}:i.qrbox;this.validateQrboxConfig(l);var c=this.toQrdimensions(t,n,l);c.height>n&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var m=i.isShadedBoxEnabled()&&c.height<=n,_={x:0,y:0,width:t,height:n},v=m?this.getShadedRegionBounds(t,n,c):_,y=this.createCanvasElement(v.width,v.height),S={willReadFrequently:!0},E=y.getContext("2d",S);E.canvas.width=v.width,E.canvas.height=v.height,this.element.append(y),m&&this.possiblyInsertShadingElement(this.element,t,n,c),this.createScannerPausedUiElement(this.element),this.qrRegion=v,this.context=E,this.canvasElement=y},e.prototype.createScannerPausedUiElement=function(t){var n=document.createElement("div");n.innerText=Uo.scannerPaused(),n.style.display="none",n.style.position="absolute",n.style.top="0px",n.style.zIndex="1",n.style.background="rgba(9, 9, 9, 0.46)",n.style.color="#FFECEC",n.style.textAlign="center",n.style.width="100%",t.appendChild(n),this.scannerPausedUiElement=n},e.prototype.scanContext=function(t,n){var i=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(l){return t(l.text,J1.createFromQrcodeResult(l)),i.possiblyUpdateShaders(!0),!0}).catch(function(l){i.possiblyUpdateShaders(!1);var c=Uo.codeParseError(l);return n(c,Dx.createFrom(c)),!1})},e.prototype.foreverScan=function(t,n,i){var l=this;if(this.shouldScan&&this.renderedCamera){var c=this.renderedCamera.getSurface(),m=c.videoWidth/c.clientWidth,_=c.videoHeight/c.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var v=this.qrRegion.width*m,y=this.qrRegion.height*_,S=this.qrRegion.x*m,E=this.qrRegion.y*_;this.context.drawImage(c,S,E,v,y,0,0,this.qrRegion.width,this.qrRegion.height);var T=function(){l.foreverScanTimeout=setTimeout(function(){l.foreverScan(t,n,i)},l.getTimeoutFps(t.fps))};this.scanContext(n,i).then(function(U){!U&&t.disableFlip!==!0?(l.context.translate(l.context.canvas.width,0),l.context.scale(-1,1),l.scanContext(n,i).finally(function(){T()})):T()}).catch(function(U){l.logger.logError("Error happend while scanning context",U),T()})}},e.prototype.createVideoConstraints=function(t){if(typeof t=="string")return{deviceId:{exact:t}};if(typeof t=="object"){var n="facingMode",i="deviceId",l={user:!0,environment:!0},c="exact",m=function(j){if(j in l)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(j,"'")},_=Object.keys(t);if(_.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(_.length," keys");var v=Object.keys(t)[0];if(v!==n&&v!==i)throw"Only '".concat(n,"' and '").concat(i,"' ")+" are supported for 'cameraIdOrConfig'";if(v===n){var y=t.facingMode;if(typeof y=="string"){if(m(y))return{facingMode:y}}else if(typeof y=="object")if(c in y){if(m(y["".concat(c)]))return{facingMode:{exact:y["".concat(c)]}}}else throw"'facingMode' should be string or object with"+" ".concat(c," as key.");else{var S=typeof y;throw"Invalid type of 'facingMode' = ".concat(S)}}else{var E=t.deviceId;if(typeof E=="string")return{deviceId:E};if(typeof E=="object"){if(c in E)return{deviceId:{exact:E["".concat(c)]}};throw"'deviceId' should be string or object with"+" ".concat(c," as key.")}else{var T=typeof E;throw"Invalid type of 'deviceId' = ".concat(T)}}}var U=typeof t;throw"Invalid type of 'cameraIdOrConfig' = ".concat(U)},e.prototype.computeCanvasDrawConfig=function(t,n,i,l){if(t<=i&&n<=l){var c=(i-t)/2,m=(l-n)/2;return{x:c,y:m,width:t,height:n}}else{var _=t,v=n;return t>i&&(n=i/t*n,t=i),n>l&&(t=l/n*t,n=l),this.logger.log("Image downsampled from "+"".concat(_,"X").concat(v)+" to ".concat(t,"X").concat(n,".")),this.computeCanvasDrawConfig(t,n,i,l)}},e.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var t=document.getElementById(this.elementId);t&&(t.innerHTML="")},e.prototype.possiblyUpdateShaders=function(t){this.qrMatch!==t&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(n){n.style.backgroundColor=t?pr.BORDER_SHADER_MATCH_COLOR:pr.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=t)},e.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},e.prototype.createCanvasElement=function(t,n,i){var l=t,c=n,m=document.createElement("canvas");return m.style.width="".concat(l,"px"),m.style.height="".concat(c,"px"),m.style.display="none",m.id=fi(i)?"qr-canvas":i,m},e.prototype.getShadedRegionBounds=function(t,n,i){if(i.width>t||i.height>n)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(t-i.width)/2,y:(n-i.height)/2,width:i.width,height:i.height}},e.prototype.possiblyInsertShadingElement=function(t,n,i,l){if(!(n-l.width<1||i-l.height<1)){var c=document.createElement("div");c.style.position="absolute";var m=(n-l.width)/2,_=(i-l.height)/2;if(c.style.borderLeft="".concat(m,"px solid rgba(0, 0, 0, 0.48)"),c.style.borderRight="".concat(m,"px solid rgba(0, 0, 0, 0.48)"),c.style.borderTop="".concat(_,"px solid rgba(0, 0, 0, 0.48)"),c.style.borderBottom="".concat(_,"px solid rgba(0, 0, 0, 0.48)"),c.style.boxSizing="border-box",c.style.top="0px",c.style.bottom="0px",c.style.left="0px",c.style.right="0px",c.id="".concat(pr.SHADED_REGION_ELEMENT_ID),n-l.width<11||i-l.height<11)this.hasBorderShaders=!1;else{var v=5,y=40;this.insertShaderBorders(c,y,v,-v,null,0,!0),this.insertShaderBorders(c,y,v,-v,null,0,!1),this.insertShaderBorders(c,y,v,null,-v,0,!0),this.insertShaderBorders(c,y,v,null,-v,0,!1),this.insertShaderBorders(c,v,y+v,-v,null,-v,!0),this.insertShaderBorders(c,v,y+v,null,-v,-v,!0),this.insertShaderBorders(c,v,y+v,-v,null,-v,!1),this.insertShaderBorders(c,v,y+v,null,-v,-v,!1),this.hasBorderShaders=!0}t.append(c)}},e.prototype.insertShaderBorders=function(t,n,i,l,c,m,_){var v=document.createElement("div");v.style.position="absolute",v.style.backgroundColor=pr.BORDER_SHADER_DEFAULT_COLOR,v.style.width="".concat(n,"px"),v.style.height="".concat(i,"px"),l!==null&&(v.style.top="".concat(l,"px")),c!==null&&(v.style.bottom="".concat(c,"px")),_?v.style.left="".concat(m,"px"):v.style.right="".concat(m,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(v),t.appendChild(v)},e.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},e.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},e.prototype.getTimeoutFps=function(t){return 1e3/t},e}(),Yf="data:image/svg+xml;base64,",HC=Yf+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNzEuNjQzIDM3MS42NDMiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDM3MS42NDMgMzcxLjY0MyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZD0iTTEwNS4wODQgMzguMjcxaDE2My43Njh2MjBIMTA1LjA4NHoiLz48cGF0aCBkPSJNMzExLjU5NiAxOTAuMTg5Yy03LjQ0MS05LjM0Ny0xOC40MDMtMTYuMjA2LTMyLjc0My0yMC41MjJWMzBjMC0xNi41NDItMTMuNDU4LTMwLTMwLTMwSDEyNS4wODRjLTE2LjU0MiAwLTMwIDEzLjQ1OC0zMCAzMHYxMjAuMTQzaC04LjI5NmMtMTYuNTQyIDAtMzAgMTMuNDU4LTMwIDMwdjEuMzMzYTI5LjgwNCAyOS44MDQgMCAwIDAgNC42MDMgMTUuOTM5Yy03LjM0IDUuNDc0LTEyLjEwMyAxNC4yMjEtMTIuMTAzIDI0LjA2MXYxLjMzM2MwIDkuODQgNC43NjMgMTguNTg3IDEyLjEwMyAyNC4wNjJhMjkuODEgMjkuODEgMCAwIDAtNC42MDMgMTUuOTM4djEuMzMzYzAgMTYuNTQyIDEzLjQ1OCAzMCAzMCAzMGg4LjMyNGMuNDI3IDExLjYzMSA3LjUwMyAyMS41ODcgMTcuNTM0IDI2LjE3Ny45MzEgMTAuNTAzIDQuMDg0IDMwLjE4NyAxNC43NjggNDUuNTM3YTkuOTg4IDkuOTg4IDAgMCAwIDguMjE2IDQuMjg4IDkuOTU4IDkuOTU4IDAgMCAwIDUuNzA0LTEuNzkzYzQuNTMzLTMuMTU1IDUuNjUtOS4zODggMi40OTUtMTMuOTIxLTYuNzk4LTkuNzY3LTkuNjAyLTIyLjYwOC0xMC43Ni0zMS40aDgyLjY4NWMuMjcyLjQxNC41NDUuODE4LjgxNSAxLjIxIDMuMTQyIDQuNTQxIDkuMzcyIDUuNjc5IDEzLjkxMyAyLjUzNCA0LjU0Mi0zLjE0MiA1LjY3Ny05LjM3MSAyLjUzNS0xMy45MTMtMTEuOTE5LTE3LjIyOS04Ljc4Ny0zNS44ODQgOS41ODEtNTcuMDEyIDMuMDY3LTIuNjUyIDEyLjMwNy0xMS43MzIgMTEuMjE3LTI0LjAzMy0uODI4LTkuMzQzLTcuMTA5LTE3LjE5NC0xOC42NjktMjMuMzM3YTkuODU3IDkuODU3IDAgMCAwLTEuMDYxLS40ODZjLS40NjYtLjE4Mi0xMS40MDMtNC41NzktOS43NDEtMTUuNzA2IDEuMDA3LTYuNzM3IDE0Ljc2OC04LjI3MyAyMy43NjYtNy42NjYgMjMuMTU2IDEuNTY5IDM5LjY5OCA3LjgwMyA0Ny44MzYgMTguMDI2IDUuNzUyIDcuMjI1IDcuNjA3IDE2LjYyMyA1LjY3MyAyOC43MzMtLjQxMyAyLjU4NS0uODI0IDUuMjQxLTEuMjQ1IDcuOTU5LTUuNzU2IDM3LjE5NC0xMi45MTkgODMuNDgzLTQ5Ljg3IDExNC42NjEtNC4yMjEgMy41NjEtNC43NTYgOS44Ny0xLjE5NCAxNC4wOTJhOS45OCA5Ljk4IDAgMCAwIDcuNjQ4IDMuNTUxIDkuOTU1IDkuOTU1IDAgMCAwIDYuNDQ0LTIuMzU4YzQyLjY3Mi0zNi4wMDUgNTAuODAyLTg4LjUzMyA1Ni43MzctMTI2Ljg4OC40MTUtMi42ODQuODIxLTUuMzA5IDEuMjI5LTcuODYzIDIuODM0LTE3LjcyMS0uNDU1LTMyLjY0MS05Ljc3Mi00NC4zNDV6bS0yMzIuMzA4IDQyLjYyYy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM2MwLTUuNTE0IDQuNDg2LTEwIDEwLTEwaDE1djIxLjMzM2gtMTV6bS0yLjUtNTIuNjY2YzAtNS41MTQgNC40ODYtMTAgMTAtMTBoNy41djIxLjMzM2gtNy41Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM3ptMTcuNSA5My45OTloLTcuNWMtNS41MTQgMC0xMC00LjQ4Ni0xMC0xMHYtMS4zMzNjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGg3LjV2MjEuMzMzem0zMC43OTYgMjguODg3Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi04LjI3MWg5MS40NTdjLS44NTEgNi42NjgtLjQzNyAxMi43ODcuNzMxIDE4LjI3MWgtODIuMTg4em03OS40ODItMTEzLjY5OGMtMy4xMjQgMjAuOTA2IDEyLjQyNyAzMy4xODQgMjEuNjI1IDM3LjA0IDUuNDQxIDIuOTY4IDcuNTUxIDUuNjQ3IDcuNzAxIDcuMTg4LjIxIDIuMTUtMi41NTMgNS42ODQtNC40NzcgNy4yNTEtLjQ4Mi4zNzgtLjkyOS44LTEuMzM1IDEuMjYxLTYuOTg3IDcuOTM2LTExLjk4MiAxNS41Mi0xNS40MzIgMjIuNjg4aC05Ny41NjRWMzBjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGgxMjMuNzY5YzUuNTE0IDAgMTAgNC40ODYgMTAgMTB2MTM1LjU3OWMtMy4wMzItLjM4MS02LjE1LS42OTQtOS4zODktLjkxNC0yNS4xNTktMS42OTQtNDIuMzcgNy43NDgtNDQuODk4IDI0LjY2NnoiLz48cGF0aCBkPSJNMTc5LjEyOSA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXpNMTcyLjYyOSAxNDIuODZoLTEyLjU2VjEzMC44YTUgNSAwIDEgMC0xMCAwdjE3LjA2MWE1IDUgMCAwIDAgNSA1aDE3LjU2YTUgNSAwIDEgMCAwLTEwLjAwMXpNMjE2LjU2OCA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXptLTUgMjQuMDYxaC0xNC4wNlY5My4xNjdoMTQuMDZ2MTQuMDYxek0yMTEuNjY5IDEyNS45MzZIMTk3LjQxYTUgNSAwIDAgMC01IDV2MTQuMjU3YTUgNSAwIDAgMCA1IDVoMTQuMjU5YTUgNSAwIDAgMCA1LTV2LTE0LjI1N2E1IDUgMCAwIDAtNS01eiIvPjwvc3ZnPg==",WC=Yf+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1OS4wMTggNTkuMDE4IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1OS4wMTggNTkuMDE4IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJtNTguNzQxIDU0LjgwOS01Ljk2OS02LjI0NGExMC43NCAxMC43NCAwIDAgMCAyLjgyLTcuMjVjMC01Ljk1My00Ljg0My0xMC43OTYtMTAuNzk2LTEwLjc5NlMzNCAzNS4zNjEgMzQgNDEuMzE0IDM4Ljg0MyA1Mi4xMSA0NC43OTYgNTIuMTFjMi40NDEgMCA0LjY4OC0uODI0IDYuNDk5LTIuMTk2bDYuMDAxIDYuMjc3YS45OTguOTk4IDAgMCAwIDEuNDE0LjAzMiAxIDEgMCAwIDAgLjAzMS0xLjQxNHpNMzYgNDEuMzE0YzAtNC44NSAzLjk0Ni04Ljc5NiA4Ljc5Ni04Ljc5NnM4Ljc5NiAzLjk0NiA4Ljc5NiA4Ljc5Ni0zLjk0NiA4Ljc5Ni04Ljc5NiA4Ljc5NlMzNiA0Ni4xNjQgMzYgNDEuMzE0ek0xMC40MzEgMTYuMDg4YzAgMy4wNyAyLjQ5OCA1LjU2OCA1LjU2OSA1LjU2OHM1LjU2OS0yLjQ5OCA1LjU2OS01LjU2OGMwLTMuMDcxLTIuNDk4LTUuNTY5LTUuNTY5LTUuNTY5cy01LjU2OSAyLjQ5OC01LjU2OSA1LjU2OXptOS4xMzggMGMwIDEuOTY4LTEuNjAyIDMuNTY4LTMuNTY5IDMuNTY4cy0zLjU2OS0xLjYwMS0zLjU2OS0zLjU2OCAxLjYwMi0zLjU2OSAzLjU2OS0zLjU2OSAzLjU2OSAxLjYwMSAzLjU2OSAzLjU2OXoiLz48cGF0aCBkPSJtMzAuODgyIDI4Ljk4NyA5LjE4LTEwLjA1NCAxMS4yNjIgMTAuMzIzYTEgMSAwIDAgMCAxLjM1MS0xLjQ3NWwtMTItMTFhMSAxIDAgMCAwLTEuNDE0LjA2M2wtOS43OTQgMTAuNzI3LTQuNzQzLTQuNzQzYTEuMDAzIDEuMDAzIDAgMCAwLTEuMzY4LS4wNDRMNi4zMzkgMzcuNzY4YTEgMSAwIDEgMCAxLjMyMiAxLjUwMWwxNi4zMTMtMTQuMzYyIDcuMzE5IDcuMzE4YS45OTkuOTk5IDAgMSAwIDEuNDE0LTEuNDE0bC0xLjgyNS0xLjgyNHoiLz48cGF0aCBkPSJNMzAgNDYuNTE4SDJ2LTQyaDU0djI4YTEgMSAwIDEgMCAyIDB2LTI5YTEgMSAwIDAgMC0xLTFIMWExIDEgMCAwIDAtMSAxdjQ0YTEgMSAwIDAgMCAxIDFoMjlhMSAxIDAgMSAwIDAtMnoiLz48L3N2Zz4=",lg=Yf+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NjAgNDYwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0NjAgNDYwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJNMjMwIDBDMTAyLjk3NSAwIDAgMTAyLjk3NSAwIDIzMHMxMDIuOTc1IDIzMCAyMzAgMjMwIDIzMC0xMDIuOTc0IDIzMC0yMzBTMzU3LjAyNSAwIDIzMCAwem0zOC4zMzMgMzc3LjM2YzAgOC42NzYtNy4wMzQgMTUuNzEtMTUuNzEgMTUuNzFoLTQzLjEwMWMtOC42NzYgMC0xNS43MS03LjAzNC0xNS43MS0xNS43MVYyMDIuNDc3YzAtOC42NzYgNy4wMzMtMTUuNzEgMTUuNzEtMTUuNzFoNDMuMTAxYzguNjc2IDAgMTUuNzEgNy4wMzMgMTUuNzEgMTUuNzFWMzc3LjM2ek0yMzAgMTU3Yy0yMS41MzkgMC0zOS0xNy40NjEtMzktMzlzMTcuNDYxLTM5IDM5LTM5IDM5IDE3LjQ2MSAzOSAzOS0xNy40NjEgMzktMzkgMzl6Ii8+PC9zdmc+",VC="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAQgAAAEIBarqQRAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAE1SURBVDiNfdI7S0NBEAXgLya1otFgpbYSbISAgpXYi6CmiH9KCAiChaVga6OiWPgfRDQ+0itaGVNosXtluWwcuMzePfM4M3sq8lbHBubwg1dc4m1E/J/N4ghDPOIsfk/4xiEao5KX0McFljN4C9d4QTPXuY99jP3DsIoDPGM6BY5i5yI5R7O4q+ImFkJY2DCh3cAH2klyB+9J1xUMMAG7eCh1a+Mr+k48b5diXrFVwwLuS+BJ9MfR7+G0FHOHhTHhnXNWS87VDF4pcnfQK4Ep7XScNLmPTZgURNKKYENYWDpzW1BhscS1WHS8CDgURFJQrWcoF3c13KKbgg1BYQfy8xZWEzTTw1QZbAoKu8FqJnktdu5hcVSHmchiILzzuaDQvjBzV2m8yohCE1jHfPx/xhU+y4G/D75ELlRJsSYAAAAASUVORK5CYII=",cg=function(){function e(){}return e.createDefault=function(){return{hasPermission:!1,lastUsedCameraId:null}},e}(),GC=function(){function e(){this.data=cg.createDefault();var t=localStorage.getItem(e.LOCAL_STORAGE_KEY);t?this.data=JSON.parse(t):this.reset()}return e.prototype.hasCameraPermissions=function(){return this.data.hasPermission},e.prototype.getLastUsedCameraId=function(){return this.data.lastUsedCameraId},e.prototype.setHasPermission=function(t){this.data.hasPermission=t,this.flush()},e.prototype.setLastUsedCameraId=function(t){this.data.lastUsedCameraId=t,this.flush()},e.prototype.resetLastUsedCameraId=function(){this.data.lastUsedCameraId=null,this.flush()},e.prototype.reset=function(){this.data=cg.createDefault(),this.flush()},e.prototype.flush=function(){localStorage.setItem(e.LOCAL_STORAGE_KEY,JSON.stringify(this.data))},e.LOCAL_STORAGE_KEY="HTML5_QRCODE_DATA",e}(),ZC=function(){function e(){this.infoDiv=document.createElement("div")}return e.prototype.renderInto=function(t){this.infoDiv.style.position="absolute",this.infoDiv.style.top="10px",this.infoDiv.style.right="10px",this.infoDiv.style.zIndex="2",this.infoDiv.style.display="none",this.infoDiv.style.padding="5pt",this.infoDiv.style.border="1px solid #171717",this.infoDiv.style.fontSize="10pt",this.infoDiv.style.background="rgb(0 0 0 / 69%)",this.infoDiv.style.borderRadius="5px",this.infoDiv.style.textAlign="center",this.infoDiv.style.fontWeight="400",this.infoDiv.style.color="white",this.infoDiv.innerText=eg.poweredBy();var n=document.createElement("a");n.innerText="ScanApp",n.href="https://scanapp.org",n.target="new",n.style.color="white",this.infoDiv.appendChild(n);var i=document.createElement("br"),l=document.createElement("br");this.infoDiv.appendChild(i),this.infoDiv.appendChild(l);var c=document.createElement("a");c.innerText=eg.reportIssues(),c.href="https://github.com/mebjas/html5-qrcode/issues",c.target="new",c.style.color="white",this.infoDiv.appendChild(c),t.appendChild(this.infoDiv)},e.prototype.show=function(){this.infoDiv.style.display="block"},e.prototype.hide=function(){this.infoDiv.style.display="none"},e}(),YC=function(){function e(t,n){this.isShowingInfoIcon=!0,this.onTapIn=t,this.onTapOut=n,this.infoIcon=document.createElement("img")}return e.prototype.renderInto=function(t){var n=this;this.infoIcon.alt="Info icon",this.infoIcon.src=lg,this.infoIcon.style.position="absolute",this.infoIcon.style.top="4px",this.infoIcon.style.right="4px",this.infoIcon.style.opacity="0.6",this.infoIcon.style.cursor="pointer",this.infoIcon.style.zIndex="2",this.infoIcon.style.width="16px",this.infoIcon.style.height="16px",this.infoIcon.onmouseover=function(i){return n.onHoverIn()},this.infoIcon.onmouseout=function(i){return n.onHoverOut()},this.infoIcon.onclick=function(i){return n.onClick()},t.appendChild(this.infoIcon)},e.prototype.onHoverIn=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="1")},e.prototype.onHoverOut=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="0.6")},e.prototype.onClick=function(){this.isShowingInfoIcon?(this.isShowingInfoIcon=!1,this.onTapIn(),this.infoIcon.src=VC,this.infoIcon.style.opacity="1"):(this.isShowingInfoIcon=!0,this.onTapOut(),this.infoIcon.src=lg,this.infoIcon.style.opacity="0.6")},e}(),$C=function(){function e(){var t=this;this.infoDiv=new ZC,this.infoIcon=new YC(function(){t.infoDiv.show()},function(){t.infoDiv.hide()})}return e.prototype.renderInto=function(t){this.infoDiv.renderInto(t),this.infoIcon.renderInto(t)},e}(),XC=function(e,t,n,i){function l(c){return c instanceof n?c:new n(function(m){m(c)})}return new(n||(n=Promise))(function(c,m){function _(S){try{y(i.next(S))}catch(E){m(E)}}function v(S){try{y(i.throw(S))}catch(E){m(E)}}function y(S){S.done?c(S.value):l(S.value).then(_,v)}y((i=i.apply(e,t||[])).next())})},qC=function(e,t){var n={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,l,c,m;return m={next:_(0),throw:_(1),return:_(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function _(y){return function(S){return v([y,S])}}function v(y){if(i)throw new TypeError("Generator is already executing.");for(;m&&(m=0,y[0]&&(n=0)),n;)try{if(i=1,l&&(c=y[0]&2?l.return:y[0]?l.throw||((c=l.return)&&c.call(l),0):l.next)&&!(c=c.call(l,y[1])).done)return c;switch(l=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return n.label++,{value:y[1],done:!1};case 5:n.label++,l=y[1],y=[0];continue;case 7:y=n.ops.pop(),n.trys.pop();continue;default:if(c=n.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){n=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){n.label=y[1];break}if(y[0]===6&&n.label<c[1]){n.label=c[1],c=y;break}if(c&&n.label<c[2]){n.label=c[2],n.ops.push(y);break}c[2]&&n.ops.pop(),n.trys.pop();continue}y=t.call(e,n)}catch(S){y=[6,S],l=0}finally{i=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}},ug=function(){function e(){}return e.hasPermissions=function(){return XC(this,void 0,void 0,function(){var t,n,i,l;return qC(this,function(c){switch(c.label){case 0:return[4,navigator.mediaDevices.enumerateDevices()];case 1:for(t=c.sent(),n=0,i=t;n<i.length;n++)if(l=i[n],l.kind==="videoinput"&&l.label)return[2,!0];return[2,!1]}})})},e}(),rs=function(){function e(t){this.supportedScanTypes=this.validateAndReturnScanTypes(t)}return e.prototype.getDefaultScanType=function(){return this.supportedScanTypes[0]},e.prototype.hasMoreThanOneScanType=function(){return this.supportedScanTypes.length>1},e.prototype.isCameraScanRequired=function(){for(var t=0,n=this.supportedScanTypes;t<n.length;t++){var i=n[t];if(e.isCameraScanType(i))return!0}return!1},e.isCameraScanType=function(t){return t===Ss.SCAN_TYPE_CAMERA},e.isFileScanType=function(t){return t===Ss.SCAN_TYPE_FILE},e.prototype.validateAndReturnScanTypes=function(t){if(!t||t.length===0)return Qr.DEFAULT_SUPPORTED_SCAN_TYPE;var n=Qr.DEFAULT_SUPPORTED_SCAN_TYPE.length;if(t.length>n)throw"Max ".concat(n," values expected for ")+"supportedScanTypes";for(var i=0,l=t;i<l.length;i++){var c=l[i];if(!Qr.DEFAULT_SUPPORTED_SCAN_TYPE.includes(c))throw"Unsupported scan type ".concat(c)}return t},e}(),vr=function(){function e(){}return e.ALL_ELEMENT_CLASS="html5-qrcode-element",e.CAMERA_PERMISSION_BUTTON_ID="html5-qrcode-button-camera-permission",e.CAMERA_START_BUTTON_ID="html5-qrcode-button-camera-start",e.CAMERA_STOP_BUTTON_ID="html5-qrcode-button-camera-stop",e.TORCH_BUTTON_ID="html5-qrcode-button-torch",e.CAMERA_SELECTION_SELECT_ID="html5-qrcode-select-camera",e.FILE_SELECTION_BUTTON_ID="html5-qrcode-button-file-selection",e.ZOOM_SLIDER_ID="html5-qrcode-input-range-zoom",e.SCAN_TYPE_CHANGE_ANCHOR_ID="html5-qrcode-anchor-scan-type-change",e.TORCH_BUTTON_CLASS_TORCH_ON="html5-qrcode-button-torch-on",e.TORCH_BUTTON_CLASS_TORCH_OFF="html5-qrcode-button-torch-off",e}(),Pi=function(){function e(){}return e.createElement=function(t,n){var i=document.createElement(t);return i.id=n,i.classList.add(vr.ALL_ELEMENT_CLASS),t==="button"&&i.setAttribute("type","button"),i},e}(),zx=function(e,t,n,i){function l(c){return c instanceof n?c:new n(function(m){m(c)})}return new(n||(n=Promise))(function(c,m){function _(S){try{y(i.next(S))}catch(E){m(E)}}function v(S){try{y(i.throw(S))}catch(E){m(E)}}function y(S){S.done?c(S.value):l(S.value).then(_,v)}y((i=i.apply(e,t||[])).next())})},Hx=function(e,t){var n={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,l,c,m;return m={next:_(0),throw:_(1),return:_(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function _(y){return function(S){return v([y,S])}}function v(y){if(i)throw new TypeError("Generator is already executing.");for(;m&&(m=0,y[0]&&(n=0)),n;)try{if(i=1,l&&(c=y[0]&2?l.return:y[0]?l.throw||((c=l.return)&&c.call(l),0):l.next)&&!(c=c.call(l,y[1])).done)return c;switch(l=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return n.label++,{value:y[1],done:!1};case 5:n.label++,l=y[1],y=[0];continue;case 7:y=n.ops.pop(),n.trys.pop();continue;default:if(c=n.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){n=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){n.label=y[1];break}if(y[0]===6&&n.label<c[1]){n.label=c[1],c=y;break}if(c&&n.label<c[2]){n.label=c[2],n.ops.push(y);break}c[2]&&n.ops.pop(),n.trys.pop();continue}y=t.call(e,n)}catch(S){y=[6,S],l=0}finally{i=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}},dg=function(){function e(t,n,i){this.isTorchOn=!1,this.torchCapability=t,this.buttonController=n,this.onTorchActionFailureCallback=i}return e.prototype.isTorchEnabled=function(){return this.isTorchOn},e.prototype.flipState=function(){return zx(this,void 0,void 0,function(){var t,n;return Hx(this,function(i){switch(i.label){case 0:this.buttonController.disable(),t=!this.isTorchOn,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.torchCapability.apply(t)];case 2:return i.sent(),this.updateUiBasedOnLatestSettings(this.torchCapability.value(),t),[3,4];case 3:return n=i.sent(),this.propagateFailure(t,n),this.buttonController.enable(),[3,4];case 4:return[2]}})})},e.prototype.updateUiBasedOnLatestSettings=function(t,n){t===n?(this.buttonController.setText(n?Et.torchOffButton():Et.torchOnButton()),this.isTorchOn=n):this.propagateFailure(n),this.buttonController.enable()},e.prototype.propagateFailure=function(t,n){var i=t?Et.torchOnFailedMessage():Et.torchOffFailedMessage();n&&(i+="; Error = "+n),this.onTorchActionFailureCallback(i)},e.prototype.reset=function(){this.isTorchOn=!1},e}(),KC=function(){function e(t,n){this.onTorchActionFailureCallback=n,this.torchButton=Pi.createElement("button",vr.TORCH_BUTTON_ID),this.torchController=new dg(t,this,n)}return e.prototype.render=function(t,n){var i=this;this.torchButton.innerText=Et.torchOnButton(),this.torchButton.style.display=n.display,this.torchButton.style.marginLeft=n.marginLeft;var l=this;this.torchButton.addEventListener("click",function(c){return zx(i,void 0,void 0,function(){return Hx(this,function(m){switch(m.label){case 0:return[4,l.torchController.flipState()];case 1:return m.sent(),l.torchController.isTorchEnabled()?(l.torchButton.classList.remove(vr.TORCH_BUTTON_CLASS_TORCH_OFF),l.torchButton.classList.add(vr.TORCH_BUTTON_CLASS_TORCH_ON)):(l.torchButton.classList.remove(vr.TORCH_BUTTON_CLASS_TORCH_ON),l.torchButton.classList.add(vr.TORCH_BUTTON_CLASS_TORCH_OFF)),[2]}})})}),t.appendChild(this.torchButton)},e.prototype.updateTorchCapability=function(t){this.torchController=new dg(t,this,this.onTorchActionFailureCallback)},e.prototype.getTorchButton=function(){return this.torchButton},e.prototype.hide=function(){this.torchButton.style.display="none"},e.prototype.show=function(){this.torchButton.style.display="inline-block"},e.prototype.disable=function(){this.torchButton.disabled=!0},e.prototype.enable=function(){this.torchButton.disabled=!1},e.prototype.setText=function(t){this.torchButton.innerText=t},e.prototype.reset=function(){this.torchButton.innerText=Et.torchOnButton(),this.torchController.reset()},e.create=function(t,n,i,l){var c=new e(n,l);return c.render(t,i),c},e}(),QC=function(){function e(t,n,i){this.fileBasedScanRegion=this.createFileBasedScanRegion(),this.fileBasedScanRegion.style.display=n?"block":"none",t.appendChild(this.fileBasedScanRegion);var l=document.createElement("label");l.setAttribute("for",this.getFileScanInputId()),l.style.display="inline-block",this.fileBasedScanRegion.appendChild(l),this.fileSelectionButton=Pi.createElement("button",vr.FILE_SELECTION_BUTTON_ID),this.setInitialValueToButton(),this.fileSelectionButton.addEventListener("click",function(_){l.click()}),l.append(this.fileSelectionButton),this.fileScanInput=Pi.createElement("input",this.getFileScanInputId()),this.fileScanInput.type="file",this.fileScanInput.accept="image/*",this.fileScanInput.style.display="none",l.appendChild(this.fileScanInput);var c=this;this.fileScanInput.addEventListener("change",function(_){if(!(_==null||_.target==null)){var v=_.target;if(!(v.files&&v.files.length===0)){var y=v.files,S=y[0],E=S.name;c.setImageNameToButton(E),i(S)}}});var m=this.createDragAndDropMessage();this.fileBasedScanRegion.appendChild(m),this.fileBasedScanRegion.addEventListener("dragenter",function(_){c.fileBasedScanRegion.style.border=c.fileBasedScanRegionActiveBorder(),_.stopPropagation(),_.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragleave",function(_){c.fileBasedScanRegion.style.border=c.fileBasedScanRegionDefaultBorder(),_.stopPropagation(),_.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragover",function(_){c.fileBasedScanRegion.style.border=c.fileBasedScanRegionActiveBorder(),_.stopPropagation(),_.preventDefault()}),this.fileBasedScanRegion.addEventListener("drop",function(_){_.stopPropagation(),_.preventDefault(),c.fileBasedScanRegion.style.border=c.fileBasedScanRegionDefaultBorder();var v=_.dataTransfer;if(v){var y=v.files;if(!y||y.length===0)return;for(var S=!1,E=0;E<y.length;++E){var T=y.item(E);if(T){var U=/image.*/;if(T.type.match(U)){S=!0;var j=T.name;c.setImageNameToButton(j),i(T),m.innerText=Et.dragAndDropMessage();break}}}S||(m.innerText=Et.dragAndDropMessageOnlyImages())}})}return e.prototype.hide=function(){this.fileBasedScanRegion.style.display="none",this.fileScanInput.disabled=!0},e.prototype.show=function(){this.fileBasedScanRegion.style.display="block",this.fileScanInput.disabled=!1},e.prototype.isShowing=function(){return this.fileBasedScanRegion.style.display==="block"},e.prototype.resetValue=function(){this.fileScanInput.value="",this.setInitialValueToButton()},e.prototype.createFileBasedScanRegion=function(){var t=document.createElement("div");return t.style.textAlign="center",t.style.margin="auto",t.style.width="80%",t.style.maxWidth="600px",t.style.border=this.fileBasedScanRegionDefaultBorder(),t.style.padding="10px",t.style.marginBottom="10px",t},e.prototype.fileBasedScanRegionDefaultBorder=function(){return"6px dashed #ebebeb"},e.prototype.fileBasedScanRegionActiveBorder=function(){return"6px dashed rgb(153 151 151)"},e.prototype.createDragAndDropMessage=function(){var t=document.createElement("div");return t.innerText=Et.dragAndDropMessage(),t.style.fontWeight="400",t},e.prototype.setImageNameToButton=function(t){var n=20;if(t.length>n){var i=t.substring(0,8),l=t.length,c=t.substring(l-8,l);t="".concat(i,"....").concat(c)}var m=Et.fileSelectionChooseAnother()+" - "+t;this.fileSelectionButton.innerText=m},e.prototype.setInitialValueToButton=function(){var t=Et.fileSelectionChooseImage()+" - "+Et.fileSelectionNoImageSelected();this.fileSelectionButton.innerText=t},e.prototype.getFileScanInputId=function(){return"html5-qrcode-private-filescan-input"},e.create=function(t,n,i){var l=new e(t,n,i);return l},e}(),JC=function(){function e(t){this.selectElement=Pi.createElement("select",vr.CAMERA_SELECTION_SELECT_ID),this.cameras=t,this.options=[]}return e.prototype.render=function(t){var n=document.createElement("span");n.style.marginRight="10px";var i=this.cameras.length;if(i===0)throw new Error("No cameras found");if(i===1)n.style.display="none";else{var l=Et.selectCamera();n.innerText="".concat(l," (").concat(this.cameras.length,")  ")}for(var c=1,m=0,_=this.cameras;m<_.length;m++){var v=_[m],y=v.id,S=v.label==null?y:v.label;(!S||S==="")&&(S=[Et.anonymousCameraPrefix(),c++].join(" "));var E=document.createElement("option");E.value=y,E.innerText=S,this.options.push(E),this.selectElement.appendChild(E)}n.appendChild(this.selectElement),t.appendChild(n)},e.prototype.disable=function(){this.selectElement.disabled=!0},e.prototype.isDisabled=function(){return this.selectElement.disabled===!0},e.prototype.enable=function(){this.selectElement.disabled=!1},e.prototype.getValue=function(){return this.selectElement.value},e.prototype.hasValue=function(t){for(var n=0,i=this.options;n<i.length;n++){var l=i[n];if(l.value===t)return!0}return!1},e.prototype.setValue=function(t){if(!this.hasValue(t))throw new Error("".concat(t," is not present in the camera list."));this.selectElement.value=t},e.prototype.hasSingleItem=function(){return this.cameras.length===1},e.prototype.numCameras=function(){return this.cameras.length},e.create=function(t,n){var i=new e(n);return i.render(t),i},e}(),eE=function(){function e(){this.onChangeCallback=null,this.zoomElementContainer=document.createElement("div"),this.rangeInput=Pi.createElement("input",vr.ZOOM_SLIDER_ID),this.rangeInput.type="range",this.rangeText=document.createElement("span"),this.rangeInput.min="1",this.rangeInput.max="5",this.rangeInput.value="1",this.rangeInput.step="0.1"}return e.prototype.render=function(t,n){this.zoomElementContainer.style.display=n?"block":"none",this.zoomElementContainer.style.padding="5px 10px",this.zoomElementContainer.style.textAlign="center",t.appendChild(this.zoomElementContainer),this.rangeInput.style.display="inline-block",this.rangeInput.style.width="50%",this.rangeInput.style.height="5px",this.rangeInput.style.background="#d3d3d3",this.rangeInput.style.outline="none",this.rangeInput.style.opacity="0.7";var i=Et.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(i),this.rangeText.style.marginRight="10px";var l=this;this.rangeInput.addEventListener("input",function(){return l.onValueChange()}),this.rangeInput.addEventListener("change",function(){return l.onValueChange()}),this.zoomElementContainer.appendChild(this.rangeInput),this.zoomElementContainer.appendChild(this.rangeText)},e.prototype.onValueChange=function(){var t=Et.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(t),this.onChangeCallback&&this.onChangeCallback(parseFloat(this.rangeInput.value))},e.prototype.setValues=function(t,n,i,l){this.rangeInput.min=t.toString(),this.rangeInput.max=n.toString(),this.rangeInput.step=l.toString(),this.rangeInput.value=i.toString(),this.onValueChange()},e.prototype.show=function(){this.zoomElementContainer.style.display="block"},e.prototype.hide=function(){this.zoomElementContainer.style.display="none"},e.prototype.setOnCameraZoomValueChangeCallback=function(t){this.onChangeCallback=t},e.prototype.removeOnCameraZoomValueChangeCallback=function(){this.onChangeCallback=null},e.create=function(t,n){var i=new e;return i.render(t,n),i},e}(),xr;(function(e){e[e.STATUS_DEFAULT=0]="STATUS_DEFAULT",e[e.STATUS_SUCCESS=1]="STATUS_SUCCESS",e[e.STATUS_WARNING=2]="STATUS_WARNING",e[e.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(xr||(xr={}));function tE(e){return{fps:e.fps,qrbox:e.qrbox,aspectRatio:e.aspectRatio,disableFlip:e.disableFlip,videoConstraints:e.videoConstraints}}function nE(e,t){return{formatsToSupport:e.formatsToSupport,useBarCodeDetectorIfSupported:e.useBarCodeDetectorIfSupported,experimentalFeatures:e.experimentalFeatures,verbose:t}}var rE=function(){function e(t,n,i){if(this.lastMatchFound=null,this.cameraScanImage=null,this.fileScanImage=null,this.fileSelectionUi=null,this.elementId=t,this.config=this.createConfig(n),this.verbose=i===!0,!document.getElementById(t))throw"HTML Element with id=".concat(t," not found");this.scanTypeSelector=new rs(this.config.supportedScanTypes),this.currentScanType=this.scanTypeSelector.getDefaultScanType(),this.sectionSwapAllowed=!0,this.logger=new Bx(this.verbose),this.persistedDataManager=new GC,n.rememberLastUsedCamera!==!0&&this.persistedDataManager.reset()}return e.prototype.render=function(t,n){var i=this;this.lastMatchFound=null,this.qrCodeSuccessCallback=function(c,m){if(t)t(c,m);else{if(i.lastMatchFound===c)return;i.lastMatchFound=c,i.setHeaderMessage(Et.lastMatch(c),xr.STATUS_SUCCESS)}},this.qrCodeErrorCallback=function(c,m){n&&n(c,m)};var l=document.getElementById(this.elementId);if(!l)throw"HTML Element with id=".concat(this.elementId," not found");l.innerHTML="",this.createBasicLayout(l),this.html5Qrcode=new ag(this.getScanRegionId(),nE(this.config,this.verbose))},e.prototype.pause=function(t){(fi(t)||t!==!0)&&(t=!1),this.getHtml5QrcodeOrFail().pause(t)},e.prototype.resume=function(){this.getHtml5QrcodeOrFail().resume()},e.prototype.getState=function(){return this.getHtml5QrcodeOrFail().getState()},e.prototype.clear=function(){var t=this,n=function(){var i=document.getElementById(t.elementId);i&&(i.innerHTML="",t.resetBasicLayout(i))};return this.html5Qrcode?new Promise(function(i,l){if(!t.html5Qrcode){i();return}t.html5Qrcode.isScanning?t.html5Qrcode.stop().then(function(c){if(!t.html5Qrcode){i();return}t.html5Qrcode.clear(),n(),i()}).catch(function(c){t.verbose&&t.logger.logError("Unable to stop qrcode scanner",c),l(c)}):(t.html5Qrcode.clear(),n(),i())}):Promise.resolve()},e.prototype.getRunningTrackCapabilities=function(){return this.getHtml5QrcodeOrFail().getRunningTrackCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getHtml5QrcodeOrFail().getRunningTrackSettings()},e.prototype.applyVideoConstraints=function(t){return this.getHtml5QrcodeOrFail().applyVideoConstraints(t)},e.prototype.getHtml5QrcodeOrFail=function(){if(!this.html5Qrcode)throw"Code scanner not initialized.";return this.html5Qrcode},e.prototype.createConfig=function(t){return t?(t.fps||(t.fps=Qr.SCAN_DEFAULT_FPS),t.rememberLastUsedCamera!==!Qr.DEFAULT_REMEMBER_LAST_CAMERA_USED&&(t.rememberLastUsedCamera=Qr.DEFAULT_REMEMBER_LAST_CAMERA_USED),t.supportedScanTypes||(t.supportedScanTypes=Qr.DEFAULT_SUPPORTED_SCAN_TYPE),t):{fps:Qr.SCAN_DEFAULT_FPS,rememberLastUsedCamera:Qr.DEFAULT_REMEMBER_LAST_CAMERA_USED,supportedScanTypes:Qr.DEFAULT_SUPPORTED_SCAN_TYPE}},e.prototype.createBasicLayout=function(t){t.style.position="relative",t.style.padding="0px",t.style.border="1px solid silver",this.createHeader(t);var n=document.createElement("div"),i=this.getScanRegionId();n.id=i,n.style.width="100%",n.style.minHeight="100px",n.style.textAlign="center",t.appendChild(n),rs.isCameraScanType(this.currentScanType)?this.insertCameraScanImageToScanRegion():this.insertFileScanImageToScanRegion();var l=document.createElement("div"),c=this.getDashboardId();l.id=c,l.style.width="100%",t.appendChild(l),this.setupInitialDashboard(l)},e.prototype.resetBasicLayout=function(t){t.style.border="none"},e.prototype.setupInitialDashboard=function(t){this.createSection(t),this.createSectionControlPanel(),this.scanTypeSelector.hasMoreThanOneScanType()&&this.createSectionSwap()},e.prototype.createHeader=function(t){var n=document.createElement("div");n.style.textAlign="left",n.style.margin="0px",t.appendChild(n);var i=new $C;i.renderInto(n);var l=document.createElement("div");l.id=this.getHeaderMessageContainerId(),l.style.display="none",l.style.textAlign="center",l.style.fontSize="14px",l.style.padding="2px 10px",l.style.margin="4px",l.style.borderTop="1px solid #f6f6f6",n.appendChild(l)},e.prototype.createSection=function(t){var n=document.createElement("div");n.id=this.getDashboardSectionId(),n.style.width="100%",n.style.padding="10px 0px 10px 0px",n.style.textAlign="left",t.appendChild(n)},e.prototype.createCameraListUi=function(t,n,i){var l=this;l.showHideScanTypeSwapLink(!1),l.setHeaderMessage(Et.cameraPermissionRequesting());var c=function(){i||l.createPermissionButton(t,n)};ag.getCameras().then(function(m){l.persistedDataManager.setHasPermission(!0),l.showHideScanTypeSwapLink(!0),l.resetHeaderMessage(),m&&m.length>0?(t.removeChild(n),l.renderCameraSelection(m)):(l.setHeaderMessage(Et.noCameraFound(),xr.STATUS_WARNING),c())}).catch(function(m){l.persistedDataManager.setHasPermission(!1),i?i.disabled=!1:c(),l.setHeaderMessage(m,xr.STATUS_WARNING),l.showHideScanTypeSwapLink(!0)})},e.prototype.createPermissionButton=function(t,n){var i=this,l=Pi.createElement("button",this.getCameraPermissionButtonId());l.innerText=Et.cameraPermissionTitle(),l.addEventListener("click",function(){l.disabled=!0,i.createCameraListUi(t,n,l)}),n.appendChild(l)},e.prototype.createPermissionsUi=function(t,n){var i=this;if(rs.isCameraScanType(this.currentScanType)&&this.persistedDataManager.hasCameraPermissions()){ug.hasPermissions().then(function(l){l?i.createCameraListUi(t,n):(i.persistedDataManager.setHasPermission(!1),i.createPermissionButton(t,n))}).catch(function(l){i.persistedDataManager.setHasPermission(!1),i.createPermissionButton(t,n)});return}this.createPermissionButton(t,n)},e.prototype.createSectionControlPanel=function(){var t=document.getElementById(this.getDashboardSectionId()),n=document.createElement("div");t.appendChild(n);var i=document.createElement("div");i.id=this.getDashboardSectionCameraScanRegionId(),i.style.display=rs.isCameraScanType(this.currentScanType)?"block":"none",n.appendChild(i);var l=document.createElement("div");l.style.textAlign="center",i.appendChild(l),this.scanTypeSelector.isCameraScanRequired()&&this.createPermissionsUi(i,l),this.renderFileScanUi(n)},e.prototype.renderFileScanUi=function(t){var n=rs.isFileScanType(this.currentScanType),i=this,l=function(c){if(!i.html5Qrcode)throw"html5Qrcode not defined";rs.isFileScanType(i.currentScanType)&&(i.setHeaderMessage(Et.loadingImage()),i.html5Qrcode.scanFileV2(c,!0).then(function(m){i.resetHeaderMessage(),i.qrCodeSuccessCallback(m.decodedText,m)}).catch(function(m){i.setHeaderMessage(m,xr.STATUS_WARNING),i.qrCodeErrorCallback(m,Dx.createFrom(m))}))};this.fileSelectionUi=QC.create(t,n,l)},e.prototype.renderCameraSelection=function(t){var n=this,i=this,l=document.getElementById(this.getDashboardSectionCameraScanRegionId());l.style.textAlign="center";var c=eE.create(l,!1),m=function(P){var D=P.zoomFeature();if(D.isSupported()){c.setOnCameraZoomValueChangeCallback(function(I){D.apply(I)});var R=1;n.config.defaultZoomValueIfSupported&&(R=n.config.defaultZoomValueIfSupported),R=_C(R,D.min(),D.max()),c.setValues(D.min(),D.max(),R,D.step()),c.show()}},_=JC.create(l,t),v=document.createElement("span"),y=Pi.createElement("button",vr.CAMERA_START_BUTTON_ID);y.innerText=Et.scanButtonStartScanningText(),v.appendChild(y);var S=Pi.createElement("button",vr.CAMERA_STOP_BUTTON_ID);S.innerText=Et.scanButtonStopScanningText(),S.style.display="none",S.disabled=!0,v.appendChild(S);var E,T=function(P){if(!P.torchFeature().isSupported()){E&&E.hide();return}E?E.updateTorchCapability(P.torchFeature()):E=KC.create(v,P.torchFeature(),{display:"none",marginLeft:"5px"},function(D){i.setHeaderMessage(D,xr.STATUS_WARNING)}),E.show()};l.appendChild(v);var U=function(P){P||(y.style.display="none"),y.innerText=Et.scanButtonStartScanningText(),y.style.opacity="1",y.disabled=!1,P&&(y.style.display="inline-block")};if(y.addEventListener("click",function(P){y.innerText=Et.scanButtonScanningStarting(),_.disable(),y.disabled=!0,y.style.opacity="0.5",n.scanTypeSelector.hasMoreThanOneScanType()&&i.showHideScanTypeSwapLink(!1),i.resetHeaderMessage();var D=_.getValue();i.persistedDataManager.setLastUsedCameraId(D),i.html5Qrcode.start(D,tE(i.config),i.qrCodeSuccessCallback,i.qrCodeErrorCallback).then(function(R){S.disabled=!1,S.style.display="inline-block",U(!1);var I=i.html5Qrcode.getRunningTrackCameraCapabilities();n.config.showTorchButtonIfSupported===!0&&T(I),n.config.showZoomSliderIfSupported===!0&&m(I)}).catch(function(R){i.showHideScanTypeSwapLink(!0),_.enable(),U(!0),i.setHeaderMessage(R,xr.STATUS_WARNING)})}),_.hasSingleItem()&&y.click(),S.addEventListener("click",function(P){if(!i.html5Qrcode)throw"html5Qrcode not defined";S.disabled=!0,i.html5Qrcode.stop().then(function(D){n.scanTypeSelector.hasMoreThanOneScanType()&&i.showHideScanTypeSwapLink(!0),_.enable(),y.disabled=!1,S.style.display="none",y.style.display="inline-block",E&&(E.reset(),E.hide()),c.removeOnCameraZoomValueChangeCallback(),c.hide(),i.insertCameraScanImageToScanRegion()}).catch(function(D){S.disabled=!1,i.setHeaderMessage(D,xr.STATUS_WARNING)})}),i.persistedDataManager.getLastUsedCameraId()){var j=i.persistedDataManager.getLastUsedCameraId();_.hasValue(j)?(_.setValue(j),y.click()):i.persistedDataManager.resetLastUsedCameraId()}},e.prototype.createSectionSwap=function(){var t=this,n=Et.textIfCameraScanSelected(),i=Et.textIfFileScanSelected(),l=document.getElementById(this.getDashboardSectionId()),c=document.createElement("div");c.style.textAlign="center";var m=Pi.createElement("span",this.getDashboardSectionSwapLinkId());m.style.textDecoration="underline",m.style.cursor="pointer",m.innerText=rs.isCameraScanType(this.currentScanType)?n:i,m.addEventListener("click",function(){if(!t.sectionSwapAllowed){t.verbose&&t.logger.logError("Section swap called when not allowed");return}t.resetHeaderMessage(),t.fileSelectionUi.resetValue(),t.sectionSwapAllowed=!1,rs.isCameraScanType(t.currentScanType)?(t.clearScanRegion(),t.getCameraScanRegion().style.display="none",t.fileSelectionUi.show(),m.innerText=i,t.currentScanType=Ss.SCAN_TYPE_FILE,t.insertFileScanImageToScanRegion()):(t.clearScanRegion(),t.getCameraScanRegion().style.display="block",t.fileSelectionUi.hide(),m.innerText=n,t.currentScanType=Ss.SCAN_TYPE_CAMERA,t.insertCameraScanImageToScanRegion(),t.startCameraScanIfPermissionExistsOnSwap()),t.sectionSwapAllowed=!0}),c.appendChild(m),l.appendChild(c)},e.prototype.startCameraScanIfPermissionExistsOnSwap=function(){var t=this,n=this;if(this.persistedDataManager.hasCameraPermissions()){ug.hasPermissions().then(function(i){if(i){var l=document.getElementById(n.getCameraPermissionButtonId());if(!l)throw t.logger.logError("Permission button not found, fail;"),"Permission button not found";l.click()}else n.persistedDataManager.setHasPermission(!1)}).catch(function(i){n.persistedDataManager.setHasPermission(!1)});return}},e.prototype.resetHeaderMessage=function(){var t=document.getElementById(this.getHeaderMessageContainerId());t.style.display="none"},e.prototype.setHeaderMessage=function(t,n){n||(n=xr.STATUS_DEFAULT);var i=this.getHeaderMessageDiv();switch(i.innerText=t,i.style.display="block",n){case xr.STATUS_SUCCESS:i.style.background="rgba(106, 175, 80, 0.26)",i.style.color="#477735";break;case xr.STATUS_WARNING:i.style.background="rgba(203, 36, 49, 0.14)",i.style.color="#cb2431";break;case xr.STATUS_DEFAULT:default:i.style.background="rgba(0, 0, 0, 0)",i.style.color="rgb(17, 17, 17)";break}},e.prototype.showHideScanTypeSwapLink=function(t){this.scanTypeSelector.hasMoreThanOneScanType()&&(t!==!0&&(t=!1),this.sectionSwapAllowed=t,this.getDashboardSectionSwapLink().style.display=t?"inline-block":"none")},e.prototype.insertCameraScanImageToScanRegion=function(){var t=this,n=document.getElementById(this.getScanRegionId());if(this.cameraScanImage){n.innerHTML="<br>",n.appendChild(this.cameraScanImage);return}this.cameraScanImage=new Image,this.cameraScanImage.onload=function(i){n.innerHTML="<br>",n.appendChild(t.cameraScanImage)},this.cameraScanImage.width=64,this.cameraScanImage.style.opacity="0.8",this.cameraScanImage.src=HC,this.cameraScanImage.alt=Et.cameraScanAltText()},e.prototype.insertFileScanImageToScanRegion=function(){var t=this,n=document.getElementById(this.getScanRegionId());if(this.fileScanImage){n.innerHTML="<br>",n.appendChild(this.fileScanImage);return}this.fileScanImage=new Image,this.fileScanImage.onload=function(i){n.innerHTML="<br>",n.appendChild(t.fileScanImage)},this.fileScanImage.width=64,this.fileScanImage.style.opacity="0.8",this.fileScanImage.src=WC,this.fileScanImage.alt=Et.fileScanAltText()},e.prototype.clearScanRegion=function(){var t=document.getElementById(this.getScanRegionId());t.innerHTML=""},e.prototype.getDashboardSectionId=function(){return"".concat(this.elementId,"__dashboard_section")},e.prototype.getDashboardSectionCameraScanRegionId=function(){return"".concat(this.elementId,"__dashboard_section_csr")},e.prototype.getDashboardSectionSwapLinkId=function(){return vr.SCAN_TYPE_CHANGE_ANCHOR_ID},e.prototype.getScanRegionId=function(){return"".concat(this.elementId,"__scan_region")},e.prototype.getDashboardId=function(){return"".concat(this.elementId,"__dashboard")},e.prototype.getHeaderMessageContainerId=function(){return"".concat(this.elementId,"__header_message")},e.prototype.getCameraPermissionButtonId=function(){return vr.CAMERA_PERMISSION_BUTTON_ID},e.prototype.getCameraScanRegion=function(){return document.getElementById(this.getDashboardSectionCameraScanRegionId())},e.prototype.getDashboardSectionSwapLink=function(){return document.getElementById(this.getDashboardSectionSwapLinkId())},e.prototype.getHeaderMessageDiv=function(){return document.getElementById(this.getHeaderMessageContainerId())},e}();const iE=({result:e,onClose:t})=>{if(!e)return null;const n=()=>{switch(e.kind){case"ok":return g.jsx(Jb,{className:"w-16 h-16 text-green-500"});case"warn":return g.jsx(Z1,{className:"w-16 h-16 text-yellow-500"});case"err":return g.jsx(e3,{className:"w-16 h-16 text-red-500"});default:return g.jsx(Z1,{className:"w-16 h-16 text-gray-500"})}},i=()=>{switch(e.kind){case"ok":return"bg-green-50 border-green-200";case"warn":return"bg-yellow-50 border-yellow-200";case"err":return"bg-red-50 border-red-200";default:return"bg-gray-50 border-gray-200"}},l=()=>{switch(e.kind){case"ok":return"text-green-800";case"warn":return"text-yellow-800";case"err":return"text-red-800";default:return"text-gray-800"}};return g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:g.jsxs("div",{className:`${i()} border-2 rounded-2xl p-8 max-w-md w-full text-center shadow-2xl`,children:[g.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:g.jsx(zf,{className:"w-6 h-6"})}),g.jsx("div",{className:"mb-4",children:n()}),g.jsx("h3",{className:`text-2xl font-bold mb-2 ${l()}`,children:e.kind==="ok"?"SUCCESS!":e.kind==="warn"?"WARNING":"ERROR"}),g.jsx("p",{className:`text-lg ${l()} mb-6`,children:e.text}),g.jsx("button",{onClick:t,className:`px-6 py-3 rounded-lg font-semibold transition-colors ${e.kind==="ok"?"bg-green-500 hover:bg-green-600 text-white":e.kind==="warn"?"bg-yellow-500 hover:bg-yellow-600 text-white":"bg-red-500 hover:bg-red-600 text-white"}`,children:"Scan Next Ticket"})]})})};function sE(){const{user:e}=ur(),[t]=Fp(),[n,i]=H.useState([]),[l,c]=H.useState(t.get("event")||""),[m,_]=H.useState(null),[v,y]=H.useState(""),S=H.useRef(null),E=H.useRef(null),T=H.useRef(!0),U=()=>{if(!l)return;if(!document.getElementById("qr-reader")){y("QR reader element not found");return}T.current=!0;try{E.current=new rE("qr-reader",{fps:10,qrbox:250},!1),E.current.render(async D=>{if(T.current)try{if(T.current=!1,E.current){try{await E.current.clear()}catch(z){console.warn("Error clearing scanner:",z)}E.current=null}const R=D.trim().toLowerCase().startsWith("suki:")?D.trim().slice(5):D.trim();y("");const{data:I,error:k}=await Re.rpc("validate_and_use_ticket",{p_event:l,p_qr_token:R});if(k)_({kind:"err",text:k.message});else{const z=I==null?void 0:I.status;_(z==="OK"?{kind:"ok",text:"PASS ✓ Ticket validated"}:z==="ALREADY_USED"?{kind:"warn",text:"ALREADY USED"}:z==="WRONG_EVENT"?{kind:"err",text:"WRONG EVENT"}:z==="NOT_FOUND"?{kind:"err",text:"TICKET NOT FOUND"}:z==="FORBIDDEN"?{kind:"err",text:"You are not allowed to scan for this event"}:z==="NOT_AUTHENTICATED"?{kind:"err",text:"Please sign in"}:{kind:"err",text:z||"ERROR"})}}catch(R){_({kind:"err",text:R.message})}},D=>{typeof D=="string"&&D&&y(D)})}catch(D){y("Failed to initialize scanner: "+D.message)}},j=()=>{if(E.current){try{E.current.clear()}catch(D){console.warn("Error clearing scanner:",D)}E.current=null}const P=document.getElementById("qr-reader");P&&(P.innerHTML=""),T.current=!0,y(""),setTimeout(()=>{U()},300)};return H.useEffect(()=>{e&&(async()=>{const{data:P,error:D}=await Re.from("events").select("id,title,start_at").eq("creator_id",e.id).eq("status","published").order("start_at",{ascending:!1});D||i(P||[])})()},[e]),H.useEffect(()=>{if(!l||E.current)return;T.current=!0,_(null),y("");const P=setTimeout(()=>{U()},100);return()=>{var D;clearTimeout(P);try{(D=E.current)==null||D.clear()}catch{}E.current=null}},[l]),e?g.jsx("div",{className:"min-h-screen bg-gray-50",children:g.jsxs("div",{className:"container mx-auto px-4 py-8 space-y-6",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Door Scanner"}),g.jsx(bs,{to:"/manage-events",className:"btn",children:"Back"})]}),g.jsxs("div",{className:"card p-6 space-y-4",children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Choose event to scan"}),g.jsxs("select",{className:"input w-full",value:l,onChange:P=>c(P.target.value),children:[g.jsx("option",{value:"",children:"— Select one of your published events —"}),n.map(P=>g.jsxs("option",{value:P.id,children:[P.title," — ",new Date(P.start_at).toLocaleString()]},P.id))]})]}),l&&g.jsxs("div",{className:"card p-6 space-y-4",children:[g.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"QR Code Scanner"}),g.jsx("div",{id:"qr-reader",ref:S,className:"w-full"}),v&&g.jsxs("div",{className:"p-3 rounded text-center bg-red-600/20 text-red-300",children:["Camera error: ",v]}),g.jsxs("div",{className:"text-sm text-gray-500 bg-blue-50 p-3 rounded",children:["💡 ",g.jsx("strong",{children:"Tip:"})," If camera access is blocked, allow it in your browser settings. This scanner works best on mobile devices."]})]}),g.jsx(iE,{result:m,onClose:()=>{_(null),j()}})]})}):g.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:g.jsx("div",{className:"card p-6 text-center",children:"Please sign in to access the scanner."})})}bd.createRoot(document.getElementById("root")).render(g.jsx(qn.StrictMode,{children:g.jsx(Yb,{children:g.jsx($b,{children:g.jsx(Nw,{children:g.jsxs(yw,{children:[g.jsx(Xn,{path:"/",element:g.jsx(p3,{})}),g.jsx(Xn,{path:"/tickets",element:g.jsx(M3,{})}),g.jsx(Xn,{path:"/auth",element:g.jsx(O3,{})}),g.jsx(Xn,{path:"/auth/callback",element:g.jsx(L3,{})}),g.jsx(Xn,{path:"/profile",element:g.jsx(R3,{})}),g.jsx(Xn,{path:"/organizer",element:g.jsx(D3,{})}),g.jsx(Xn,{path:"/saved",element:g.jsx(U3,{})}),g.jsx(Xn,{path:"/create",element:g.jsx(lC,{})}),g.jsx(Xn,{path:"/events/:id",element:g.jsx(fC,{})}),g.jsx(Xn,{path:"/browse-events",element:g.jsx(mC,{})}),g.jsx(Xn,{path:"/manage-events",element:g.jsx(pC,{})}),g.jsx(Xn,{path:"/edit-event",element:g.jsx(yC,{})}),g.jsx(Xn,{path:"/copy-event",element:g.jsx(vC,{})}),g.jsx(Xn,{path:"/scan",element:g.jsx(sE,{})})]})})})})}));
